{"modules":[{"ast":{"type":"Program","start":0,"end":2617,"body":[{"type":"ExportNamedDeclaration","start":0,"end":10,"specifiers":[],"source":null,"attributes":[],"declaration":null}],"_rollupRemoved":[{"end":2617,"start":11,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"export {};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNvbmZpZy5tb2RlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBPQXV0aDIgQ29uZmlndXJhdGlvbiBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgT0F1dGgyQ29uZmlnIHtcclxuICAvKiogT0F1dGgyIENsaWVudCBJRCAqL1xyXG4gIGNsaWVudElkOiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIFJlZGlyZWN0IFVSSSBmb3IgT0F1dGgyIGNhbGxiYWNrICovXHJcbiAgcmVkaXJlY3RVcmk6IHN0cmluZztcclxuICBcclxuICAvKiogQXV0aG9yaXphdGlvbiBlbmRwb2ludCBVUkwgKi9cclxuICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IHN0cmluZztcclxuICBcclxuICAvKiogVG9rZW4gZW5kcG9pbnQgVVJMICovXHJcbiAgdG9rZW5FbmRwb2ludDogc3RyaW5nO1xyXG4gIFxyXG4gIC8qKiBUb2tlbiByZXZvY2F0aW9uIGVuZHBvaW50IFVSTCAob3B0aW9uYWwpICovXHJcbiAgcmV2b2tlRW5kcG9pbnQ/OiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIE9JREMgVXNlckluZm8gZW5kcG9pbnQgVVJMIChvcHRpb25hbCkgKi9cclxuICB1c2VySW5mb0VuZHBvaW50Pzogc3RyaW5nO1xyXG4gIFxyXG4gIC8qKiBPQXV0aDIgYXVkaWVuY2UgcGFyYW1ldGVyIChvcHRpb25hbCkgKi9cclxuICBhdWRpZW5jZT86IHN0cmluZztcclxuICBcclxuICAvKiogT0F1dGgyIHNjb3BlIHBhcmFtZXRlciAqL1xyXG4gIHNjb3BlOiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIE9BdXRoMiByZXNwb25zZSB0eXBlIChkZWZhdWx0OiAnY29kZScpICovXHJcbiAgcmVzcG9uc2VUeXBlPzogJ2NvZGUnO1xyXG4gIFxyXG4gIC8qKiBQS0NFIGNvZGUgY2hhbGxlbmdlIG1ldGhvZCAoZGVmYXVsdDogJ1MyNTYnKSAqL1xyXG4gIGNvZGVDaGFsbGVuZ2VNZXRob2Q/OiAnUzI1Nic7XHJcbiAgXHJcbiAgLyoqIFN0b3JhZ2Ugc3RyYXRlZ3kgZm9yIHRva2VucyAqL1xyXG4gIHN0b3JhZ2U/OiAnbG9jYWxTdG9yYWdlJyB8ICdzZXNzaW9uU3RvcmFnZScgfCAnY3VzdG9tJztcclxuICBcclxuICAvKiogQ3VzdG9tIHN0b3JhZ2UgaW1wbGVtZW50YXRpb24gKHJlcXVpcmVkIGlmIHN0b3JhZ2UgaXMgJ2N1c3RvbScpICovXHJcbiAgY3VzdG9tU3RvcmFnZT86IE9BdXRoMlN0b3JhZ2U7XHJcbiAgXHJcbiAgLyoqIEVuYWJsZSBhdXRvbWF0aWMgdG9rZW4gcmVmcmVzaCAoZGVmYXVsdDogdHJ1ZSkgKi9cclxuICBhdXRvUmVmcmVzaD86IGJvb2xlYW47XHJcbiAgXHJcbiAgLyoqIFNlY29uZHMgYmVmb3JlIGV4cGlyeSB0byByZWZyZXNoIHRva2VuIChkZWZhdWx0OiAzMDApICovXHJcbiAgcmVmcmVzaFRocmVzaG9sZD86IG51bWJlcjtcclxuICBcclxuICAvKiogTG9nZ2luZyBsZXZlbCAoZGVmYXVsdDogJ3dhcm4nKSAqL1xyXG4gIGxvZ0xldmVsPzogJ25vbmUnIHwgJ2Vycm9yJyB8ICd3YXJuJyB8ICdpbmZvJyB8ICdkZWJ1Zyc7XHJcbiAgXHJcbiAgLyoqIEN1c3RvbSBub25jZSB2YWx1ZSAob3B0aW9uYWwsIHdpbGwgYmUgZ2VuZXJhdGVkIGlmIG5vdCBwcm92aWRlZCkgKi9cclxuICBub25jZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEN1c3RvbSBTdG9yYWdlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBPQXV0aDJTdG9yYWdlIHtcclxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbDtcclxuICBzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZDtcclxuICByZW1vdmVJdGVtKGtleTogc3RyaW5nKTogdm9pZDtcclxuICBjbGVhcj8oKTogdm9pZDtcclxufVxyXG4iXX0=","customTransformCache":false,"dependencies":[],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-config.model.mjs","meta":{},"moduleSideEffects":true,"originalCode":"export {};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNvbmZpZy5tb2RlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBPQXV0aDIgQ29uZmlndXJhdGlvbiBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgT0F1dGgyQ29uZmlnIHtcclxuICAvKiogT0F1dGgyIENsaWVudCBJRCAqL1xyXG4gIGNsaWVudElkOiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIFJlZGlyZWN0IFVSSSBmb3IgT0F1dGgyIGNhbGxiYWNrICovXHJcbiAgcmVkaXJlY3RVcmk6IHN0cmluZztcclxuICBcclxuICAvKiogQXV0aG9yaXphdGlvbiBlbmRwb2ludCBVUkwgKi9cclxuICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IHN0cmluZztcclxuICBcclxuICAvKiogVG9rZW4gZW5kcG9pbnQgVVJMICovXHJcbiAgdG9rZW5FbmRwb2ludDogc3RyaW5nO1xyXG4gIFxyXG4gIC8qKiBUb2tlbiByZXZvY2F0aW9uIGVuZHBvaW50IFVSTCAob3B0aW9uYWwpICovXHJcbiAgcmV2b2tlRW5kcG9pbnQ/OiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIE9JREMgVXNlckluZm8gZW5kcG9pbnQgVVJMIChvcHRpb25hbCkgKi9cclxuICB1c2VySW5mb0VuZHBvaW50Pzogc3RyaW5nO1xyXG4gIFxyXG4gIC8qKiBPQXV0aDIgYXVkaWVuY2UgcGFyYW1ldGVyIChvcHRpb25hbCkgKi9cclxuICBhdWRpZW5jZT86IHN0cmluZztcclxuICBcclxuICAvKiogT0F1dGgyIHNjb3BlIHBhcmFtZXRlciAqL1xyXG4gIHNjb3BlOiBzdHJpbmc7XHJcbiAgXHJcbiAgLyoqIE9BdXRoMiByZXNwb25zZSB0eXBlIChkZWZhdWx0OiAnY29kZScpICovXHJcbiAgcmVzcG9uc2VUeXBlPzogJ2NvZGUnO1xyXG4gIFxyXG4gIC8qKiBQS0NFIGNvZGUgY2hhbGxlbmdlIG1ldGhvZCAoZGVmYXVsdDogJ1MyNTYnKSAqL1xyXG4gIGNvZGVDaGFsbGVuZ2VNZXRob2Q/OiAnUzI1Nic7XHJcbiAgXHJcbiAgLyoqIFN0b3JhZ2Ugc3RyYXRlZ3kgZm9yIHRva2VucyAqL1xyXG4gIHN0b3JhZ2U/OiAnbG9jYWxTdG9yYWdlJyB8ICdzZXNzaW9uU3RvcmFnZScgfCAnY3VzdG9tJztcclxuICBcclxuICAvKiogQ3VzdG9tIHN0b3JhZ2UgaW1wbGVtZW50YXRpb24gKHJlcXVpcmVkIGlmIHN0b3JhZ2UgaXMgJ2N1c3RvbScpICovXHJcbiAgY3VzdG9tU3RvcmFnZT86IE9BdXRoMlN0b3JhZ2U7XHJcbiAgXHJcbiAgLyoqIEVuYWJsZSBhdXRvbWF0aWMgdG9rZW4gcmVmcmVzaCAoZGVmYXVsdDogdHJ1ZSkgKi9cclxuICBhdXRvUmVmcmVzaD86IGJvb2xlYW47XHJcbiAgXHJcbiAgLyoqIFNlY29uZHMgYmVmb3JlIGV4cGlyeSB0byByZWZyZXNoIHRva2VuIChkZWZhdWx0OiAzMDApICovXHJcbiAgcmVmcmVzaFRocmVzaG9sZD86IG51bWJlcjtcclxuICBcclxuICAvKiogTG9nZ2luZyBsZXZlbCAoZGVmYXVsdDogJ3dhcm4nKSAqL1xyXG4gIGxvZ0xldmVsPzogJ25vbmUnIHwgJ2Vycm9yJyB8ICd3YXJuJyB8ICdpbmZvJyB8ICdkZWJ1Zyc7XHJcbiAgXHJcbiAgLyoqIEN1c3RvbSBub25jZSB2YWx1ZSAob3B0aW9uYWwsIHdpbGwgYmUgZ2VuZXJhdGVkIGlmIG5vdCBwcm92aWRlZCkgKi9cclxuICBub25jZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIEN1c3RvbSBTdG9yYWdlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBPQXV0aDJTdG9yYWdlIHtcclxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbDtcclxuICBzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZDtcclxuICByZW1vdmVJdGVtKGtleTogc3RyaW5nKTogdm9pZDtcclxuICBjbGVhcj8oKTogdm9pZDtcclxufVxyXG4iXX0=","originalSourcemap":{"mappings":[],"names":[],"sources":[],"version":3},"resolvedIds":{},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":5241,"body":[{"type":"ExportNamedDeclaration","start":41,"end":406,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"VariableDeclaration","start":48,"end":406,"kind":"const","declarations":[{"type":"VariableDeclarator","start":54,"end":405,"id":{"type":"Identifier","start":54,"end":73,"name":"OAUTH2_STORAGE_KEYS"},"init":{"type":"ObjectExpression","start":76,"end":405,"properties":[{"type":"Property","start":82,"end":119,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":82,"end":95,"name":"CODE_VERIFIER"},"value":{"type":"Literal","start":97,"end":119,"value":"oauth2_code_verifier","raw":"'oauth2_code_verifier'"},"kind":"init"},{"type":"Property","start":125,"end":146,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":125,"end":130,"name":"STATE"},"value":{"type":"Literal","start":132,"end":146,"value":"oauth2_state","raw":"'oauth2_state'"},"kind":"init"},{"type":"Property","start":152,"end":187,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":152,"end":164,"name":"ACCESS_TOKEN"},"value":{"type":"Literal","start":166,"end":187,"value":"oauth2_access_token","raw":"'oauth2_access_token'"},"kind":"init"},{"type":"Property","start":193,"end":230,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":193,"end":206,"name":"REFRESH_TOKEN"},"value":{"type":"Literal","start":208,"end":230,"value":"oauth2_refresh_token","raw":"'oauth2_refresh_token'"},"kind":"init"},{"type":"Property","start":236,"end":279,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":236,"end":252,"name":"TOKEN_EXPIRES_AT"},"value":{"type":"Literal","start":254,"end":279,"value":"oauth2_token_expires_at","raw":"'oauth2_token_expires_at'"},"kind":"init"},{"type":"Property","start":285,"end":316,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":285,"end":295,"name":"TOKEN_TYPE"},"value":{"type":"Literal","start":297,"end":316,"value":"oauth2_token_type","raw":"'oauth2_token_type'"},"kind":"init"},{"type":"Property","start":322,"end":343,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":322,"end":327,"name":"SCOPE"},"value":{"type":"Literal","start":329,"end":343,"value":"oauth2_scope","raw":"'oauth2_scope'"},"kind":"init"},{"type":"Property","start":349,"end":376,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":349,"end":357,"name":"ID_TOKEN"},"value":{"type":"Literal","start":359,"end":376,"value":"oauth2_id_token","raw":"'oauth2_id_token'"},"kind":"init"},{"type":"Property","start":382,"end":403,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":382,"end":387,"name":"NONCE"},"value":{"type":"Literal","start":389,"end":403,"value":"oauth2_nonce","raw":"'oauth2_nonce'"},"kind":"init"}]}}]}}],"_rollupRemoved":[{"end":5241,"start":407,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"/**\n * OAuth2 Storage Keys Constants\n */\nexport const OAUTH2_STORAGE_KEYS = {\n    CODE_VERIFIER: 'oauth2_code_verifier',\n    STATE: 'oauth2_state',\n    ACCESS_TOKEN: 'oauth2_access_token',\n    REFRESH_TOKEN: 'oauth2_refresh_token',\n    TOKEN_EXPIRES_AT: 'oauth2_token_expires_at',\n    TOKEN_TYPE: 'oauth2_token_type',\n    SCOPE: 'oauth2_scope',\n    ID_TOKEN: 'oauth2_id_token',\n    NONCE: 'oauth2_nonce'\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLXR5cGVzLm1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2RlbHMvb2F1dGgyLXR5cGVzLm1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWlIQTs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHO0lBQ2pDLGFBQWEsRUFBRSxzQkFBc0I7SUFDckMsS0FBSyxFQUFFLGNBQWM7SUFDckIsWUFBWSxFQUFFLHFCQUFxQjtJQUNuQyxhQUFhLEVBQUUsc0JBQXNCO0lBQ3JDLGdCQUFnQixFQUFFLHlCQUF5QjtJQUMzQyxVQUFVLEVBQUUsbUJBQW1CO0lBQy9CLEtBQUssRUFBRSxjQUFjO0lBQ3JCLFFBQVEsRUFBRSxpQkFBaUI7SUFDM0IsS0FBSyxFQUFFLGNBQWM7Q0FDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFBLQ0UgQ2hhbGxlbmdlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQS0NFQ2hhbGxlbmdlIHtcclxuICBjb2RlVmVyaWZpZXI6IHN0cmluZztcclxuICBjb2RlQ2hhbGxlbmdlOiBzdHJpbmc7XHJcbiAgY29kZUNoYWxsZW5nZU1ldGhvZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogT0F1dGgyIEF1dGhvcml6YXRpb24gUmVxdWVzdCBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXV0aG9yaXphdGlvblJlcXVlc3Qge1xyXG4gIGNsaWVudF9pZDogc3RyaW5nO1xyXG4gIHJlZGlyZWN0X3VyaTogc3RyaW5nO1xyXG4gIHJlc3BvbnNlX3R5cGU6IHN0cmluZztcclxuICBub25jZTogc3RyaW5nO1xyXG4gIGF1ZGllbmNlPzogc3RyaW5nO1xyXG4gIHNjb3BlOiBzdHJpbmc7XHJcbiAgY29kZV9jaGFsbGVuZ2VfbWV0aG9kOiBzdHJpbmc7XHJcbiAgY29kZV9jaGFsbGVuZ2U6IHN0cmluZztcclxuICBzdGF0ZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBUb2tlbiBSZXF1ZXN0IEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb2tlblJlcXVlc3Qge1xyXG4gIGdyYW50X3R5cGU6IHN0cmluZztcclxuICByZWRpcmVjdF91cmk6IHN0cmluZztcclxuICBjbGllbnRfaWQ6IHN0cmluZztcclxuICBjb2RlOiBzdHJpbmc7XHJcbiAgY29kZV92ZXJpZmllcjogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogT0F1dGgyIFRva2VuIFJlc3BvbnNlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb2tlblJlc3BvbnNlIHtcclxuICBhY2Nlc3NfdG9rZW46IHN0cmluZztcclxuICByZWZyZXNoX3Rva2VuPzogc3RyaW5nO1xyXG4gIHRva2VuX3R5cGU6IHN0cmluZztcclxuICBleHBpcmVzX2luOiBudW1iZXI7XHJcbiAgc2NvcGU/OiBzdHJpbmc7XHJcbiAgaWRfdG9rZW4/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUb2tlbiBJbmZvcm1hdGlvbiBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVG9rZW5JbmZvIHtcclxuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xyXG4gIHJlZnJlc2hUb2tlbj86IHN0cmluZztcclxuICB0b2tlblR5cGU6IHN0cmluZztcclxuICBleHBpcmVzQXQ6IG51bWJlcjtcclxuICBzY29wZT86IHN0cmluZztcclxuICBpZFRva2VuPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogQXV0aGVudGljYXRpb24gU3RhdGUgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhTdGF0ZSB7XHJcbiAgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuO1xyXG4gIGlzTG9hZGluZzogYm9vbGVhbjtcclxuICBlcnJvcj86IHN0cmluZztcclxuICB0b2tlbkluZm8/OiBUb2tlbkluZm87XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgRXJyb3IgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMkVycm9yIHtcclxuICBlcnJvcjogc3RyaW5nO1xyXG4gIGVycm9yX2Rlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gIGVycm9yX3VyaT86IHN0cmluZztcclxuICBzdGF0ZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIFVzZXIgSW5mb3JtYXRpb24gUmVzcG9uc2UgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJJbmZvUmVzcG9uc2Uge1xyXG4gIHN1Yjogc3RyaW5nO1xyXG4gIG5hbWU/OiBzdHJpbmc7XHJcbiAgZ2l2ZW5fbmFtZT86IHN0cmluZztcclxuICBmYW1pbHlfbmFtZT86IHN0cmluZztcclxuICBtaWRkbGVfbmFtZT86IHN0cmluZztcclxuICBuaWNrbmFtZT86IHN0cmluZztcclxuICBwcmVmZXJyZWRfdXNlcm5hbWU/OiBzdHJpbmc7XHJcbiAgcHJvZmlsZT86IHN0cmluZztcclxuICBwaWN0dXJlPzogc3RyaW5nO1xyXG4gIHdlYnNpdGU/OiBzdHJpbmc7XHJcbiAgZW1haWw/OiBzdHJpbmc7XHJcbiAgZW1haWxfdmVyaWZpZWQ/OiBib29sZWFuO1xyXG4gIGdlbmRlcj86IHN0cmluZztcclxuICBiaXJ0aGRhdGU/OiBzdHJpbmc7XHJcbiAgem9uZWluZm8/OiBzdHJpbmc7XHJcbiAgbG9jYWxlPzogc3RyaW5nO1xyXG4gIHBob25lX251bWJlcj86IHN0cmluZztcclxuICBwaG9uZV9udW1iZXJfdmVyaWZpZWQ/OiBib29sZWFuO1xyXG4gIGFkZHJlc3M/OiB7XHJcbiAgICBmb3JtYXR0ZWQ/OiBzdHJpbmc7XHJcbiAgICBzdHJlZXRfYWRkcmVzcz86IHN0cmluZztcclxuICAgIGxvY2FsaXR5Pzogc3RyaW5nO1xyXG4gICAgcmVnaW9uPzogc3RyaW5nO1xyXG4gICAgcG9zdGFsX2NvZGU/OiBzdHJpbmc7XHJcbiAgICBjb3VudHJ5Pzogc3RyaW5nO1xyXG4gIH07XHJcbiAgdXBkYXRlZF9hdD86IG51bWJlcjtcclxuICBba2V5OiBzdHJpbmddOiBhbnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgU3RvcmFnZSBLZXlzIENvbnN0YW50c1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IE9BVVRIMl9TVE9SQUdFX0tFWVMgPSB7XHJcbiAgQ09ERV9WRVJJRklFUjogJ29hdXRoMl9jb2RlX3ZlcmlmaWVyJyxcclxuICBTVEFURTogJ29hdXRoMl9zdGF0ZScsXHJcbiAgQUNDRVNTX1RPS0VOOiAnb2F1dGgyX2FjY2Vzc190b2tlbicsXHJcbiAgUkVGUkVTSF9UT0tFTjogJ29hdXRoMl9yZWZyZXNoX3Rva2VuJyxcclxuICBUT0tFTl9FWFBJUkVTX0FUOiAnb2F1dGgyX3Rva2VuX2V4cGlyZXNfYXQnLFxyXG4gIFRPS0VOX1RZUEU6ICdvYXV0aDJfdG9rZW5fdHlwZScsXHJcbiAgU0NPUEU6ICdvYXV0aDJfc2NvcGUnLFxyXG4gIElEX1RPS0VOOiAnb2F1dGgyX2lkX3Rva2VuJyxcclxuICBOT05DRTogJ29hdXRoMl9ub25jZSdcclxufSBhcyBjb25zdDtcclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgTG9nIExldmVsc1xyXG4gKi9cclxuZXhwb3J0IHR5cGUgT0F1dGgyTG9nTGV2ZWwgPSAnbm9uZScgfCAnZXJyb3InIHwgJ3dhcm4nIHwgJ2luZm8nIHwgJ2RlYnVnJztcclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgRXZlbnRzXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMkV2ZW50cyB7XHJcbiAgdG9rZW5SZWZyZXNoZWQ6IFRva2VuSW5mbztcclxuICB0b2tlbkV4cGlyZWQ6IHZvaWQ7XHJcbiAgYXV0aGVudGljYXRpb25GYWlsZWQ6IE9BdXRoMkVycm9yO1xyXG4gIHVzZXJMb2dnZWRPdXQ6IHZvaWQ7XHJcbn0iXX0=","customTransformCache":false,"dependencies":[],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","meta":{},"moduleSideEffects":true,"originalCode":"/**\n * OAuth2 Storage Keys Constants\n */\nexport const OAUTH2_STORAGE_KEYS = {\n    CODE_VERIFIER: 'oauth2_code_verifier',\n    STATE: 'oauth2_state',\n    ACCESS_TOKEN: 'oauth2_access_token',\n    REFRESH_TOKEN: 'oauth2_refresh_token',\n    TOKEN_EXPIRES_AT: 'oauth2_token_expires_at',\n    TOKEN_TYPE: 'oauth2_token_type',\n    SCOPE: 'oauth2_scope',\n    ID_TOKEN: 'oauth2_id_token',\n    NONCE: 'oauth2_nonce'\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLXR5cGVzLm1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tb2RlbHMvb2F1dGgyLXR5cGVzLm1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWlIQTs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHO0lBQ2pDLGFBQWEsRUFBRSxzQkFBc0I7SUFDckMsS0FBSyxFQUFFLGNBQWM7SUFDckIsWUFBWSxFQUFFLHFCQUFxQjtJQUNuQyxhQUFhLEVBQUUsc0JBQXNCO0lBQ3JDLGdCQUFnQixFQUFFLHlCQUF5QjtJQUMzQyxVQUFVLEVBQUUsbUJBQW1CO0lBQy9CLEtBQUssRUFBRSxjQUFjO0lBQ3JCLFFBQVEsRUFBRSxpQkFBaUI7SUFDM0IsS0FBSyxFQUFFLGNBQWM7Q0FDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIFBLQ0UgQ2hhbGxlbmdlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBQS0NFQ2hhbGxlbmdlIHtcclxuICBjb2RlVmVyaWZpZXI6IHN0cmluZztcclxuICBjb2RlQ2hhbGxlbmdlOiBzdHJpbmc7XHJcbiAgY29kZUNoYWxsZW5nZU1ldGhvZDogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogT0F1dGgyIEF1dGhvcml6YXRpb24gUmVxdWVzdCBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXV0aG9yaXphdGlvblJlcXVlc3Qge1xyXG4gIGNsaWVudF9pZDogc3RyaW5nO1xyXG4gIHJlZGlyZWN0X3VyaTogc3RyaW5nO1xyXG4gIHJlc3BvbnNlX3R5cGU6IHN0cmluZztcclxuICBub25jZTogc3RyaW5nO1xyXG4gIGF1ZGllbmNlPzogc3RyaW5nO1xyXG4gIHNjb3BlOiBzdHJpbmc7XHJcbiAgY29kZV9jaGFsbGVuZ2VfbWV0aG9kOiBzdHJpbmc7XHJcbiAgY29kZV9jaGFsbGVuZ2U6IHN0cmluZztcclxuICBzdGF0ZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBUb2tlbiBSZXF1ZXN0IEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb2tlblJlcXVlc3Qge1xyXG4gIGdyYW50X3R5cGU6IHN0cmluZztcclxuICByZWRpcmVjdF91cmk6IHN0cmluZztcclxuICBjbGllbnRfaWQ6IHN0cmluZztcclxuICBjb2RlOiBzdHJpbmc7XHJcbiAgY29kZV92ZXJpZmllcjogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogT0F1dGgyIFRva2VuIFJlc3BvbnNlIEludGVyZmFjZVxyXG4gKi9cclxuZXhwb3J0IGludGVyZmFjZSBUb2tlblJlc3BvbnNlIHtcclxuICBhY2Nlc3NfdG9rZW46IHN0cmluZztcclxuICByZWZyZXNoX3Rva2VuPzogc3RyaW5nO1xyXG4gIHRva2VuX3R5cGU6IHN0cmluZztcclxuICBleHBpcmVzX2luOiBudW1iZXI7XHJcbiAgc2NvcGU/OiBzdHJpbmc7XHJcbiAgaWRfdG9rZW4/OiBzdHJpbmc7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBUb2tlbiBJbmZvcm1hdGlvbiBJbnRlcmZhY2VcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgVG9rZW5JbmZvIHtcclxuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xyXG4gIHJlZnJlc2hUb2tlbj86IHN0cmluZztcclxuICB0b2tlblR5cGU6IHN0cmluZztcclxuICBleHBpcmVzQXQ6IG51bWJlcjtcclxuICBzY29wZT86IHN0cmluZztcclxuICBpZFRva2VuPzogc3RyaW5nO1xyXG59XHJcblxyXG4vKipcclxuICogQXV0aGVudGljYXRpb24gU3RhdGUgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhTdGF0ZSB7XHJcbiAgaXNBdXRoZW50aWNhdGVkOiBib29sZWFuO1xyXG4gIGlzTG9hZGluZzogYm9vbGVhbjtcclxuICBlcnJvcj86IHN0cmluZztcclxuICB0b2tlbkluZm8/OiBUb2tlbkluZm87XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgRXJyb3IgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMkVycm9yIHtcclxuICBlcnJvcjogc3RyaW5nO1xyXG4gIGVycm9yX2Rlc2NyaXB0aW9uPzogc3RyaW5nO1xyXG4gIGVycm9yX3VyaT86IHN0cmluZztcclxuICBzdGF0ZT86IHN0cmluZztcclxufVxyXG5cclxuLyoqXHJcbiAqIFVzZXIgSW5mb3JtYXRpb24gUmVzcG9uc2UgSW50ZXJmYWNlXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJJbmZvUmVzcG9uc2Uge1xyXG4gIHN1Yjogc3RyaW5nO1xyXG4gIG5hbWU/OiBzdHJpbmc7XHJcbiAgZ2l2ZW5fbmFtZT86IHN0cmluZztcclxuICBmYW1pbHlfbmFtZT86IHN0cmluZztcclxuICBtaWRkbGVfbmFtZT86IHN0cmluZztcclxuICBuaWNrbmFtZT86IHN0cmluZztcclxuICBwcmVmZXJyZWRfdXNlcm5hbWU/OiBzdHJpbmc7XHJcbiAgcHJvZmlsZT86IHN0cmluZztcclxuICBwaWN0dXJlPzogc3RyaW5nO1xyXG4gIHdlYnNpdGU/OiBzdHJpbmc7XHJcbiAgZW1haWw/OiBzdHJpbmc7XHJcbiAgZW1haWxfdmVyaWZpZWQ/OiBib29sZWFuO1xyXG4gIGdlbmRlcj86IHN0cmluZztcclxuICBiaXJ0aGRhdGU/OiBzdHJpbmc7XHJcbiAgem9uZWluZm8/OiBzdHJpbmc7XHJcbiAgbG9jYWxlPzogc3RyaW5nO1xyXG4gIHBob25lX251bWJlcj86IHN0cmluZztcclxuICBwaG9uZV9udW1iZXJfdmVyaWZpZWQ/OiBib29sZWFuO1xyXG4gIGFkZHJlc3M/OiB7XHJcbiAgICBmb3JtYXR0ZWQ/OiBzdHJpbmc7XHJcbiAgICBzdHJlZXRfYWRkcmVzcz86IHN0cmluZztcclxuICAgIGxvY2FsaXR5Pzogc3RyaW5nO1xyXG4gICAgcmVnaW9uPzogc3RyaW5nO1xyXG4gICAgcG9zdGFsX2NvZGU/OiBzdHJpbmc7XHJcbiAgICBjb3VudHJ5Pzogc3RyaW5nO1xyXG4gIH07XHJcbiAgdXBkYXRlZF9hdD86IG51bWJlcjtcclxuICBba2V5OiBzdHJpbmddOiBhbnk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgU3RvcmFnZSBLZXlzIENvbnN0YW50c1xyXG4gKi9cclxuZXhwb3J0IGNvbnN0IE9BVVRIMl9TVE9SQUdFX0tFWVMgPSB7XHJcbiAgQ09ERV9WRVJJRklFUjogJ29hdXRoMl9jb2RlX3ZlcmlmaWVyJyxcclxuICBTVEFURTogJ29hdXRoMl9zdGF0ZScsXHJcbiAgQUNDRVNTX1RPS0VOOiAnb2F1dGgyX2FjY2Vzc190b2tlbicsXHJcbiAgUkVGUkVTSF9UT0tFTjogJ29hdXRoMl9yZWZyZXNoX3Rva2VuJyxcclxuICBUT0tFTl9FWFBJUkVTX0FUOiAnb2F1dGgyX3Rva2VuX2V4cGlyZXNfYXQnLFxyXG4gIFRPS0VOX1RZUEU6ICdvYXV0aDJfdG9rZW5fdHlwZScsXHJcbiAgU0NPUEU6ICdvYXV0aDJfc2NvcGUnLFxyXG4gIElEX1RPS0VOOiAnb2F1dGgyX2lkX3Rva2VuJyxcclxuICBOT05DRTogJ29hdXRoMl9ub25jZSdcclxufSBhcyBjb25zdDtcclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgTG9nIExldmVsc1xyXG4gKi9cclxuZXhwb3J0IHR5cGUgT0F1dGgyTG9nTGV2ZWwgPSAnbm9uZScgfCAnZXJyb3InIHwgJ3dhcm4nIHwgJ2luZm8nIHwgJ2RlYnVnJztcclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgRXZlbnRzXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMkV2ZW50cyB7XHJcbiAgdG9rZW5SZWZyZXNoZWQ6IFRva2VuSW5mbztcclxuICB0b2tlbkV4cGlyZWQ6IHZvaWQ7XHJcbiAgYXV0aGVudGljYXRpb25GYWlsZWQ6IE9BdXRoMkVycm9yO1xyXG4gIHVzZXJMb2dnZWRPdXQ6IHZvaWQ7XHJcbn0iXX0=","originalSourcemap":{"version":3,"file":"oauth2-types.model.js","sourceRoot":"","sources":["../../../../../src/lib/models/oauth2-types.model.ts"],"names":[],"mappings":[[[0,0,113,0]],[],[[3,0,115,3]],[[0,0,116,0],[6,0,116,6],[7,0,116,7],[13,0,116,13],[32,0,116,32],[35,0,116,35]],[[4,0,117,2],[17,0,117,15],[19,0,117,17],[41,0,117,39]],[[4,0,118,2],[9,0,118,7],[11,0,118,9],[25,0,118,23]],[[4,0,119,2],[16,0,119,14],[18,0,119,16],[39,0,119,37]],[[4,0,120,2],[17,0,120,15],[19,0,120,17],[41,0,120,39]],[[4,0,121,2],[20,0,121,18],[22,0,121,20],[47,0,121,45]],[[4,0,122,2],[14,0,122,12],[16,0,122,14],[35,0,122,33]],[[4,0,123,2],[9,0,123,7],[11,0,123,9],[25,0,123,23]],[[4,0,124,2],[12,0,124,10],[14,0,124,12],[31,0,124,29]],[[4,0,125,2],[9,0,125,7],[11,0,125,9],[25,0,125,23]],[[1,0,126,10],[2,0,126,11]]],"sourcesContent":["/**\r\n * PKCE Challenge Interface\r\n */\r\nexport interface PKCEChallenge {\r\n  codeVerifier: string;\r\n  codeChallenge: string;\r\n  codeChallengeMethod: string;\r\n}\r\n\r\n/**\r\n * OAuth2 Authorization Request Interface\r\n */\r\nexport interface AuthorizationRequest {\r\n  client_id: string;\r\n  redirect_uri: string;\r\n  response_type: string;\r\n  nonce: string;\r\n  audience?: string;\r\n  scope: string;\r\n  code_challenge_method: string;\r\n  code_challenge: string;\r\n  state?: string;\r\n}\r\n\r\n/**\r\n * OAuth2 Token Request Interface\r\n */\r\nexport interface TokenRequest {\r\n  grant_type: string;\r\n  redirect_uri: string;\r\n  client_id: string;\r\n  code: string;\r\n  code_verifier: string;\r\n}\r\n\r\n/**\r\n * OAuth2 Token Response Interface\r\n */\r\nexport interface TokenResponse {\r\n  access_token: string;\r\n  refresh_token?: string;\r\n  token_type: string;\r\n  expires_in: number;\r\n  scope?: string;\r\n  id_token?: string;\r\n}\r\n\r\n/**\r\n * Token Information Interface\r\n */\r\nexport interface TokenInfo {\r\n  accessToken: string;\r\n  refreshToken?: string;\r\n  tokenType: string;\r\n  expiresAt: number;\r\n  scope?: string;\r\n  idToken?: string;\r\n}\r\n\r\n/**\r\n * Authentication State Interface\r\n */\r\nexport interface AuthState {\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error?: string;\r\n  tokenInfo?: TokenInfo;\r\n}\r\n\r\n/**\r\n * OAuth2 Error Interface\r\n */\r\nexport interface OAuth2Error {\r\n  error: string;\r\n  error_description?: string;\r\n  error_uri?: string;\r\n  state?: string;\r\n}\r\n\r\n/**\r\n * User Information Response Interface\r\n */\r\nexport interface UserInfoResponse {\r\n  sub: string;\r\n  name?: string;\r\n  given_name?: string;\r\n  family_name?: string;\r\n  middle_name?: string;\r\n  nickname?: string;\r\n  preferred_username?: string;\r\n  profile?: string;\r\n  picture?: string;\r\n  website?: string;\r\n  email?: string;\r\n  email_verified?: boolean;\r\n  gender?: string;\r\n  birthdate?: string;\r\n  zoneinfo?: string;\r\n  locale?: string;\r\n  phone_number?: string;\r\n  phone_number_verified?: boolean;\r\n  address?: {\r\n    formatted?: string;\r\n    street_address?: string;\r\n    locality?: string;\r\n    region?: string;\r\n    postal_code?: string;\r\n    country?: string;\r\n  };\r\n  updated_at?: number;\r\n  [key: string]: any;\r\n}\r\n\r\n/**\r\n * OAuth2 Storage Keys Constants\r\n */\r\nexport const OAUTH2_STORAGE_KEYS = {\r\n  CODE_VERIFIER: 'oauth2_code_verifier',\r\n  STATE: 'oauth2_state',\r\n  ACCESS_TOKEN: 'oauth2_access_token',\r\n  REFRESH_TOKEN: 'oauth2_refresh_token',\r\n  TOKEN_EXPIRES_AT: 'oauth2_token_expires_at',\r\n  TOKEN_TYPE: 'oauth2_token_type',\r\n  SCOPE: 'oauth2_scope',\r\n  ID_TOKEN: 'oauth2_id_token',\r\n  NONCE: 'oauth2_nonce'\r\n} as const;\r\n\r\n/**\r\n * OAuth2 Log Levels\r\n */\r\nexport type OAuth2LogLevel = 'none' | 'error' | 'warn' | 'info' | 'debug';\r\n\r\n/**\r\n * OAuth2 Events\r\n */\r\nexport interface OAuth2Events {\r\n  tokenRefreshed: TokenInfo;\r\n  tokenExpired: void;\r\n  authenticationFailed: OAuth2Error;\r\n  userLoggedOut: void;\r\n}"]},"resolvedIds":{},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":962,"body":[{"type":"ImportDeclaration","start":0,"end":47,"specifiers":[{"type":"ImportSpecifier","start":9,"end":23,"imported":{"type":"Identifier","start":9,"end":23,"name":"InjectionToken"},"local":{"type":"Identifier","start":9,"end":23,"name":"InjectionToken"}}],"source":{"type":"Literal","start":31,"end":46,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ExportNamedDeclaration","start":100,"end":171,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"VariableDeclaration","start":107,"end":171,"kind":"const","declarations":[{"type":"VariableDeclarator","start":113,"end":170,"id":{"type":"Identifier","start":113,"end":132,"name":"OAUTH2_CONFIG_TOKEN"},"init":{"type":"NewExpression","start":135,"end":170,"callee":{"type":"Identifier","start":139,"end":153,"name":"InjectionToken"},"arguments":[{"type":"Literal","start":154,"end":169,"value":"OAUTH2_CONFIG","raw":"'OAUTH2_CONFIG'"}]}}]}}],"_rollupRemoved":[{"end":962,"start":172,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { InjectionToken } from '@angular/core';\n/**\n * Injection token for OAuth2 configuration\n */\nexport const OAUTH2_CONFIG_TOKEN = new InjectionToken('OAUTH2_CONFIG');\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNvbmZpZy50b2tlbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUcvQzs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHLElBQUksY0FBYyxDQUFlLGVBQWUsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0aW9uVG9rZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5cclxuLyoqXHJcbiAqIEluamVjdGlvbiB0b2tlbiBmb3IgT0F1dGgyIGNvbmZpZ3VyYXRpb25cclxuICovXHJcbmV4cG9ydCBjb25zdCBPQVVUSDJfQ09ORklHX1RPS0VOID0gbmV3IEluamVjdGlvblRva2VuPE9BdXRoMkNvbmZpZz4oJ09BVVRIMl9DT05GSUcnKTsiXX0=","customTransformCache":false,"dependencies":["@angular/core"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { InjectionToken } from '@angular/core';\n/**\n * Injection token for OAuth2 configuration\n */\nexport const OAUTH2_CONFIG_TOKEN = new InjectionToken('OAUTH2_CONFIG');\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNvbmZpZy50b2tlbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUcvQzs7R0FFRztBQUNILE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFHLElBQUksY0FBYyxDQUFlLGVBQWUsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0aW9uVG9rZW4gfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5cclxuLyoqXHJcbiAqIEluamVjdGlvbiB0b2tlbiBmb3IgT0F1dGgyIGNvbmZpZ3VyYXRpb25cclxuICovXHJcbmV4cG9ydCBjb25zdCBPQVVUSDJfQ09ORklHX1RPS0VOID0gbmV3IEluamVjdGlvblRva2VuPE9BdXRoMkNvbmZpZz4oJ09BVVRIMl9DT05GSUcnKTsiXX0=","originalSourcemap":{"version":3,"file":"oauth2-config.token.js","sourceRoot":"","sources":["../../../../../src/lib/tokens/oauth2-config.token.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[23,0,0,23],[25,0,0,25],[31,0,0,31],[46,0,0,46],[47,0,0,47]],[[0,0,3,0]],[],[[3,0,5,3]],[[0,0,6,0],[6,0,6,6],[7,0,6,7],[13,0,6,13],[32,0,6,32],[35,0,6,35],[39,0,6,39],[53,0,6,53],[54,0,6,68],[69,0,6,83],[70,0,6,84],[71,0,6,85]]],"sourcesContent":["import { InjectionToken } from '@angular/core';\r\nimport { OAuth2Config } from '../models/oauth2-config.model';\r\n\r\n/**\r\n * Injection token for OAuth2 configuration\r\n */\r\nexport const OAUTH2_CONFIG_TOKEN = new InjectionToken<OAuth2Config>('OAUTH2_CONFIG');"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":21523,"body":[{"type":"ImportDeclaration","start":0,"end":64,"specifiers":[{"type":"ImportSpecifier","start":9,"end":19,"imported":{"type":"Identifier","start":9,"end":19,"name":"Injectable"},"local":{"type":"Identifier","start":9,"end":19,"name":"Injectable"}},{"type":"ImportSpecifier","start":21,"end":27,"imported":{"type":"Identifier","start":21,"end":27,"name":"Inject"},"local":{"type":"Identifier","start":21,"end":27,"name":"Inject"}},{"type":"ImportSpecifier","start":29,"end":40,"imported":{"type":"Identifier","start":29,"end":40,"name":"PLATFORM_ID"},"local":{"type":"Identifier","start":29,"end":40,"name":"PLATFORM_ID"}}],"source":{"type":"Literal","start":48,"end":63,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":65,"end":117,"specifiers":[{"type":"ImportSpecifier","start":74,"end":91,"imported":{"type":"Identifier","start":74,"end":91,"name":"isPlatformBrowser"},"local":{"type":"Identifier","start":74,"end":91,"name":"isPlatformBrowser"}}],"source":{"type":"Literal","start":99,"end":116,"value":"@angular/common","raw":"'@angular/common'"},"attributes":[]},{"type":"ImportDeclaration","start":118,"end":185,"specifiers":[{"type":"ImportSpecifier","start":127,"end":146,"imported":{"type":"Identifier","start":127,"end":146,"name":"OAUTH2_STORAGE_KEYS"},"local":{"type":"Identifier","start":127,"end":146,"name":"OAUTH2_STORAGE_KEYS"}}],"source":{"type":"Literal","start":154,"end":184,"value":"../models/oauth2-types.model","raw":"'../models/oauth2-types.model'"},"attributes":[]},{"type":"ImportDeclaration","start":186,"end":254,"specifiers":[{"type":"ImportSpecifier","start":195,"end":214,"imported":{"type":"Identifier","start":195,"end":214,"name":"OAUTH2_CONFIG_TOKEN"},"local":{"type":"Identifier","start":195,"end":214,"name":"OAUTH2_CONFIG_TOKEN"}}],"source":{"type":"Literal","start":222,"end":253,"value":"../tokens/oauth2-config.token","raw":"'../tokens/oauth2-config.token'"},"attributes":[]},{"type":"ImportDeclaration","start":255,"end":291,"specifiers":[{"type":"ImportNamespaceSpecifier","start":262,"end":269,"local":{"type":"Identifier","start":267,"end":269,"name":"i0"}}],"source":{"type":"Literal","start":275,"end":290,"value":"@angular/core","raw":"\"@angular/core\""},"attributes":[]},{"type":"ExportNamedDeclaration","start":392,"end":6155,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":399,"end":6155,"decorators":[],"id":{"type":"Identifier","start":405,"end":425,"name":"OAuth2StorageService"},"superClass":null,"body":{"type":"ClassBody","start":426,"end":6155,"body":[{"type":"MethodDefinition","start":432,"end":639,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":432,"end":443,"name":"constructor"},"value":{"type":"FunctionExpression","start":443,"end":639,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":444,"end":450,"name":"config"},{"type":"Identifier","start":452,"end":462,"name":"platformId"}],"body":{"type":"BlockStatement","start":464,"end":639,"body":[{"type":"ExpressionStatement","start":474,"end":495,"expression":{"type":"AssignmentExpression","start":474,"end":494,"operator":"=","left":{"type":"MemberExpression","start":474,"end":485,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":474,"end":478},"property":{"type":"Identifier","start":479,"end":485,"name":"config"}},"right":{"type":"Identifier","start":488,"end":494,"name":"config"}}},{"type":"ExpressionStatement","start":504,"end":533,"expression":{"type":"AssignmentExpression","start":504,"end":532,"operator":"=","left":{"type":"MemberExpression","start":504,"end":519,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":504,"end":508},"property":{"type":"Identifier","start":509,"end":519,"name":"platformId"}},"right":{"type":"Identifier","start":522,"end":532,"name":"platformId"}}},{"type":"ExpressionStatement","start":542,"end":584,"expression":{"type":"AssignmentExpression","start":542,"end":583,"operator":"=","left":{"type":"MemberExpression","start":542,"end":555,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":542,"end":546},"property":{"type":"Identifier","start":547,"end":555,"name":"logLevel"}},"right":{"type":"LogicalExpression","start":558,"end":583,"operator":"||","left":{"type":"MemberExpression","start":558,"end":573,"computed":false,"optional":false,"object":{"type":"Identifier","start":558,"end":564,"name":"config"},"property":{"type":"Identifier","start":565,"end":573,"name":"logLevel"}},"right":{"type":"Literal","start":577,"end":583,"value":"warn","raw":"'warn'"}}}},{"type":"ExpressionStatement","start":593,"end":633,"expression":{"type":"AssignmentExpression","start":593,"end":632,"operator":"=","left":{"type":"MemberExpression","start":593,"end":605,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":593,"end":597},"property":{"type":"Identifier","start":598,"end":605,"name":"storage"}},"right":{"type":"CallExpression","start":608,"end":632,"optional":false,"callee":{"type":"MemberExpression","start":608,"end":630,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":608,"end":612},"property":{"type":"Identifier","start":613,"end":630,"name":"initializeStorage"}},"arguments":[]}}}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":709,"end":1504,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":709,"end":726,"name":"initializeStorage"},"value":{"type":"FunctionExpression","start":726,"end":1504,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":729,"end":1504,"body":[{"type":"IfStatement","start":739,"end":1018,"test":{"type":"UnaryExpression","start":743,"end":778,"operator":"!","argument":{"type":"CallExpression","start":744,"end":778,"optional":false,"callee":{"type":"Identifier","start":744,"end":761,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":762,"end":777,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":762,"end":766},"property":{"type":"Identifier","start":767,"end":777,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":780,"end":1018,"body":[{"type":"ReturnStatement","start":840,"end":1008,"argument":{"type":"ObjectExpression","start":847,"end":1007,"properties":[{"type":"Property","start":865,"end":884,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":865,"end":872,"name":"getItem"},"value":{"type":"ArrowFunctionExpression","start":874,"end":884,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"Literal","start":880,"end":884,"raw":"null","value":null},"id":null},"kind":"init"},{"type":"Property","start":902,"end":920,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":902,"end":909,"name":"setItem"},"value":{"type":"ArrowFunctionExpression","start":911,"end":920,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":917,"end":920,"body":[]},"id":null},"kind":"init"},{"type":"Property","start":938,"end":959,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":938,"end":948,"name":"removeItem"},"value":{"type":"ArrowFunctionExpression","start":950,"end":959,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":956,"end":959,"body":[]},"id":null},"kind":"init"},{"type":"Property","start":977,"end":993,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":977,"end":982,"name":"clear"},"value":{"type":"ArrowFunctionExpression","start":984,"end":993,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":990,"end":993,"body":[]},"id":null},"kind":"init"}]}}]},"alternate":null},{"type":"SwitchStatement","start":1027,"end":1498,"discriminant":{"type":"MemberExpression","start":1035,"end":1054,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1035,"end":1046,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1035,"end":1039},"property":{"type":"Identifier","start":1040,"end":1046,"name":"config"}},"property":{"type":"Identifier","start":1047,"end":1054,"name":"storage"}},"cases":[{"type":"SwitchCase","start":1070,"end":1131,"test":{"type":"Literal","start":1075,"end":1091,"value":"sessionStorage","raw":"'sessionStorage'"},"consequent":[{"type":"ReturnStatement","start":1109,"end":1131,"argument":{"type":"Identifier","start":1116,"end":1130,"name":"sessionStorage"}}]},{"type":"SwitchCase","start":1144,"end":1397,"test":{"type":"Literal","start":1149,"end":1157,"value":"custom","raw":"'custom'"},"consequent":[{"type":"IfStatement","start":1175,"end":1347,"test":{"type":"UnaryExpression","start":1179,"end":1205,"operator":"!","argument":{"type":"MemberExpression","start":1180,"end":1205,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1180,"end":1191,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1180,"end":1184},"property":{"type":"Identifier","start":1185,"end":1191,"name":"config"}},"property":{"type":"Identifier","start":1192,"end":1205,"name":"customStorage"}},"prefix":true},"consequent":{"type":"BlockStatement","start":1207,"end":1347,"body":[{"type":"ExpressionStatement","start":1229,"end":1288,"expression":{"type":"CallExpression","start":1229,"end":1287,"optional":false,"callee":{"type":"MemberExpression","start":1229,"end":1242,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1229,"end":1233},"property":{"type":"Identifier","start":1234,"end":1242,"name":"logError"}},"arguments":[{"type":"Literal","start":1243,"end":1286,"value":"Custom storage specified but not provided","raw":"'Custom storage specified but not provided'"}]}},{"type":"ReturnStatement","start":1309,"end":1329,"argument":{"type":"Identifier","start":1316,"end":1328,"name":"localStorage"}}]},"alternate":null},{"type":"ReturnStatement","start":1364,"end":1397,"argument":{"type":"MemberExpression","start":1371,"end":1396,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1371,"end":1382,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1371,"end":1375},"property":{"type":"Identifier","start":1376,"end":1382,"name":"config"}},"property":{"type":"Identifier","start":1383,"end":1396,"name":"customStorage"}}}]},{"type":"SwitchCase","start":1410,"end":1430,"test":{"type":"Literal","start":1415,"end":1429,"value":"localStorage","raw":"'localStorage'"},"consequent":[]},{"type":"SwitchCase","start":1443,"end":1488,"test":null,"consequent":[{"type":"ReturnStatement","start":1468,"end":1488,"argument":{"type":"Identifier","start":1475,"end":1487,"name":"localStorage"}}]}]}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":1555,"end":1922,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1555,"end":1562,"name":"setItem"},"value":{"type":"FunctionExpression","start":1562,"end":1922,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":1563,"end":1566,"name":"key"},{"type":"Identifier","start":1568,"end":1573,"name":"value"}],"body":{"type":"BlockStatement","start":1575,"end":1922,"body":[{"type":"TryStatement","start":1585,"end":1916,"block":{"type":"BlockStatement","start":1589,"end":1772,"body":[{"type":"ExpressionStatement","start":1670,"end":1703,"expression":{"type":"CallExpression","start":1670,"end":1702,"optional":false,"callee":{"type":"MemberExpression","start":1670,"end":1690,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1670,"end":1682,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1670,"end":1674},"property":{"type":"Identifier","start":1675,"end":1682,"name":"storage"}},"property":{"type":"Identifier","start":1683,"end":1690,"name":"setItem"}},"arguments":[{"type":"Identifier","start":1691,"end":1694,"name":"key"},{"type":"Identifier","start":1696,"end":1701,"name":"value"}]}},{"type":"ExpressionStatement","start":1716,"end":1762,"expression":{"type":"CallExpression","start":1716,"end":1761,"optional":false,"callee":{"type":"MemberExpression","start":1716,"end":1729,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1716,"end":1720},"property":{"type":"Identifier","start":1721,"end":1729,"name":"logDebug"}},"arguments":[{"type":"TemplateLiteral","start":1730,"end":1760,"quasis":[{"type":"TemplateElement","start":1731,"end":1753,"tail":false,"value":{"cooked":"Stored item with key: ","raw":"Stored item with key: "}},{"type":"TemplateElement","start":1759,"end":1759,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":1755,"end":1758,"name":"key"}]}]}}]},"handler":{"type":"CatchClause","start":1781,"end":1916,"param":{"type":"Identifier","start":1788,"end":1793,"name":"error"},"body":{"type":"BlockStatement","start":1795,"end":1916,"body":[{"type":"ExpressionStatement","start":1809,"end":1853,"expression":{"type":"CallExpression","start":1809,"end":1852,"optional":false,"callee":{"type":"MemberExpression","start":1809,"end":1822,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1809,"end":1813},"property":{"type":"Identifier","start":1814,"end":1822,"name":"logError"}},"arguments":[{"type":"Literal","start":1823,"end":1844,"value":"Error storing item:","raw":"'Error storing item:'"},{"type":"Identifier","start":1846,"end":1851,"name":"error"}]}},{"type":"ThrowStatement","start":1866,"end":1906,"argument":{"type":"NewExpression","start":1872,"end":1905,"callee":{"type":"Identifier","start":1876,"end":1881,"name":"Error"},"arguments":[{"type":"Literal","start":1882,"end":1904,"value":"Failed to store item","raw":"'Failed to store item'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":1976,"end":2311,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1976,"end":1983,"name":"getItem"},"value":{"type":"FunctionExpression","start":1983,"end":2311,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":1984,"end":1987,"name":"key"}],"body":{"type":"BlockStatement","start":1989,"end":2311,"body":[{"type":"TryStatement","start":1999,"end":2305,"block":{"type":"BlockStatement","start":2003,"end":2186,"body":[{"type":"VariableDeclaration","start":2017,"end":2057,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2023,"end":2056,"id":{"type":"Identifier","start":2023,"end":2028,"name":"value"},"init":{"type":"CallExpression","start":2031,"end":2056,"optional":false,"callee":{"type":"MemberExpression","start":2031,"end":2051,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2031,"end":2043,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2031,"end":2035},"property":{"type":"Identifier","start":2036,"end":2043,"name":"storage"}},"property":{"type":"Identifier","start":2044,"end":2051,"name":"getItem"}},"arguments":[{"type":"Identifier","start":2052,"end":2055,"name":"key"}]}}]},{"type":"ExpressionStatement","start":2070,"end":2150,"expression":{"type":"CallExpression","start":2070,"end":2149,"optional":false,"callee":{"type":"MemberExpression","start":2070,"end":2083,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2070,"end":2074},"property":{"type":"Identifier","start":2075,"end":2083,"name":"logDebug"}},"arguments":[{"type":"TemplateLiteral","start":2084,"end":2117,"quasis":[{"type":"TemplateElement","start":2085,"end":2110,"tail":false,"value":{"cooked":"Retrieved item with key: ","raw":"Retrieved item with key: "}},{"type":"TemplateElement","start":2116,"end":2116,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":2112,"end":2115,"name":"key"}]},{"type":"ConditionalExpression","start":2119,"end":2148,"test":{"type":"Identifier","start":2119,"end":2124,"name":"value"},"consequent":{"type":"Literal","start":2127,"end":2134,"value":"Found","raw":"'Found'"},"alternate":{"type":"Literal","start":2137,"end":2148,"value":"Not found","raw":"'Not found'"}}]}},{"type":"ReturnStatement","start":2163,"end":2176,"argument":{"type":"Identifier","start":2170,"end":2175,"name":"value"}}]},"handler":{"type":"CatchClause","start":2195,"end":2305,"param":{"type":"Identifier","start":2202,"end":2207,"name":"error"},"body":{"type":"BlockStatement","start":2209,"end":2305,"body":[{"type":"ExpressionStatement","start":2223,"end":2270,"expression":{"type":"CallExpression","start":2223,"end":2269,"optional":false,"callee":{"type":"MemberExpression","start":2223,"end":2236,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2223,"end":2227},"property":{"type":"Identifier","start":2228,"end":2236,"name":"logError"}},"arguments":[{"type":"Literal","start":2237,"end":2261,"value":"Error retrieving item:","raw":"'Error retrieving item:'"},{"type":"Identifier","start":2263,"end":2268,"name":"error"}]}},{"type":"ReturnStatement","start":2283,"end":2295,"argument":{"type":"Literal","start":2290,"end":2294,"raw":"null","value":null}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":2362,"end":2603,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":2362,"end":2372,"name":"removeItem"},"value":{"type":"FunctionExpression","start":2372,"end":2603,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":2373,"end":2376,"name":"key"}],"body":{"type":"BlockStatement","start":2378,"end":2603,"body":[{"type":"TryStatement","start":2388,"end":2597,"block":{"type":"BlockStatement","start":2392,"end":2505,"body":[{"type":"ExpressionStatement","start":2406,"end":2435,"expression":{"type":"CallExpression","start":2406,"end":2434,"optional":false,"callee":{"type":"MemberExpression","start":2406,"end":2429,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2406,"end":2418,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2406,"end":2410},"property":{"type":"Identifier","start":2411,"end":2418,"name":"storage"}},"property":{"type":"Identifier","start":2419,"end":2429,"name":"removeItem"}},"arguments":[{"type":"Identifier","start":2430,"end":2433,"name":"key"}]}},{"type":"ExpressionStatement","start":2448,"end":2495,"expression":{"type":"CallExpression","start":2448,"end":2494,"optional":false,"callee":{"type":"MemberExpression","start":2448,"end":2461,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2448,"end":2452},"property":{"type":"Identifier","start":2453,"end":2461,"name":"logDebug"}},"arguments":[{"type":"TemplateLiteral","start":2462,"end":2493,"quasis":[{"type":"TemplateElement","start":2463,"end":2486,"tail":false,"value":{"cooked":"Removed item with key: ","raw":"Removed item with key: "}},{"type":"TemplateElement","start":2492,"end":2492,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":2488,"end":2491,"name":"key"}]}]}}]},"handler":{"type":"CatchClause","start":2514,"end":2597,"param":{"type":"Identifier","start":2521,"end":2526,"name":"error"},"body":{"type":"BlockStatement","start":2528,"end":2597,"body":[{"type":"ExpressionStatement","start":2542,"end":2587,"expression":{"type":"CallExpression","start":2542,"end":2586,"optional":false,"callee":{"type":"MemberExpression","start":2542,"end":2555,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2542,"end":2546},"property":{"type":"Identifier","start":2547,"end":2555,"name":"logError"}},"arguments":[{"type":"Literal","start":2556,"end":2578,"value":"Error removing item:","raw":"'Error removing item:'"},{"type":"Identifier","start":2580,"end":2585,"name":"error"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":2664,"end":2984,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":2664,"end":2672,"name":"clearAll"},"value":{"type":"FunctionExpression","start":2672,"end":2984,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":2675,"end":2984,"body":[{"type":"TryStatement","start":2685,"end":2978,"block":{"type":"BlockStatement","start":2689,"end":2883,"body":[{"type":"ExpressionStatement","start":2703,"end":2816,"expression":{"type":"CallExpression","start":2703,"end":2815,"optional":false,"callee":{"type":"MemberExpression","start":2703,"end":2745,"computed":false,"optional":false,"object":{"type":"CallExpression","start":2703,"end":2737,"optional":false,"callee":{"type":"MemberExpression","start":2703,"end":2716,"computed":false,"optional":false,"object":{"type":"Identifier","start":2703,"end":2709,"name":"Object"},"property":{"type":"Identifier","start":2710,"end":2716,"name":"values"}},"arguments":[{"type":"Identifier","start":2717,"end":2736,"name":"OAUTH2_STORAGE_KEYS"}]},"property":{"type":"Identifier","start":2738,"end":2745,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":2746,"end":2814,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":2746,"end":2749,"name":"key"}],"body":{"type":"BlockStatement","start":2753,"end":2814,"body":[{"type":"ExpressionStatement","start":2771,"end":2800,"expression":{"type":"CallExpression","start":2771,"end":2799,"optional":false,"callee":{"type":"MemberExpression","start":2771,"end":2794,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2771,"end":2783,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2771,"end":2775},"property":{"type":"Identifier","start":2776,"end":2783,"name":"storage"}},"property":{"type":"Identifier","start":2784,"end":2794,"name":"removeItem"}},"arguments":[{"type":"Identifier","start":2795,"end":2798,"name":"key"}]}}]},"id":null}]}},{"type":"ExpressionStatement","start":2829,"end":2873,"expression":{"type":"CallExpression","start":2829,"end":2872,"optional":false,"callee":{"type":"MemberExpression","start":2829,"end":2842,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2829,"end":2833},"property":{"type":"Identifier","start":2834,"end":2842,"name":"logDebug"}},"arguments":[{"type":"Literal","start":2843,"end":2871,"value":"Cleared all OAuth2 storage","raw":"'Cleared all OAuth2 storage'"}]}}]},"handler":{"type":"CatchClause","start":2892,"end":2978,"param":{"type":"Identifier","start":2899,"end":2904,"name":"error"},"body":{"type":"BlockStatement","start":2906,"end":2978,"body":[{"type":"ExpressionStatement","start":2920,"end":2968,"expression":{"type":"CallExpression","start":2920,"end":2967,"optional":false,"callee":{"type":"MemberExpression","start":2920,"end":2933,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2920,"end":2924},"property":{"type":"Identifier","start":2925,"end":2933,"name":"logError"}},"arguments":[{"type":"Literal","start":2934,"end":2959,"value":"Error clearing storage:","raw":"'Error clearing storage:'"},{"type":"Identifier","start":2961,"end":2966,"name":"error"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":3075,"end":3744,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":3075,"end":3086,"name":"clearTokens"},"value":{"type":"FunctionExpression","start":3086,"end":3744,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":3089,"end":3744,"body":[{"type":"TryStatement","start":3099,"end":3738,"block":{"type":"BlockStatement","start":3103,"end":3637,"body":[{"type":"VariableDeclaration","start":3117,"end":3442,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3123,"end":3441,"id":{"type":"Identifier","start":3123,"end":3132,"name":"tokenKeys"},"init":{"type":"ArrayExpression","start":3135,"end":3441,"elements":[{"type":"MemberExpression","start":3153,"end":3185,"computed":false,"optional":false,"object":{"type":"Identifier","start":3153,"end":3172,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3173,"end":3185,"name":"ACCESS_TOKEN"}},{"type":"MemberExpression","start":3203,"end":3236,"computed":false,"optional":false,"object":{"type":"Identifier","start":3203,"end":3222,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3223,"end":3236,"name":"REFRESH_TOKEN"}},{"type":"MemberExpression","start":3254,"end":3290,"computed":false,"optional":false,"object":{"type":"Identifier","start":3254,"end":3273,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3274,"end":3290,"name":"TOKEN_EXPIRES_AT"}},{"type":"MemberExpression","start":3308,"end":3338,"computed":false,"optional":false,"object":{"type":"Identifier","start":3308,"end":3327,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3328,"end":3338,"name":"TOKEN_TYPE"}},{"type":"MemberExpression","start":3356,"end":3381,"computed":false,"optional":false,"object":{"type":"Identifier","start":3356,"end":3375,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3376,"end":3381,"name":"SCOPE"}},{"type":"MemberExpression","start":3399,"end":3427,"computed":false,"optional":false,"object":{"type":"Identifier","start":3399,"end":3418,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3419,"end":3427,"name":"ID_TOKEN"}}]}}]},{"type":"ExpressionStatement","start":3455,"end":3543,"expression":{"type":"CallExpression","start":3455,"end":3542,"optional":false,"callee":{"type":"MemberExpression","start":3455,"end":3472,"computed":false,"optional":false,"object":{"type":"Identifier","start":3455,"end":3464,"name":"tokenKeys"},"property":{"type":"Identifier","start":3465,"end":3472,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":3473,"end":3541,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":3473,"end":3476,"name":"key"}],"body":{"type":"BlockStatement","start":3480,"end":3541,"body":[{"type":"ExpressionStatement","start":3498,"end":3527,"expression":{"type":"CallExpression","start":3498,"end":3526,"optional":false,"callee":{"type":"MemberExpression","start":3498,"end":3521,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3498,"end":3510,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3498,"end":3502},"property":{"type":"Identifier","start":3503,"end":3510,"name":"storage"}},"property":{"type":"Identifier","start":3511,"end":3521,"name":"removeItem"}},"arguments":[{"type":"Identifier","start":3522,"end":3525,"name":"key"}]}}]},"id":null}]}},{"type":"ExpressionStatement","start":3556,"end":3627,"expression":{"type":"CallExpression","start":3556,"end":3626,"optional":false,"callee":{"type":"MemberExpression","start":3556,"end":3569,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3556,"end":3560},"property":{"type":"Identifier","start":3561,"end":3569,"name":"logDebug"}},"arguments":[{"type":"Literal","start":3570,"end":3625,"value":"Cleared token storage (OAuth2 flow storage preserved)","raw":"'Cleared token storage (OAuth2 flow storage preserved)'"}]}}]},"handler":{"type":"CatchClause","start":3646,"end":3738,"param":{"type":"Identifier","start":3653,"end":3658,"name":"error"},"body":{"type":"BlockStatement","start":3660,"end":3738,"body":[{"type":"ExpressionStatement","start":3674,"end":3728,"expression":{"type":"CallExpression","start":3674,"end":3727,"optional":false,"callee":{"type":"MemberExpression","start":3674,"end":3687,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3674,"end":3678},"property":{"type":"Identifier","start":3679,"end":3687,"name":"logError"}},"arguments":[{"type":"Literal","start":3688,"end":3719,"value":"Error clearing token storage:","raw":"'Error clearing token storage:'"},{"type":"Identifier","start":3721,"end":3726,"name":"error"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":3808,"end":4224,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":3808,"end":3822,"name":"clearTemporary"},"value":{"type":"FunctionExpression","start":3822,"end":4224,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":3825,"end":4224,"body":[{"type":"TryStatement","start":3835,"end":4218,"block":{"type":"BlockStatement","start":3839,"end":4113,"body":[{"type":"ExpressionStatement","start":3853,"end":3912,"expression":{"type":"CallExpression","start":3853,"end":3911,"optional":false,"callee":{"type":"MemberExpression","start":3853,"end":3876,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3853,"end":3865,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3853,"end":3857},"property":{"type":"Identifier","start":3858,"end":3865,"name":"storage"}},"property":{"type":"Identifier","start":3866,"end":3876,"name":"removeItem"}},"arguments":[{"type":"MemberExpression","start":3877,"end":3910,"computed":false,"optional":false,"object":{"type":"Identifier","start":3877,"end":3896,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3897,"end":3910,"name":"CODE_VERIFIER"}}]}},{"type":"ExpressionStatement","start":3925,"end":3976,"expression":{"type":"CallExpression","start":3925,"end":3975,"optional":false,"callee":{"type":"MemberExpression","start":3925,"end":3948,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3925,"end":3937,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3925,"end":3929},"property":{"type":"Identifier","start":3930,"end":3937,"name":"storage"}},"property":{"type":"Identifier","start":3938,"end":3948,"name":"removeItem"}},"arguments":[{"type":"MemberExpression","start":3949,"end":3974,"computed":false,"optional":false,"object":{"type":"Identifier","start":3949,"end":3968,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":3969,"end":3974,"name":"STATE"}}]}},{"type":"ExpressionStatement","start":3989,"end":4040,"expression":{"type":"CallExpression","start":3989,"end":4039,"optional":false,"callee":{"type":"MemberExpression","start":3989,"end":4012,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3989,"end":4001,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3989,"end":3993},"property":{"type":"Identifier","start":3994,"end":4001,"name":"storage"}},"property":{"type":"Identifier","start":4002,"end":4012,"name":"removeItem"}},"arguments":[{"type":"MemberExpression","start":4013,"end":4038,"computed":false,"optional":false,"object":{"type":"Identifier","start":4013,"end":4032,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":4033,"end":4038,"name":"NONCE"}}]}},{"type":"ExpressionStatement","start":4053,"end":4103,"expression":{"type":"CallExpression","start":4053,"end":4102,"optional":false,"callee":{"type":"MemberExpression","start":4053,"end":4066,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4053,"end":4057},"property":{"type":"Identifier","start":4058,"end":4066,"name":"logDebug"}},"arguments":[{"type":"Literal","start":4067,"end":4101,"value":"Cleared temporary OAuth2 storage","raw":"'Cleared temporary OAuth2 storage'"}]}}]},"handler":{"type":"CatchClause","start":4122,"end":4218,"param":{"type":"Identifier","start":4129,"end":4134,"name":"error"},"body":{"type":"BlockStatement","start":4136,"end":4218,"body":[{"type":"ExpressionStatement","start":4150,"end":4208,"expression":{"type":"CallExpression","start":4150,"end":4207,"optional":false,"callee":{"type":"MemberExpression","start":4150,"end":4163,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4150,"end":4154},"property":{"type":"Identifier","start":4155,"end":4163,"name":"logError"}},"arguments":[{"type":"Literal","start":4164,"end":4199,"value":"Error clearing temporary storage:","raw":"'Error clearing temporary storage:'"},{"type":"Identifier","start":4201,"end":4206,"name":"error"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":4282,"end":4354,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":4282,"end":4293,"name":"isAvailable"},"value":{"type":"FunctionExpression","start":4293,"end":4354,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":4296,"end":4354,"body":[{"type":"ReturnStatement","start":4306,"end":4348,"argument":{"type":"CallExpression","start":4313,"end":4347,"optional":false,"callee":{"type":"Identifier","start":4313,"end":4330,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":4331,"end":4346,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4331,"end":4335},"property":{"type":"Identifier","start":4336,"end":4346,"name":"platformId"}}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":4418,"end":4964,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":4418,"end":4431,"name":"getStoredKeys"},"value":{"type":"FunctionExpression","start":4431,"end":4964,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":4434,"end":4964,"body":[{"type":"IfStatement","start":4444,"end":4503,"test":{"type":"UnaryExpression","start":4448,"end":4467,"operator":"!","argument":{"type":"CallExpression","start":4449,"end":4467,"optional":false,"callee":{"type":"MemberExpression","start":4449,"end":4465,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4449,"end":4453},"property":{"type":"Identifier","start":4454,"end":4465,"name":"isAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":4469,"end":4503,"body":[{"type":"ReturnStatement","start":4483,"end":4493,"argument":{"type":"ArrayExpression","start":4490,"end":4492,"elements":[]}}]},"alternate":null},{"type":"TryStatement","start":4512,"end":4958,"block":{"type":"BlockStatement","start":4516,"end":4837,"body":[{"type":"VariableDeclaration","start":4530,"end":4546,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4536,"end":4545,"id":{"type":"Identifier","start":4536,"end":4540,"name":"keys"},"init":{"type":"ArrayExpression","start":4543,"end":4545,"elements":[]}}]},{"type":"ForStatement","start":4559,"end":4802,"init":{"type":"VariableDeclaration","start":4564,"end":4573,"kind":"let","declarations":[{"type":"VariableDeclarator","start":4568,"end":4573,"id":{"type":"Identifier","start":4568,"end":4569,"name":"i"},"init":{"type":"Literal","start":4572,"end":4573,"raw":"0","value":0}}]},"test":{"type":"BinaryExpression","start":4575,"end":4598,"operator":"<","left":{"type":"Identifier","start":4575,"end":4576,"name":"i"},"right":{"type":"MemberExpression","start":4579,"end":4598,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4579,"end":4591,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4579,"end":4583},"property":{"type":"Identifier","start":4584,"end":4591,"name":"storage"}},"property":{"type":"Identifier","start":4592,"end":4598,"name":"length"}}},"update":{"type":"UpdateExpression","start":4600,"end":4603,"prefix":false,"operator":"++","argument":{"type":"Identifier","start":4600,"end":4601,"name":"i"}},"body":{"type":"BlockStatement","start":4605,"end":4802,"body":[{"type":"VariableDeclaration","start":4623,"end":4655,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4629,"end":4654,"id":{"type":"Identifier","start":4629,"end":4632,"name":"key"},"init":{"type":"CallExpression","start":4635,"end":4654,"optional":false,"callee":{"type":"MemberExpression","start":4635,"end":4651,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4635,"end":4647,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4635,"end":4639},"property":{"type":"Identifier","start":4640,"end":4647,"name":"storage"}},"property":{"type":"Identifier","start":4648,"end":4651,"name":"key"}},"arguments":[{"type":"Identifier","start":4652,"end":4653,"name":"i"}]}}]},{"type":"IfStatement","start":4672,"end":4788,"test":{"type":"LogicalExpression","start":4676,"end":4731,"operator":"&&","left":{"type":"Identifier","start":4676,"end":4679,"name":"key"},"right":{"type":"CallExpression","start":4683,"end":4731,"optional":false,"callee":{"type":"MemberExpression","start":4683,"end":4726,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4683,"end":4717,"optional":false,"callee":{"type":"MemberExpression","start":4683,"end":4696,"computed":false,"optional":false,"object":{"type":"Identifier","start":4683,"end":4689,"name":"Object"},"property":{"type":"Identifier","start":4690,"end":4696,"name":"values"}},"arguments":[{"type":"Identifier","start":4697,"end":4716,"name":"OAUTH2_STORAGE_KEYS"}]},"property":{"type":"Identifier","start":4718,"end":4726,"name":"includes"}},"arguments":[{"type":"Identifier","start":4727,"end":4730,"name":"key"}]}},"consequent":{"type":"BlockStatement","start":4733,"end":4788,"body":[{"type":"ExpressionStatement","start":4755,"end":4770,"expression":{"type":"CallExpression","start":4755,"end":4769,"optional":false,"callee":{"type":"MemberExpression","start":4755,"end":4764,"computed":false,"optional":false,"object":{"type":"Identifier","start":4755,"end":4759,"name":"keys"},"property":{"type":"Identifier","start":4760,"end":4764,"name":"push"}},"arguments":[{"type":"Identifier","start":4765,"end":4768,"name":"key"}]}}]},"alternate":null}]}},{"type":"ReturnStatement","start":4815,"end":4827,"argument":{"type":"Identifier","start":4822,"end":4826,"name":"keys"}}]},"handler":{"type":"CatchClause","start":4846,"end":4958,"param":{"type":"Identifier","start":4853,"end":4858,"name":"error"},"body":{"type":"BlockStatement","start":4860,"end":4958,"body":[{"type":"ExpressionStatement","start":4874,"end":4925,"expression":{"type":"CallExpression","start":4874,"end":4924,"optional":false,"callee":{"type":"MemberExpression","start":4874,"end":4887,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4874,"end":4878},"property":{"type":"Identifier","start":4879,"end":4887,"name":"logError"}},"arguments":[{"type":"Literal","start":4888,"end":4916,"value":"Error getting stored keys:","raw":"'Error getting stored keys:'"},{"type":"Identifier","start":4918,"end":4923,"name":"error"}]}},{"type":"ReturnStatement","start":4938,"end":4948,"argument":{"type":"ArrayExpression","start":4945,"end":4947,"elements":[]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5006,"end":5162,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5006,"end":5014,"name":"logDebug"},"value":{"type":"FunctionExpression","start":5014,"end":5162,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":5015,"end":5022,"name":"message"},{"type":"RestElement","start":5024,"end":5031,"argument":{"type":"Identifier","start":5027,"end":5031,"name":"args"}}],"body":{"type":"BlockStatement","start":5033,"end":5162,"body":[{"type":"IfStatement","start":5043,"end":5156,"test":{"type":"BinaryExpression","start":5047,"end":5072,"operator":"===","left":{"type":"MemberExpression","start":5047,"end":5060,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5047,"end":5051},"property":{"type":"Identifier","start":5052,"end":5060,"name":"logLevel"}},"right":{"type":"Literal","start":5065,"end":5072,"value":"debug","raw":"'debug'"}},"consequent":{"type":"BlockStatement","start":5074,"end":5156,"body":[{"type":"ExpressionStatement","start":5088,"end":5146,"expression":{"type":"CallExpression","start":5088,"end":5145,"optional":false,"callee":{"type":"MemberExpression","start":5088,"end":5099,"computed":false,"optional":false,"object":{"type":"Identifier","start":5088,"end":5095,"name":"console"},"property":{"type":"Identifier","start":5096,"end":5099,"name":"log"}},"arguments":[{"type":"TemplateLiteral","start":5100,"end":5135,"quasis":[{"type":"TemplateElement","start":5101,"end":5124,"tail":false,"value":{"cooked":"[OAuth2StorageService] ","raw":"[OAuth2StorageService] "}},{"type":"TemplateElement","start":5134,"end":5134,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":5126,"end":5133,"name":"message"}]},{"type":"SpreadElement","start":5137,"end":5144,"argument":{"type":"Identifier","start":5140,"end":5144,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5203,"end":5375,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5203,"end":5210,"name":"logInfo"},"value":{"type":"FunctionExpression","start":5210,"end":5375,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":5211,"end":5218,"name":"message"},{"type":"RestElement","start":5220,"end":5227,"argument":{"type":"Identifier","start":5223,"end":5227,"name":"args"}}],"body":{"type":"BlockStatement","start":5229,"end":5375,"body":[{"type":"IfStatement","start":5239,"end":5369,"test":{"type":"CallExpression","start":5243,"end":5284,"optional":false,"callee":{"type":"MemberExpression","start":5243,"end":5269,"computed":false,"optional":false,"object":{"type":"ArrayExpression","start":5243,"end":5260,"elements":[{"type":"Literal","start":5244,"end":5251,"value":"debug","raw":"'debug'"},{"type":"Literal","start":5253,"end":5259,"value":"info","raw":"'info'"}]},"property":{"type":"Identifier","start":5261,"end":5269,"name":"includes"}},"arguments":[{"type":"MemberExpression","start":5270,"end":5283,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5270,"end":5274},"property":{"type":"Identifier","start":5275,"end":5283,"name":"logLevel"}}]},"consequent":{"type":"BlockStatement","start":5286,"end":5369,"body":[{"type":"ExpressionStatement","start":5300,"end":5359,"expression":{"type":"CallExpression","start":5300,"end":5358,"optional":false,"callee":{"type":"MemberExpression","start":5300,"end":5312,"computed":false,"optional":false,"object":{"type":"Identifier","start":5300,"end":5307,"name":"console"},"property":{"type":"Identifier","start":5308,"end":5312,"name":"info"}},"arguments":[{"type":"TemplateLiteral","start":5313,"end":5348,"quasis":[{"type":"TemplateElement","start":5314,"end":5337,"tail":false,"value":{"cooked":"[OAuth2StorageService] ","raw":"[OAuth2StorageService] "}},{"type":"TemplateElement","start":5347,"end":5347,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":5339,"end":5346,"name":"message"}]},{"type":"SpreadElement","start":5350,"end":5357,"argument":{"type":"Identifier","start":5353,"end":5357,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5419,"end":5599,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5419,"end":5426,"name":"logWarn"},"value":{"type":"FunctionExpression","start":5426,"end":5599,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":5427,"end":5434,"name":"message"},{"type":"RestElement","start":5436,"end":5443,"argument":{"type":"Identifier","start":5439,"end":5443,"name":"args"}}],"body":{"type":"BlockStatement","start":5445,"end":5599,"body":[{"type":"IfStatement","start":5455,"end":5593,"test":{"type":"CallExpression","start":5459,"end":5508,"optional":false,"callee":{"type":"MemberExpression","start":5459,"end":5493,"computed":false,"optional":false,"object":{"type":"ArrayExpression","start":5459,"end":5484,"elements":[{"type":"Literal","start":5460,"end":5467,"value":"debug","raw":"'debug'"},{"type":"Literal","start":5469,"end":5475,"value":"info","raw":"'info'"},{"type":"Literal","start":5477,"end":5483,"value":"warn","raw":"'warn'"}]},"property":{"type":"Identifier","start":5485,"end":5493,"name":"includes"}},"arguments":[{"type":"MemberExpression","start":5494,"end":5507,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5494,"end":5498},"property":{"type":"Identifier","start":5499,"end":5507,"name":"logLevel"}}]},"consequent":{"type":"BlockStatement","start":5510,"end":5593,"body":[{"type":"ExpressionStatement","start":5524,"end":5583,"expression":{"type":"CallExpression","start":5524,"end":5582,"optional":false,"callee":{"type":"MemberExpression","start":5524,"end":5536,"computed":false,"optional":false,"object":{"type":"Identifier","start":5524,"end":5531,"name":"console"},"property":{"type":"Identifier","start":5532,"end":5536,"name":"warn"}},"arguments":[{"type":"TemplateLiteral","start":5537,"end":5572,"quasis":[{"type":"TemplateElement","start":5538,"end":5561,"tail":false,"value":{"cooked":"[OAuth2StorageService] ","raw":"[OAuth2StorageService] "}},{"type":"TemplateElement","start":5571,"end":5571,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":5563,"end":5570,"name":"message"}]},{"type":"SpreadElement","start":5574,"end":5581,"argument":{"type":"Identifier","start":5577,"end":5581,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5641,"end":5794,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5641,"end":5649,"name":"logError"},"value":{"type":"FunctionExpression","start":5649,"end":5794,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":5650,"end":5657,"name":"message"},{"type":"Identifier","start":5659,"end":5664,"name":"error"}],"body":{"type":"BlockStatement","start":5666,"end":5794,"body":[{"type":"IfStatement","start":5676,"end":5788,"test":{"type":"BinaryExpression","start":5680,"end":5704,"operator":"!==","left":{"type":"MemberExpression","start":5680,"end":5693,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5680,"end":5684},"property":{"type":"Identifier","start":5685,"end":5693,"name":"logLevel"}},"right":{"type":"Literal","start":5698,"end":5704,"value":"none","raw":"'none'"}},"consequent":{"type":"BlockStatement","start":5706,"end":5788,"body":[{"type":"ExpressionStatement","start":5720,"end":5778,"expression":{"type":"CallExpression","start":5720,"end":5777,"optional":false,"callee":{"type":"MemberExpression","start":5720,"end":5733,"computed":false,"optional":false,"object":{"type":"Identifier","start":5720,"end":5727,"name":"console"},"property":{"type":"Identifier","start":5728,"end":5733,"name":"error"}},"arguments":[{"type":"TemplateLiteral","start":5734,"end":5769,"quasis":[{"type":"TemplateElement","start":5735,"end":5758,"tail":false,"value":{"cooked":"[OAuth2StorageService] ","raw":"[OAuth2StorageService] "}},{"type":"TemplateElement","start":5768,"end":5768,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":5760,"end":5767,"name":"message"}]},{"type":"Identifier","start":5771,"end":5776,"name":"error"}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"StaticBlock","start":5799,"end":5999,"body":[{"type":"ExpressionStatement","start":5808,"end":5997,"expression":{"type":"AssignmentExpression","start":5808,"end":5996,"operator":"=","left":{"type":"MemberExpression","start":5808,"end":5817,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5808,"end":5812},"property":{"type":"Identifier","start":5813,"end":5817,"name":"ɵfac"}},"right":{"type":"FunctionExpression","start":5820,"end":5996,"async":false,"generator":false,"id":{"type":"Identifier","start":5829,"end":5857,"name":"OAuth2StorageService_Factory"},"params":[{"type":"Identifier","start":5858,"end":5875,"name":"__ngFactoryType__"}],"body":{"type":"BlockStatement","start":5877,"end":5996,"body":[{"type":"ReturnStatement","start":5879,"end":5994,"argument":{"type":"NewExpression","start":5886,"end":5993,"callee":{"type":"LogicalExpression","start":5891,"end":5932,"operator":"||","left":{"type":"Identifier","start":5891,"end":5908,"name":"__ngFactoryType__"},"right":{"type":"Identifier","start":5912,"end":5932,"name":"OAuth2StorageService"}},"arguments":[{"type":"CallExpression","start":5934,"end":5966,"optional":false,"callee":{"type":"MemberExpression","start":5934,"end":5945,"computed":false,"optional":false,"object":{"type":"Identifier","start":5934,"end":5936,"name":"i0"},"property":{"type":"Identifier","start":5937,"end":5945,"name":"ɵɵinject"}},"arguments":[{"type":"Identifier","start":5946,"end":5965,"name":"OAUTH2_CONFIG_TOKEN"}]},{"type":"CallExpression","start":5968,"end":5992,"optional":false,"callee":{"type":"MemberExpression","start":5968,"end":5979,"computed":false,"optional":false,"object":{"type":"Identifier","start":5968,"end":5970,"name":"i0"},"property":{"type":"Identifier","start":5971,"end":5979,"name":"ɵɵinject"}},"arguments":[{"type":"Identifier","start":5980,"end":5991,"name":"PLATFORM_ID"}]}]}}]},"expression":false}}}]},{"type":"StaticBlock","start":6004,"end":6153,"body":[{"type":"ExpressionStatement","start":6013,"end":6151,"expression":{"type":"AssignmentExpression","start":6013,"end":6150,"operator":"=","left":{"type":"MemberExpression","start":6013,"end":6023,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6013,"end":6017},"property":{"type":"Identifier","start":6018,"end":6023,"name":"ɵprov"}},"right":{"type":"CallExpression","start":6040,"end":6150,"optional":false,"_rollupAnnotations":[{"end":6039,"start":6026,"type":"pure"}],"callee":{"type":"MemberExpression","start":6040,"end":6061,"computed":false,"optional":false,"object":{"type":"Identifier","start":6040,"end":6042,"name":"i0"},"property":{"type":"Identifier","start":6043,"end":6061,"name":"ɵɵdefineInjectable"}},"arguments":[{"type":"ObjectExpression","start":6062,"end":6149,"properties":[{"type":"Property","start":6064,"end":6091,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6064,"end":6069,"name":"token"},"value":{"type":"Identifier","start":6071,"end":6091,"name":"OAuth2StorageService"},"kind":"init"},{"type":"Property","start":6093,"end":6127,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6093,"end":6100,"name":"factory"},"value":{"type":"MemberExpression","start":6102,"end":6127,"computed":false,"optional":false,"object":{"type":"Identifier","start":6102,"end":6122,"name":"OAuth2StorageService"},"property":{"type":"Identifier","start":6123,"end":6127,"name":"ɵfac"}},"kind":"init"},{"type":"Property","start":6129,"end":6147,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6129,"end":6139,"name":"providedIn"},"value":{"type":"Literal","start":6141,"end":6147,"value":"root","raw":"'root'"},"kind":"init"}]}]}}}]}]}}},{"type":"ExpressionStatement","start":6156,"end":6624,"expression":{"type":"CallExpression","start":6156,"end":6623,"optional":false,"callee":{"type":"ArrowFunctionExpression","start":6157,"end":6620,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":6163,"end":6620,"body":[{"type":"ExpressionStatement","start":6165,"end":6618,"expression":{"type":"LogicalExpression","start":6165,"end":6617,"operator":"&&","left":{"type":"LogicalExpression","start":6166,"end":6211,"operator":"||","left":{"type":"BinaryExpression","start":6166,"end":6198,"operator":"===","left":{"type":"UnaryExpression","start":6166,"end":6182,"operator":"typeof","argument":{"type":"Identifier","start":6173,"end":6182,"name":"ngDevMode"},"prefix":true},"right":{"type":"Literal","start":6187,"end":6198,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":6202,"end":6211,"name":"ngDevMode"}},"right":{"type":"CallExpression","start":6216,"end":6617,"optional":false,"callee":{"type":"MemberExpression","start":6216,"end":6236,"computed":false,"optional":false,"object":{"type":"Identifier","start":6216,"end":6218,"name":"i0"},"property":{"type":"Identifier","start":6219,"end":6236,"name":"ɵsetClassMetadata"}},"arguments":[{"type":"Identifier","start":6237,"end":6257,"name":"OAuth2StorageService"},{"type":"ArrayExpression","start":6259,"end":6361,"elements":[{"type":"ObjectExpression","start":6260,"end":6360,"properties":[{"type":"Property","start":6270,"end":6286,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6270,"end":6274,"name":"type"},"value":{"type":"Identifier","start":6276,"end":6286,"name":"Injectable"},"kind":"init"},{"type":"Property","start":6296,"end":6354,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6296,"end":6300,"name":"args"},"value":{"type":"ArrayExpression","start":6302,"end":6354,"elements":[{"type":"ObjectExpression","start":6303,"end":6353,"properties":[{"type":"Property","start":6321,"end":6339,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6321,"end":6331,"name":"providedIn"},"value":{"type":"Literal","start":6333,"end":6339,"value":"root","raw":"'root'"},"kind":"init"}]}]},"kind":"init"}]}]},{"type":"ArrowFunctionExpression","start":6363,"end":6610,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"ArrayExpression","start":6369,"end":6610,"elements":[{"type":"ObjectExpression","start":6370,"end":6494,"properties":[{"type":"Property","start":6372,"end":6387,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6372,"end":6376,"name":"type"},"value":{"type":"Identifier","start":6378,"end":6387,"name":"undefined"},"kind":"init"},{"type":"Property","start":6389,"end":6492,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6389,"end":6399,"name":"decorators"},"value":{"type":"ArrayExpression","start":6401,"end":6492,"elements":[{"type":"ObjectExpression","start":6402,"end":6491,"properties":[{"type":"Property","start":6420,"end":6432,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6420,"end":6424,"name":"type"},"value":{"type":"Identifier","start":6426,"end":6432,"name":"Inject"},"kind":"init"},{"type":"Property","start":6450,"end":6477,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6450,"end":6454,"name":"args"},"value":{"type":"ArrayExpression","start":6456,"end":6477,"elements":[{"type":"Identifier","start":6457,"end":6476,"name":"OAUTH2_CONFIG_TOKEN"}]},"kind":"init"}]}]},"kind":"init"}]},{"type":"ObjectExpression","start":6496,"end":6609,"properties":[{"type":"Property","start":6498,"end":6510,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6498,"end":6502,"name":"type"},"value":{"type":"Identifier","start":6504,"end":6510,"name":"Object"},"kind":"init"},{"type":"Property","start":6512,"end":6607,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6512,"end":6522,"name":"decorators"},"value":{"type":"ArrayExpression","start":6524,"end":6607,"elements":[{"type":"ObjectExpression","start":6525,"end":6606,"properties":[{"type":"Property","start":6543,"end":6555,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6543,"end":6547,"name":"type"},"value":{"type":"Identifier","start":6549,"end":6555,"name":"Inject"},"kind":"init"},{"type":"Property","start":6573,"end":6592,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6573,"end":6577,"name":"args"},"value":{"type":"ArrayExpression","start":6579,"end":6592,"elements":[{"type":"Identifier","start":6580,"end":6591,"name":"PLATFORM_ID"}]},"kind":"init"}]}]},"kind":"init"}]}]},"id":null},{"type":"Literal","start":6612,"end":6616,"raw":"null","value":null}]}}}]},"id":null},"arguments":[]}}],"_rollupRemoved":[{"end":21523,"start":6625,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport * as i0 from \"@angular/core\";\n/**\n * OAuth2 Storage Service\n * Handles secure storage and retrieval of OAuth2 tokens and data\n */\nexport class OAuth2StorageService {\n    constructor(config, platformId) {\n        this.config = config;\n        this.platformId = platformId;\n        this.logLevel = config.logLevel || 'warn';\n        this.storage = this.initializeStorage();\n    }\n    /**\n     * Initialize storage based on configuration\n     */\n    initializeStorage() {\n        if (!isPlatformBrowser(this.platformId)) {\n            // Return a no-op storage for SSR\n            return {\n                getItem: () => null,\n                setItem: () => { },\n                removeItem: () => { },\n                clear: () => { }\n            };\n        }\n        switch (this.config.storage) {\n            case 'sessionStorage':\n                return sessionStorage;\n            case 'custom':\n                if (!this.config.customStorage) {\n                    this.logError('Custom storage specified but not provided');\n                    return localStorage;\n                }\n                return this.config.customStorage;\n            case 'localStorage':\n            default:\n                return localStorage;\n        }\n    }\n    /**\n     * Store a value securely\n     */\n    setItem(key, value) {\n        try {\n            // In production, consider encrypting sensitive values\n            this.storage.setItem(key, value);\n            this.logDebug(`Stored item with key: ${key}`);\n        }\n        catch (error) {\n            this.logError('Error storing item:', error);\n            throw new Error('Failed to store item');\n        }\n    }\n    /**\n     * Retrieve a value securely\n     */\n    getItem(key) {\n        try {\n            const value = this.storage.getItem(key);\n            this.logDebug(`Retrieved item with key: ${key}`, value ? 'Found' : 'Not found');\n            return value;\n        }\n        catch (error) {\n            this.logError('Error retrieving item:', error);\n            return null;\n        }\n    }\n    /**\n     * Remove a specific item\n     */\n    removeItem(key) {\n        try {\n            this.storage.removeItem(key);\n            this.logDebug(`Removed item with key: ${key}`);\n        }\n        catch (error) {\n            this.logError('Error removing item:', error);\n        }\n    }\n    /**\n     * Clear all OAuth2 related storage\n     */\n    clearAll() {\n        try {\n            Object.values(OAUTH2_STORAGE_KEYS).forEach(key => {\n                this.storage.removeItem(key);\n            });\n            this.logDebug('Cleared all OAuth2 storage');\n        }\n        catch (error) {\n            this.logError('Error clearing storage:', error);\n        }\n    }\n    /**\n     * Clear only token-related storage, preserve OAuth2 flow storage\n     */\n    clearTokens() {\n        try {\n            const tokenKeys = [\n                OAUTH2_STORAGE_KEYS.ACCESS_TOKEN,\n                OAUTH2_STORAGE_KEYS.REFRESH_TOKEN,\n                OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT,\n                OAUTH2_STORAGE_KEYS.TOKEN_TYPE,\n                OAUTH2_STORAGE_KEYS.SCOPE,\n                OAUTH2_STORAGE_KEYS.ID_TOKEN\n            ];\n            tokenKeys.forEach(key => {\n                this.storage.removeItem(key);\n            });\n            this.logDebug('Cleared token storage (OAuth2 flow storage preserved)');\n        }\n        catch (error) {\n            this.logError('Error clearing token storage:', error);\n        }\n    }\n    /**\n     * Clear temporary OAuth2 flow storage\n     */\n    clearTemporary() {\n        try {\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.STATE);\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.NONCE);\n            this.logDebug('Cleared temporary OAuth2 storage');\n        }\n        catch (error) {\n            this.logError('Error clearing temporary storage:', error);\n        }\n    }\n    /**\n     * Check if storage is available\n     */\n    isAvailable() {\n        return isPlatformBrowser(this.platformId);\n    }\n    /**\n     * Get all stored keys (for debugging)\n     */\n    getStoredKeys() {\n        if (!this.isAvailable()) {\n            return [];\n        }\n        try {\n            const keys = [];\n            for (let i = 0; i < this.storage.length; i++) {\n                const key = this.storage.key(i);\n                if (key && Object.values(OAUTH2_STORAGE_KEYS).includes(key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        catch (error) {\n            this.logError('Error getting stored keys:', error);\n            return [];\n        }\n    }\n    /**\n     * Debug logging\n     */\n    logDebug(message, ...args) {\n        if (this.logLevel === 'debug') {\n            console.log(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Info logging\n     */\n    logInfo(message, ...args) {\n        if (['debug', 'info'].includes(this.logLevel)) {\n            console.info(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Warning logging\n     */\n    logWarn(message, ...args) {\n        if (['debug', 'info', 'warn'].includes(this.logLevel)) {\n            console.warn(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Error logging\n     */\n    logError(message, error) {\n        if (this.logLevel !== 'none') {\n            console.error(`[OAuth2StorageService] ${message}`, error);\n        }\n    }\n    static { this.ɵfac = function OAuth2StorageService_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2StorageService)(i0.ɵɵinject(OAUTH2_CONFIG_TOKEN), i0.ɵɵinject(PLATFORM_ID)); }; }\n    static { this.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: OAuth2StorageService, factory: OAuth2StorageService.ɵfac, providedIn: 'root' }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2StorageService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], () => [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [OAUTH2_CONFIG_TOKEN]\n            }] }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }], null); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLXN0b3JhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFcEQsT0FBTyxFQUFFLG1CQUFtQixFQUFrQixNQUFNLDhCQUE4QixDQUFDO0FBQ25GLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDOztBQUVwRTs7O0dBR0c7QUFJSCxNQUFNLE9BQU8sb0JBQW9CO0lBSS9CLFlBQ3VDLE1BQW9CLEVBQzVCLFVBQWtCO1FBRFYsV0FBTSxHQUFOLE1BQU0sQ0FBYztRQUM1QixlQUFVLEdBQVYsVUFBVSxDQUFRO1FBRS9DLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsSUFBSSxNQUFNLENBQUM7UUFDMUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUMxQyxDQUFDO0lBRUQ7O09BRUc7SUFDSyxpQkFBaUI7UUFDdkIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO1lBQ3hDLGlDQUFpQztZQUNqQyxPQUFPO2dCQUNMLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJO2dCQUNuQixPQUFPLEVBQUUsR0FBRyxFQUFFLEdBQUUsQ0FBQztnQkFDakIsVUFBVSxFQUFFLEdBQUcsRUFBRSxHQUFFLENBQUM7Z0JBQ3BCLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDO2FBQ2hCLENBQUM7UUFDSixDQUFDO1FBRUQsUUFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8s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TSxFQUFFLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUN0RCxPQUFPLENBQUMsSUFBSSxDQUFDLDBCQUEwQixPQUFPLEVBQUUsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQzdELENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxRQUFRLENBQUMsT0FBZSxFQUFFLEtBQVc7UUFDM0MsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQzdCLE9BQU8sQ0FBQyxLQUFLLENBQUMsMEJBQTBCLE9BQU8sRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzVELENBQUM7SUFDSCxDQUFDO3FIQXJNVSxvQkFBb0IsY0FLckIsbUJBQW1CLGVBQ25CLFdBQVc7dUVBTlYsb0JBQW9CLFdBQXBCLG9CQUFvQixtQkFGbkIsTUFBTTs7aUZBRVAsb0JBQW9CO2NBSGhDLFVBQVU7ZUFBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQjs7c0JBTUksTUFBTTt1QkFBQyxtQkFBbUI7O3NCQUMxQixNQUFNO3VCQUFDLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnLCBPQXV0aDJTdG9yYWdlIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfU1RPUkFHRV9LRVlTLCBPQXV0aDJMb2dMZXZlbCB9IGZyb20gJy4uL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfQ09ORklHX1RPS0VOIH0gZnJvbSAnLi4vdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4nO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBTdG9yYWdlIFNlcnZpY2VcclxuICogSGFuZGxlcyBzZWN1cmUgc3RvcmFnZSBhbmQgcmV0cmlldmFsIG9mIE9BdXRoMiB0b2tlbnMgYW5kIGRhdGFcclxuICovXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIE9BdXRoMlN0b3JhZ2VTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0b3JhZ2U6IE9BdXRoMlN0b3JhZ2U7XHJcbiAgcHJpdmF0ZSBsb2dMZXZlbDogT0F1dGgyTG9nTGV2ZWw7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgQEluamVjdChPQVVUSDJfQ09ORklHX1RPS0VOKSBwcml2YXRlIGNvbmZpZzogT0F1dGgyQ29uZmlnLFxyXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybUlkOiBPYmplY3RcclxuICApIHtcclxuICAgIHRoaXMubG9nTGV2ZWwgPSBjb25maWcubG9nTGV2ZWwgfHwgJ3dhcm4nO1xyXG4gICAgdGhpcy5zdG9yYWdlID0gdGhpcy5pbml0aWFsaXplU3RvcmFnZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSBzdG9yYWdlIGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVTdG9yYWdlKCk6IE9BdXRoMlN0b3JhZ2Uge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIC8vIFJldHVybiBhIG5vLW9wIHN0b3JhZ2UgZm9yIFNTUlxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldEl0ZW06ICgpID0+IG51bGwsXHJcbiAgICAgICAgc2V0SXRlbTogKCkgPT4ge30sXHJcbiAgICAgICAgcmVtb3ZlSXRlbTogKCkgPT4ge30sXHJcbiAgICAgICAgY2xlYXI6ICgpID0+IHt9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3dpdGNoICh0aGlzLmNvbmZpZy5zdG9yYWdlKSB7XHJcbiAgICAgIGNhc2UgJ3Nlc3Npb25TdG9yYWdlJzpcclxuICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2U7XHJcbiAgICAgIGNhc2UgJ2N1c3RvbSc6XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5jdXN0b21TdG9yYWdlKSB7XHJcbiAgICAgICAgICB0aGlzLmxvZ0Vycm9yKCdDdXN0b20gc3RvcmFnZSBzcGVjaWZpZWQgYnV0IG5vdCBwcm92aWRlZCcpO1xyXG4gICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLmN1c3RvbVN0b3JhZ2U7XHJcbiAgICAgIGNhc2UgJ2xvY2FsU3RvcmFnZSc6XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3JlIGEgdmFsdWUgc2VjdXJlbHlcclxuICAgKi9cclxuICBzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbiBwcm9kdWN0aW9uLCBjb25zaWRlciBlbmNyeXB0aW5nIHNlbnNpdGl2ZSB2YWx1ZXNcclxuICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFN0b3JlZCBpdGVtIHdpdGgga2V5OiAke2tleX1gKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIHN0b3JpbmcgaXRlbTonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHN0b3JlIGl0ZW0nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIGEgdmFsdWUgc2VjdXJlbHlcclxuICAgKi9cclxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFJldHJpZXZlZCBpdGVtIHdpdGgga2V5OiAke2tleX1gLCB2YWx1ZSA/ICdGb3VuZCcgOiAnTm90IGZvdW5kJyk7XHJcbiAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIHJldHJpZXZpbmcgaXRlbTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlIGEgc3BlY2lmaWMgaXRlbVxyXG4gICAqL1xyXG4gIHJlbW92ZUl0ZW0oa2V5OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFJlbW92ZWQgaXRlbSB3aXRoIGtleTogJHtrZXl9YCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciByZW1vdmluZyBpdGVtOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIGFsbCBPQXV0aDIgcmVsYXRlZCBzdG9yYWdlXHJcbiAgICovXHJcbiAgY2xlYXJBbGwoKTogdm9pZCB7XHJcbiAgICB0cnkge1xyXG4gICAgICBPYmplY3QudmFsdWVzKE9BVVRIMl9TVE9SQUdFX0tFWVMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnQ2xlYXJlZCBhbGwgT0F1dGgyIHN0b3JhZ2UnKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGNsZWFyaW5nIHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXIgb25seSB0b2tlbi1yZWxhdGVkIHN0b3JhZ2UsIHByZXNlcnZlIE9BdXRoMiBmbG93IHN0b3JhZ2VcclxuICAgKi9cclxuICBjbGVhclRva2VucygpOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuS2V5cyA9IFtcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLkFDQ0VTU19UT0tFTixcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4sXHJcbiAgICAgICAgT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULFxyXG4gICAgICAgIE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fVFlQRSxcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLlNDT1BFLFxyXG4gICAgICAgIE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU5cclxuICAgICAgXTtcclxuICAgICAgXHJcbiAgICAgIHRva2VuS2V5cy5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdDbGVhcmVkIHRva2VuIHN0b3JhZ2UgKE9BdXRoMiBmbG93IHN0b3JhZ2UgcHJlc2VydmVkKScpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgY2xlYXJpbmcgdG9rZW4gc3RvcmFnZTonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhciB0ZW1wb3JhcnkgT0F1dGgyIGZsb3cgc3RvcmFnZVxyXG4gICAqL1xyXG4gIGNsZWFyVGVtcG9yYXJ5KCk6IHZvaWQge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5DT0RFX1ZFUklGSUVSKTtcclxuICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TVEFURSk7XHJcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuTk9OQ0UpO1xyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdDbGVhcmVkIHRlbXBvcmFyeSBPQXV0aDIgc3RvcmFnZScpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgY2xlYXJpbmcgdGVtcG9yYXJ5IHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgc3RvcmFnZSBpcyBhdmFpbGFibGVcclxuICAgKi9cclxuICBpc0F2YWlsYWJsZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBzdG9yZWQga2V5cyAoZm9yIGRlYnVnZ2luZylcclxuICAgKi9cclxuICBnZXRTdG9yZWRLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIGlmICghdGhpcy5pc0F2YWlsYWJsZSgpKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBrZXlzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICh0aGlzLnN0b3JhZ2UgYXMgYW55KS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGtleSA9ICh0aGlzLnN0b3JhZ2UgYXMgYW55KS5rZXkoaSk7XHJcbiAgICAgICAgaWYgKGtleSAmJiBPYmplY3QudmFsdWVzKE9BVVRIMl9TVE9SQUdFX0tFWVMpLmluY2x1ZGVzKGtleSkpIHtcclxuICAgICAgICAgIGtleXMucHVzaChrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4ga2V5cztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGdldHRpbmcgc3RvcmVkIGtleXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZWJ1ZyBsb2dnaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2dEZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5sb2dMZXZlbCA9PT0gJ2RlYnVnJykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmZvIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0luZm8obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbyddLmluY2x1ZGVzKHRoaXMubG9nTGV2ZWwpKSB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXJuaW5nIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ1dhcm4obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbycsICd3YXJuJ10uaW5jbHVkZXModGhpcy5sb2dMZXZlbCkpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBbT0F1dGgyU3RvcmFnZVNlcnZpY2VdICR7bWVzc2FnZX1gLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVycm9yIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0Vycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBhbnkpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmxvZ0xldmVsICE9PSAnbm9uZScpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxufSJdfQ==","customTransformCache":false,"dependencies":["@angular/core","@angular/common","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport * as i0 from \"@angular/core\";\n/**\n * OAuth2 Storage Service\n * Handles secure storage and retrieval of OAuth2 tokens and data\n */\nexport class OAuth2StorageService {\n    constructor(config, platformId) {\n        this.config = config;\n        this.platformId = platformId;\n        this.logLevel = config.logLevel || 'warn';\n        this.storage = this.initializeStorage();\n    }\n    /**\n     * Initialize storage based on configuration\n     */\n    initializeStorage() {\n        if (!isPlatformBrowser(this.platformId)) {\n            // Return a no-op storage for SSR\n            return {\n                getItem: () => null,\n                setItem: () => { },\n                removeItem: () => { },\n                clear: () => { }\n            };\n        }\n        switch (this.config.storage) {\n            case 'sessionStorage':\n                return sessionStorage;\n            case 'custom':\n                if (!this.config.customStorage) {\n                    this.logError('Custom storage specified but not provided');\n                    return localStorage;\n                }\n                return this.config.customStorage;\n            case 'localStorage':\n            default:\n                return localStorage;\n        }\n    }\n    /**\n     * Store a value securely\n     */\n    setItem(key, value) {\n        try {\n            // In production, consider encrypting sensitive values\n            this.storage.setItem(key, value);\n            this.logDebug(`Stored item with key: ${key}`);\n        }\n        catch (error) {\n            this.logError('Error storing item:', error);\n            throw new Error('Failed to store item');\n        }\n    }\n    /**\n     * Retrieve a value securely\n     */\n    getItem(key) {\n        try {\n            const value = this.storage.getItem(key);\n            this.logDebug(`Retrieved item with key: ${key}`, value ? 'Found' : 'Not found');\n            return value;\n        }\n        catch (error) {\n            this.logError('Error retrieving item:', error);\n            return null;\n        }\n    }\n    /**\n     * Remove a specific item\n     */\n    removeItem(key) {\n        try {\n            this.storage.removeItem(key);\n            this.logDebug(`Removed item with key: ${key}`);\n        }\n        catch (error) {\n            this.logError('Error removing item:', error);\n        }\n    }\n    /**\n     * Clear all OAuth2 related storage\n     */\n    clearAll() {\n        try {\n            Object.values(OAUTH2_STORAGE_KEYS).forEach(key => {\n                this.storage.removeItem(key);\n            });\n            this.logDebug('Cleared all OAuth2 storage');\n        }\n        catch (error) {\n            this.logError('Error clearing storage:', error);\n        }\n    }\n    /**\n     * Clear only token-related storage, preserve OAuth2 flow storage\n     */\n    clearTokens() {\n        try {\n            const tokenKeys = [\n                OAUTH2_STORAGE_KEYS.ACCESS_TOKEN,\n                OAUTH2_STORAGE_KEYS.REFRESH_TOKEN,\n                OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT,\n                OAUTH2_STORAGE_KEYS.TOKEN_TYPE,\n                OAUTH2_STORAGE_KEYS.SCOPE,\n                OAUTH2_STORAGE_KEYS.ID_TOKEN\n            ];\n            tokenKeys.forEach(key => {\n                this.storage.removeItem(key);\n            });\n            this.logDebug('Cleared token storage (OAuth2 flow storage preserved)');\n        }\n        catch (error) {\n            this.logError('Error clearing token storage:', error);\n        }\n    }\n    /**\n     * Clear temporary OAuth2 flow storage\n     */\n    clearTemporary() {\n        try {\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.STATE);\n            this.storage.removeItem(OAUTH2_STORAGE_KEYS.NONCE);\n            this.logDebug('Cleared temporary OAuth2 storage');\n        }\n        catch (error) {\n            this.logError('Error clearing temporary storage:', error);\n        }\n    }\n    /**\n     * Check if storage is available\n     */\n    isAvailable() {\n        return isPlatformBrowser(this.platformId);\n    }\n    /**\n     * Get all stored keys (for debugging)\n     */\n    getStoredKeys() {\n        if (!this.isAvailable()) {\n            return [];\n        }\n        try {\n            const keys = [];\n            for (let i = 0; i < this.storage.length; i++) {\n                const key = this.storage.key(i);\n                if (key && Object.values(OAUTH2_STORAGE_KEYS).includes(key)) {\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        catch (error) {\n            this.logError('Error getting stored keys:', error);\n            return [];\n        }\n    }\n    /**\n     * Debug logging\n     */\n    logDebug(message, ...args) {\n        if (this.logLevel === 'debug') {\n            console.log(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Info logging\n     */\n    logInfo(message, ...args) {\n        if (['debug', 'info'].includes(this.logLevel)) {\n            console.info(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Warning logging\n     */\n    logWarn(message, ...args) {\n        if (['debug', 'info', 'warn'].includes(this.logLevel)) {\n            console.warn(`[OAuth2StorageService] ${message}`, ...args);\n        }\n    }\n    /**\n     * Error logging\n     */\n    logError(message, error) {\n        if (this.logLevel !== 'none') {\n            console.error(`[OAuth2StorageService] ${message}`, error);\n        }\n    }\n    static { this.ɵfac = function OAuth2StorageService_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2StorageService)(i0.ɵɵinject(OAUTH2_CONFIG_TOKEN), i0.ɵɵinject(PLATFORM_ID)); }; }\n    static { this.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: OAuth2StorageService, factory: OAuth2StorageService.ɵfac, providedIn: 'root' }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2StorageService, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], () => [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [OAUTH2_CONFIG_TOKEN]\n            }] }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }], null); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLXN0b3JhZ2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDaEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFcEQsT0FBTyxFQUFFLG1CQUFtQixFQUFrQixNQUFNLDhCQUE4QixDQUFDO0FBQ25GLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDOztBQUVwRTs7O0dBR0c7QUFJSCxNQUFNLE9BQU8sb0JBQW9CO0lBSS9CLFlBQ3VDLE1BQW9CLEVBQzVCLFVBQWtCO1FBRFYsV0FBTSxHQUFOLE1BQU0sQ0FBYztRQUM1QixlQUFVLEdBQVYsVUFBVSxDQUFRO1FBRS9DLElBQUksQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLFFBQVEsSUFBSSxNQUFNLENBQUM7UUFDMUMsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztJQUMxQyxDQUFDO0lBRUQ7O09BRUc7SUFDSyxpQkFBaUI7UUFDdkIsSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO1lBQ3hDLGlDQUFpQztZQUNqQyxPQUFPO2dCQUNMLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxJQUFJO2dCQUNuQixPQUFPLEVBQUUsR0FBRyxFQUFFLEdBQUUsQ0FBQztnQkFDakIsVUFBVSxFQUFFLEdBQUcsRUFBRSxHQUFFLENBQUM7Z0JBQ3BCLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDO2FBQ2hCLENBQUM7UUFDSixDQUFDO1FBRUQsUUFBUSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8s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TSxFQUFFLE1BQU0sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUN0RCxPQUFPLENBQUMsSUFBSSxDQUFDLDBCQUEwQixPQUFPLEVBQUUsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQzdELENBQUM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSyxRQUFRLENBQUMsT0FBZSxFQUFFLEtBQVc7UUFDM0MsSUFBSSxJQUFJLENBQUMsUUFBUSxLQUFLLE1BQU0sRUFBRSxDQUFDO1lBQzdCLE9BQU8sQ0FBQyxLQUFLLENBQUMsMEJBQTBCLE9BQU8sRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzVELENBQUM7SUFDSCxDQUFDO3FIQXJNVSxvQkFBb0IsY0FLckIsbUJBQW1CLGVBQ25CLFdBQVc7dUVBTlYsb0JBQW9CLFdBQXBCLG9CQUFvQixtQkFGbkIsTUFBTTs7aUZBRVAsb0JBQW9CO2NBSGhDLFVBQVU7ZUFBQztnQkFDVixVQUFVLEVBQUUsTUFBTTthQUNuQjs7c0JBTUksTUFBTTt1QkFBQyxtQkFBbUI7O3NCQUMxQixNQUFNO3VCQUFDLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IGlzUGxhdGZvcm1Ccm93c2VyIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnLCBPQXV0aDJTdG9yYWdlIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfU1RPUkFHRV9LRVlTLCBPQXV0aDJMb2dMZXZlbCB9IGZyb20gJy4uL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfQ09ORklHX1RPS0VOIH0gZnJvbSAnLi4vdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4nO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBTdG9yYWdlIFNlcnZpY2VcclxuICogSGFuZGxlcyBzZWN1cmUgc3RvcmFnZSBhbmQgcmV0cmlldmFsIG9mIE9BdXRoMiB0b2tlbnMgYW5kIGRhdGFcclxuICovXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIE9BdXRoMlN0b3JhZ2VTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0b3JhZ2U6IE9BdXRoMlN0b3JhZ2U7XHJcbiAgcHJpdmF0ZSBsb2dMZXZlbDogT0F1dGgyTG9nTGV2ZWw7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgQEluamVjdChPQVVUSDJfQ09ORklHX1RPS0VOKSBwcml2YXRlIGNvbmZpZzogT0F1dGgyQ29uZmlnLFxyXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybUlkOiBPYmplY3RcclxuICApIHtcclxuICAgIHRoaXMubG9nTGV2ZWwgPSBjb25maWcubG9nTGV2ZWwgfHwgJ3dhcm4nO1xyXG4gICAgdGhpcy5zdG9yYWdlID0gdGhpcy5pbml0aWFsaXplU3RvcmFnZSgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSBzdG9yYWdlIGJhc2VkIG9uIGNvbmZpZ3VyYXRpb25cclxuICAgKi9cclxuICBwcml2YXRlIGluaXRpYWxpemVTdG9yYWdlKCk6IE9BdXRoMlN0b3JhZ2Uge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIC8vIFJldHVybiBhIG5vLW9wIHN0b3JhZ2UgZm9yIFNTUlxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldEl0ZW06ICgpID0+IG51bGwsXHJcbiAgICAgICAgc2V0SXRlbTogKCkgPT4ge30sXHJcbiAgICAgICAgcmVtb3ZlSXRlbTogKCkgPT4ge30sXHJcbiAgICAgICAgY2xlYXI6ICgpID0+IHt9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3dpdGNoICh0aGlzLmNvbmZpZy5zdG9yYWdlKSB7XHJcbiAgICAgIGNhc2UgJ3Nlc3Npb25TdG9yYWdlJzpcclxuICAgICAgICByZXR1cm4gc2Vzc2lvblN0b3JhZ2U7XHJcbiAgICAgIGNhc2UgJ2N1c3RvbSc6XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZy5jdXN0b21TdG9yYWdlKSB7XHJcbiAgICAgICAgICB0aGlzLmxvZ0Vycm9yKCdDdXN0b20gc3RvcmFnZSBzcGVjaWZpZWQgYnV0IG5vdCBwcm92aWRlZCcpO1xyXG4gICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnLmN1c3RvbVN0b3JhZ2U7XHJcbiAgICAgIGNhc2UgJ2xvY2FsU3RvcmFnZSc6XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3JlIGEgdmFsdWUgc2VjdXJlbHlcclxuICAgKi9cclxuICBzZXRJdGVtKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBJbiBwcm9kdWN0aW9uLCBjb25zaWRlciBlbmNyeXB0aW5nIHNlbnNpdGl2ZSB2YWx1ZXNcclxuICAgICAgdGhpcy5zdG9yYWdlLnNldEl0ZW0oa2V5LCB2YWx1ZSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFN0b3JlZCBpdGVtIHdpdGgga2V5OiAke2tleX1gKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIHN0b3JpbmcgaXRlbTonLCBlcnJvcik7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHN0b3JlIGl0ZW0nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIGEgdmFsdWUgc2VjdXJlbHlcclxuICAgKi9cclxuICBnZXRJdGVtKGtleTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuc3RvcmFnZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFJldHJpZXZlZCBpdGVtIHdpdGgga2V5OiAke2tleX1gLCB2YWx1ZSA/ICdGb3VuZCcgOiAnTm90IGZvdW5kJyk7XHJcbiAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIHJldHJpZXZpbmcgaXRlbTonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVtb3ZlIGEgc3BlY2lmaWMgaXRlbVxyXG4gICAqL1xyXG4gIHJlbW92ZUl0ZW0oa2V5OiBzdHJpbmcpOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoYFJlbW92ZWQgaXRlbSB3aXRoIGtleTogJHtrZXl9YCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciByZW1vdmluZyBpdGVtOicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFyIGFsbCBPQXV0aDIgcmVsYXRlZCBzdG9yYWdlXHJcbiAgICovXHJcbiAgY2xlYXJBbGwoKTogdm9pZCB7XHJcbiAgICB0cnkge1xyXG4gICAgICBPYmplY3QudmFsdWVzKE9BVVRIMl9TVE9SQUdFX0tFWVMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnQ2xlYXJlZCBhbGwgT0F1dGgyIHN0b3JhZ2UnKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGNsZWFyaW5nIHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2xlYXIgb25seSB0b2tlbi1yZWxhdGVkIHN0b3JhZ2UsIHByZXNlcnZlIE9BdXRoMiBmbG93IHN0b3JhZ2VcclxuICAgKi9cclxuICBjbGVhclRva2VucygpOiB2b2lkIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuS2V5cyA9IFtcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLkFDQ0VTU19UT0tFTixcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4sXHJcbiAgICAgICAgT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULFxyXG4gICAgICAgIE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fVFlQRSxcclxuICAgICAgICBPQVVUSDJfU1RPUkFHRV9LRVlTLlNDT1BFLFxyXG4gICAgICAgIE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU5cclxuICAgICAgXTtcclxuICAgICAgXHJcbiAgICAgIHRva2VuS2V5cy5mb3JFYWNoKGtleSA9PiB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdDbGVhcmVkIHRva2VuIHN0b3JhZ2UgKE9BdXRoMiBmbG93IHN0b3JhZ2UgcHJlc2VydmVkKScpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgY2xlYXJpbmcgdG9rZW4gc3RvcmFnZTonLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbGVhciB0ZW1wb3JhcnkgT0F1dGgyIGZsb3cgc3RvcmFnZVxyXG4gICAqL1xyXG4gIGNsZWFyVGVtcG9yYXJ5KCk6IHZvaWQge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5DT0RFX1ZFUklGSUVSKTtcclxuICAgICAgdGhpcy5zdG9yYWdlLnJlbW92ZUl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TVEFURSk7XHJcbiAgICAgIHRoaXMuc3RvcmFnZS5yZW1vdmVJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuTk9OQ0UpO1xyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdDbGVhcmVkIHRlbXBvcmFyeSBPQXV0aDIgc3RvcmFnZScpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgY2xlYXJpbmcgdGVtcG9yYXJ5IHN0b3JhZ2U6JywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgc3RvcmFnZSBpcyBhdmFpbGFibGVcclxuICAgKi9cclxuICBpc0F2YWlsYWJsZSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGFsbCBzdG9yZWQga2V5cyAoZm9yIGRlYnVnZ2luZylcclxuICAgKi9cclxuICBnZXRTdG9yZWRLZXlzKCk6IHN0cmluZ1tdIHtcclxuICAgIGlmICghdGhpcy5pc0F2YWlsYWJsZSgpKSB7XHJcbiAgICAgIHJldHVybiBbXTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBrZXlzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8ICh0aGlzLnN0b3JhZ2UgYXMgYW55KS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGNvbnN0IGtleSA9ICh0aGlzLnN0b3JhZ2UgYXMgYW55KS5rZXkoaSk7XHJcbiAgICAgICAgaWYgKGtleSAmJiBPYmplY3QudmFsdWVzKE9BVVRIMl9TVE9SQUdFX0tFWVMpLmluY2x1ZGVzKGtleSkpIHtcclxuICAgICAgICAgIGtleXMucHVzaChrZXkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4ga2V5cztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGdldHRpbmcgc3RvcmVkIGtleXM6JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBEZWJ1ZyBsb2dnaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2dEZWJ1ZyhtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5sb2dMZXZlbCA9PT0gJ2RlYnVnJykge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmZvIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0luZm8obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbyddLmluY2x1ZGVzKHRoaXMubG9nTGV2ZWwpKSB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXJuaW5nIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ1dhcm4obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbycsICd3YXJuJ10uaW5jbHVkZXModGhpcy5sb2dMZXZlbCkpIHtcclxuICAgICAgY29uc29sZS53YXJuKGBbT0F1dGgyU3RvcmFnZVNlcnZpY2VdICR7bWVzc2FnZX1gLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVycm9yIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0Vycm9yKG1lc3NhZ2U6IHN0cmluZywgZXJyb3I/OiBhbnkpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmxvZ0xldmVsICE9PSAnbm9uZScpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihgW09BdXRoMlN0b3JhZ2VTZXJ2aWNlXSAke21lc3NhZ2V9YCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxufSJdfQ==","originalSourcemap":{"version":3,"file":"oauth2-storage.service.js","sourceRoot":"","sources":["../../../../../src/lib/services/oauth2-storage.service.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[19,0,0,19],[21,0,0,21],[27,0,0,27],[29,0,0,29],[40,0,0,40],[42,0,0,42],[48,0,0,48],[63,0,0,63],[64,0,0,64]],[[0,0,1,0],[7,0,1,7],[9,0,1,9],[26,0,1,26],[28,0,1,28],[34,0,1,34],[51,0,1,51],[52,0,1,52]],[[0,0,3,0],[7,0,3,7],[9,0,3,9],[28,0,3,28],[30,0,3,46],[36,0,3,52],[66,0,3,82],[67,0,3,83]],[[0,0,4,0],[7,0,4,7],[9,0,4,9],[28,0,4,28],[30,0,4,30],[36,0,4,36],[67,0,4,67],[68,0,4,68]],[],[[0,0,6,0]],[],[],[[3,0,9,3]],[[0,0,13,0],[6,0,13,6],[13,0,13,13],[33,0,13,33]],[[4,0,17,2],[16,0,18,41],[22,0,18,61],[24,0,19,33],[34,0,19,51]],[[8,0,18,41],[19,0,18,47],[22,0,18,41],[28,0,18,47],[29,0,18,61]],[[8,0,19,33],[23,0,19,43],[26,0,19,33],[36,0,19,43],[37,0,19,51]],[[8,0,21,4],[12,0,21,8],[13,0,21,9],[21,0,21,17],[24,0,21,20],[30,0,21,26],[31,0,21,27],[39,0,21,35],[43,0,21,39],[49,0,21,45],[50,0,21,46]],[[8,0,22,4],[12,0,22,8],[13,0,22,9],[20,0,22,16],[23,0,22,19],[27,0,22,23],[28,0,22,24],[45,0,22,41],[47,0,22,43],[48,0,22,44]],[[4,0,23,2],[5,0,23,3]],[[4,0,25,2]],[],[[7,0,27,5]],[[4,0,28,10],[21,0,28,27]],[[8,0,29,4],[12,0,29,8],[13,0,29,9],[30,0,29,26],[31,0,29,27],[35,0,29,31],[36,0,29,32],[46,0,29,42],[47,0,29,43],[49,0,29,45],[50,0,29,46]],[[12,0,30,6],[45,0,30,39]],[[12,0,31,6],[19,0,31,13]],[[16,0,32,8],[23,0,32,15],[25,0,32,17],[28,0,32,20],[30,0,32,22],[31,0,32,23],[35,0,32,27]],[[16,0,33,8],[23,0,33,15],[25,0,33,17],[28,0,33,20],[30,0,33,22],[33,0,33,24],[34,0,33,25]],[[16,0,34,8],[26,0,34,18],[28,0,34,20],[31,0,34,23],[33,0,34,25],[36,0,34,27],[37,0,34,28]],[[16,0,35,8],[21,0,35,13],[23,0,35,15],[26,0,35,18],[28,0,35,20],[31,0,35,22],[32,0,35,23]],[[13,0,36,7],[14,0,36,8]],[[8,0,37,4],[9,0,37,5]],[[8,0,39,4],[16,0,39,12],[20,0,39,16],[21,0,39,17],[27,0,39,23],[28,0,39,24],[35,0,39,31],[37,0,39,33],[38,0,39,34]],[[12,0,40,6],[17,0,40,11],[33,0,40,27]],[[16,0,41,8],[23,0,41,15],[37,0,41,29],[38,0,41,30]],[[12,0,42,6],[17,0,42,11],[25,0,42,19]],[[16,0,43,8],[20,0,43,12],[21,0,43,13],[25,0,43,17],[26,0,43,18],[32,0,43,24],[33,0,43,25],[46,0,43,38],[48,0,43,40],[49,0,43,41]],[[20,0,44,10],[24,0,44,14],[25,0,44,15],[33,0,44,23],[34,0,44,24],[77,0,44,67],[78,0,44,68],[79,0,44,69]],[[20,0,45,10],[27,0,45,17],[39,0,45,29],[40,0,45,30]],[[16,0,46,8],[17,0,46,9]],[[16,0,47,8],[23,0,47,15],[27,0,47,19],[28,0,47,20],[34,0,47,26],[35,0,47,27],[48,0,47,40],[49,0,47,41]],[[12,0,48,6],[17,0,48,11],[31,0,48,25],[32,0,48,26]],[[12,0,49,6]],[[16,0,50,8],[23,0,50,15],[35,0,50,27],[36,0,50,28]],[[8,0,51,4],[9,0,51,5]],[[4,0,52,2],[5,0,52,3]],[[4,0,54,2]],[],[[7,0,56,5]],[[4,0,57,2],[11,0,57,9],[12,0,57,10],[15,0,57,21],[17,0,57,23],[22,0,57,36]],[[8,0,58,4],[12,0,58,8],[13,0,58,9]],[[12,0,59,6],[66,0,59,60]],[[12,0,60,6],[16,0,60,10],[17,0,60,11],[24,0,60,18],[25,0,60,19],[32,0,60,26],[33,0,60,27],[36,0,60,30],[38,0,60,32],[43,0,60,37],[44,0,60,38],[45,0,60,39]],[[12,0,61,6],[16,0,61,10],[17,0,61,11],[25,0,61,19],[26,0,61,20],[51,0,61,45],[54,0,61,48],[56,0,61,50],[57,0,61,51],[58,0,61,52]],[[8,0,62,4],[9,0,62,5]],[[8,0,62,6],[15,0,62,13],[20,0,62,18],[22,0,62,20],[23,0,62,21]],[[12,0,63,6],[16,0,63,10],[17,0,63,11],[25,0,63,19],[26,0,63,20],[47,0,63,41],[49,0,63,43],[54,0,63,48],[55,0,63,49],[56,0,63,50]],[[12,0,64,6],[18,0,64,12],[22,0,64,16],[27,0,64,21],[28,0,64,22],[50,0,64,44],[51,0,64,45],[52,0,64,46]],[[8,0,65,4],[9,0,65,5]],[[4,0,66,2],[5,0,66,3]],[[4,0,68,2]],[],[[7,0,70,5]],[[4,0,71,2],[11,0,71,9],[12,0,71,10],[15,0,71,21]],[[8,0,72,4],[12,0,72,8],[13,0,72,9]],[[12,0,73,6],[18,0,73,12],[23,0,73,17],[26,0,73,20],[30,0,73,24],[31,0,73,25],[38,0,73,32],[39,0,73,33],[46,0,73,40],[47,0,73,41],[50,0,73,44],[51,0,73,45],[52,0,73,46]],[[12,0,74,6],[16,0,74,10],[17,0,74,11],[25,0,74,19],[26,0,74,20],[54,0,74,48],[57,0,74,51],[59,0,74,53],[61,0,74,55],[66,0,74,60],[67,0,74,61],[68,0,74,62],[69,0,74,63],[76,0,74,70],[77,0,74,71],[78,0,74,72],[79,0,74,73],[90,0,74,84],[91,0,74,85],[92,0,74,86]],[[12,0,75,6],[19,0,75,13],[24,0,75,18],[25,0,75,19]],[[8,0,76,4],[9,0,76,5]],[[8,0,76,6],[15,0,76,13],[20,0,76,18],[22,0,76,20],[23,0,76,21]],[[12,0,77,6],[16,0,77,10],[17,0,77,11],[25,0,77,19],[26,0,77,20],[50,0,77,44],[52,0,77,46],[57,0,77,51],[58,0,77,52],[59,0,77,53]],[[12,0,78,6],[19,0,78,13],[23,0,78,17],[24,0,78,18]],[[8,0,79,4],[9,0,79,5]],[[4,0,80,2],[5,0,80,3]],[[4,0,82,2]],[],[[7,0,84,5]],[[4,0,85,2],[14,0,85,12],[15,0,85,13],[18,0,85,24]],[[8,0,86,4],[12,0,86,8],[13,0,86,9]],[[12,0,87,6],[16,0,87,10],[17,0,87,11],[24,0,87,18],[25,0,87,19],[35,0,87,29],[36,0,87,30],[39,0,87,33],[40,0,87,34],[41,0,87,35]],[[12,0,88,6],[16,0,88,10],[17,0,88,11],[25,0,88,19],[26,0,88,20],[52,0,88,46],[55,0,88,49],[57,0,88,51],[58,0,88,52],[59,0,88,53]],[[8,0,89,4],[9,0,89,5]],[[8,0,89,6],[15,0,89,13],[20,0,89,18],[22,0,89,20],[23,0,89,21]],[[12,0,90,6],[16,0,90,10],[17,0,90,11],[25,0,90,19],[26,0,90,20],[48,0,90,42],[50,0,90,44],[55,0,90,49],[56,0,90,50],[57,0,90,51]],[[8,0,91,4],[9,0,91,5]],[[4,0,92,2],[5,0,92,3]],[[4,0,94,2]],[],[[7,0,96,5]],[[4,0,97,2],[12,0,97,10]],[[8,0,98,4],[12,0,98,8],[13,0,98,9]],[[12,0,99,6],[18,0,99,12],[19,0,99,13],[25,0,99,19],[26,0,99,20],[45,0,99,39],[46,0,99,40],[47,0,99,41],[54,0,99,48],[55,0,99,49],[58,0,99,52],[59,0,99,53],[61,0,99,55]],[[16,0,100,8],[20,0,100,12],[21,0,100,13],[28,0,100,20],[29,0,100,21],[39,0,100,31],[40,0,100,32],[43,0,100,35],[44,0,100,36],[45,0,100,37]],[[12,0,101,6],[13,0,101,7],[14,0,101,8],[15,0,101,9]],[[12,0,102,6],[16,0,102,10],[17,0,102,11],[25,0,102,19],[26,0,102,20],[54,0,102,48],[55,0,102,49],[56,0,102,50]],[[8,0,103,4],[9,0,103,5]],[[8,0,103,6],[15,0,103,13],[20,0,103,18],[22,0,103,20],[23,0,103,21]],[[12,0,104,6],[16,0,104,10],[17,0,104,11],[25,0,104,19],[26,0,104,20],[51,0,104,45],[53,0,104,47],[58,0,104,52],[59,0,104,53],[60,0,104,54]],[[8,0,105,4],[9,0,105,5]],[[4,0,106,2],[5,0,106,3]],[[4,0,108,2]],[],[[7,0,110,5]],[[4,0,111,2],[15,0,111,13]],[[8,0,112,4],[12,0,112,8],[13,0,112,9]],[[12,0,113,6],[18,0,113,12],[27,0,113,21],[30,0,113,24]],[[16,0,114,8],[35,0,114,27],[36,0,114,28],[48,0,114,40]],[[16,0,115,8],[35,0,115,27],[36,0,115,28],[49,0,115,41]],[[16,0,116,8],[35,0,116,27],[36,0,116,28],[52,0,116,44]],[[16,0,117,8],[35,0,117,27],[36,0,117,28],[46,0,117,38]],[[16,0,118,8],[35,0,118,27],[36,0,118,28],[41,0,118,33]],[[16,0,119,8],[35,0,119,27],[36,0,119,28],[44,0,119,36]],[[13,0,120,7],[14,0,120,8]],[[12,0,122,6],[21,0,122,15],[22,0,122,16],[29,0,122,23],[30,0,122,24],[33,0,122,27],[34,0,122,28],[36,0,122,30]],[[16,0,123,8],[20,0,123,12],[21,0,123,13],[28,0,123,20],[29,0,123,21],[39,0,123,31],[40,0,123,32],[43,0,123,35],[44,0,123,36],[45,0,123,37]],[[12,0,124,6],[13,0,124,7],[14,0,124,8],[15,0,124,9]],[[12,0,126,6],[16,0,126,10],[17,0,126,11],[25,0,126,19],[26,0,126,20],[81,0,126,75],[82,0,126,76],[83,0,126,77]],[[8,0,127,4],[9,0,127,5]],[[8,0,127,6],[15,0,127,13],[20,0,127,18],[22,0,127,20],[23,0,127,21]],[[12,0,128,6],[16,0,128,10],[17,0,128,11],[25,0,128,19],[26,0,128,20],[57,0,128,51],[59,0,128,53],[64,0,128,58],[65,0,128,59],[66,0,128,60]],[[8,0,129,4],[9,0,129,5]],[[4,0,130,2],[5,0,130,3]],[[4,0,132,2]],[],[[7,0,134,5]],[[4,0,135,2],[18,0,135,16]],[[8,0,136,4],[12,0,136,8],[13,0,136,9]],[[12,0,137,6],[16,0,137,10],[17,0,137,11],[24,0,137,18],[25,0,137,19],[35,0,137,29],[36,0,137,30],[55,0,137,49],[56,0,137,50],[69,0,137,63],[70,0,137,64],[71,0,137,65]],[[12,0,138,6],[16,0,138,10],[17,0,138,11],[24,0,138,18],[25,0,138,19],[35,0,138,29],[36,0,138,30],[55,0,138,49],[56,0,138,50],[61,0,138,55],[62,0,138,56],[63,0,138,57]],[[12,0,139,6],[16,0,139,10],[17,0,139,11],[24,0,139,18],[25,0,139,19],[35,0,139,29],[36,0,139,30],[55,0,139,49],[56,0,139,50],[61,0,139,55],[62,0,139,56],[63,0,139,57]],[[12,0,140,6],[16,0,140,10],[17,0,140,11],[25,0,140,19],[26,0,140,20],[60,0,140,54],[61,0,140,55],[62,0,140,56]],[[8,0,141,4],[9,0,141,5]],[[8,0,141,6],[15,0,141,13],[20,0,141,18],[22,0,141,20],[23,0,141,21]],[[12,0,142,6],[16,0,142,10],[17,0,142,11],[25,0,142,19],[26,0,142,20],[61,0,142,55],[63,0,142,57],[68,0,142,62],[69,0,142,63],[70,0,142,64]],[[8,0,143,4],[9,0,143,5]],[[4,0,144,2],[5,0,144,3]],[[4,0,146,2]],[],[[7,0,148,5]],[[4,0,149,2],[15,0,149,13]],[[8,0,150,4],[15,0,150,11],[32,0,150,28],[33,0,150,29],[37,0,150,33],[38,0,150,34],[48,0,150,44],[49,0,150,45],[50,0,150,46]],[[4,0,151,2],[5,0,151,3]],[[4,0,153,2]],[],[[7,0,155,5]],[[4,0,156,2],[17,0,156,15]],[[8,0,157,4],[12,0,157,8],[13,0,157,9],[17,0,157,13],[18,0,157,14],[29,0,157,25],[31,0,157,27],[33,0,157,29],[34,0,157,30]],[[12,0,158,6],[19,0,158,13],[21,0,158,15],[22,0,158,16]],[[8,0,159,4],[9,0,159,5]],[[8,0,161,4],[12,0,161,8],[13,0,161,9]],[[12,0,162,6],[18,0,162,12],[22,0,162,16],[25,0,162,29],[27,0,162,31],[28,0,162,32]],[[12,0,163,6],[17,0,163,11],[21,0,163,15],[22,0,163,16],[25,0,163,19],[26,0,163,20],[28,0,163,22],[29,0,163,23],[32,0,163,27],[36,0,163,31],[37,0,163,32],[44,0,163,47],[45,0,163,48],[51,0,163,54],[53,0,163,56],[54,0,163,57],[56,0,163,59],[58,0,163,61],[59,0,163,62]],[[16,0,164,8],[22,0,164,14],[25,0,164,17],[28,0,164,21],[32,0,164,25],[33,0,164,26],[40,0,164,41],[41,0,164,42],[44,0,164,45],[45,0,164,46],[46,0,164,47],[47,0,164,48],[48,0,164,49]],[[16,0,165,8],[20,0,165,12],[23,0,165,15],[27,0,165,19],[33,0,165,25],[34,0,165,26],[40,0,165,32],[41,0,165,33],[60,0,165,52],[61,0,165,53],[62,0,165,54],[70,0,165,62],[71,0,165,63],[74,0,165,66],[75,0,165,67],[77,0,165,69],[78,0,165,70]],[[20,0,166,10],[24,0,166,14],[25,0,166,15],[29,0,166,19],[30,0,166,20],[33,0,166,23],[34,0,166,24],[35,0,166,25]],[[16,0,167,8],[17,0,167,9]],[[12,0,168,6],[13,0,168,7]],[[12,0,169,6],[19,0,169,13],[23,0,169,17],[24,0,169,18]],[[8,0,170,4],[9,0,170,5]],[[8,0,170,6],[15,0,170,13],[20,0,170,18],[22,0,170,20],[23,0,170,21]],[[12,0,171,6],[16,0,171,10],[17,0,171,11],[25,0,171,19],[26,0,171,20],[54,0,171,48],[56,0,171,50],[61,0,171,55],[62,0,171,56],[63,0,171,57]],[[12,0,172,6],[19,0,172,13],[21,0,172,15],[22,0,172,16]],[[8,0,173,4],[9,0,173,5]],[[4,0,174,2],[5,0,174,3]],[[4,0,176,2]],[],[[7,0,178,5]],[[4,0,179,10],[12,0,179,18],[13,0,179,19],[20,0,179,34],[22,0,179,36],[25,0,179,39],[29,0,179,50]],[[8,0,180,4],[12,0,180,8],[16,0,180,12],[17,0,180,13],[25,0,180,21],[30,0,180,26],[37,0,180,33],[39,0,180,35],[40,0,180,36]],[[12,0,181,6],[19,0,181,13],[20,0,181,14],[23,0,181,17],[24,0,181,18],[50,0,181,44],[57,0,181,51],[59,0,181,53],[61,0,181,55],[64,0,181,58],[68,0,181,62],[69,0,181,63],[70,0,181,64]],[[8,0,182,4],[9,0,182,5]],[[4,0,183,2],[5,0,183,3]],[[4,0,185,2]],[],[[7,0,187,5]],[[4,0,188,10],[11,0,188,17],[12,0,188,18],[19,0,188,33],[21,0,188,35],[24,0,188,38],[28,0,188,49]],[[8,0,189,4],[12,0,189,8],[13,0,189,9],[20,0,189,16],[22,0,189,18],[28,0,189,24],[29,0,189,25],[30,0,189,26],[38,0,189,34],[39,0,189,35],[43,0,189,39],[44,0,189,40],[52,0,189,48],[53,0,189,49],[55,0,189,51],[56,0,189,52]],[[12,0,190,6],[19,0,190,13],[20,0,190,14],[24,0,190,18],[25,0,190,19],[51,0,190,45],[58,0,190,52],[60,0,190,54],[62,0,190,56],[65,0,190,59],[69,0,190,63],[70,0,190,64],[71,0,190,65]],[[8,0,191,4],[9,0,191,5]],[[4,0,192,2],[5,0,192,3]],[[4,0,194,2]],[],[[7,0,196,5]],[[4,0,197,10],[11,0,197,17],[12,0,197,18],[19,0,197,33],[21,0,197,35],[24,0,197,38],[28,0,197,49]],[[8,0,198,4],[12,0,198,8],[13,0,198,9],[20,0,198,16],[22,0,198,18],[28,0,198,24],[30,0,198,26],[36,0,198,32],[37,0,198,33],[38,0,198,34],[46,0,198,42],[47,0,198,43],[51,0,198,47],[52,0,198,48],[60,0,198,56],[61,0,198,57],[63,0,198,59],[64,0,198,60]],[[12,0,199,6],[19,0,199,13],[20,0,199,14],[24,0,199,18],[25,0,199,19],[51,0,199,45],[58,0,199,52],[60,0,199,54],[62,0,199,56],[65,0,199,59],[69,0,199,63],[70,0,199,64],[71,0,199,65]],[[8,0,200,4],[9,0,200,5]],[[4,0,201,2],[5,0,201,3]],[[4,0,203,2]],[],[[7,0,205,5]],[[4,0,206,10],[12,0,206,18],[13,0,206,19],[20,0,206,34],[22,0,206,36],[27,0,206,47]],[[8,0,207,4],[12,0,207,8],[16,0,207,12],[17,0,207,13],[25,0,207,21],[30,0,207,26],[36,0,207,32],[38,0,207,34],[39,0,207,35]],[[12,0,208,6],[19,0,208,13],[20,0,208,14],[25,0,208,19],[26,0,208,20],[52,0,208,46],[59,0,208,53],[61,0,208,55],[63,0,208,57],[68,0,208,62],[69,0,208,63],[70,0,208,64]],[[8,0,209,4],[9,0,209,5]],[[4,0,210,2],[5,0,210,3]],[[117,0,13,13],[137,0,13,33],[151,0,18,12],[170,0,18,31],[185,0,19,12],[196,0,19,23]],[[71,0,13,13],[91,0,13,33],[102,0,13,13],[122,0,13,33],[141,0,11,14],[147,0,11,20]],[],[[81,0,13,13],[101,0,13,33]],[[14,0,10,1],[24,0,10,11]],[[15,0,10,12]],[[16,0,11,2],[26,0,11,12],[28,0,11,14],[34,0,11,20]],[[13,0,12,1]],[],[[22,0,18,5],[28,0,18,11]],[[23,0,18,12],[42,0,18,31]],[],[[22,0,19,5],[28,0,19,11]],[[23,0,19,12],[34,0,19,23]]],"sourcesContent":["import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport { OAuth2Config, OAuth2Storage } from '../models/oauth2-config.model';\r\nimport { OAUTH2_STORAGE_KEYS, OAuth2LogLevel } from '../models/oauth2-types.model';\r\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\r\n\r\n/**\r\n * OAuth2 Storage Service\r\n * Handles secure storage and retrieval of OAuth2 tokens and data\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OAuth2StorageService {\r\n  private storage: OAuth2Storage;\r\n  private logLevel: OAuth2LogLevel;\r\n\r\n  constructor(\r\n    @Inject(OAUTH2_CONFIG_TOKEN) private config: OAuth2Config,\r\n    @Inject(PLATFORM_ID) private platformId: Object\r\n  ) {\r\n    this.logLevel = config.logLevel || 'warn';\r\n    this.storage = this.initializeStorage();\r\n  }\r\n\r\n  /**\r\n   * Initialize storage based on configuration\r\n   */\r\n  private initializeStorage(): OAuth2Storage {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      // Return a no-op storage for SSR\r\n      return {\r\n        getItem: () => null,\r\n        setItem: () => {},\r\n        removeItem: () => {},\r\n        clear: () => {}\r\n      };\r\n    }\r\n\r\n    switch (this.config.storage) {\r\n      case 'sessionStorage':\r\n        return sessionStorage;\r\n      case 'custom':\r\n        if (!this.config.customStorage) {\r\n          this.logError('Custom storage specified but not provided');\r\n          return localStorage;\r\n        }\r\n        return this.config.customStorage;\r\n      case 'localStorage':\r\n      default:\r\n        return localStorage;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store a value securely\r\n   */\r\n  setItem(key: string, value: string): void {\r\n    try {\r\n      // In production, consider encrypting sensitive values\r\n      this.storage.setItem(key, value);\r\n      this.logDebug(`Stored item with key: ${key}`);\r\n    } catch (error) {\r\n      this.logError('Error storing item:', error);\r\n      throw new Error('Failed to store item');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve a value securely\r\n   */\r\n  getItem(key: string): string | null {\r\n    try {\r\n      const value = this.storage.getItem(key);\r\n      this.logDebug(`Retrieved item with key: ${key}`, value ? 'Found' : 'Not found');\r\n      return value;\r\n    } catch (error) {\r\n      this.logError('Error retrieving item:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a specific item\r\n   */\r\n  removeItem(key: string): void {\r\n    try {\r\n      this.storage.removeItem(key);\r\n      this.logDebug(`Removed item with key: ${key}`);\r\n    } catch (error) {\r\n      this.logError('Error removing item:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all OAuth2 related storage\r\n   */\r\n  clearAll(): void {\r\n    try {\r\n      Object.values(OAUTH2_STORAGE_KEYS).forEach(key => {\r\n        this.storage.removeItem(key);\r\n      });\r\n      this.logDebug('Cleared all OAuth2 storage');\r\n    } catch (error) {\r\n      this.logError('Error clearing storage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear only token-related storage, preserve OAuth2 flow storage\r\n   */\r\n  clearTokens(): void {\r\n    try {\r\n      const tokenKeys = [\r\n        OAUTH2_STORAGE_KEYS.ACCESS_TOKEN,\r\n        OAUTH2_STORAGE_KEYS.REFRESH_TOKEN,\r\n        OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT,\r\n        OAUTH2_STORAGE_KEYS.TOKEN_TYPE,\r\n        OAUTH2_STORAGE_KEYS.SCOPE,\r\n        OAUTH2_STORAGE_KEYS.ID_TOKEN\r\n      ];\r\n      \r\n      tokenKeys.forEach(key => {\r\n        this.storage.removeItem(key);\r\n      });\r\n      \r\n      this.logDebug('Cleared token storage (OAuth2 flow storage preserved)');\r\n    } catch (error) {\r\n      this.logError('Error clearing token storage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear temporary OAuth2 flow storage\r\n   */\r\n  clearTemporary(): void {\r\n    try {\r\n      this.storage.removeItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\r\n      this.storage.removeItem(OAUTH2_STORAGE_KEYS.STATE);\r\n      this.storage.removeItem(OAUTH2_STORAGE_KEYS.NONCE);\r\n      this.logDebug('Cleared temporary OAuth2 storage');\r\n    } catch (error) {\r\n      this.logError('Error clearing temporary storage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if storage is available\r\n   */\r\n  isAvailable(): boolean {\r\n    return isPlatformBrowser(this.platformId);\r\n  }\r\n\r\n  /**\r\n   * Get all stored keys (for debugging)\r\n   */\r\n  getStoredKeys(): string[] {\r\n    if (!this.isAvailable()) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      const keys: string[] = [];\r\n      for (let i = 0; i < (this.storage as any).length; i++) {\r\n        const key = (this.storage as any).key(i);\r\n        if (key && Object.values(OAUTH2_STORAGE_KEYS).includes(key)) {\r\n          keys.push(key);\r\n        }\r\n      }\r\n      return keys;\r\n    } catch (error) {\r\n      this.logError('Error getting stored keys:', error);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Debug logging\r\n   */\r\n  private logDebug(message: string, ...args: any[]): void {\r\n    if (this.logLevel === 'debug') {\r\n      console.log(`[OAuth2StorageService] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Info logging\r\n   */\r\n  private logInfo(message: string, ...args: any[]): void {\r\n    if (['debug', 'info'].includes(this.logLevel)) {\r\n      console.info(`[OAuth2StorageService] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Warning logging\r\n   */\r\n  private logWarn(message: string, ...args: any[]): void {\r\n    if (['debug', 'info', 'warn'].includes(this.logLevel)) {\r\n      console.warn(`[OAuth2StorageService] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Error logging\r\n   */\r\n  private logError(message: string, error?: any): void {\r\n    if (this.logLevel !== 'none') {\r\n      console.error(`[OAuth2StorageService] ${message}`, error);\r\n    }\r\n  }\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common":{"attributes":{},"external":true,"id":"@angular/common","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"../models/oauth2-types.model":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"../tokens/oauth2-config.token":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":95718,"body":[{"type":"ImportDeclaration","start":0,"end":72,"specifiers":[{"type":"ImportSpecifier","start":9,"end":19,"imported":{"type":"Identifier","start":9,"end":19,"name":"Injectable"},"local":{"type":"Identifier","start":9,"end":19,"name":"Injectable"}},{"type":"ImportSpecifier","start":21,"end":27,"imported":{"type":"Identifier","start":21,"end":27,"name":"Inject"},"local":{"type":"Identifier","start":21,"end":27,"name":"Inject"}},{"type":"ImportSpecifier","start":29,"end":40,"imported":{"type":"Identifier","start":29,"end":40,"name":"PLATFORM_ID"},"local":{"type":"Identifier","start":29,"end":40,"name":"PLATFORM_ID"}},{"type":"ImportSpecifier","start":42,"end":48,"imported":{"type":"Identifier","start":42,"end":48,"name":"signal"},"local":{"type":"Identifier","start":42,"end":48,"name":"signal"}}],"source":{"type":"Literal","start":56,"end":71,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":73,"end":125,"specifiers":[{"type":"ImportSpecifier","start":82,"end":99,"imported":{"type":"Identifier","start":82,"end":99,"name":"isPlatformBrowser"},"local":{"type":"Identifier","start":82,"end":99,"name":"isPlatformBrowser"}}],"source":{"type":"Literal","start":107,"end":124,"value":"@angular/common","raw":"'@angular/common'"},"attributes":[]},{"type":"ImportDeclaration","start":126,"end":165,"specifiers":[{"type":"ImportSpecifier","start":135,"end":150,"imported":{"type":"Identifier","start":135,"end":150,"name":"BehaviorSubject"},"local":{"type":"Identifier","start":135,"end":150,"name":"BehaviorSubject"}}],"source":{"type":"Literal","start":158,"end":164,"value":"rxjs","raw":"'rxjs'"},"attributes":[]},{"type":"ImportDeclaration","start":166,"end":233,"specifiers":[{"type":"ImportSpecifier","start":175,"end":194,"imported":{"type":"Identifier","start":175,"end":194,"name":"OAUTH2_STORAGE_KEYS"},"local":{"type":"Identifier","start":175,"end":194,"name":"OAUTH2_STORAGE_KEYS"}}],"source":{"type":"Literal","start":202,"end":232,"value":"../models/oauth2-types.model","raw":"'../models/oauth2-types.model'"},"attributes":[]},{"type":"ImportDeclaration","start":234,"end":302,"specifiers":[{"type":"ImportSpecifier","start":243,"end":262,"imported":{"type":"Identifier","start":243,"end":262,"name":"OAUTH2_CONFIG_TOKEN"},"local":{"type":"Identifier","start":243,"end":262,"name":"OAUTH2_CONFIG_TOKEN"}}],"source":{"type":"Literal","start":270,"end":301,"value":"../tokens/oauth2-config.token","raw":"'../tokens/oauth2-config.token'"},"attributes":[]},{"type":"ImportDeclaration","start":303,"end":339,"specifiers":[{"type":"ImportNamespaceSpecifier","start":310,"end":317,"local":{"type":"Identifier","start":315,"end":317,"name":"i0"}}],"source":{"type":"Literal","start":323,"end":338,"value":"@angular/core","raw":"\"@angular/core\""},"attributes":[]},{"type":"ImportDeclaration","start":340,"end":383,"specifiers":[{"type":"ImportNamespaceSpecifier","start":347,"end":354,"local":{"type":"Identifier","start":352,"end":354,"name":"i1"}}],"source":{"type":"Literal","start":360,"end":382,"value":"@angular/common/http","raw":"\"@angular/common/http\""},"attributes":[]},{"type":"ImportDeclaration","start":384,"end":422,"specifiers":[{"type":"ImportNamespaceSpecifier","start":391,"end":398,"local":{"type":"Identifier","start":396,"end":398,"name":"i2"}}],"source":{"type":"Literal","start":404,"end":421,"value":"@angular/router","raw":"\"@angular/router\""},"attributes":[]},{"type":"ImportDeclaration","start":423,"end":470,"specifiers":[{"type":"ImportNamespaceSpecifier","start":430,"end":437,"local":{"type":"Identifier","start":435,"end":437,"name":"i3"}}],"source":{"type":"Literal","start":443,"end":469,"value":"./oauth2-storage.service","raw":"\"./oauth2-storage.service\""},"attributes":[]},{"type":"ExportNamedDeclaration","start":595,"end":28292,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":602,"end":28292,"decorators":[],"id":{"type":"Identifier","start":608,"end":621,"name":"OAuth2Service"},"superClass":null,"body":{"type":"ClassBody","start":622,"end":28292,"body":[{"type":"MethodDefinition","start":628,"end":1318,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":628,"end":639,"name":"constructor"},"value":{"type":"FunctionExpression","start":639,"end":1318,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":640,"end":646,"name":"config"},{"type":"Identifier","start":648,"end":658,"name":"platformId"},{"type":"Identifier","start":660,"end":664,"name":"http"},{"type":"Identifier","start":666,"end":672,"name":"router"},{"type":"Identifier","start":674,"end":688,"name":"storageService"}],"body":{"type":"BlockStatement","start":690,"end":1318,"body":[{"type":"ExpressionStatement","start":700,"end":721,"expression":{"type":"AssignmentExpression","start":700,"end":720,"operator":"=","left":{"type":"MemberExpression","start":700,"end":711,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":700,"end":704},"property":{"type":"Identifier","start":705,"end":711,"name":"config"}},"right":{"type":"Identifier","start":714,"end":720,"name":"config"}}},{"type":"ExpressionStatement","start":730,"end":759,"expression":{"type":"AssignmentExpression","start":730,"end":758,"operator":"=","left":{"type":"MemberExpression","start":730,"end":745,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":730,"end":734},"property":{"type":"Identifier","start":735,"end":745,"name":"platformId"}},"right":{"type":"Identifier","start":748,"end":758,"name":"platformId"}}},{"type":"ExpressionStatement","start":768,"end":785,"expression":{"type":"AssignmentExpression","start":768,"end":784,"operator":"=","left":{"type":"MemberExpression","start":768,"end":777,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":768,"end":772},"property":{"type":"Identifier","start":773,"end":777,"name":"http"}},"right":{"type":"Identifier","start":780,"end":784,"name":"http"}}},{"type":"ExpressionStatement","start":794,"end":815,"expression":{"type":"AssignmentExpression","start":794,"end":814,"operator":"=","left":{"type":"MemberExpression","start":794,"end":805,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":794,"end":798},"property":{"type":"Identifier","start":799,"end":805,"name":"router"}},"right":{"type":"Identifier","start":808,"end":814,"name":"router"}}},{"type":"ExpressionStatement","start":824,"end":861,"expression":{"type":"AssignmentExpression","start":824,"end":860,"operator":"=","left":{"type":"MemberExpression","start":824,"end":843,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":824,"end":828},"property":{"type":"Identifier","start":829,"end":843,"name":"storageService"}},"right":{"type":"Identifier","start":846,"end":860,"name":"storageService"}}},{"type":"ExpressionStatement","start":870,"end":973,"expression":{"type":"AssignmentExpression","start":870,"end":972,"operator":"=","left":{"type":"MemberExpression","start":870,"end":885,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":870,"end":874},"property":{"type":"Identifier","start":875,"end":885,"name":"_authState"}},"right":{"type":"CallExpression","start":888,"end":972,"optional":false,"callee":{"type":"Identifier","start":888,"end":894,"name":"signal"},"arguments":[{"type":"ObjectExpression","start":895,"end":971,"properties":[{"type":"Property","start":909,"end":931,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":909,"end":924,"name":"isAuthenticated"},"value":{"type":"Literal","start":926,"end":931,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":945,"end":961,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":945,"end":954,"name":"isLoading"},"value":{"type":"Literal","start":956,"end":961,"value":false,"raw":"false"},"kind":"init"}]}]}}},{"type":"ExpressionStatement","start":982,"end":1105,"expression":{"type":"AssignmentExpression","start":982,"end":1104,"operator":"=","left":{"type":"MemberExpression","start":982,"end":1004,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":982,"end":986},"property":{"type":"Identifier","start":987,"end":1004,"name":"_authStateSubject"}},"right":{"type":"NewExpression","start":1007,"end":1104,"callee":{"type":"Identifier","start":1011,"end":1026,"name":"BehaviorSubject"},"arguments":[{"type":"ObjectExpression","start":1027,"end":1103,"properties":[{"type":"Property","start":1041,"end":1063,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1041,"end":1056,"name":"isAuthenticated"},"value":{"type":"Literal","start":1058,"end":1063,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":1077,"end":1093,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1077,"end":1086,"name":"isLoading"},"value":{"type":"Literal","start":1088,"end":1093,"value":false,"raw":"false"},"kind":"init"}]}]}}},{"type":"ExpressionStatement","start":1114,"end":1170,"expression":{"type":"AssignmentExpression","start":1114,"end":1169,"operator":"=","left":{"type":"MemberExpression","start":1114,"end":1129,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1114,"end":1118},"property":{"type":"Identifier","start":1119,"end":1129,"name":"authState$"}},"right":{"type":"CallExpression","start":1132,"end":1169,"optional":false,"callee":{"type":"MemberExpression","start":1132,"end":1167,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1132,"end":1154,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1132,"end":1136},"property":{"type":"Identifier","start":1137,"end":1154,"name":"_authStateSubject"}},"property":{"type":"Identifier","start":1155,"end":1167,"name":"asObservable"}},"arguments":[]}}},{"type":"ExpressionStatement","start":1179,"end":1225,"expression":{"type":"AssignmentExpression","start":1179,"end":1224,"operator":"=","left":{"type":"MemberExpression","start":1179,"end":1193,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1179,"end":1183},"property":{"type":"Identifier","start":1184,"end":1193,"name":"authState"}},"right":{"type":"CallExpression","start":1196,"end":1224,"optional":false,"callee":{"type":"MemberExpression","start":1196,"end":1222,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1196,"end":1211,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1196,"end":1200},"property":{"type":"Identifier","start":1201,"end":1211,"name":"_authState"}},"property":{"type":"Identifier","start":1212,"end":1222,"name":"asReadonly"}},"arguments":[]}}},{"type":"ExpressionStatement","start":1234,"end":1276,"expression":{"type":"AssignmentExpression","start":1234,"end":1275,"operator":"=","left":{"type":"MemberExpression","start":1234,"end":1247,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1234,"end":1238},"property":{"type":"Identifier","start":1239,"end":1247,"name":"logLevel"}},"right":{"type":"LogicalExpression","start":1250,"end":1275,"operator":"||","left":{"type":"MemberExpression","start":1250,"end":1265,"computed":false,"optional":false,"object":{"type":"Identifier","start":1250,"end":1256,"name":"config"},"property":{"type":"Identifier","start":1257,"end":1265,"name":"logLevel"}},"right":{"type":"Literal","start":1269,"end":1275,"value":"warn","raw":"'warn'"}}}},{"type":"ExpressionStatement","start":1285,"end":1312,"expression":{"type":"CallExpression","start":1285,"end":1311,"optional":false,"callee":{"type":"MemberExpression","start":1285,"end":1309,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1285,"end":1289},"property":{"type":"Identifier","start":1290,"end":1309,"name":"initializeAuthState"}},"arguments":[]}}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":1397,"end":2727,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1397,"end":1416,"name":"initializeAuthState"},"value":{"type":"FunctionExpression","start":1416,"end":2727,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":1419,"end":2727,"body":[{"type":"IfStatement","start":1429,"end":1501,"test":{"type":"UnaryExpression","start":1433,"end":1468,"operator":"!","argument":{"type":"CallExpression","start":1434,"end":1468,"optional":false,"callee":{"type":"Identifier","start":1434,"end":1451,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":1452,"end":1467,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1452,"end":1456},"property":{"type":"Identifier","start":1457,"end":1467,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":1470,"end":1501,"body":[{"type":"ReturnStatement","start":1484,"end":1491,"argument":null}]},"alternate":null},{"type":"TryStatement","start":1510,"end":2721,"block":{"type":"BlockStatement","start":1514,"end":2572,"body":[{"type":"VariableDeclaration","start":1528,"end":1572,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1534,"end":1571,"id":{"type":"Identifier","start":1534,"end":1543,"name":"tokenInfo"},"init":{"type":"CallExpression","start":1546,"end":1571,"optional":false,"callee":{"type":"MemberExpression","start":1546,"end":1569,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1546,"end":1550},"property":{"type":"Identifier","start":1551,"end":1569,"name":"getStoredTokenInfo"}},"arguments":[]}}]},{"type":"IfStatement","start":1585,"end":2562,"test":{"type":"LogicalExpression","start":1589,"end":1630,"operator":"&&","left":{"type":"Identifier","start":1589,"end":1598,"name":"tokenInfo"},"right":{"type":"CallExpression","start":1602,"end":1630,"optional":false,"callee":{"type":"MemberExpression","start":1602,"end":1619,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1602,"end":1606},"property":{"type":"Identifier","start":1607,"end":1619,"name":"isTokenValid"}},"arguments":[{"type":"Identifier","start":1620,"end":1629,"name":"tokenInfo"}]}},"consequent":{"type":"BlockStatement","start":1632,"end":1902,"body":[{"type":"ExpressionStatement","start":1650,"end":1803,"expression":{"type":"CallExpression","start":1650,"end":1802,"optional":false,"callee":{"type":"MemberExpression","start":1650,"end":1670,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1650,"end":1654},"property":{"type":"Identifier","start":1655,"end":1670,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":1671,"end":1801,"properties":[{"type":"Property","start":1693,"end":1714,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1693,"end":1708,"name":"isAuthenticated"},"value":{"type":"Literal","start":1710,"end":1714,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":1736,"end":1752,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1736,"end":1745,"name":"isLoading"},"value":{"type":"Literal","start":1747,"end":1752,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":1774,"end":1783,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1774,"end":1783,"name":"tokenInfo"},"value":{"type":"Identifier","start":1774,"end":1783,"name":"tokenInfo"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":1820,"end":1888,"expression":{"type":"CallExpression","start":1820,"end":1887,"optional":false,"callee":{"type":"MemberExpression","start":1820,"end":1832,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1820,"end":1824},"property":{"type":"Identifier","start":1825,"end":1832,"name":"logInfo"}},"arguments":[{"type":"Literal","start":1833,"end":1886,"value":"Authentication state initialized from stored tokens","raw":"'Authentication state initialized from stored tokens'"}]}}]},"alternate":{"type":"IfStatement","start":1920,"end":2562,"test":{"type":"LogicalExpression","start":1924,"end":1959,"operator":"&&","left":{"type":"Identifier","start":1924,"end":1933,"name":"tokenInfo"},"right":{"type":"MemberExpression","start":1937,"end":1959,"computed":false,"optional":false,"object":{"type":"Identifier","start":1937,"end":1946,"name":"tokenInfo"},"property":{"type":"Identifier","start":1947,"end":1959,"name":"refreshToken"}}},"consequent":{"type":"BlockStatement","start":1961,"end":2338,"body":[{"type":"ExpressionStatement","start":2047,"end":2142,"expression":{"type":"CallExpression","start":2047,"end":2141,"optional":false,"callee":{"type":"MemberExpression","start":2047,"end":2059,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2047,"end":2051},"property":{"type":"Identifier","start":2052,"end":2059,"name":"logInfo"}},"arguments":[{"type":"Literal","start":2060,"end":2140,"value":"Access token expired but refresh token available - preserving for refresh flow","raw":"'Access token expired but refresh token available - preserving for refresh flow'"}]}},{"type":"ExpressionStatement","start":2159,"end":2324,"expression":{"type":"CallExpression","start":2159,"end":2323,"optional":false,"callee":{"type":"MemberExpression","start":2159,"end":2179,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2159,"end":2163},"property":{"type":"Identifier","start":2164,"end":2179,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":2180,"end":2322,"properties":[{"type":"Property","start":2202,"end":2224,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2202,"end":2217,"name":"isAuthenticated"},"value":{"type":"Literal","start":2219,"end":2224,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":2246,"end":2262,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2246,"end":2255,"name":"isLoading"},"value":{"type":"Literal","start":2257,"end":2262,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":2284,"end":2304,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2284,"end":2293,"name":"tokenInfo"},"value":{"type":"Identifier","start":2295,"end":2304,"name":"undefined"},"kind":"init"}]}]}}]},"alternate":{"type":"BlockStatement","start":2356,"end":2562,"body":[{"type":"ExpressionStatement","start":2452,"end":2486,"expression":{"type":"CallExpression","start":2452,"end":2485,"optional":false,"callee":{"type":"MemberExpression","start":2452,"end":2483,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2452,"end":2471,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2452,"end":2456},"property":{"type":"Identifier","start":2457,"end":2471,"name":"storageService"}},"property":{"type":"Identifier","start":2472,"end":2483,"name":"clearTokens"}},"arguments":[]}},{"type":"ExpressionStatement","start":2503,"end":2548,"expression":{"type":"CallExpression","start":2503,"end":2547,"optional":false,"callee":{"type":"MemberExpression","start":2503,"end":2515,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2503,"end":2507},"property":{"type":"Identifier","start":2508,"end":2515,"name":"logInfo"}},"arguments":[{"type":"Literal","start":2516,"end":2546,"value":"No valid stored tokens found","raw":"'No valid stored tokens found'"}]}}]}}}]},"handler":{"type":"CatchClause","start":2581,"end":2721,"param":{"type":"Identifier","start":2588,"end":2593,"name":"error"},"body":{"type":"BlockStatement","start":2595,"end":2721,"body":[{"type":"ExpressionStatement","start":2609,"end":2664,"expression":{"type":"CallExpression","start":2609,"end":2663,"optional":false,"callee":{"type":"MemberExpression","start":2609,"end":2622,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2609,"end":2613},"property":{"type":"Identifier","start":2614,"end":2622,"name":"logError"}},"arguments":[{"type":"Literal","start":2623,"end":2655,"value":"Error initializing auth state:","raw":"'Error initializing auth state:'"},{"type":"Identifier","start":2657,"end":2662,"name":"error"}]}},{"type":"ExpressionStatement","start":2677,"end":2711,"expression":{"type":"CallExpression","start":2677,"end":2710,"optional":false,"callee":{"type":"MemberExpression","start":2677,"end":2708,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2677,"end":2696,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2677,"end":2681},"property":{"type":"Identifier","start":2682,"end":2696,"name":"storageService"}},"property":{"type":"Identifier","start":2697,"end":2708,"name":"clearTokens"}},"arguments":[]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":2804,"end":3137,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":2810,"end":2831,"name":"generatePKCEChallenge"},"value":{"type":"FunctionExpression","start":2831,"end":3137,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":2834,"end":3137,"body":[{"type":"VariableDeclaration","start":2844,"end":2899,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2850,"end":2898,"id":{"type":"Identifier","start":2850,"end":2862,"name":"codeVerifier"},"init":{"type":"CallExpression","start":2865,"end":2898,"optional":false,"callee":{"type":"MemberExpression","start":2865,"end":2896,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2865,"end":2869},"property":{"type":"Identifier","start":2870,"end":2896,"name":"generateSecureCodeVerifier"}},"arguments":[]}}]},{"type":"VariableDeclaration","start":2908,"end":2975,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2914,"end":2974,"id":{"type":"Identifier","start":2914,"end":2927,"name":"codeChallenge"},"init":{"type":"AwaitExpression","start":2930,"end":2974,"argument":{"type":"CallExpression","start":2936,"end":2974,"optional":false,"callee":{"type":"MemberExpression","start":2936,"end":2960,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2936,"end":2940},"property":{"type":"Identifier","start":2941,"end":2960,"name":"createCodeChallenge"}},"arguments":[{"type":"Identifier","start":2961,"end":2973,"name":"codeVerifier"}]}}}]},{"type":"ReturnStatement","start":2984,"end":3131,"argument":{"type":"ObjectExpression","start":2991,"end":3130,"properties":[{"type":"Property","start":3005,"end":3017,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":3005,"end":3017,"name":"codeVerifier"},"value":{"type":"Identifier","start":3005,"end":3017,"name":"codeVerifier"},"kind":"init"},{"type":"Property","start":3031,"end":3044,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":3031,"end":3044,"name":"codeChallenge"},"value":{"type":"Identifier","start":3031,"end":3044,"name":"codeChallenge"},"kind":"init"},{"type":"Property","start":3058,"end":3120,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3058,"end":3077,"name":"codeChallengeMethod"},"value":{"type":"LogicalExpression","start":3079,"end":3120,"operator":"||","left":{"type":"MemberExpression","start":3079,"end":3110,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3079,"end":3090,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3079,"end":3083},"property":{"type":"Identifier","start":3084,"end":3090,"name":"config"}},"property":{"type":"Identifier","start":3091,"end":3110,"name":"codeChallengeMethod"}},"right":{"type":"Literal","start":3114,"end":3120,"value":"S256","raw":"'S256'"}},"kind":"init"}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":3221,"end":3811,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":3221,"end":3247,"name":"generateSecureCodeVerifier"},"value":{"type":"FunctionExpression","start":3247,"end":3811,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":3250,"end":3811,"body":[{"type":"IfStatement","start":3260,"end":3398,"test":{"type":"UnaryExpression","start":3264,"end":3299,"operator":"!","argument":{"type":"CallExpression","start":3265,"end":3299,"optional":false,"callee":{"type":"Identifier","start":3265,"end":3282,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":3283,"end":3298,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3283,"end":3287},"property":{"type":"Identifier","start":3288,"end":3298,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":3301,"end":3398,"body":[{"type":"ThrowStatement","start":3315,"end":3388,"argument":{"type":"NewExpression","start":3321,"end":3387,"callee":{"type":"Identifier","start":3325,"end":3330,"name":"Error"},"arguments":[{"type":"Literal","start":3331,"end":3386,"value":"Code verifier generation requires browser environment","raw":"'Code verifier generation requires browser environment'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":3468,"end":3500,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3474,"end":3499,"id":{"type":"Identifier","start":3474,"end":3479,"name":"array"},"init":{"type":"NewExpression","start":3482,"end":3499,"callee":{"type":"Identifier","start":3486,"end":3496,"name":"Uint8Array"},"arguments":[{"type":"Literal","start":3497,"end":3498,"raw":"6","value":6}]}}]},{"type":"ExpressionStatement","start":3509,"end":3539,"expression":{"type":"CallExpression","start":3509,"end":3538,"optional":false,"callee":{"type":"MemberExpression","start":3509,"end":3531,"computed":false,"optional":false,"object":{"type":"Identifier","start":3509,"end":3515,"name":"crypto"},"property":{"type":"Identifier","start":3516,"end":3531,"name":"getRandomValues"}},"arguments":[{"type":"Identifier","start":3532,"end":3537,"name":"array"}]}},{"type":"VariableDeclaration","start":3601,"end":3711,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3607,"end":3710,"id":{"type":"Identifier","start":3607,"end":3619,"name":"codeVerifier"},"init":{"type":"CallExpression","start":3622,"end":3710,"optional":false,"callee":{"type":"MemberExpression","start":3622,"end":3706,"computed":false,"optional":false,"object":{"type":"CallExpression","start":3622,"end":3688,"optional":false,"callee":{"type":"MemberExpression","start":3622,"end":3656,"computed":false,"optional":false,"object":{"type":"CallExpression","start":3622,"end":3639,"optional":false,"callee":{"type":"MemberExpression","start":3622,"end":3632,"computed":false,"optional":false,"object":{"type":"Identifier","start":3622,"end":3627,"name":"Array"},"property":{"type":"Identifier","start":3628,"end":3632,"name":"from"}},"arguments":[{"type":"Identifier","start":3633,"end":3638,"name":"array"}]},"property":{"type":"Identifier","start":3653,"end":3656,"name":"map"}},"arguments":[{"type":"ArrowFunctionExpression","start":3657,"end":3687,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":3657,"end":3661,"name":"byte"}],"body":{"type":"CallExpression","start":3665,"end":3687,"optional":false,"callee":{"type":"MemberExpression","start":3665,"end":3685,"computed":false,"optional":false,"object":{"type":"BinaryExpression","start":3666,"end":3675,"operator":"%","left":{"type":"Identifier","start":3666,"end":3670,"name":"byte"},"right":{"type":"Literal","start":3673,"end":3675,"raw":"10","value":10}},"property":{"type":"Identifier","start":3677,"end":3685,"name":"toString"}},"arguments":[]},"id":null}]},"property":{"type":"Identifier","start":3702,"end":3706,"name":"join"}},"arguments":[{"type":"Literal","start":3707,"end":3709,"value":"","raw":"''"}]}}]},{"type":"ExpressionStatement","start":3720,"end":3776,"expression":{"type":"CallExpression","start":3720,"end":3775,"optional":false,"callee":{"type":"MemberExpression","start":3720,"end":3733,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3720,"end":3724},"property":{"type":"Identifier","start":3725,"end":3733,"name":"logDebug"}},"arguments":[{"type":"Literal","start":3734,"end":3774,"value":"Generated secure 6-digit code verifier","raw":"'Generated secure 6-digit code verifier'"}]}},{"type":"ReturnStatement","start":3785,"end":3805,"argument":{"type":"Identifier","start":3792,"end":3804,"name":"codeVerifier"}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":3896,"end":4929,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":3902,"end":3921,"name":"createCodeChallenge"},"value":{"type":"FunctionExpression","start":3921,"end":4929,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":3922,"end":3934,"name":"codeVerifier"}],"body":{"type":"BlockStatement","start":3936,"end":4929,"body":[{"type":"IfStatement","start":3946,"end":4083,"test":{"type":"UnaryExpression","start":3950,"end":3985,"operator":"!","argument":{"type":"CallExpression","start":3951,"end":3985,"optional":false,"callee":{"type":"Identifier","start":3951,"end":3968,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":3969,"end":3984,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3969,"end":3973},"property":{"type":"Identifier","start":3974,"end":3984,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":3987,"end":4083,"body":[{"type":"ThrowStatement","start":4001,"end":4073,"argument":{"type":"NewExpression","start":4007,"end":4072,"callee":{"type":"Identifier","start":4011,"end":4016,"name":"Error"},"arguments":[{"type":"Literal","start":4017,"end":4071,"value":"Code challenge creation requires browser environment","raw":"'Code challenge creation requires browser environment'"}]}}]},"alternate":null},{"type":"TryStatement","start":4092,"end":4923,"block":{"type":"BlockStatement","start":4096,"end":4757,"body":[{"type":"VariableDeclaration","start":4159,"end":4193,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4165,"end":4192,"id":{"type":"Identifier","start":4165,"end":4172,"name":"encoder"},"init":{"type":"NewExpression","start":4175,"end":4192,"callee":{"type":"Identifier","start":4179,"end":4190,"name":"TextEncoder"},"arguments":[]}}]},{"type":"VariableDeclaration","start":4206,"end":4248,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4212,"end":4247,"id":{"type":"Identifier","start":4212,"end":4216,"name":"data"},"init":{"type":"CallExpression","start":4219,"end":4247,"optional":false,"callee":{"type":"MemberExpression","start":4219,"end":4233,"computed":false,"optional":false,"object":{"type":"Identifier","start":4219,"end":4226,"name":"encoder"},"property":{"type":"Identifier","start":4227,"end":4233,"name":"encode"}},"arguments":[{"type":"Identifier","start":4234,"end":4246,"name":"codeVerifier"}]}}]},{"type":"VariableDeclaration","start":4296,"end":4359,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4302,"end":4358,"id":{"type":"Identifier","start":4302,"end":4312,"name":"hashBuffer"},"init":{"type":"AwaitExpression","start":4315,"end":4358,"argument":{"type":"CallExpression","start":4321,"end":4358,"optional":false,"callee":{"type":"MemberExpression","start":4321,"end":4341,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4321,"end":4334,"computed":false,"optional":false,"object":{"type":"Identifier","start":4321,"end":4327,"name":"crypto"},"property":{"type":"Identifier","start":4328,"end":4334,"name":"subtle"}},"property":{"type":"Identifier","start":4335,"end":4341,"name":"digest"}},"arguments":[{"type":"Literal","start":4342,"end":4351,"value":"SHA-256","raw":"'SHA-256'"},{"type":"Identifier","start":4353,"end":4357,"name":"data"}]}}}]},{"type":"VariableDeclaration","start":4417,"end":4462,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4423,"end":4461,"id":{"type":"Identifier","start":4423,"end":4432,"name":"hashArray"},"init":{"type":"NewExpression","start":4435,"end":4461,"callee":{"type":"Identifier","start":4439,"end":4449,"name":"Uint8Array"},"arguments":[{"type":"Identifier","start":4450,"end":4460,"name":"hashBuffer"}]}}]},{"type":"VariableDeclaration","start":4475,"end":4645,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4481,"end":4644,"id":{"type":"Identifier","start":4481,"end":4493,"name":"base64String"},"init":{"type":"CallExpression","start":4496,"end":4644,"optional":false,"callee":{"type":"MemberExpression","start":4496,"end":4634,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4496,"end":4609,"optional":false,"callee":{"type":"MemberExpression","start":4496,"end":4597,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4496,"end":4572,"optional":false,"callee":{"type":"MemberExpression","start":4496,"end":4560,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4496,"end":4535,"optional":false,"callee":{"type":"Identifier","start":4496,"end":4500,"name":"btoa"},"arguments":[{"type":"CallExpression","start":4501,"end":4534,"optional":false,"callee":{"type":"MemberExpression","start":4501,"end":4520,"computed":false,"optional":false,"object":{"type":"Identifier","start":4501,"end":4507,"name":"String"},"property":{"type":"Identifier","start":4508,"end":4520,"name":"fromCharCode"}},"arguments":[{"type":"SpreadElement","start":4521,"end":4533,"argument":{"type":"Identifier","start":4524,"end":4533,"name":"hashArray"}}]}]},"property":{"type":"Identifier","start":4553,"end":4560,"name":"replace"}},"arguments":[{"type":"Literal","start":4561,"end":4566,"raw":"/\\+/g","regex":{"flags":"g","pattern":"\\+"},"value":{}},{"type":"Literal","start":4568,"end":4571,"value":"-","raw":"'-'"}]},"property":{"type":"Identifier","start":4590,"end":4597,"name":"replace"}},"arguments":[{"type":"Literal","start":4598,"end":4603,"raw":"/\\//g","regex":{"flags":"g","pattern":"\\/"},"value":{}},{"type":"Literal","start":4605,"end":4608,"value":"_","raw":"'_'"}]},"property":{"type":"Identifier","start":4627,"end":4634,"name":"replace"}},"arguments":[{"type":"Literal","start":4635,"end":4639,"raw":"/=/g","regex":{"flags":"g","pattern":"="},"value":{}},{"type":"Literal","start":4641,"end":4643,"value":"","raw":"''"}]}}]},{"type":"ExpressionStatement","start":4658,"end":4714,"expression":{"type":"CallExpression","start":4658,"end":4713,"optional":false,"callee":{"type":"MemberExpression","start":4658,"end":4671,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4658,"end":4662},"property":{"type":"Identifier","start":4663,"end":4671,"name":"logDebug"}},"arguments":[{"type":"Literal","start":4672,"end":4712,"value":"Generated code challenge from verifier","raw":"'Generated code challenge from verifier'"}]}},{"type":"ReturnStatement","start":4727,"end":4747,"argument":{"type":"Identifier","start":4734,"end":4746,"name":"base64String"}}]},"handler":{"type":"CatchClause","start":4766,"end":4923,"param":{"type":"Identifier","start":4773,"end":4778,"name":"error"},"body":{"type":"BlockStatement","start":4780,"end":4923,"body":[{"type":"ExpressionStatement","start":4794,"end":4849,"expression":{"type":"CallExpression","start":4794,"end":4848,"optional":false,"callee":{"type":"MemberExpression","start":4794,"end":4807,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4794,"end":4798},"property":{"type":"Identifier","start":4799,"end":4807,"name":"logError"}},"arguments":[{"type":"Literal","start":4808,"end":4840,"value":"Error creating code challenge:","raw":"'Error creating code challenge:'"},{"type":"Identifier","start":4842,"end":4847,"name":"error"}]}},{"type":"ThrowStatement","start":4862,"end":4913,"argument":{"type":"NewExpression","start":4868,"end":4912,"callee":{"type":"Identifier","start":4872,"end":4877,"name":"Error"},"arguments":[{"type":"Literal","start":4878,"end":4911,"value":"Failed to create code challenge","raw":"'Failed to create code challenge'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5027,"end":5378,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5027,"end":5040,"name":"generateState"},"value":{"type":"FunctionExpression","start":5040,"end":5378,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":5043,"end":5378,"body":[{"type":"IfStatement","start":5053,"end":5142,"test":{"type":"UnaryExpression","start":5057,"end":5092,"operator":"!","argument":{"type":"CallExpression","start":5058,"end":5092,"optional":false,"callee":{"type":"Identifier","start":5058,"end":5075,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":5076,"end":5091,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5076,"end":5080},"property":{"type":"Identifier","start":5081,"end":5091,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":5094,"end":5142,"body":[{"type":"ReturnStatement","start":5108,"end":5132,"argument":{"type":"Literal","start":5115,"end":5131,"value":"fallback-state","raw":"'fallback-state'"}}]},"alternate":null},{"type":"VariableDeclaration","start":5151,"end":5184,"kind":"const","declarations":[{"type":"VariableDeclarator","start":5157,"end":5183,"id":{"type":"Identifier","start":5157,"end":5162,"name":"array"},"init":{"type":"NewExpression","start":5165,"end":5183,"callee":{"type":"Identifier","start":5169,"end":5179,"name":"Uint8Array"},"arguments":[{"type":"Literal","start":5180,"end":5182,"raw":"32","value":32}]}}]},{"type":"ExpressionStatement","start":5193,"end":5223,"expression":{"type":"CallExpression","start":5193,"end":5222,"optional":false,"callee":{"type":"MemberExpression","start":5193,"end":5215,"computed":false,"optional":false,"object":{"type":"Identifier","start":5193,"end":5199,"name":"crypto"},"property":{"type":"Identifier","start":5200,"end":5215,"name":"getRandomValues"}},"arguments":[{"type":"Identifier","start":5216,"end":5221,"name":"array"}]}},{"type":"ReturnStatement","start":5232,"end":5372,"argument":{"type":"CallExpression","start":5239,"end":5371,"optional":false,"callee":{"type":"MemberExpression","start":5239,"end":5361,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5239,"end":5340,"optional":false,"callee":{"type":"MemberExpression","start":5239,"end":5328,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5239,"end":5307,"optional":false,"callee":{"type":"MemberExpression","start":5239,"end":5295,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5239,"end":5274,"optional":false,"callee":{"type":"Identifier","start":5239,"end":5243,"name":"btoa"},"arguments":[{"type":"CallExpression","start":5244,"end":5273,"optional":false,"callee":{"type":"MemberExpression","start":5244,"end":5263,"computed":false,"optional":false,"object":{"type":"Identifier","start":5244,"end":5250,"name":"String"},"property":{"type":"Identifier","start":5251,"end":5263,"name":"fromCharCode"}},"arguments":[{"type":"SpreadElement","start":5264,"end":5272,"argument":{"type":"Identifier","start":5267,"end":5272,"name":"array"}}]}]},"property":{"type":"Identifier","start":5288,"end":5295,"name":"replace"}},"arguments":[{"type":"Literal","start":5296,"end":5301,"raw":"/\\+/g","regex":{"flags":"g","pattern":"\\+"},"value":{}},{"type":"Literal","start":5303,"end":5306,"value":"-","raw":"'-'"}]},"property":{"type":"Identifier","start":5321,"end":5328,"name":"replace"}},"arguments":[{"type":"Literal","start":5329,"end":5334,"raw":"/\\//g","regex":{"flags":"g","pattern":"\\/"},"value":{}},{"type":"Literal","start":5336,"end":5339,"value":"_","raw":"'_'"}]},"property":{"type":"Identifier","start":5354,"end":5361,"name":"replace"}},"arguments":[{"type":"Literal","start":5362,"end":5366,"raw":"/=/g","regex":{"flags":"g","pattern":"="},"value":{}},{"type":"Literal","start":5368,"end":5370,"value":"","raw":"''"}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5447,"end":5879,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5447,"end":5460,"name":"generateNonce"},"value":{"type":"FunctionExpression","start":5460,"end":5879,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":5463,"end":5879,"body":[{"type":"IfStatement","start":5473,"end":5545,"test":{"type":"MemberExpression","start":5477,"end":5494,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5477,"end":5488,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5477,"end":5481},"property":{"type":"Identifier","start":5482,"end":5488,"name":"config"}},"property":{"type":"Identifier","start":5489,"end":5494,"name":"nonce"}},"consequent":{"type":"BlockStatement","start":5496,"end":5545,"body":[{"type":"ReturnStatement","start":5510,"end":5535,"argument":{"type":"MemberExpression","start":5517,"end":5534,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5517,"end":5528,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5517,"end":5521},"property":{"type":"Identifier","start":5522,"end":5528,"name":"config"}},"property":{"type":"Identifier","start":5529,"end":5534,"name":"nonce"}}}]},"alternate":null},{"type":"IfStatement","start":5554,"end":5643,"test":{"type":"UnaryExpression","start":5558,"end":5593,"operator":"!","argument":{"type":"CallExpression","start":5559,"end":5593,"optional":false,"callee":{"type":"Identifier","start":5559,"end":5576,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":5577,"end":5592,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":5577,"end":5581},"property":{"type":"Identifier","start":5582,"end":5592,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":5595,"end":5643,"body":[{"type":"ReturnStatement","start":5609,"end":5633,"argument":{"type":"Literal","start":5616,"end":5632,"value":"fallback-nonce","raw":"'fallback-nonce'"}}]},"alternate":null},{"type":"VariableDeclaration","start":5652,"end":5685,"kind":"const","declarations":[{"type":"VariableDeclarator","start":5658,"end":5684,"id":{"type":"Identifier","start":5658,"end":5663,"name":"array"},"init":{"type":"NewExpression","start":5666,"end":5684,"callee":{"type":"Identifier","start":5670,"end":5680,"name":"Uint8Array"},"arguments":[{"type":"Literal","start":5681,"end":5683,"raw":"16","value":16}]}}]},{"type":"ExpressionStatement","start":5694,"end":5724,"expression":{"type":"CallExpression","start":5694,"end":5723,"optional":false,"callee":{"type":"MemberExpression","start":5694,"end":5716,"computed":false,"optional":false,"object":{"type":"Identifier","start":5694,"end":5700,"name":"crypto"},"property":{"type":"Identifier","start":5701,"end":5716,"name":"getRandomValues"}},"arguments":[{"type":"Identifier","start":5717,"end":5722,"name":"array"}]}},{"type":"ReturnStatement","start":5733,"end":5873,"argument":{"type":"CallExpression","start":5740,"end":5872,"optional":false,"callee":{"type":"MemberExpression","start":5740,"end":5862,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5740,"end":5841,"optional":false,"callee":{"type":"MemberExpression","start":5740,"end":5829,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5740,"end":5808,"optional":false,"callee":{"type":"MemberExpression","start":5740,"end":5796,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5740,"end":5775,"optional":false,"callee":{"type":"Identifier","start":5740,"end":5744,"name":"btoa"},"arguments":[{"type":"CallExpression","start":5745,"end":5774,"optional":false,"callee":{"type":"MemberExpression","start":5745,"end":5764,"computed":false,"optional":false,"object":{"type":"Identifier","start":5745,"end":5751,"name":"String"},"property":{"type":"Identifier","start":5752,"end":5764,"name":"fromCharCode"}},"arguments":[{"type":"SpreadElement","start":5765,"end":5773,"argument":{"type":"Identifier","start":5768,"end":5773,"name":"array"}}]}]},"property":{"type":"Identifier","start":5789,"end":5796,"name":"replace"}},"arguments":[{"type":"Literal","start":5797,"end":5802,"raw":"/\\+/g","regex":{"flags":"g","pattern":"\\+"},"value":{}},{"type":"Literal","start":5804,"end":5807,"value":"-","raw":"'-'"}]},"property":{"type":"Identifier","start":5822,"end":5829,"name":"replace"}},"arguments":[{"type":"Literal","start":5830,"end":5835,"raw":"/\\//g","regex":{"flags":"g","pattern":"\\/"},"value":{}},{"type":"Literal","start":5837,"end":5840,"value":"_","raw":"'_'"}]},"property":{"type":"Identifier","start":5855,"end":5862,"name":"replace"}},"arguments":[{"type":"Literal","start":5863,"end":5867,"raw":"/=/g","regex":{"flags":"g","pattern":"="},"value":{}},{"type":"Literal","start":5869,"end":5871,"value":"","raw":"''"}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":5944,"end":8164,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":5950,"end":5968,"name":"startAuthorization"},"value":{"type":"FunctionExpression","start":5968,"end":8164,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":5971,"end":8164,"body":[{"type":"IfStatement","start":5981,"end":6329,"test":{"type":"UnaryExpression","start":5985,"end":6020,"operator":"!","argument":{"type":"CallExpression","start":5986,"end":6020,"optional":false,"callee":{"type":"Identifier","start":5986,"end":6003,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":6004,"end":6019,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6004,"end":6008},"property":{"type":"Identifier","start":6009,"end":6019,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":6022,"end":6329,"body":[{"type":"ExpressionStatement","start":6036,"end":6138,"expression":{"type":"CallExpression","start":6036,"end":6137,"optional":false,"callee":{"type":"MemberExpression","start":6036,"end":6049,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6036,"end":6040},"property":{"type":"Identifier","start":6041,"end":6049,"name":"logError"}},"arguments":[{"type":"Literal","start":6050,"end":6102,"value":"Authorization attempted in non-browser environment","raw":"'Authorization attempted in non-browser environment'"},{"type":"Literal","start":6104,"end":6136,"value":"SSR or server context detected","raw":"'SSR or server context detected'"}]}},{"type":"ExpressionStatement","start":6151,"end":6299,"expression":{"type":"CallExpression","start":6151,"end":6298,"optional":false,"callee":{"type":"MemberExpression","start":6151,"end":6171,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6151,"end":6155},"property":{"type":"Identifier","start":6156,"end":6171,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":6172,"end":6297,"properties":[{"type":"Property","start":6190,"end":6206,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6190,"end":6199,"name":"isLoading"},"value":{"type":"Literal","start":6201,"end":6206,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":6224,"end":6283,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6224,"end":6229,"name":"error"},"value":{"type":"Literal","start":6231,"end":6283,"value":"Authentication not available in server environment","raw":"'Authentication not available in server environment'"},"kind":"init"}]}]}},{"type":"ReturnStatement","start":6312,"end":6319,"argument":null}]},"alternate":null},{"type":"TryStatement","start":6338,"end":8158,"block":{"type":"BlockStatement","start":6342,"end":7887,"body":[{"type":"ExpressionStatement","start":6356,"end":6416,"expression":{"type":"CallExpression","start":6356,"end":6415,"optional":false,"callee":{"type":"MemberExpression","start":6356,"end":6376,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6356,"end":6360},"property":{"type":"Identifier","start":6361,"end":6376,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":6377,"end":6414,"properties":[{"type":"Property","start":6379,"end":6394,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6379,"end":6388,"name":"isLoading"},"value":{"type":"Literal","start":6390,"end":6394,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":6396,"end":6412,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6396,"end":6401,"name":"error"},"value":{"type":"Identifier","start":6403,"end":6412,"name":"undefined"},"kind":"init"}]}]}},{"type":"VariableDeclaration","start":6468,"end":6525,"kind":"const","declarations":[{"type":"VariableDeclarator","start":6474,"end":6524,"id":{"type":"Identifier","start":6474,"end":6487,"name":"pkceChallenge"},"init":{"type":"AwaitExpression","start":6490,"end":6524,"argument":{"type":"CallExpression","start":6496,"end":6524,"optional":false,"callee":{"type":"MemberExpression","start":6496,"end":6522,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6496,"end":6500},"property":{"type":"Identifier","start":6501,"end":6522,"name":"generatePKCEChallenge"}},"arguments":[]}}}]},{"type":"VariableDeclaration","start":6588,"end":6623,"kind":"const","declarations":[{"type":"VariableDeclarator","start":6594,"end":6622,"id":{"type":"Identifier","start":6594,"end":6599,"name":"state"},"init":{"type":"CallExpression","start":6602,"end":6622,"optional":false,"callee":{"type":"MemberExpression","start":6602,"end":6620,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6602,"end":6606},"property":{"type":"Identifier","start":6607,"end":6620,"name":"generateState"}},"arguments":[]}}]},{"type":"VariableDeclaration","start":6666,"end":6701,"kind":"const","declarations":[{"type":"VariableDeclarator","start":6672,"end":6700,"id":{"type":"Identifier","start":6672,"end":6677,"name":"nonce"},"init":{"type":"CallExpression","start":6680,"end":6700,"optional":false,"callee":{"type":"MemberExpression","start":6680,"end":6698,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6680,"end":6684},"property":{"type":"Identifier","start":6685,"end":6698,"name":"generateNonce"}},"arguments":[]}}]},{"type":"ExpressionStatement","start":6776,"end":6867,"expression":{"type":"CallExpression","start":6776,"end":6866,"optional":false,"callee":{"type":"MemberExpression","start":6776,"end":6803,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":6776,"end":6795,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6776,"end":6780},"property":{"type":"Identifier","start":6781,"end":6795,"name":"storageService"}},"property":{"type":"Identifier","start":6796,"end":6803,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":6804,"end":6837,"computed":false,"optional":false,"object":{"type":"Identifier","start":6804,"end":6823,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":6824,"end":6837,"name":"CODE_VERIFIER"}},{"type":"MemberExpression","start":6839,"end":6865,"computed":false,"optional":false,"object":{"type":"Identifier","start":6839,"end":6852,"name":"pkceChallenge"},"property":{"type":"Identifier","start":6853,"end":6865,"name":"codeVerifier"}}]}},{"type":"ExpressionStatement","start":6880,"end":6942,"expression":{"type":"CallExpression","start":6880,"end":6941,"optional":false,"callee":{"type":"MemberExpression","start":6880,"end":6907,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":6880,"end":6899,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6880,"end":6884},"property":{"type":"Identifier","start":6885,"end":6899,"name":"storageService"}},"property":{"type":"Identifier","start":6900,"end":6907,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":6908,"end":6933,"computed":false,"optional":false,"object":{"type":"Identifier","start":6908,"end":6927,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":6928,"end":6933,"name":"STATE"}},{"type":"Identifier","start":6935,"end":6940,"name":"state"}]}},{"type":"ExpressionStatement","start":6955,"end":7017,"expression":{"type":"CallExpression","start":6955,"end":7016,"optional":false,"callee":{"type":"MemberExpression","start":6955,"end":6982,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":6955,"end":6974,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":6955,"end":6959},"property":{"type":"Identifier","start":6960,"end":6974,"name":"storageService"}},"property":{"type":"Identifier","start":6975,"end":6982,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":6983,"end":7008,"computed":false,"optional":false,"object":{"type":"Identifier","start":6983,"end":7002,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":7003,"end":7008,"name":"NONCE"}},{"type":"Identifier","start":7010,"end":7015,"name":"nonce"}]}},{"type":"VariableDeclaration","start":7073,"end":7550,"kind":"const","declarations":[{"type":"VariableDeclarator","start":7079,"end":7549,"id":{"type":"Identifier","start":7079,"end":7090,"name":"authRequest"},"init":{"type":"ObjectExpression","start":7093,"end":7549,"properties":[{"type":"Property","start":7111,"end":7142,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7111,"end":7120,"name":"client_id"},"value":{"type":"MemberExpression","start":7122,"end":7142,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7122,"end":7133,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7122,"end":7126},"property":{"type":"Identifier","start":7127,"end":7133,"name":"config"}},"property":{"type":"Identifier","start":7134,"end":7142,"name":"clientId"}},"kind":"init"},{"type":"Property","start":7160,"end":7197,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7160,"end":7172,"name":"redirect_uri"},"value":{"type":"MemberExpression","start":7174,"end":7197,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7174,"end":7185,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7174,"end":7178},"property":{"type":"Identifier","start":7179,"end":7185,"name":"config"}},"property":{"type":"Identifier","start":7186,"end":7197,"name":"redirectUri"}},"kind":"init"},{"type":"Property","start":7215,"end":7264,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7215,"end":7228,"name":"response_type"},"value":{"type":"LogicalExpression","start":7230,"end":7264,"operator":"||","left":{"type":"MemberExpression","start":7230,"end":7254,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7230,"end":7241,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7230,"end":7234},"property":{"type":"Identifier","start":7235,"end":7241,"name":"config"}},"property":{"type":"Identifier","start":7242,"end":7254,"name":"responseType"}},"right":{"type":"Literal","start":7258,"end":7264,"value":"code","raw":"'code'"}},"kind":"init"},{"type":"Property","start":7282,"end":7287,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7282,"end":7287,"name":"nonce"},"value":{"type":"Identifier","start":7282,"end":7287,"name":"nonce"},"kind":"init"},{"type":"Property","start":7305,"end":7335,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7305,"end":7313,"name":"audience"},"value":{"type":"MemberExpression","start":7315,"end":7335,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7315,"end":7326,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7315,"end":7319},"property":{"type":"Identifier","start":7320,"end":7326,"name":"config"}},"property":{"type":"Identifier","start":7327,"end":7335,"name":"audience"}},"kind":"init"},{"type":"Property","start":7353,"end":7377,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7353,"end":7358,"name":"scope"},"value":{"type":"MemberExpression","start":7360,"end":7377,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7360,"end":7371,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7360,"end":7364},"property":{"type":"Identifier","start":7365,"end":7371,"name":"config"}},"property":{"type":"Identifier","start":7372,"end":7377,"name":"scope"}},"kind":"init"},{"type":"Property","start":7395,"end":7451,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7395,"end":7416,"name":"code_challenge_method"},"value":{"type":"MemberExpression","start":7418,"end":7451,"computed":false,"optional":false,"object":{"type":"Identifier","start":7418,"end":7431,"name":"pkceChallenge"},"property":{"type":"Identifier","start":7432,"end":7451,"name":"codeChallengeMethod"}},"kind":"init"},{"type":"Property","start":7469,"end":7512,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":7469,"end":7483,"name":"code_challenge"},"value":{"type":"MemberExpression","start":7485,"end":7512,"computed":false,"optional":false,"object":{"type":"Identifier","start":7485,"end":7498,"name":"pkceChallenge"},"property":{"type":"Identifier","start":7499,"end":7512,"name":"codeChallenge"}},"kind":"init"},{"type":"Property","start":7530,"end":7535,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":7530,"end":7535,"name":"state"},"value":{"type":"Identifier","start":7530,"end":7535,"name":"state"},"kind":"init"}]}}]},{"type":"VariableDeclaration","start":7602,"end":7658,"kind":"const","declarations":[{"type":"VariableDeclarator","start":7608,"end":7657,"id":{"type":"Identifier","start":7608,"end":7615,"name":"authUrl"},"init":{"type":"CallExpression","start":7618,"end":7657,"optional":false,"callee":{"type":"MemberExpression","start":7618,"end":7644,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7618,"end":7622},"property":{"type":"Identifier","start":7623,"end":7644,"name":"buildAuthorizationUrl"}},"arguments":[{"type":"Identifier","start":7645,"end":7656,"name":"authRequest"}]}}]},{"type":"ExpressionStatement","start":7671,"end":7727,"expression":{"type":"CallExpression","start":7671,"end":7726,"optional":false,"callee":{"type":"MemberExpression","start":7671,"end":7683,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7671,"end":7675},"property":{"type":"Identifier","start":7676,"end":7683,"name":"logInfo"}},"arguments":[{"type":"Literal","start":7684,"end":7725,"value":"Starting OAuth2 PKCE authorization flow","raw":"'Starting OAuth2 PKCE authorization flow'"}]}},{"type":"ExpressionStatement","start":7740,"end":7785,"expression":{"type":"CallExpression","start":7740,"end":7784,"optional":false,"callee":{"type":"MemberExpression","start":7740,"end":7753,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7740,"end":7744},"property":{"type":"Identifier","start":7745,"end":7753,"name":"logDebug"}},"arguments":[{"type":"Literal","start":7754,"end":7774,"value":"Authorization URL:","raw":"'Authorization URL:'"},{"type":"Identifier","start":7776,"end":7783,"name":"authUrl"}]}},{"type":"ExpressionStatement","start":7846,"end":7877,"expression":{"type":"AssignmentExpression","start":7846,"end":7876,"operator":"=","left":{"type":"MemberExpression","start":7846,"end":7866,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":7846,"end":7861,"computed":false,"optional":false,"object":{"type":"Identifier","start":7846,"end":7852,"name":"window"},"property":{"type":"Identifier","start":7853,"end":7861,"name":"location"}},"property":{"type":"Identifier","start":7862,"end":7866,"name":"href"}},"right":{"type":"Identifier","start":7869,"end":7876,"name":"authUrl"}}}]},"handler":{"type":"CatchClause","start":7896,"end":8158,"param":{"type":"Identifier","start":7903,"end":7908,"name":"error"},"body":{"type":"BlockStatement","start":7910,"end":8158,"body":[{"type":"ExpressionStatement","start":7924,"end":7978,"expression":{"type":"CallExpression","start":7924,"end":7977,"optional":false,"callee":{"type":"MemberExpression","start":7924,"end":7937,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7924,"end":7928},"property":{"type":"Identifier","start":7929,"end":7937,"name":"logError"}},"arguments":[{"type":"Literal","start":7938,"end":7969,"value":"Error starting authorization:","raw":"'Error starting authorization:'"},{"type":"Identifier","start":7971,"end":7976,"name":"error"}]}},{"type":"ExpressionStatement","start":7991,"end":8123,"expression":{"type":"CallExpression","start":7991,"end":8122,"optional":false,"callee":{"type":"MemberExpression","start":7991,"end":8011,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":7991,"end":7995},"property":{"type":"Identifier","start":7996,"end":8011,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":8012,"end":8121,"properties":[{"type":"Property","start":8030,"end":8046,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8030,"end":8039,"name":"isLoading"},"value":{"type":"Literal","start":8041,"end":8046,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":8064,"end":8107,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8064,"end":8069,"name":"error"},"value":{"type":"Literal","start":8071,"end":8107,"value":"Failed to start authorization flow","raw":"'Failed to start authorization flow'"},"kind":"init"}]}]}},{"type":"ThrowStatement","start":8136,"end":8148,"argument":{"type":"Identifier","start":8142,"end":8147,"name":"error"}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":8232,"end":8571,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":8232,"end":8253,"name":"buildAuthorizationUrl"},"value":{"type":"FunctionExpression","start":8253,"end":8571,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":8254,"end":8261,"name":"request"}],"body":{"type":"BlockStatement","start":8263,"end":8571,"body":[{"type":"VariableDeclaration","start":8273,"end":8310,"kind":"const","declarations":[{"type":"VariableDeclarator","start":8279,"end":8309,"id":{"type":"Identifier","start":8279,"end":8285,"name":"params"},"init":{"type":"NewExpression","start":8288,"end":8309,"callee":{"type":"Identifier","start":8292,"end":8307,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":8319,"end":8489,"expression":{"type":"CallExpression","start":8319,"end":8488,"optional":false,"callee":{"type":"MemberExpression","start":8319,"end":8350,"computed":false,"optional":false,"object":{"type":"CallExpression","start":8319,"end":8342,"optional":false,"callee":{"type":"MemberExpression","start":8319,"end":8333,"computed":false,"optional":false,"object":{"type":"Identifier","start":8319,"end":8325,"name":"Object"},"property":{"type":"Identifier","start":8326,"end":8333,"name":"entries"}},"arguments":[{"type":"Identifier","start":8334,"end":8341,"name":"request"}]},"property":{"type":"Identifier","start":8343,"end":8350,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":8351,"end":8487,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":8352,"end":8364,"elements":[{"type":"Identifier","start":8353,"end":8356,"name":"key"},{"type":"Identifier","start":8358,"end":8363,"name":"value"}]}],"body":{"type":"BlockStatement","start":8369,"end":8487,"body":[{"type":"IfStatement","start":8383,"end":8477,"test":{"type":"BinaryExpression","start":8387,"end":8406,"operator":"!==","left":{"type":"Identifier","start":8387,"end":8392,"name":"value"},"right":{"type":"Identifier","start":8397,"end":8406,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":8408,"end":8477,"body":[{"type":"ExpressionStatement","start":8426,"end":8463,"expression":{"type":"CallExpression","start":8426,"end":8462,"optional":false,"callee":{"type":"MemberExpression","start":8426,"end":8439,"computed":false,"optional":false,"object":{"type":"Identifier","start":8426,"end":8432,"name":"params"},"property":{"type":"Identifier","start":8433,"end":8439,"name":"append"}},"arguments":[{"type":"Identifier","start":8440,"end":8443,"name":"key"},{"type":"CallExpression","start":8445,"end":8461,"optional":false,"callee":{"type":"MemberExpression","start":8445,"end":8459,"computed":false,"optional":false,"object":{"type":"Identifier","start":8445,"end":8450,"name":"value"},"property":{"type":"Identifier","start":8451,"end":8459,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"ReturnStatement","start":8498,"end":8565,"argument":{"type":"TemplateLiteral","start":8505,"end":8564,"quasis":[{"type":"TemplateElement","start":8506,"end":8506,"tail":false,"value":{"cooked":"","raw":""}},{"type":"TemplateElement","start":8542,"end":8543,"tail":false,"value":{"cooked":"?","raw":"?"}},{"type":"TemplateElement","start":8563,"end":8563,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"MemberExpression","start":8508,"end":8541,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":8508,"end":8519,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":8508,"end":8512},"property":{"type":"Identifier","start":8513,"end":8519,"name":"config"}},"property":{"type":"Identifier","start":8520,"end":8541,"name":"authorizationEndpoint"}},{"type":"CallExpression","start":8545,"end":8562,"optional":false,"callee":{"type":"MemberExpression","start":8545,"end":8560,"computed":false,"optional":false,"object":{"type":"Identifier","start":8545,"end":8551,"name":"params"},"property":{"type":"Identifier","start":8552,"end":8560,"name":"toString"}},"arguments":[]}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":8641,"end":10407,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":8647,"end":8661,"name":"handleCallback"},"value":{"type":"FunctionExpression","start":8661,"end":10407,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":8664,"end":10407,"body":[{"type":"IfStatement","start":8674,"end":8805,"test":{"type":"UnaryExpression","start":8678,"end":8713,"operator":"!","argument":{"type":"CallExpression","start":8679,"end":8713,"optional":false,"callee":{"type":"Identifier","start":8679,"end":8696,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":8697,"end":8712,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":8697,"end":8701},"property":{"type":"Identifier","start":8702,"end":8712,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":8715,"end":8805,"body":[{"type":"ThrowStatement","start":8729,"end":8795,"argument":{"type":"NewExpression","start":8735,"end":8794,"callee":{"type":"Identifier","start":8739,"end":8744,"name":"Error"},"arguments":[{"type":"Literal","start":8745,"end":8793,"value":"Callback handling requires browser environment","raw":"'Callback handling requires browser environment'"}]}}]},"alternate":null},{"type":"TryStatement","start":8814,"end":10401,"block":{"type":"BlockStatement","start":8818,"end":10060,"body":[{"type":"ExpressionStatement","start":8832,"end":8892,"expression":{"type":"CallExpression","start":8832,"end":8891,"optional":false,"callee":{"type":"MemberExpression","start":8832,"end":8852,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":8832,"end":8836},"property":{"type":"Identifier","start":8837,"end":8852,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":8853,"end":8890,"properties":[{"type":"Property","start":8855,"end":8870,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8855,"end":8864,"name":"isLoading"},"value":{"type":"Literal","start":8866,"end":8870,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":8872,"end":8888,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8872,"end":8877,"name":"error"},"value":{"type":"Identifier","start":8879,"end":8888,"name":"undefined"},"kind":"init"}]}]}},{"type":"VariableDeclaration","start":8905,"end":8945,"kind":"const","declarations":[{"type":"VariableDeclarator","start":8911,"end":8944,"id":{"type":"Identifier","start":8911,"end":8921,"name":"currentUrl"},"init":{"type":"MemberExpression","start":8924,"end":8944,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":8924,"end":8939,"computed":false,"optional":false,"object":{"type":"Identifier","start":8924,"end":8930,"name":"window"},"property":{"type":"Identifier","start":8931,"end":8939,"name":"location"}},"property":{"type":"Identifier","start":8940,"end":8944,"name":"href"}}}]},{"type":"ExpressionStatement","start":8958,"end":9012,"expression":{"type":"CallExpression","start":8958,"end":9011,"optional":false,"callee":{"type":"MemberExpression","start":8958,"end":8970,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":8958,"end":8962},"property":{"type":"Identifier","start":8963,"end":8970,"name":"logInfo"}},"arguments":[{"type":"Literal","start":8971,"end":8998,"value":"Handling OAuth2 callback:","raw":"'Handling OAuth2 callback:'"},{"type":"Identifier","start":9000,"end":9010,"name":"currentUrl"}]}},{"type":"VariableDeclaration","start":9068,"end":9114,"kind":"const","declarations":[{"type":"VariableDeclarator","start":9074,"end":9113,"id":{"type":"Identifier","start":9074,"end":9079,"name":"error"},"init":{"type":"CallExpression","start":9082,"end":9113,"optional":false,"callee":{"type":"MemberExpression","start":9082,"end":9111,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9082,"end":9086},"property":{"type":"Identifier","start":9087,"end":9111,"name":"extractErrorFromCallback"}},"arguments":[]}}]},{"type":"IfStatement","start":9127,"end":9266,"test":{"type":"Identifier","start":9131,"end":9136,"name":"error"},"consequent":{"type":"BlockStatement","start":9138,"end":9266,"body":[{"type":"ThrowStatement","start":9156,"end":9252,"argument":{"type":"NewExpression","start":9162,"end":9251,"callee":{"type":"Identifier","start":9166,"end":9171,"name":"Error"},"arguments":[{"type":"TemplateLiteral","start":9172,"end":9250,"quasis":[{"type":"TemplateElement","start":9173,"end":9187,"tail":false,"value":{"cooked":"OAuth2 Error: ","raw":"OAuth2 Error: "}},{"type":"TemplateElement","start":9201,"end":9204,"tail":false,"value":{"cooked":" - ","raw":" - "}},{"type":"TemplateElement","start":9249,"end":9249,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"MemberExpression","start":9189,"end":9200,"computed":false,"optional":false,"object":{"type":"Identifier","start":9189,"end":9194,"name":"error"},"property":{"type":"Identifier","start":9195,"end":9200,"name":"error"}},{"type":"LogicalExpression","start":9206,"end":9248,"operator":"||","left":{"type":"MemberExpression","start":9206,"end":9229,"computed":false,"optional":false,"object":{"type":"Identifier","start":9206,"end":9211,"name":"error"},"property":{"type":"Identifier","start":9212,"end":9229,"name":"error_description"}},"right":{"type":"Literal","start":9233,"end":9248,"value":"Unknown error","raw":"'Unknown error'"}}]}]}}]},"alternate":null},{"type":"VariableDeclaration","start":9360,"end":9409,"kind":"const","declarations":[{"type":"VariableDeclarator","start":9366,"end":9408,"id":{"type":"Identifier","start":9366,"end":9374,"name":"authCode"},"init":{"type":"CallExpression","start":9377,"end":9408,"optional":false,"callee":{"type":"MemberExpression","start":9377,"end":9406,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9377,"end":9381},"property":{"type":"Identifier","start":9382,"end":9406,"name":"extractAuthorizationCode"}},"arguments":[]}}]},{"type":"ExpressionStatement","start":9422,"end":9503,"expression":{"type":"CallExpression","start":9422,"end":9502,"optional":false,"callee":{"type":"MemberExpression","start":9422,"end":9435,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9422,"end":9426},"property":{"type":"Identifier","start":9427,"end":9435,"name":"logDebug"}},"arguments":[{"type":"Literal","start":9436,"end":9467,"value":"Extracted authorization code:","raw":"'Extracted authorization code:'"},{"type":"ConditionalExpression","start":9469,"end":9501,"test":{"type":"Identifier","start":9469,"end":9477,"name":"authCode"},"consequent":{"type":"Literal","start":9480,"end":9487,"value":"Found","raw":"'Found'"},"alternate":{"type":"Literal","start":9490,"end":9501,"value":"Not found","raw":"'Not found'"}}]}},{"type":"IfStatement","start":9516,"end":9629,"test":{"type":"Identifier","start":9520,"end":9528,"name":"authCode"},"consequent":{"type":"BlockStatement","start":9530,"end":9629,"body":[{"type":"ExpressionStatement","start":9548,"end":9591,"expression":{"type":"AwaitExpression","start":9548,"end":9590,"argument":{"type":"CallExpression","start":9554,"end":9590,"optional":false,"callee":{"type":"MemberExpression","start":9554,"end":9580,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9554,"end":9558},"property":{"type":"Identifier","start":9559,"end":9580,"name":"exchangeCodeForTokens"}},"arguments":[{"type":"Identifier","start":9581,"end":9589,"name":"authCode"}]}}},{"type":"ReturnStatement","start":9608,"end":9615,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":9706,"end":9754,"kind":"const","declarations":[{"type":"VariableDeclarator","start":9712,"end":9753,"id":{"type":"Identifier","start":9712,"end":9718,"name":"tokens"},"init":{"type":"CallExpression","start":9721,"end":9753,"optional":false,"callee":{"type":"MemberExpression","start":9721,"end":9751,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9721,"end":9725},"property":{"type":"Identifier","start":9726,"end":9751,"name":"extractTokensFromFragment"}},"arguments":[]}}]},{"type":"ExpressionStatement","start":9767,"end":9848,"expression":{"type":"CallExpression","start":9767,"end":9847,"optional":false,"callee":{"type":"MemberExpression","start":9767,"end":9780,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9767,"end":9771},"property":{"type":"Identifier","start":9772,"end":9780,"name":"logDebug"}},"arguments":[{"type":"Literal","start":9781,"end":9814,"value":"Extracted tokens from fragment:","raw":"'Extracted tokens from fragment:'"},{"type":"ConditionalExpression","start":9816,"end":9846,"test":{"type":"Identifier","start":9816,"end":9822,"name":"tokens"},"consequent":{"type":"Literal","start":9825,"end":9832,"value":"Found","raw":"'Found'"},"alternate":{"type":"Literal","start":9835,"end":9846,"value":"Not found","raw":"'Not found'"}}]}},{"type":"IfStatement","start":9861,"end":9968,"test":{"type":"Identifier","start":9865,"end":9871,"name":"tokens"},"consequent":{"type":"BlockStatement","start":9873,"end":9968,"body":[{"type":"ExpressionStatement","start":9891,"end":9930,"expression":{"type":"AwaitExpression","start":9891,"end":9929,"argument":{"type":"CallExpression","start":9897,"end":9929,"optional":false,"callee":{"type":"MemberExpression","start":9897,"end":9921,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":9897,"end":9901},"property":{"type":"Identifier","start":9902,"end":9921,"name":"handleTokenResponse"}},"arguments":[{"type":"Identifier","start":9922,"end":9928,"name":"tokens"}]}}},{"type":"ReturnStatement","start":9947,"end":9954,"argument":null}]},"alternate":null},{"type":"ThrowStatement","start":9981,"end":10050,"argument":{"type":"NewExpression","start":9987,"end":10049,"callee":{"type":"Identifier","start":9991,"end":9996,"name":"Error"},"arguments":[{"type":"Literal","start":9997,"end":10048,"value":"No authorization code or tokens found in callback","raw":"'No authorization code or tokens found in callback'"}]}}]},"handler":{"type":"CatchClause","start":10069,"end":10401,"param":{"type":"Identifier","start":10076,"end":10081,"name":"error"},"body":{"type":"BlockStatement","start":10083,"end":10401,"body":[{"type":"ExpressionStatement","start":10097,"end":10146,"expression":{"type":"CallExpression","start":10097,"end":10145,"optional":false,"callee":{"type":"MemberExpression","start":10097,"end":10110,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":10097,"end":10101},"property":{"type":"Identifier","start":10102,"end":10110,"name":"logError"}},"arguments":[{"type":"Literal","start":10111,"end":10137,"value":"Error handling callback:","raw":"'Error handling callback:'"},{"type":"Identifier","start":10139,"end":10144,"name":"error"}]}},{"type":"ExpressionStatement","start":10159,"end":10322,"expression":{"type":"CallExpression","start":10159,"end":10321,"optional":false,"callee":{"type":"MemberExpression","start":10159,"end":10179,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":10159,"end":10163},"property":{"type":"Identifier","start":10164,"end":10179,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":10180,"end":10320,"properties":[{"type":"Property","start":10198,"end":10214,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10198,"end":10207,"name":"isLoading"},"value":{"type":"Literal","start":10209,"end":10214,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":10232,"end":10306,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10232,"end":10237,"name":"error"},"value":{"type":"ConditionalExpression","start":10239,"end":10306,"test":{"type":"BinaryExpression","start":10239,"end":10261,"operator":"instanceof","left":{"type":"Identifier","start":10239,"end":10244,"name":"error"},"right":{"type":"Identifier","start":10256,"end":10261,"name":"Error"}},"consequent":{"type":"MemberExpression","start":10264,"end":10277,"computed":false,"optional":false,"object":{"type":"Identifier","start":10264,"end":10269,"name":"error"},"property":{"type":"Identifier","start":10270,"end":10277,"name":"message"}},"alternate":{"type":"Literal","start":10280,"end":10306,"value":"Callback handling failed","raw":"'Callback handling failed'"}},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":10335,"end":10366,"expression":{"type":"CallExpression","start":10335,"end":10365,"optional":false,"callee":{"type":"MemberExpression","start":10335,"end":10363,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":10335,"end":10354,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":10335,"end":10339},"property":{"type":"Identifier","start":10340,"end":10354,"name":"storageService"}},"property":{"type":"Identifier","start":10355,"end":10363,"name":"clearAll"}},"arguments":[]}},{"type":"ThrowStatement","start":10379,"end":10391,"argument":{"type":"Identifier","start":10385,"end":10390,"name":"error"}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":10467,"end":11147,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":10467,"end":10491,"name":"extractErrorFromCallback"},"value":{"type":"FunctionExpression","start":10491,"end":11147,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":10494,"end":11147,"body":[{"type":"VariableDeclaration","start":10504,"end":10566,"kind":"const","declarations":[{"type":"VariableDeclarator","start":10510,"end":10565,"id":{"type":"Identifier","start":10510,"end":10519,"name":"urlParams"},"init":{"type":"NewExpression","start":10522,"end":10565,"callee":{"type":"Identifier","start":10526,"end":10541,"name":"URLSearchParams"},"arguments":[{"type":"MemberExpression","start":10542,"end":10564,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":10542,"end":10557,"computed":false,"optional":false,"object":{"type":"Identifier","start":10542,"end":10548,"name":"window"},"property":{"type":"Identifier","start":10549,"end":10557,"name":"location"}},"property":{"type":"Identifier","start":10558,"end":10564,"name":"search"}}]}}]},{"type":"VariableDeclaration","start":10575,"end":10649,"kind":"const","declarations":[{"type":"VariableDeclarator","start":10581,"end":10648,"id":{"type":"Identifier","start":10581,"end":10591,"name":"hashParams"},"init":{"type":"NewExpression","start":10594,"end":10648,"callee":{"type":"Identifier","start":10598,"end":10613,"name":"URLSearchParams"},"arguments":[{"type":"CallExpression","start":10614,"end":10647,"optional":false,"callee":{"type":"MemberExpression","start":10614,"end":10644,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":10614,"end":10634,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":10614,"end":10629,"computed":false,"optional":false,"object":{"type":"Identifier","start":10614,"end":10620,"name":"window"},"property":{"type":"Identifier","start":10621,"end":10629,"name":"location"}},"property":{"type":"Identifier","start":10630,"end":10634,"name":"hash"}},"property":{"type":"Identifier","start":10635,"end":10644,"name":"substring"}},"arguments":[{"type":"Literal","start":10645,"end":10646,"raw":"1","value":1}]}]}}]},{"type":"VariableDeclaration","start":10658,"end":10722,"kind":"const","declarations":[{"type":"VariableDeclarator","start":10664,"end":10721,"id":{"type":"Identifier","start":10664,"end":10669,"name":"error"},"init":{"type":"LogicalExpression","start":10672,"end":10721,"operator":"||","left":{"type":"CallExpression","start":10672,"end":10694,"optional":false,"callee":{"type":"MemberExpression","start":10672,"end":10685,"computed":false,"optional":false,"object":{"type":"Identifier","start":10672,"end":10681,"name":"urlParams"},"property":{"type":"Identifier","start":10682,"end":10685,"name":"get"}},"arguments":[{"type":"Literal","start":10686,"end":10693,"value":"error","raw":"'error'"}]},"right":{"type":"CallExpression","start":10698,"end":10721,"optional":false,"callee":{"type":"MemberExpression","start":10698,"end":10712,"computed":false,"optional":false,"object":{"type":"Identifier","start":10698,"end":10708,"name":"hashParams"},"property":{"type":"Identifier","start":10709,"end":10712,"name":"get"}},"arguments":[{"type":"Literal","start":10713,"end":10720,"value":"error","raw":"'error'"}]}}}]},{"type":"IfStatement","start":10731,"end":11120,"test":{"type":"Identifier","start":10735,"end":10740,"name":"error"},"consequent":{"type":"BlockStatement","start":10742,"end":11120,"body":[{"type":"ReturnStatement","start":10756,"end":11110,"argument":{"type":"ObjectExpression","start":10763,"end":11109,"properties":[{"type":"Property","start":10781,"end":10786,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":10781,"end":10786,"name":"error"},"value":{"type":"Identifier","start":10781,"end":10786,"name":"error"},"kind":"init"},{"type":"Property","start":10804,"end":10909,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10804,"end":10821,"name":"error_description"},"value":{"type":"LogicalExpression","start":10823,"end":10909,"operator":"||","left":{"type":"LogicalExpression","start":10823,"end":10896,"operator":"||","left":{"type":"CallExpression","start":10823,"end":10857,"optional":false,"callee":{"type":"MemberExpression","start":10823,"end":10836,"computed":false,"optional":false,"object":{"type":"Identifier","start":10823,"end":10832,"name":"urlParams"},"property":{"type":"Identifier","start":10833,"end":10836,"name":"get"}},"arguments":[{"type":"Literal","start":10837,"end":10856,"value":"error_description","raw":"'error_description'"}]},"right":{"type":"CallExpression","start":10861,"end":10896,"optional":false,"callee":{"type":"MemberExpression","start":10861,"end":10875,"computed":false,"optional":false,"object":{"type":"Identifier","start":10861,"end":10871,"name":"hashParams"},"property":{"type":"Identifier","start":10872,"end":10875,"name":"get"}},"arguments":[{"type":"Literal","start":10876,"end":10895,"value":"error_description","raw":"'error_description'"}]}},"right":{"type":"Identifier","start":10900,"end":10909,"name":"undefined"}},"kind":"init"},{"type":"Property","start":10927,"end":11008,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":10927,"end":10936,"name":"error_uri"},"value":{"type":"LogicalExpression","start":10938,"end":11008,"operator":"||","left":{"type":"LogicalExpression","start":10938,"end":10995,"operator":"||","left":{"type":"CallExpression","start":10938,"end":10964,"optional":false,"callee":{"type":"MemberExpression","start":10938,"end":10951,"computed":false,"optional":false,"object":{"type":"Identifier","start":10938,"end":10947,"name":"urlParams"},"property":{"type":"Identifier","start":10948,"end":10951,"name":"get"}},"arguments":[{"type":"Literal","start":10952,"end":10963,"value":"error_uri","raw":"'error_uri'"}]},"right":{"type":"CallExpression","start":10968,"end":10995,"optional":false,"callee":{"type":"MemberExpression","start":10968,"end":10982,"computed":false,"optional":false,"object":{"type":"Identifier","start":10968,"end":10978,"name":"hashParams"},"property":{"type":"Identifier","start":10979,"end":10982,"name":"get"}},"arguments":[{"type":"Literal","start":10983,"end":10994,"value":"error_uri","raw":"'error_uri'"}]}},"right":{"type":"Identifier","start":10999,"end":11008,"name":"undefined"}},"kind":"init"},{"type":"Property","start":11026,"end":11095,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11026,"end":11031,"name":"state"},"value":{"type":"LogicalExpression","start":11033,"end":11095,"operator":"||","left":{"type":"LogicalExpression","start":11033,"end":11082,"operator":"||","left":{"type":"CallExpression","start":11033,"end":11055,"optional":false,"callee":{"type":"MemberExpression","start":11033,"end":11046,"computed":false,"optional":false,"object":{"type":"Identifier","start":11033,"end":11042,"name":"urlParams"},"property":{"type":"Identifier","start":11043,"end":11046,"name":"get"}},"arguments":[{"type":"Literal","start":11047,"end":11054,"value":"state","raw":"'state'"}]},"right":{"type":"CallExpression","start":11059,"end":11082,"optional":false,"callee":{"type":"MemberExpression","start":11059,"end":11073,"computed":false,"optional":false,"object":{"type":"Identifier","start":11059,"end":11069,"name":"hashParams"},"property":{"type":"Identifier","start":11070,"end":11073,"name":"get"}},"arguments":[{"type":"Literal","start":11074,"end":11081,"value":"state","raw":"'state'"}]}},"right":{"type":"Identifier","start":11086,"end":11095,"name":"undefined"}},"kind":"init"}]}}]},"alternate":null},{"type":"ReturnStatement","start":11129,"end":11141,"argument":{"type":"Literal","start":11136,"end":11140,"raw":"null","value":null}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":11224,"end":11806,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":11224,"end":11248,"name":"extractAuthorizationCode"},"value":{"type":"FunctionExpression","start":11248,"end":11806,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":11251,"end":11806,"body":[{"type":"VariableDeclaration","start":11301,"end":11363,"kind":"const","declarations":[{"type":"VariableDeclarator","start":11307,"end":11362,"id":{"type":"Identifier","start":11307,"end":11316,"name":"urlParams"},"init":{"type":"NewExpression","start":11319,"end":11362,"callee":{"type":"Identifier","start":11323,"end":11338,"name":"URLSearchParams"},"arguments":[{"type":"MemberExpression","start":11339,"end":11361,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11339,"end":11354,"computed":false,"optional":false,"object":{"type":"Identifier","start":11339,"end":11345,"name":"window"},"property":{"type":"Identifier","start":11346,"end":11354,"name":"location"}},"property":{"type":"Identifier","start":11355,"end":11361,"name":"search"}}]}}]},{"type":"VariableDeclaration","start":11372,"end":11405,"kind":"let","declarations":[{"type":"VariableDeclarator","start":11376,"end":11404,"id":{"type":"Identifier","start":11376,"end":11380,"name":"code"},"init":{"type":"CallExpression","start":11383,"end":11404,"optional":false,"callee":{"type":"MemberExpression","start":11383,"end":11396,"computed":false,"optional":false,"object":{"type":"Identifier","start":11383,"end":11392,"name":"urlParams"},"property":{"type":"Identifier","start":11393,"end":11396,"name":"get"}},"arguments":[{"type":"Literal","start":11397,"end":11403,"value":"code","raw":"'code'"}]}}]},{"type":"IfStatement","start":11475,"end":11651,"test":{"type":"LogicalExpression","start":11479,"end":11508,"operator":"&&","left":{"type":"UnaryExpression","start":11479,"end":11484,"operator":"!","argument":{"type":"Identifier","start":11480,"end":11484,"name":"code"},"prefix":true},"right":{"type":"MemberExpression","start":11488,"end":11508,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11488,"end":11503,"computed":false,"optional":false,"object":{"type":"Identifier","start":11488,"end":11494,"name":"window"},"property":{"type":"Identifier","start":11495,"end":11503,"name":"location"}},"property":{"type":"Identifier","start":11504,"end":11508,"name":"hash"}}},"consequent":{"type":"BlockStatement","start":11510,"end":11651,"body":[{"type":"VariableDeclaration","start":11524,"end":11598,"kind":"const","declarations":[{"type":"VariableDeclarator","start":11530,"end":11597,"id":{"type":"Identifier","start":11530,"end":11540,"name":"hashParams"},"init":{"type":"NewExpression","start":11543,"end":11597,"callee":{"type":"Identifier","start":11547,"end":11562,"name":"URLSearchParams"},"arguments":[{"type":"CallExpression","start":11563,"end":11596,"optional":false,"callee":{"type":"MemberExpression","start":11563,"end":11593,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11563,"end":11583,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11563,"end":11578,"computed":false,"optional":false,"object":{"type":"Identifier","start":11563,"end":11569,"name":"window"},"property":{"type":"Identifier","start":11570,"end":11578,"name":"location"}},"property":{"type":"Identifier","start":11579,"end":11583,"name":"hash"}},"property":{"type":"Identifier","start":11584,"end":11593,"name":"substring"}},"arguments":[{"type":"Literal","start":11594,"end":11595,"raw":"1","value":1}]}]}}]},{"type":"ExpressionStatement","start":11611,"end":11641,"expression":{"type":"AssignmentExpression","start":11611,"end":11640,"operator":"=","left":{"type":"Identifier","start":11611,"end":11615,"name":"code"},"right":{"type":"CallExpression","start":11618,"end":11640,"optional":false,"callee":{"type":"MemberExpression","start":11618,"end":11632,"computed":false,"optional":false,"object":{"type":"Identifier","start":11618,"end":11628,"name":"hashParams"},"property":{"type":"Identifier","start":11629,"end":11632,"name":"get"}},"arguments":[{"type":"Literal","start":11633,"end":11639,"value":"code","raw":"'code'"}]}}}]},"alternate":null},{"type":"IfStatement","start":11660,"end":11779,"test":{"type":"Identifier","start":11664,"end":11668,"name":"code"},"consequent":{"type":"BlockStatement","start":11670,"end":11779,"body":[{"type":"ExpressionStatement","start":11684,"end":11744,"expression":{"type":"CallExpression","start":11684,"end":11743,"optional":false,"callee":{"type":"MemberExpression","start":11684,"end":11697,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":11684,"end":11688},"property":{"type":"Identifier","start":11689,"end":11697,"name":"logDebug"}},"arguments":[{"type":"Literal","start":11698,"end":11742,"value":"Authorization code extracted from callback","raw":"'Authorization code extracted from callback'"}]}},{"type":"ReturnStatement","start":11757,"end":11769,"argument":{"type":"Identifier","start":11764,"end":11768,"name":"code"}}]},"alternate":null},{"type":"ReturnStatement","start":11788,"end":11800,"argument":{"type":"Literal","start":11795,"end":11799,"raw":"null","value":null}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":11867,"end":12670,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":11867,"end":11892,"name":"extractTokensFromFragment"},"value":{"type":"FunctionExpression","start":11892,"end":12670,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":11895,"end":12670,"body":[{"type":"VariableDeclaration","start":11905,"end":11956,"kind":"const","declarations":[{"type":"VariableDeclarator","start":11911,"end":11955,"id":{"type":"Identifier","start":11911,"end":11919,"name":"fragment"},"init":{"type":"CallExpression","start":11922,"end":11955,"optional":false,"callee":{"type":"MemberExpression","start":11922,"end":11952,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11922,"end":11942,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":11922,"end":11937,"computed":false,"optional":false,"object":{"type":"Identifier","start":11922,"end":11928,"name":"window"},"property":{"type":"Identifier","start":11929,"end":11937,"name":"location"}},"property":{"type":"Identifier","start":11938,"end":11942,"name":"hash"}},"property":{"type":"Identifier","start":11943,"end":11952,"name":"substring"}},"arguments":[{"type":"Literal","start":11953,"end":11954,"raw":"1","value":1}]}}]},{"type":"IfStatement","start":11965,"end":12016,"test":{"type":"UnaryExpression","start":11969,"end":11978,"operator":"!","argument":{"type":"Identifier","start":11970,"end":11978,"name":"fragment"},"prefix":true},"consequent":{"type":"BlockStatement","start":11980,"end":12016,"body":[{"type":"ReturnStatement","start":11994,"end":12006,"argument":{"type":"Literal","start":12001,"end":12005,"raw":"null","value":null}}]},"alternate":null},{"type":"VariableDeclaration","start":12025,"end":12070,"kind":"const","declarations":[{"type":"VariableDeclarator","start":12031,"end":12069,"id":{"type":"Identifier","start":12031,"end":12037,"name":"params"},"init":{"type":"NewExpression","start":12040,"end":12069,"callee":{"type":"Identifier","start":12044,"end":12059,"name":"URLSearchParams"},"arguments":[{"type":"Identifier","start":12060,"end":12068,"name":"fragment"}]}}]},{"type":"VariableDeclaration","start":12079,"end":12126,"kind":"const","declarations":[{"type":"VariableDeclarator","start":12085,"end":12125,"id":{"type":"Identifier","start":12085,"end":12096,"name":"accessToken"},"init":{"type":"CallExpression","start":12099,"end":12125,"optional":false,"callee":{"type":"MemberExpression","start":12099,"end":12109,"computed":false,"optional":false,"object":{"type":"Identifier","start":12099,"end":12105,"name":"params"},"property":{"type":"Identifier","start":12106,"end":12109,"name":"get"}},"arguments":[{"type":"Literal","start":12110,"end":12124,"value":"access_token","raw":"'access_token'"}]}}]},{"type":"IfStatement","start":12135,"end":12643,"test":{"type":"Identifier","start":12139,"end":12150,"name":"accessToken"},"consequent":{"type":"BlockStatement","start":12152,"end":12643,"body":[{"type":"ExpressionStatement","start":12166,"end":12218,"expression":{"type":"CallExpression","start":12166,"end":12217,"optional":false,"callee":{"type":"MemberExpression","start":12166,"end":12179,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":12166,"end":12170},"property":{"type":"Identifier","start":12171,"end":12179,"name":"logDebug"}},"arguments":[{"type":"Literal","start":12180,"end":12216,"value":"Tokens extracted from URL fragment","raw":"'Tokens extracted from URL fragment'"}]}},{"type":"ReturnStatement","start":12231,"end":12633,"argument":{"type":"ObjectExpression","start":12238,"end":12632,"properties":[{"type":"Property","start":12256,"end":12281,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12256,"end":12268,"name":"access_token"},"value":{"type":"Identifier","start":12270,"end":12281,"name":"accessToken"},"kind":"init"},{"type":"Property","start":12299,"end":12354,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12299,"end":12312,"name":"refresh_token"},"value":{"type":"LogicalExpression","start":12314,"end":12354,"operator":"||","left":{"type":"CallExpression","start":12314,"end":12341,"optional":false,"callee":{"type":"MemberExpression","start":12314,"end":12324,"computed":false,"optional":false,"object":{"type":"Identifier","start":12314,"end":12320,"name":"params"},"property":{"type":"Identifier","start":12321,"end":12324,"name":"get"}},"arguments":[{"type":"Literal","start":12325,"end":12340,"value":"refresh_token","raw":"'refresh_token'"}]},"right":{"type":"Identifier","start":12345,"end":12354,"name":"undefined"}},"kind":"init"},{"type":"Property","start":12372,"end":12420,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12372,"end":12382,"name":"token_type"},"value":{"type":"LogicalExpression","start":12384,"end":12420,"operator":"||","left":{"type":"CallExpression","start":12384,"end":12408,"optional":false,"callee":{"type":"MemberExpression","start":12384,"end":12394,"computed":false,"optional":false,"object":{"type":"Identifier","start":12384,"end":12390,"name":"params"},"property":{"type":"Identifier","start":12391,"end":12394,"name":"get"}},"arguments":[{"type":"Literal","start":12395,"end":12407,"value":"token_type","raw":"'token_type'"}]},"right":{"type":"Literal","start":12412,"end":12420,"value":"Bearer","raw":"'Bearer'"}},"kind":"init"},{"type":"Property","start":12438,"end":12498,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12438,"end":12448,"name":"expires_in"},"value":{"type":"CallExpression","start":12450,"end":12498,"optional":false,"callee":{"type":"Identifier","start":12450,"end":12458,"name":"parseInt"},"arguments":[{"type":"LogicalExpression","start":12459,"end":12493,"operator":"||","left":{"type":"CallExpression","start":12459,"end":12483,"optional":false,"callee":{"type":"MemberExpression","start":12459,"end":12469,"computed":false,"optional":false,"object":{"type":"Identifier","start":12459,"end":12465,"name":"params"},"property":{"type":"Identifier","start":12466,"end":12469,"name":"get"}},"arguments":[{"type":"Literal","start":12470,"end":12482,"value":"expires_in","raw":"'expires_in'"}]},"right":{"type":"Literal","start":12487,"end":12493,"value":"3600","raw":"'3600'"}},{"type":"Literal","start":12495,"end":12497,"raw":"10","value":10}]},"kind":"init"},{"type":"Property","start":12516,"end":12555,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12516,"end":12521,"name":"scope"},"value":{"type":"LogicalExpression","start":12523,"end":12555,"operator":"||","left":{"type":"CallExpression","start":12523,"end":12542,"optional":false,"callee":{"type":"MemberExpression","start":12523,"end":12533,"computed":false,"optional":false,"object":{"type":"Identifier","start":12523,"end":12529,"name":"params"},"property":{"type":"Identifier","start":12530,"end":12533,"name":"get"}},"arguments":[{"type":"Literal","start":12534,"end":12541,"value":"scope","raw":"'scope'"}]},"right":{"type":"Identifier","start":12546,"end":12555,"name":"undefined"}},"kind":"init"},{"type":"Property","start":12573,"end":12618,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12573,"end":12581,"name":"id_token"},"value":{"type":"LogicalExpression","start":12583,"end":12618,"operator":"||","left":{"type":"CallExpression","start":12583,"end":12605,"optional":false,"callee":{"type":"MemberExpression","start":12583,"end":12593,"computed":false,"optional":false,"object":{"type":"Identifier","start":12583,"end":12589,"name":"params"},"property":{"type":"Identifier","start":12590,"end":12593,"name":"get"}},"arguments":[{"type":"Literal","start":12594,"end":12604,"value":"id_token","raw":"'id_token'"}]},"right":{"type":"Identifier","start":12609,"end":12618,"name":"undefined"}},"kind":"init"}]}}]},"alternate":null},{"type":"ReturnStatement","start":12652,"end":12664,"argument":{"type":"Literal","start":12659,"end":12663,"raw":"null","value":null}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":12737,"end":14323,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":12743,"end":12764,"name":"exchangeCodeForTokens"},"value":{"type":"FunctionExpression","start":12764,"end":14323,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":12765,"end":12773,"name":"authCode"}],"body":{"type":"BlockStatement","start":12775,"end":14323,"body":[{"type":"VariableDeclaration","start":12785,"end":12869,"kind":"const","declarations":[{"type":"VariableDeclarator","start":12791,"end":12868,"id":{"type":"Identifier","start":12791,"end":12803,"name":"codeVerifier"},"init":{"type":"CallExpression","start":12806,"end":12868,"optional":false,"callee":{"type":"MemberExpression","start":12806,"end":12833,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":12806,"end":12825,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":12806,"end":12810},"property":{"type":"Identifier","start":12811,"end":12825,"name":"storageService"}},"property":{"type":"Identifier","start":12826,"end":12833,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":12834,"end":12867,"computed":false,"optional":false,"object":{"type":"Identifier","start":12834,"end":12853,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":12854,"end":12867,"name":"CODE_VERIFIER"}}]}}]},{"type":"IfStatement","start":12878,"end":13040,"test":{"type":"UnaryExpression","start":12882,"end":12895,"operator":"!","argument":{"type":"Identifier","start":12883,"end":12895,"name":"codeVerifier"},"prefix":true},"consequent":{"type":"BlockStatement","start":12897,"end":13040,"body":[{"type":"ExpressionStatement","start":12911,"end":12963,"expression":{"type":"CallExpression","start":12911,"end":12962,"optional":false,"callee":{"type":"MemberExpression","start":12911,"end":12924,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":12911,"end":12915},"property":{"type":"Identifier","start":12916,"end":12924,"name":"logError"}},"arguments":[{"type":"Literal","start":12925,"end":12961,"value":"Code verifier not found in storage","raw":"'Code verifier not found in storage'"}]}},{"type":"ThrowStatement","start":12976,"end":13030,"argument":{"type":"NewExpression","start":12982,"end":13029,"callee":{"type":"Identifier","start":12986,"end":12991,"name":"Error"},"arguments":[{"type":"Literal","start":12992,"end":13028,"value":"Code verifier not found in storage","raw":"'Code verifier not found in storage'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":13049,"end":13292,"kind":"const","declarations":[{"type":"VariableDeclarator","start":13055,"end":13291,"id":{"type":"Identifier","start":13055,"end":13067,"name":"tokenRequest"},"init":{"type":"ObjectExpression","start":13070,"end":13291,"properties":[{"type":"Property","start":13084,"end":13116,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13084,"end":13094,"name":"grant_type"},"value":{"type":"Literal","start":13096,"end":13116,"value":"authorization_code","raw":"'authorization_code'"},"kind":"init"},{"type":"Property","start":13130,"end":13167,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13130,"end":13142,"name":"redirect_uri"},"value":{"type":"MemberExpression","start":13144,"end":13167,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":13144,"end":13155,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13144,"end":13148},"property":{"type":"Identifier","start":13149,"end":13155,"name":"config"}},"property":{"type":"Identifier","start":13156,"end":13167,"name":"redirectUri"}},"kind":"init"},{"type":"Property","start":13181,"end":13212,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13181,"end":13190,"name":"client_id"},"value":{"type":"MemberExpression","start":13192,"end":13212,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":13192,"end":13203,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13192,"end":13196},"property":{"type":"Identifier","start":13197,"end":13203,"name":"config"}},"property":{"type":"Identifier","start":13204,"end":13212,"name":"clientId"}},"kind":"init"},{"type":"Property","start":13226,"end":13240,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13226,"end":13230,"name":"code"},"value":{"type":"Identifier","start":13232,"end":13240,"name":"authCode"},"kind":"init"},{"type":"Property","start":13254,"end":13281,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13254,"end":13267,"name":"code_verifier"},"value":{"type":"Identifier","start":13269,"end":13281,"name":"codeVerifier"},"kind":"init"}]}}]},{"type":"ExpressionStatement","start":13301,"end":13358,"expression":{"type":"CallExpression","start":13301,"end":13357,"optional":false,"callee":{"type":"MemberExpression","start":13301,"end":13313,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13301,"end":13305},"property":{"type":"Identifier","start":13306,"end":13313,"name":"logInfo"}},"arguments":[{"type":"Literal","start":13314,"end":13356,"value":"Exchanging authorization code for tokens","raw":"'Exchanging authorization code for tokens'"}]}},{"type":"VariableDeclaration","start":13437,"end":13476,"kind":"const","declarations":[{"type":"VariableDeclarator","start":13443,"end":13475,"id":{"type":"Identifier","start":13443,"end":13451,"name":"formData"},"init":{"type":"NewExpression","start":13454,"end":13475,"callee":{"type":"Identifier","start":13458,"end":13473,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":13485,"end":13662,"expression":{"type":"CallExpression","start":13485,"end":13661,"optional":false,"callee":{"type":"MemberExpression","start":13485,"end":13521,"computed":false,"optional":false,"object":{"type":"CallExpression","start":13485,"end":13513,"optional":false,"callee":{"type":"MemberExpression","start":13485,"end":13499,"computed":false,"optional":false,"object":{"type":"Identifier","start":13485,"end":13491,"name":"Object"},"property":{"type":"Identifier","start":13492,"end":13499,"name":"entries"}},"arguments":[{"type":"Identifier","start":13500,"end":13512,"name":"tokenRequest"}]},"property":{"type":"Identifier","start":13514,"end":13521,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":13522,"end":13660,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":13523,"end":13535,"elements":[{"type":"Identifier","start":13524,"end":13527,"name":"key"},{"type":"Identifier","start":13529,"end":13534,"name":"value"}]}],"body":{"type":"BlockStatement","start":13540,"end":13660,"body":[{"type":"IfStatement","start":13554,"end":13650,"test":{"type":"BinaryExpression","start":13558,"end":13577,"operator":"!==","left":{"type":"Identifier","start":13558,"end":13563,"name":"value"},"right":{"type":"Identifier","start":13568,"end":13577,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":13579,"end":13650,"body":[{"type":"ExpressionStatement","start":13597,"end":13636,"expression":{"type":"CallExpression","start":13597,"end":13635,"optional":false,"callee":{"type":"MemberExpression","start":13597,"end":13612,"computed":false,"optional":false,"object":{"type":"Identifier","start":13597,"end":13605,"name":"formData"},"property":{"type":"Identifier","start":13606,"end":13612,"name":"append"}},"arguments":[{"type":"Identifier","start":13613,"end":13616,"name":"key"},{"type":"CallExpression","start":13618,"end":13634,"optional":false,"callee":{"type":"MemberExpression","start":13618,"end":13632,"computed":false,"optional":false,"object":{"type":"Identifier","start":13618,"end":13623,"name":"value"},"property":{"type":"Identifier","start":13624,"end":13632,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"TryStatement","start":13671,"end":14317,"block":{"type":"BlockStatement","start":13675,"end":14142,"body":[{"type":"VariableDeclaration","start":13689,"end":13926,"kind":"const","declarations":[{"type":"VariableDeclarator","start":13695,"end":13925,"id":{"type":"Identifier","start":13695,"end":13708,"name":"tokenResponse"},"init":{"type":"AwaitExpression","start":13711,"end":13925,"argument":{"type":"CallExpression","start":13717,"end":13925,"optional":false,"callee":{"type":"MemberExpression","start":13717,"end":13923,"computed":false,"optional":false,"object":{"type":"CallExpression","start":13717,"end":13913,"optional":false,"callee":{"type":"MemberExpression","start":13717,"end":13731,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":13717,"end":13726,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13717,"end":13721},"property":{"type":"Identifier","start":13722,"end":13726,"name":"http"}},"property":{"type":"Identifier","start":13727,"end":13731,"name":"post"}},"arguments":[{"type":"MemberExpression","start":13732,"end":13757,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":13732,"end":13743,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13732,"end":13736},"property":{"type":"Identifier","start":13737,"end":13743,"name":"config"}},"property":{"type":"Identifier","start":13744,"end":13757,"name":"tokenEndpoint"}},{"type":"CallExpression","start":13759,"end":13778,"optional":false,"callee":{"type":"MemberExpression","start":13759,"end":13776,"computed":false,"optional":false,"object":{"type":"Identifier","start":13759,"end":13767,"name":"formData"},"property":{"type":"Identifier","start":13768,"end":13776,"name":"toString"}},"arguments":[]},{"type":"ObjectExpression","start":13780,"end":13912,"properties":[{"type":"Property","start":13798,"end":13898,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":13798,"end":13805,"name":"headers"},"value":{"type":"ObjectExpression","start":13807,"end":13898,"properties":[{"type":"Property","start":13829,"end":13880,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":13829,"end":13843,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":13845,"end":13880,"value":"application/x-www-form-urlencoded","raw":"'application/x-www-form-urlencoded'"},"kind":"init"}]},"kind":"init"}]}]},"property":{"type":"Identifier","start":13914,"end":13923,"name":"toPromise"}},"arguments":[]}}}]},{"type":"IfStatement","start":13939,"end":14132,"test":{"type":"Identifier","start":13943,"end":13956,"name":"tokenResponse"},"consequent":{"type":"BlockStatement","start":13958,"end":14036,"body":[{"type":"ExpressionStatement","start":13976,"end":14022,"expression":{"type":"AwaitExpression","start":13976,"end":14021,"argument":{"type":"CallExpression","start":13982,"end":14021,"optional":false,"callee":{"type":"MemberExpression","start":13982,"end":14006,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":13982,"end":13986},"property":{"type":"Identifier","start":13987,"end":14006,"name":"handleTokenResponse"}},"arguments":[{"type":"Identifier","start":14007,"end":14020,"name":"tokenResponse"}]}}}]},"alternate":{"type":"BlockStatement","start":14054,"end":14132,"body":[{"type":"ThrowStatement","start":14072,"end":14118,"argument":{"type":"NewExpression","start":14078,"end":14117,"callee":{"type":"Identifier","start":14082,"end":14087,"name":"Error"},"arguments":[{"type":"Literal","start":14088,"end":14116,"value":"No token response received","raw":"'No token response received'"}]}}]}}]},"handler":{"type":"CatchClause","start":14151,"end":14317,"param":{"type":"Identifier","start":14158,"end":14163,"name":"error"},"body":{"type":"BlockStatement","start":14165,"end":14317,"body":[{"type":"ExpressionStatement","start":14179,"end":14226,"expression":{"type":"CallExpression","start":14179,"end":14225,"optional":false,"callee":{"type":"MemberExpression","start":14179,"end":14192,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":14179,"end":14183},"property":{"type":"Identifier","start":14184,"end":14192,"name":"logError"}},"arguments":[{"type":"Literal","start":14193,"end":14217,"value":"Token exchange failed:","raw":"'Token exchange failed:'"},{"type":"Identifier","start":14219,"end":14224,"name":"error"}]}},{"type":"ThrowStatement","start":14239,"end":14307,"argument":{"type":"NewExpression","start":14245,"end":14306,"callee":{"type":"Identifier","start":14249,"end":14254,"name":"Error"},"arguments":[{"type":"Literal","start":14255,"end":14305,"value":"Failed to exchange authorization code for tokens","raw":"'Failed to exchange authorization code for tokens'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":14399,"end":15602,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":14405,"end":14424,"name":"handleTokenResponse"},"value":{"type":"FunctionExpression","start":14424,"end":15602,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":14425,"end":14438,"name":"tokenResponse"}],"body":{"type":"BlockStatement","start":14440,"end":15602,"body":[{"type":"TryStatement","start":14450,"end":15596,"block":{"type":"BlockStatement","start":14454,"end":15469,"body":[{"type":"ExpressionStatement","start":14528,"end":14555,"expression":{"type":"AwaitExpression","start":14528,"end":14554,"argument":{"type":"CallExpression","start":14534,"end":14554,"optional":false,"callee":{"type":"MemberExpression","start":14534,"end":14552,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":14534,"end":14538},"property":{"type":"Identifier","start":14539,"end":14552,"name":"validateState"}},"arguments":[]}}},{"type":"VariableDeclaration","start":14601,"end":14983,"kind":"const","declarations":[{"type":"VariableDeclarator","start":14607,"end":14982,"id":{"type":"Identifier","start":14607,"end":14616,"name":"tokenInfo"},"init":{"type":"ObjectExpression","start":14619,"end":14982,"properties":[{"type":"Property","start":14637,"end":14676,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14637,"end":14648,"name":"accessToken"},"value":{"type":"MemberExpression","start":14650,"end":14676,"computed":false,"optional":false,"object":{"type":"Identifier","start":14650,"end":14663,"name":"tokenResponse"},"property":{"type":"Identifier","start":14664,"end":14676,"name":"access_token"}},"kind":"init"},{"type":"Property","start":14694,"end":14735,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14694,"end":14706,"name":"refreshToken"},"value":{"type":"MemberExpression","start":14708,"end":14735,"computed":false,"optional":false,"object":{"type":"Identifier","start":14708,"end":14721,"name":"tokenResponse"},"property":{"type":"Identifier","start":14722,"end":14735,"name":"refresh_token"}},"kind":"init"},{"type":"Property","start":14753,"end":14800,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14753,"end":14762,"name":"tokenType"},"value":{"type":"LogicalExpression","start":14764,"end":14800,"operator":"||","left":{"type":"MemberExpression","start":14764,"end":14788,"computed":false,"optional":false,"object":{"type":"Identifier","start":14764,"end":14777,"name":"tokenResponse"},"property":{"type":"Identifier","start":14778,"end":14788,"name":"token_type"}},"right":{"type":"Literal","start":14792,"end":14800,"value":"Bearer","raw":"'Bearer'"}},"kind":"init"},{"type":"Property","start":14818,"end":14875,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14818,"end":14827,"name":"expiresAt"},"value":{"type":"BinaryExpression","start":14829,"end":14875,"operator":"+","left":{"type":"CallExpression","start":14829,"end":14839,"optional":false,"callee":{"type":"MemberExpression","start":14829,"end":14837,"computed":false,"optional":false,"object":{"type":"Identifier","start":14829,"end":14833,"name":"Date"},"property":{"type":"Identifier","start":14834,"end":14837,"name":"now"}},"arguments":[]},"right":{"type":"BinaryExpression","start":14843,"end":14874,"operator":"*","left":{"type":"MemberExpression","start":14843,"end":14867,"computed":false,"optional":false,"object":{"type":"Identifier","start":14843,"end":14856,"name":"tokenResponse"},"property":{"type":"Identifier","start":14857,"end":14867,"name":"expires_in"}},"right":{"type":"Literal","start":14870,"end":14874,"raw":"1000","value":1000}}},"kind":"init"},{"type":"Property","start":14893,"end":14919,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14893,"end":14898,"name":"scope"},"value":{"type":"MemberExpression","start":14900,"end":14919,"computed":false,"optional":false,"object":{"type":"Identifier","start":14900,"end":14913,"name":"tokenResponse"},"property":{"type":"Identifier","start":14914,"end":14919,"name":"scope"}},"kind":"init"},{"type":"Property","start":14937,"end":14968,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":14937,"end":14944,"name":"idToken"},"value":{"type":"MemberExpression","start":14946,"end":14968,"computed":false,"optional":false,"object":{"type":"Identifier","start":14946,"end":14959,"name":"tokenResponse"},"property":{"type":"Identifier","start":14960,"end":14968,"name":"id_token"}},"kind":"init"}]}}]},{"type":"ExpressionStatement","start":15033,"end":15064,"expression":{"type":"CallExpression","start":15033,"end":15063,"optional":false,"callee":{"type":"MemberExpression","start":15033,"end":15052,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15033,"end":15037},"property":{"type":"Identifier","start":15038,"end":15052,"name":"storeTokenInfo"}},"arguments":[{"type":"Identifier","start":15053,"end":15062,"name":"tokenInfo"}]}},{"type":"ExpressionStatement","start":15120,"end":15291,"expression":{"type":"CallExpression","start":15120,"end":15290,"optional":false,"callee":{"type":"MemberExpression","start":15120,"end":15140,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15120,"end":15124},"property":{"type":"Identifier","start":15125,"end":15140,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":15141,"end":15289,"properties":[{"type":"Property","start":15159,"end":15180,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15159,"end":15174,"name":"isAuthenticated"},"value":{"type":"Literal","start":15176,"end":15180,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":15198,"end":15214,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15198,"end":15207,"name":"isLoading"},"value":{"type":"Literal","start":15209,"end":15214,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":15232,"end":15241,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":15232,"end":15241,"name":"tokenInfo"},"value":{"type":"Identifier","start":15232,"end":15241,"name":"tokenInfo"},"kind":"init"},{"type":"Property","start":15259,"end":15275,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":15259,"end":15264,"name":"error"},"value":{"type":"Identifier","start":15266,"end":15275,"name":"undefined"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":15346,"end":15383,"expression":{"type":"CallExpression","start":15346,"end":15382,"optional":false,"callee":{"type":"MemberExpression","start":15346,"end":15380,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":15346,"end":15365,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15346,"end":15350},"property":{"type":"Identifier","start":15351,"end":15365,"name":"storageService"}},"property":{"type":"Identifier","start":15366,"end":15380,"name":"clearTemporary"}},"arguments":[]}},{"type":"ExpressionStatement","start":15396,"end":15459,"expression":{"type":"CallExpression","start":15396,"end":15458,"optional":false,"callee":{"type":"MemberExpression","start":15396,"end":15408,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15396,"end":15400},"property":{"type":"Identifier","start":15401,"end":15408,"name":"logInfo"}},"arguments":[{"type":"Literal","start":15409,"end":15457,"value":"Tokens stored successfully, user authenticated","raw":"'Tokens stored successfully, user authenticated'"}]}}]},"handler":{"type":"CatchClause","start":15478,"end":15596,"param":{"type":"Identifier","start":15485,"end":15490,"name":"error"},"body":{"type":"BlockStatement","start":15492,"end":15596,"body":[{"type":"ExpressionStatement","start":15506,"end":15561,"expression":{"type":"CallExpression","start":15506,"end":15560,"optional":false,"callee":{"type":"MemberExpression","start":15506,"end":15519,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15506,"end":15510},"property":{"type":"Identifier","start":15511,"end":15519,"name":"logError"}},"arguments":[{"type":"Literal","start":15520,"end":15552,"value":"Error handling token response:","raw":"'Error handling token response:'"},{"type":"Identifier","start":15554,"end":15559,"name":"error"}]}},{"type":"ThrowStatement","start":15574,"end":15586,"argument":{"type":"Identifier","start":15580,"end":15585,"name":"error"}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":15675,"end":16256,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":15681,"end":15694,"name":"validateState"},"value":{"type":"FunctionExpression","start":15694,"end":16256,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":15697,"end":16256,"body":[{"type":"VariableDeclaration","start":15707,"end":15769,"kind":"const","declarations":[{"type":"VariableDeclarator","start":15713,"end":15768,"id":{"type":"Identifier","start":15713,"end":15722,"name":"urlParams"},"init":{"type":"NewExpression","start":15725,"end":15768,"callee":{"type":"Identifier","start":15729,"end":15744,"name":"URLSearchParams"},"arguments":[{"type":"MemberExpression","start":15745,"end":15767,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":15745,"end":15760,"computed":false,"optional":false,"object":{"type":"Identifier","start":15745,"end":15751,"name":"window"},"property":{"type":"Identifier","start":15752,"end":15760,"name":"location"}},"property":{"type":"Identifier","start":15761,"end":15767,"name":"search"}}]}}]},{"type":"VariableDeclaration","start":15778,"end":15852,"kind":"const","declarations":[{"type":"VariableDeclarator","start":15784,"end":15851,"id":{"type":"Identifier","start":15784,"end":15794,"name":"hashParams"},"init":{"type":"NewExpression","start":15797,"end":15851,"callee":{"type":"Identifier","start":15801,"end":15816,"name":"URLSearchParams"},"arguments":[{"type":"CallExpression","start":15817,"end":15850,"optional":false,"callee":{"type":"MemberExpression","start":15817,"end":15847,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":15817,"end":15837,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":15817,"end":15832,"computed":false,"optional":false,"object":{"type":"Identifier","start":15817,"end":15823,"name":"window"},"property":{"type":"Identifier","start":15824,"end":15832,"name":"location"}},"property":{"type":"Identifier","start":15833,"end":15837,"name":"hash"}},"property":{"type":"Identifier","start":15838,"end":15847,"name":"substring"}},"arguments":[{"type":"Literal","start":15848,"end":15849,"raw":"1","value":1}]}]}}]},{"type":"VariableDeclaration","start":15861,"end":15933,"kind":"const","declarations":[{"type":"VariableDeclarator","start":15867,"end":15932,"id":{"type":"Identifier","start":15867,"end":15880,"name":"receivedState"},"init":{"type":"LogicalExpression","start":15883,"end":15932,"operator":"||","left":{"type":"CallExpression","start":15883,"end":15905,"optional":false,"callee":{"type":"MemberExpression","start":15883,"end":15896,"computed":false,"optional":false,"object":{"type":"Identifier","start":15883,"end":15892,"name":"urlParams"},"property":{"type":"Identifier","start":15893,"end":15896,"name":"get"}},"arguments":[{"type":"Literal","start":15897,"end":15904,"value":"state","raw":"'state'"}]},"right":{"type":"CallExpression","start":15909,"end":15932,"optional":false,"callee":{"type":"MemberExpression","start":15909,"end":15923,"computed":false,"optional":false,"object":{"type":"Identifier","start":15909,"end":15919,"name":"hashParams"},"property":{"type":"Identifier","start":15920,"end":15923,"name":"get"}},"arguments":[{"type":"Literal","start":15924,"end":15931,"value":"state","raw":"'state'"}]}}}]},{"type":"VariableDeclaration","start":15942,"end":16017,"kind":"const","declarations":[{"type":"VariableDeclarator","start":15948,"end":16016,"id":{"type":"Identifier","start":15948,"end":15959,"name":"storedState"},"init":{"type":"CallExpression","start":15962,"end":16016,"optional":false,"callee":{"type":"MemberExpression","start":15962,"end":15989,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":15962,"end":15981,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":15962,"end":15966},"property":{"type":"Identifier","start":15967,"end":15981,"name":"storageService"}},"property":{"type":"Identifier","start":15982,"end":15989,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":15990,"end":16015,"computed":false,"optional":false,"object":{"type":"Identifier","start":15990,"end":16009,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":16010,"end":16015,"name":"STATE"}}]}}]},{"type":"IfStatement","start":16026,"end":16185,"test":{"type":"LogicalExpression","start":16030,"end":16093,"operator":"||","left":{"type":"LogicalExpression","start":16030,"end":16060,"operator":"||","left":{"type":"UnaryExpression","start":16030,"end":16044,"operator":"!","argument":{"type":"Identifier","start":16031,"end":16044,"name":"receivedState"},"prefix":true},"right":{"type":"UnaryExpression","start":16048,"end":16060,"operator":"!","argument":{"type":"Identifier","start":16049,"end":16060,"name":"storedState"},"prefix":true}},"right":{"type":"BinaryExpression","start":16064,"end":16093,"operator":"!==","left":{"type":"Identifier","start":16064,"end":16077,"name":"receivedState"},"right":{"type":"Identifier","start":16082,"end":16093,"name":"storedState"}}},"consequent":{"type":"BlockStatement","start":16095,"end":16185,"body":[{"type":"ThrowStatement","start":16109,"end":16175,"argument":{"type":"NewExpression","start":16115,"end":16174,"callee":{"type":"Identifier","start":16119,"end":16124,"name":"Error"},"arguments":[{"type":"Literal","start":16125,"end":16173,"value":"Invalid state parameter - possible CSRF attack","raw":"'Invalid state parameter - possible CSRF attack'"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":16194,"end":16250,"expression":{"type":"CallExpression","start":16194,"end":16249,"optional":false,"callee":{"type":"MemberExpression","start":16194,"end":16207,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":16194,"end":16198},"property":{"type":"Identifier","start":16199,"end":16207,"name":"logDebug"}},"arguments":[{"type":"Literal","start":16208,"end":16248,"value":"State parameter validated successfully","raw":"'State parameter validated successfully'"}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":16337,"end":16544,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":16337,"end":16351,"name":"getAccessToken"},"value":{"type":"FunctionExpression","start":16351,"end":16544,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":16354,"end":16544,"body":[{"type":"VariableDeclaration","start":16364,"end":16408,"kind":"const","declarations":[{"type":"VariableDeclarator","start":16370,"end":16407,"id":{"type":"Identifier","start":16370,"end":16379,"name":"tokenInfo"},"init":{"type":"CallExpression","start":16382,"end":16407,"optional":false,"callee":{"type":"MemberExpression","start":16382,"end":16405,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":16382,"end":16386},"property":{"type":"Identifier","start":16387,"end":16405,"name":"getStoredTokenInfo"}},"arguments":[]}}]},{"type":"IfStatement","start":16417,"end":16517,"test":{"type":"LogicalExpression","start":16421,"end":16462,"operator":"&&","left":{"type":"Identifier","start":16421,"end":16430,"name":"tokenInfo"},"right":{"type":"CallExpression","start":16434,"end":16462,"optional":false,"callee":{"type":"MemberExpression","start":16434,"end":16451,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":16434,"end":16438},"property":{"type":"Identifier","start":16439,"end":16451,"name":"isTokenValid"}},"arguments":[{"type":"Identifier","start":16452,"end":16461,"name":"tokenInfo"}]}},"consequent":{"type":"BlockStatement","start":16464,"end":16517,"body":[{"type":"ReturnStatement","start":16478,"end":16507,"argument":{"type":"MemberExpression","start":16485,"end":16506,"computed":false,"optional":false,"object":{"type":"Identifier","start":16485,"end":16494,"name":"tokenInfo"},"property":{"type":"Identifier","start":16495,"end":16506,"name":"accessToken"}}}]},"alternate":null},{"type":"ReturnStatement","start":16526,"end":16538,"argument":{"type":"Literal","start":16533,"end":16537,"raw":"null","value":null}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":16635,"end":16762,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":16635,"end":16652,"name":"getRawAccessToken"},"value":{"type":"FunctionExpression","start":16652,"end":16762,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":16655,"end":16762,"body":[{"type":"VariableDeclaration","start":16665,"end":16709,"kind":"const","declarations":[{"type":"VariableDeclarator","start":16671,"end":16708,"id":{"type":"Identifier","start":16671,"end":16680,"name":"tokenInfo"},"init":{"type":"CallExpression","start":16683,"end":16708,"optional":false,"callee":{"type":"MemberExpression","start":16683,"end":16706,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":16683,"end":16687},"property":{"type":"Identifier","start":16688,"end":16706,"name":"getStoredTokenInfo"}},"arguments":[]}}]},{"type":"ReturnStatement","start":16718,"end":16756,"argument":{"type":"LogicalExpression","start":16725,"end":16755,"operator":"||","left":{"type":"ChainExpression","start":16725,"end":16747,"expression":{"type":"MemberExpression","start":16725,"end":16747,"computed":false,"optional":true,"object":{"type":"Identifier","start":16725,"end":16734,"name":"tokenInfo"},"property":{"type":"Identifier","start":16736,"end":16747,"name":"accessToken"}}},"right":{"type":"Literal","start":16751,"end":16755,"raw":"null","value":null}}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":16816,"end":16942,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":16816,"end":16831,"name":"getRefreshToken"},"value":{"type":"FunctionExpression","start":16831,"end":16942,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":16834,"end":16942,"body":[{"type":"VariableDeclaration","start":16844,"end":16888,"kind":"const","declarations":[{"type":"VariableDeclarator","start":16850,"end":16887,"id":{"type":"Identifier","start":16850,"end":16859,"name":"tokenInfo"},"init":{"type":"CallExpression","start":16862,"end":16887,"optional":false,"callee":{"type":"MemberExpression","start":16862,"end":16885,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":16862,"end":16866},"property":{"type":"Identifier","start":16867,"end":16885,"name":"getStoredTokenInfo"}},"arguments":[]}}]},{"type":"ReturnStatement","start":16897,"end":16936,"argument":{"type":"LogicalExpression","start":16904,"end":16935,"operator":"||","left":{"type":"ChainExpression","start":16904,"end":16927,"expression":{"type":"MemberExpression","start":16904,"end":16927,"computed":false,"optional":true,"object":{"type":"Identifier","start":16904,"end":16913,"name":"tokenInfo"},"property":{"type":"Identifier","start":16915,"end":16927,"name":"refreshToken"}}},"right":{"type":"Literal","start":16931,"end":16935,"raw":"null","value":null}}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":17001,"end":17144,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":17001,"end":17016,"name":"isAuthenticated"},"value":{"type":"FunctionExpression","start":17016,"end":17144,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":17019,"end":17144,"body":[{"type":"VariableDeclaration","start":17029,"end":17073,"kind":"const","declarations":[{"type":"VariableDeclarator","start":17035,"end":17072,"id":{"type":"Identifier","start":17035,"end":17044,"name":"tokenInfo"},"init":{"type":"CallExpression","start":17047,"end":17072,"optional":false,"callee":{"type":"MemberExpression","start":17047,"end":17070,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17047,"end":17051},"property":{"type":"Identifier","start":17052,"end":17070,"name":"getStoredTokenInfo"}},"arguments":[]}}]},{"type":"ReturnStatement","start":17082,"end":17138,"argument":{"type":"ConditionalExpression","start":17089,"end":17137,"test":{"type":"Identifier","start":17089,"end":17098,"name":"tokenInfo"},"consequent":{"type":"CallExpression","start":17101,"end":17129,"optional":false,"callee":{"type":"MemberExpression","start":17101,"end":17118,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17101,"end":17105},"property":{"type":"Identifier","start":17106,"end":17118,"name":"isTokenValid"}},"arguments":[{"type":"Identifier","start":17119,"end":17128,"name":"tokenInfo"}]},"alternate":{"type":"Literal","start":17132,"end":17137,"value":false,"raw":"false"}}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":17232,"end":17318,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":17232,"end":17257,"name":"isAuthenticationAvailable"},"value":{"type":"FunctionExpression","start":17257,"end":17318,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":17260,"end":17318,"body":[{"type":"ReturnStatement","start":17270,"end":17312,"argument":{"type":"CallExpression","start":17277,"end":17311,"optional":false,"callee":{"type":"Identifier","start":17277,"end":17294,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":17295,"end":17310,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17295,"end":17299},"property":{"type":"Identifier","start":17300,"end":17310,"name":"platformId"}}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":17397,"end":18418,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":17403,"end":17414,"name":"getUserInfo"},"value":{"type":"FunctionExpression","start":17414,"end":18418,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":17417,"end":18418,"body":[{"type":"IfStatement","start":17427,"end":17538,"test":{"type":"UnaryExpression","start":17431,"end":17460,"operator":"!","argument":{"type":"MemberExpression","start":17432,"end":17460,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":17432,"end":17443,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17432,"end":17436},"property":{"type":"Identifier","start":17437,"end":17443,"name":"config"}},"property":{"type":"Identifier","start":17444,"end":17460,"name":"userInfoEndpoint"}},"prefix":true},"consequent":{"type":"BlockStatement","start":17462,"end":17538,"body":[{"type":"ThrowStatement","start":17476,"end":17528,"argument":{"type":"NewExpression","start":17482,"end":17527,"callee":{"type":"Identifier","start":17486,"end":17491,"name":"Error"},"arguments":[{"type":"Literal","start":17492,"end":17526,"value":"UserInfo endpoint not configured","raw":"'UserInfo endpoint not configured'"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":17547,"end":17589,"kind":"const","declarations":[{"type":"VariableDeclarator","start":17553,"end":17588,"id":{"type":"Identifier","start":17553,"end":17564,"name":"accessToken"},"init":{"type":"CallExpression","start":17567,"end":17588,"optional":false,"callee":{"type":"MemberExpression","start":17567,"end":17586,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17567,"end":17571},"property":{"type":"Identifier","start":17572,"end":17586,"name":"getAccessToken"}},"arguments":[]}}]},{"type":"IfStatement","start":17598,"end":17685,"test":{"type":"UnaryExpression","start":17602,"end":17614,"operator":"!","argument":{"type":"Identifier","start":17603,"end":17614,"name":"accessToken"},"prefix":true},"consequent":{"type":"BlockStatement","start":17616,"end":17685,"body":[{"type":"ThrowStatement","start":17630,"end":17675,"argument":{"type":"NewExpression","start":17636,"end":17674,"callee":{"type":"Identifier","start":17640,"end":17645,"name":"Error"},"arguments":[{"type":"Literal","start":17646,"end":17673,"value":"No access token available","raw":"'No access token available'"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":17694,"end":17757,"expression":{"type":"CallExpression","start":17694,"end":17756,"optional":false,"callee":{"type":"MemberExpression","start":17694,"end":17706,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17694,"end":17698},"property":{"type":"Identifier","start":17699,"end":17706,"name":"logInfo"}},"arguments":[{"type":"Literal","start":17707,"end":17755,"value":"Fetching user info from OIDC userinfo endpoint","raw":"'Fetching user info from OIDC userinfo endpoint'"}]}},{"type":"TryStatement","start":17766,"end":18412,"block":{"type":"BlockStatement","start":17770,"end":18249,"body":[{"type":"VariableDeclaration","start":17784,"end":17986,"kind":"const","declarations":[{"type":"VariableDeclarator","start":17790,"end":17985,"id":{"type":"Identifier","start":17790,"end":17798,"name":"userInfo"},"init":{"type":"AwaitExpression","start":17801,"end":17985,"argument":{"type":"CallExpression","start":17807,"end":17985,"optional":false,"callee":{"type":"MemberExpression","start":17807,"end":17983,"computed":false,"optional":false,"object":{"type":"CallExpression","start":17807,"end":17973,"optional":false,"callee":{"type":"MemberExpression","start":17807,"end":17820,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":17807,"end":17816,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17807,"end":17811},"property":{"type":"Identifier","start":17812,"end":17816,"name":"http"}},"property":{"type":"Identifier","start":17817,"end":17820,"name":"get"}},"arguments":[{"type":"MemberExpression","start":17821,"end":17849,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":17821,"end":17832,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":17821,"end":17825},"property":{"type":"Identifier","start":17826,"end":17832,"name":"config"}},"property":{"type":"Identifier","start":17833,"end":17849,"name":"userInfoEndpoint"}},{"type":"ObjectExpression","start":17851,"end":17972,"properties":[{"type":"Property","start":17869,"end":17958,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":17869,"end":17876,"name":"headers"},"value":{"type":"ObjectExpression","start":17878,"end":17958,"properties":[{"type":"Property","start":17900,"end":17940,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":17900,"end":17915,"value":"Authorization","raw":"'Authorization'"},"value":{"type":"TemplateLiteral","start":17917,"end":17940,"quasis":[{"type":"TemplateElement","start":17918,"end":17925,"tail":false,"value":{"cooked":"Bearer ","raw":"Bearer "}},{"type":"TemplateElement","start":17939,"end":17939,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":17927,"end":17938,"name":"accessToken"}]},"kind":"init"}]},"kind":"init"}]}]},"property":{"type":"Identifier","start":17974,"end":17983,"name":"toPromise"}},"arguments":[]}}}]},{"type":"IfStatement","start":17999,"end":18239,"test":{"type":"Identifier","start":18003,"end":18011,"name":"userInfo"},"consequent":{"type":"BlockStatement","start":18013,"end":18139,"body":[{"type":"ExpressionStatement","start":18031,"end":18092,"expression":{"type":"CallExpression","start":18031,"end":18091,"optional":false,"callee":{"type":"MemberExpression","start":18031,"end":18044,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":18031,"end":18035},"property":{"type":"Identifier","start":18036,"end":18044,"name":"logDebug"}},"arguments":[{"type":"Literal","start":18045,"end":18080,"value":"User info retrieved successfully:","raw":"'User info retrieved successfully:'"},{"type":"Identifier","start":18082,"end":18090,"name":"userInfo"}]}},{"type":"ReturnStatement","start":18109,"end":18125,"argument":{"type":"Identifier","start":18116,"end":18124,"name":"userInfo"}}]},"alternate":{"type":"BlockStatement","start":18157,"end":18239,"body":[{"type":"ThrowStatement","start":18175,"end":18225,"argument":{"type":"NewExpression","start":18181,"end":18224,"callee":{"type":"Identifier","start":18185,"end":18190,"name":"Error"},"arguments":[{"type":"Literal","start":18191,"end":18223,"value":"No user info response received","raw":"'No user info response received'"}]}}]}}]},"handler":{"type":"CatchClause","start":18258,"end":18412,"param":{"type":"Identifier","start":18265,"end":18270,"name":"error"},"body":{"type":"BlockStatement","start":18272,"end":18412,"body":[{"type":"ExpressionStatement","start":18286,"end":18337,"expression":{"type":"CallExpression","start":18286,"end":18336,"optional":false,"callee":{"type":"MemberExpression","start":18286,"end":18299,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":18286,"end":18290},"property":{"type":"Identifier","start":18291,"end":18299,"name":"logError"}},"arguments":[{"type":"Literal","start":18300,"end":18328,"value":"Failed to fetch user info:","raw":"'Failed to fetch user info:'"},{"type":"Identifier","start":18330,"end":18335,"name":"error"}]}},{"type":"ThrowStatement","start":18350,"end":18402,"argument":{"type":"NewExpression","start":18356,"end":18401,"callee":{"type":"Identifier","start":18360,"end":18365,"name":"Error"},"arguments":[{"type":"Literal","start":18366,"end":18400,"value":"Failed to fetch user information","raw":"'Failed to fetch user information'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":18484,"end":18677,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":18484,"end":18496,"name":"isTokenValid"},"value":{"type":"FunctionExpression","start":18496,"end":18677,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":18497,"end":18506,"name":"tokenInfo"}],"body":{"type":"BlockStatement","start":18508,"end":18677,"body":[{"type":"VariableDeclaration","start":18518,"end":18581,"kind":"const","declarations":[{"type":"VariableDeclarator","start":18524,"end":18580,"id":{"type":"Identifier","start":18524,"end":18533,"name":"threshold"},"init":{"type":"BinaryExpression","start":18536,"end":18580,"operator":"*","left":{"type":"LogicalExpression","start":18537,"end":18572,"operator":"||","left":{"type":"MemberExpression","start":18537,"end":18565,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":18537,"end":18548,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":18537,"end":18541},"property":{"type":"Identifier","start":18542,"end":18548,"name":"config"}},"property":{"type":"Identifier","start":18549,"end":18565,"name":"refreshThreshold"}},"right":{"type":"Literal","start":18569,"end":18572,"raw":"300","value":300}},"right":{"type":"Literal","start":18576,"end":18580,"raw":"1000","value":1000}}}]},{"type":"ReturnStatement","start":18617,"end":18671,"argument":{"type":"BinaryExpression","start":18624,"end":18670,"operator":"<","left":{"type":"CallExpression","start":18624,"end":18634,"optional":false,"callee":{"type":"MemberExpression","start":18624,"end":18632,"computed":false,"optional":false,"object":{"type":"Identifier","start":18624,"end":18628,"name":"Date"},"property":{"type":"Identifier","start":18629,"end":18632,"name":"now"}},"arguments":[]},"right":{"type":"BinaryExpression","start":18638,"end":18669,"operator":"-","left":{"type":"MemberExpression","start":18638,"end":18657,"computed":false,"optional":false,"object":{"type":"Identifier","start":18638,"end":18647,"name":"tokenInfo"},"property":{"type":"Identifier","start":18648,"end":18657,"name":"expiresAt"}},"right":{"type":"Identifier","start":18660,"end":18669,"name":"threshold"}}}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":18746,"end":21341,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":18752,"end":18770,"name":"refreshAccessToken"},"value":{"type":"FunctionExpression","start":18770,"end":21341,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":18773,"end":21341,"body":[{"type":"VariableDeclaration","start":18783,"end":18827,"kind":"const","declarations":[{"type":"VariableDeclarator","start":18789,"end":18826,"id":{"type":"Identifier","start":18789,"end":18801,"name":"refreshToken"},"init":{"type":"CallExpression","start":18804,"end":18826,"optional":false,"callee":{"type":"MemberExpression","start":18804,"end":18824,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":18804,"end":18808},"property":{"type":"Identifier","start":18809,"end":18824,"name":"getRefreshToken"}},"arguments":[]}}]},{"type":"IfStatement","start":18836,"end":18925,"test":{"type":"UnaryExpression","start":18840,"end":18853,"operator":"!","argument":{"type":"Identifier","start":18841,"end":18853,"name":"refreshToken"},"prefix":true},"consequent":{"type":"BlockStatement","start":18855,"end":18925,"body":[{"type":"ThrowStatement","start":18869,"end":18915,"argument":{"type":"NewExpression","start":18875,"end":18914,"callee":{"type":"Identifier","start":18879,"end":18884,"name":"Error"},"arguments":[{"type":"Literal","start":18885,"end":18913,"value":"No refresh token available","raw":"'No refresh token available'"}]}}]},"alternate":null},{"type":"ExpressionStatement","start":18934,"end":18974,"expression":{"type":"CallExpression","start":18934,"end":18973,"optional":false,"callee":{"type":"MemberExpression","start":18934,"end":18946,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":18934,"end":18938},"property":{"type":"Identifier","start":18939,"end":18946,"name":"logInfo"}},"arguments":[{"type":"Literal","start":18947,"end":18972,"value":"Refreshing access token","raw":"'Refreshing access token'"}]}},{"type":"VariableDeclaration","start":18983,"end":19142,"kind":"const","declarations":[{"type":"VariableDeclarator","start":18989,"end":19141,"id":{"type":"Identifier","start":18989,"end":19001,"name":"tokenRequest"},"init":{"type":"ObjectExpression","start":19004,"end":19141,"properties":[{"type":"Property","start":19018,"end":19045,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19018,"end":19028,"name":"grant_type"},"value":{"type":"Literal","start":19030,"end":19045,"value":"refresh_token","raw":"'refresh_token'"},"kind":"init"},{"type":"Property","start":19059,"end":19086,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19059,"end":19072,"name":"refresh_token"},"value":{"type":"Identifier","start":19074,"end":19086,"name":"refreshToken"},"kind":"init"},{"type":"Property","start":19100,"end":19131,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19100,"end":19109,"name":"client_id"},"value":{"type":"MemberExpression","start":19111,"end":19131,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":19111,"end":19122,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":19111,"end":19115},"property":{"type":"Identifier","start":19116,"end":19122,"name":"config"}},"property":{"type":"Identifier","start":19123,"end":19131,"name":"clientId"}},"kind":"init"}]}}]},{"type":"VariableDeclaration","start":19221,"end":19260,"kind":"const","declarations":[{"type":"VariableDeclarator","start":19227,"end":19259,"id":{"type":"Identifier","start":19227,"end":19235,"name":"formData"},"init":{"type":"NewExpression","start":19238,"end":19259,"callee":{"type":"Identifier","start":19242,"end":19257,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":19269,"end":19446,"expression":{"type":"CallExpression","start":19269,"end":19445,"optional":false,"callee":{"type":"MemberExpression","start":19269,"end":19305,"computed":false,"optional":false,"object":{"type":"CallExpression","start":19269,"end":19297,"optional":false,"callee":{"type":"MemberExpression","start":19269,"end":19283,"computed":false,"optional":false,"object":{"type":"Identifier","start":19269,"end":19275,"name":"Object"},"property":{"type":"Identifier","start":19276,"end":19283,"name":"entries"}},"arguments":[{"type":"Identifier","start":19284,"end":19296,"name":"tokenRequest"}]},"property":{"type":"Identifier","start":19298,"end":19305,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":19306,"end":19444,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":19307,"end":19319,"elements":[{"type":"Identifier","start":19308,"end":19311,"name":"key"},{"type":"Identifier","start":19313,"end":19318,"name":"value"}]}],"body":{"type":"BlockStatement","start":19324,"end":19444,"body":[{"type":"IfStatement","start":19338,"end":19434,"test":{"type":"BinaryExpression","start":19342,"end":19361,"operator":"!==","left":{"type":"Identifier","start":19342,"end":19347,"name":"value"},"right":{"type":"Identifier","start":19352,"end":19361,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":19363,"end":19434,"body":[{"type":"ExpressionStatement","start":19381,"end":19420,"expression":{"type":"CallExpression","start":19381,"end":19419,"optional":false,"callee":{"type":"MemberExpression","start":19381,"end":19396,"computed":false,"optional":false,"object":{"type":"Identifier","start":19381,"end":19389,"name":"formData"},"property":{"type":"Identifier","start":19390,"end":19396,"name":"append"}},"arguments":[{"type":"Identifier","start":19397,"end":19400,"name":"key"},{"type":"CallExpression","start":19402,"end":19418,"optional":false,"callee":{"type":"MemberExpression","start":19402,"end":19416,"computed":false,"optional":false,"object":{"type":"Identifier","start":19402,"end":19407,"name":"value"},"property":{"type":"Identifier","start":19408,"end":19416,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"TryStatement","start":19455,"end":21335,"block":{"type":"BlockStatement","start":19459,"end":20644,"body":[{"type":"VariableDeclaration","start":19473,"end":19710,"kind":"const","declarations":[{"type":"VariableDeclarator","start":19479,"end":19709,"id":{"type":"Identifier","start":19479,"end":19492,"name":"tokenResponse"},"init":{"type":"AwaitExpression","start":19495,"end":19709,"argument":{"type":"CallExpression","start":19501,"end":19709,"optional":false,"callee":{"type":"MemberExpression","start":19501,"end":19707,"computed":false,"optional":false,"object":{"type":"CallExpression","start":19501,"end":19697,"optional":false,"callee":{"type":"MemberExpression","start":19501,"end":19515,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":19501,"end":19510,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":19501,"end":19505},"property":{"type":"Identifier","start":19506,"end":19510,"name":"http"}},"property":{"type":"Identifier","start":19511,"end":19515,"name":"post"}},"arguments":[{"type":"MemberExpression","start":19516,"end":19541,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":19516,"end":19527,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":19516,"end":19520},"property":{"type":"Identifier","start":19521,"end":19527,"name":"config"}},"property":{"type":"Identifier","start":19528,"end":19541,"name":"tokenEndpoint"}},{"type":"CallExpression","start":19543,"end":19562,"optional":false,"callee":{"type":"MemberExpression","start":19543,"end":19560,"computed":false,"optional":false,"object":{"type":"Identifier","start":19543,"end":19551,"name":"formData"},"property":{"type":"Identifier","start":19552,"end":19560,"name":"toString"}},"arguments":[]},{"type":"ObjectExpression","start":19564,"end":19696,"properties":[{"type":"Property","start":19582,"end":19682,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19582,"end":19589,"name":"headers"},"value":{"type":"ObjectExpression","start":19591,"end":19682,"properties":[{"type":"Property","start":19613,"end":19664,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":19613,"end":19627,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":19629,"end":19664,"value":"application/x-www-form-urlencoded","raw":"'application/x-www-form-urlencoded'"},"kind":"init"}]},"kind":"init"}]}]},"property":{"type":"Identifier","start":19698,"end":19707,"name":"toPromise"}},"arguments":[]}}}]},{"type":"IfStatement","start":19723,"end":20634,"test":{"type":"Identifier","start":19727,"end":19740,"name":"tokenResponse"},"consequent":{"type":"BlockStatement","start":19742,"end":20538,"body":[{"type":"VariableDeclaration","start":19760,"end":20186,"kind":"const","declarations":[{"type":"VariableDeclarator","start":19766,"end":20185,"id":{"type":"Identifier","start":19766,"end":19775,"name":"tokenInfo"},"init":{"type":"ObjectExpression","start":19778,"end":20185,"properties":[{"type":"Property","start":19800,"end":19839,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19800,"end":19811,"name":"accessToken"},"value":{"type":"MemberExpression","start":19813,"end":19839,"computed":false,"optional":false,"object":{"type":"Identifier","start":19813,"end":19826,"name":"tokenResponse"},"property":{"type":"Identifier","start":19827,"end":19839,"name":"access_token"}},"kind":"init"},{"type":"Property","start":19861,"end":19918,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19861,"end":19873,"name":"refreshToken"},"value":{"type":"LogicalExpression","start":19875,"end":19918,"operator":"||","left":{"type":"MemberExpression","start":19875,"end":19902,"computed":false,"optional":false,"object":{"type":"Identifier","start":19875,"end":19888,"name":"tokenResponse"},"property":{"type":"Identifier","start":19889,"end":19902,"name":"refresh_token"}},"right":{"type":"Identifier","start":19906,"end":19918,"name":"refreshToken"}},"kind":"init"},{"type":"Property","start":19940,"end":19987,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":19940,"end":19949,"name":"tokenType"},"value":{"type":"LogicalExpression","start":19951,"end":19987,"operator":"||","left":{"type":"MemberExpression","start":19951,"end":19975,"computed":false,"optional":false,"object":{"type":"Identifier","start":19951,"end":19964,"name":"tokenResponse"},"property":{"type":"Identifier","start":19965,"end":19975,"name":"token_type"}},"right":{"type":"Literal","start":19979,"end":19987,"value":"Bearer","raw":"'Bearer'"}},"kind":"init"},{"type":"Property","start":20009,"end":20066,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20009,"end":20018,"name":"expiresAt"},"value":{"type":"BinaryExpression","start":20020,"end":20066,"operator":"+","left":{"type":"CallExpression","start":20020,"end":20030,"optional":false,"callee":{"type":"MemberExpression","start":20020,"end":20028,"computed":false,"optional":false,"object":{"type":"Identifier","start":20020,"end":20024,"name":"Date"},"property":{"type":"Identifier","start":20025,"end":20028,"name":"now"}},"arguments":[]},"right":{"type":"BinaryExpression","start":20034,"end":20065,"operator":"*","left":{"type":"MemberExpression","start":20034,"end":20058,"computed":false,"optional":false,"object":{"type":"Identifier","start":20034,"end":20047,"name":"tokenResponse"},"property":{"type":"Identifier","start":20048,"end":20058,"name":"expires_in"}},"right":{"type":"Literal","start":20061,"end":20065,"raw":"1000","value":1000}}},"kind":"init"},{"type":"Property","start":20088,"end":20114,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20088,"end":20093,"name":"scope"},"value":{"type":"MemberExpression","start":20095,"end":20114,"computed":false,"optional":false,"object":{"type":"Identifier","start":20095,"end":20108,"name":"tokenResponse"},"property":{"type":"Identifier","start":20109,"end":20114,"name":"scope"}},"kind":"init"},{"type":"Property","start":20136,"end":20167,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20136,"end":20143,"name":"idToken"},"value":{"type":"MemberExpression","start":20145,"end":20167,"computed":false,"optional":false,"object":{"type":"Identifier","start":20145,"end":20158,"name":"tokenResponse"},"property":{"type":"Identifier","start":20159,"end":20167,"name":"id_token"}},"kind":"init"}]}}]},{"type":"ExpressionStatement","start":20203,"end":20234,"expression":{"type":"CallExpression","start":20203,"end":20233,"optional":false,"callee":{"type":"MemberExpression","start":20203,"end":20222,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":20203,"end":20207},"property":{"type":"Identifier","start":20208,"end":20222,"name":"storeTokenInfo"}},"arguments":[{"type":"Identifier","start":20223,"end":20232,"name":"tokenInfo"}]}},{"type":"ExpressionStatement","start":20251,"end":20404,"expression":{"type":"CallExpression","start":20251,"end":20403,"optional":false,"callee":{"type":"MemberExpression","start":20251,"end":20271,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":20251,"end":20255},"property":{"type":"Identifier","start":20256,"end":20271,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":20272,"end":20402,"properties":[{"type":"Property","start":20294,"end":20315,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20294,"end":20309,"name":"isAuthenticated"},"value":{"type":"Literal","start":20311,"end":20315,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":20337,"end":20353,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":20337,"end":20346,"name":"isLoading"},"value":{"type":"Literal","start":20348,"end":20353,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":20375,"end":20384,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":20375,"end":20384,"name":"tokenInfo"},"value":{"type":"Identifier","start":20375,"end":20384,"name":"tokenInfo"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":20421,"end":20473,"expression":{"type":"CallExpression","start":20421,"end":20472,"optional":false,"callee":{"type":"MemberExpression","start":20421,"end":20433,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":20421,"end":20425},"property":{"type":"Identifier","start":20426,"end":20433,"name":"logInfo"}},"arguments":[{"type":"Literal","start":20434,"end":20471,"value":"Access token refreshed successfully","raw":"'Access token refreshed successfully'"}]}},{"type":"ReturnStatement","start":20490,"end":20524,"argument":{"type":"MemberExpression","start":20497,"end":20523,"computed":false,"optional":false,"object":{"type":"Identifier","start":20497,"end":20510,"name":"tokenResponse"},"property":{"type":"Identifier","start":20511,"end":20523,"name":"access_token"}}}]},"alternate":{"type":"BlockStatement","start":20556,"end":20634,"body":[{"type":"ThrowStatement","start":20574,"end":20620,"argument":{"type":"NewExpression","start":20580,"end":20619,"callee":{"type":"Identifier","start":20584,"end":20589,"name":"Error"},"arguments":[{"type":"Literal","start":20590,"end":20618,"value":"No token response received","raw":"'No token response received'"}]}}]}}]},"handler":{"type":"CatchClause","start":20653,"end":21335,"param":{"type":"Identifier","start":20660,"end":20665,"name":"error"},"body":{"type":"BlockStatement","start":20667,"end":21335,"body":[{"type":"ExpressionStatement","start":20681,"end":20727,"expression":{"type":"CallExpression","start":20681,"end":20726,"optional":false,"callee":{"type":"MemberExpression","start":20681,"end":20694,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":20681,"end":20685},"property":{"type":"Identifier","start":20686,"end":20694,"name":"logError"}},"arguments":[{"type":"Literal","start":20695,"end":20718,"value":"Token refresh failed:","raw":"'Token refresh failed:'"},{"type":"Identifier","start":20720,"end":20725,"name":"error"}]}},{"type":"IfStatement","start":20824,"end":21262,"test":{"type":"LogicalExpression","start":20828,"end":20871,"operator":"&&","left":{"type":"BinaryExpression","start":20828,"end":20850,"operator":"instanceof","left":{"type":"Identifier","start":20828,"end":20833,"name":"error"},"right":{"type":"Identifier","start":20845,"end":20850,"name":"Error"}},"right":{"type":"BinaryExpression","start":20854,"end":20871,"operator":"in","left":{"type":"Literal","start":20854,"end":20862,"value":"status","raw":"'status'"},"right":{"type":"Identifier","start":20866,"end":20871,"name":"error"}}},"consequent":{"type":"BlockStatement","start":20873,"end":21133,"body":[{"type":"VariableDeclaration","start":20891,"end":20915,"kind":"const","declarations":[{"type":"VariableDeclarator","start":20897,"end":20914,"id":{"type":"Identifier","start":20897,"end":20906,"name":"httpError"},"init":{"type":"Identifier","start":20909,"end":20914,"name":"error"}}]},{"type":"IfStatement","start":20932,"end":21119,"test":{"type":"LogicalExpression","start":20936,"end":20988,"operator":"||","left":{"type":"BinaryExpression","start":20936,"end":20960,"operator":"===","left":{"type":"MemberExpression","start":20936,"end":20952,"computed":false,"optional":false,"object":{"type":"Identifier","start":20936,"end":20945,"name":"httpError"},"property":{"type":"Identifier","start":20946,"end":20952,"name":"status"}},"right":{"type":"Literal","start":20957,"end":20960,"raw":"400","value":400}},"right":{"type":"BinaryExpression","start":20964,"end":20988,"operator":"===","left":{"type":"MemberExpression","start":20964,"end":20980,"computed":false,"optional":false,"object":{"type":"Identifier","start":20964,"end":20973,"name":"httpError"},"property":{"type":"Identifier","start":20974,"end":20980,"name":"status"}},"right":{"type":"Literal","start":20985,"end":20988,"raw":"401","value":401}}},"consequent":{"type":"BlockStatement","start":20990,"end":21119,"body":[{"type":"ExpressionStatement","start":21012,"end":21066,"expression":{"type":"CallExpression","start":21012,"end":21065,"optional":false,"callee":{"type":"MemberExpression","start":21012,"end":21024,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21012,"end":21016},"property":{"type":"Identifier","start":21017,"end":21024,"name":"logInfo"}},"arguments":[{"type":"Literal","start":21025,"end":21064,"value":"Refresh token is invalid, logging out","raw":"'Refresh token is invalid, logging out'"}]}},{"type":"ExpressionStatement","start":21087,"end":21101,"expression":{"type":"CallExpression","start":21087,"end":21100,"optional":false,"callee":{"type":"MemberExpression","start":21087,"end":21098,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21087,"end":21091},"property":{"type":"Identifier","start":21092,"end":21098,"name":"logout"}},"arguments":[]}}]},"alternate":null}]},"alternate":{"type":"BlockStatement","start":21151,"end":21262,"body":[{"type":"ExpressionStatement","start":21169,"end":21248,"expression":{"type":"CallExpression","start":21169,"end":21247,"optional":false,"callee":{"type":"MemberExpression","start":21169,"end":21181,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21169,"end":21173},"property":{"type":"Identifier","start":21174,"end":21181,"name":"logInfo"}},"arguments":[{"type":"Literal","start":21182,"end":21246,"value":"Network or server error during token refresh, will retry later","raw":"'Network or server error during token refresh, will retry later'"}]}}]}},{"type":"ThrowStatement","start":21275,"end":21325,"argument":{"type":"NewExpression","start":21281,"end":21324,"callee":{"type":"Identifier","start":21285,"end":21290,"name":"Error"},"arguments":[{"type":"Literal","start":21291,"end":21323,"value":"Failed to refresh access token","raw":"'Failed to refresh access token'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":21410,"end":22346,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":21416,"end":21422,"name":"logout"},"value":{"type":"FunctionExpression","start":21422,"end":22346,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":21425,"end":22346,"body":[{"type":"TryStatement","start":21435,"end":22340,"block":{"type":"BlockStatement","start":21439,"end":21979,"body":[{"type":"ExpressionStatement","start":21453,"end":21495,"expression":{"type":"CallExpression","start":21453,"end":21494,"optional":false,"callee":{"type":"MemberExpression","start":21453,"end":21473,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21453,"end":21457},"property":{"type":"Identifier","start":21458,"end":21473,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":21474,"end":21493,"properties":[{"type":"Property","start":21476,"end":21491,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":21476,"end":21485,"name":"isLoading"},"value":{"type":"Literal","start":21487,"end":21491,"value":true,"raw":"true"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":21550,"end":21576,"expression":{"type":"AwaitExpression","start":21550,"end":21575,"argument":{"type":"CallExpression","start":21556,"end":21575,"optional":false,"callee":{"type":"MemberExpression","start":21556,"end":21573,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21556,"end":21560},"property":{"type":"Identifier","start":21561,"end":21573,"name":"revokeTokens"}},"arguments":[]}}},{"type":"ExpressionStatement","start":21641,"end":21672,"expression":{"type":"CallExpression","start":21641,"end":21671,"optional":false,"callee":{"type":"MemberExpression","start":21641,"end":21669,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":21641,"end":21660,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21641,"end":21645},"property":{"type":"Identifier","start":21646,"end":21660,"name":"storageService"}},"property":{"type":"Identifier","start":21661,"end":21669,"name":"clearAll"}},"arguments":[]}},{"type":"ExpressionStatement","start":21728,"end":21911,"expression":{"type":"CallExpression","start":21728,"end":21910,"optional":false,"callee":{"type":"MemberExpression","start":21728,"end":21748,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21728,"end":21732},"property":{"type":"Identifier","start":21733,"end":21748,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":21749,"end":21909,"properties":[{"type":"Property","start":21767,"end":21789,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":21767,"end":21782,"name":"isAuthenticated"},"value":{"type":"Literal","start":21784,"end":21789,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":21807,"end":21823,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":21807,"end":21816,"name":"isLoading"},"value":{"type":"Literal","start":21818,"end":21823,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":21841,"end":21861,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":21841,"end":21850,"name":"tokenInfo"},"value":{"type":"Identifier","start":21852,"end":21861,"name":"undefined"},"kind":"init"},{"type":"Property","start":21879,"end":21895,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":21879,"end":21884,"name":"error"},"value":{"type":"Identifier","start":21886,"end":21895,"name":"undefined"},"kind":"init"}]}]}},{"type":"ExpressionStatement","start":21924,"end":21969,"expression":{"type":"CallExpression","start":21924,"end":21968,"optional":false,"callee":{"type":"MemberExpression","start":21924,"end":21936,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":21924,"end":21928},"property":{"type":"Identifier","start":21929,"end":21936,"name":"logInfo"}},"arguments":[{"type":"Literal","start":21937,"end":21967,"value":"User logged out successfully","raw":"'User logged out successfully'"}]}}]},"handler":{"type":"CatchClause","start":21988,"end":22340,"param":{"type":"Identifier","start":21995,"end":22000,"name":"error"},"body":{"type":"BlockStatement","start":22002,"end":22340,"body":[{"type":"ExpressionStatement","start":22016,"end":22061,"expression":{"type":"CallExpression","start":22016,"end":22060,"optional":false,"callee":{"type":"MemberExpression","start":22016,"end":22029,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22016,"end":22020},"property":{"type":"Identifier","start":22021,"end":22029,"name":"logError"}},"arguments":[{"type":"Literal","start":22030,"end":22052,"value":"Error during logout:","raw":"'Error during logout:'"},{"type":"Identifier","start":22054,"end":22059,"name":"error"}]}},{"type":"ExpressionStatement","start":22137,"end":22168,"expression":{"type":"CallExpression","start":22137,"end":22167,"optional":false,"callee":{"type":"MemberExpression","start":22137,"end":22165,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":22137,"end":22156,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22137,"end":22141},"property":{"type":"Identifier","start":22142,"end":22156,"name":"storageService"}},"property":{"type":"Identifier","start":22157,"end":22165,"name":"clearAll"}},"arguments":[]}},{"type":"ExpressionStatement","start":22181,"end":22330,"expression":{"type":"CallExpression","start":22181,"end":22329,"optional":false,"callee":{"type":"MemberExpression","start":22181,"end":22201,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22181,"end":22185},"property":{"type":"Identifier","start":22186,"end":22201,"name":"updateAuthState"}},"arguments":[{"type":"ObjectExpression","start":22202,"end":22328,"properties":[{"type":"Property","start":22220,"end":22242,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22220,"end":22235,"name":"isAuthenticated"},"value":{"type":"Literal","start":22237,"end":22242,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":22260,"end":22276,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22260,"end":22269,"name":"isLoading"},"value":{"type":"Literal","start":22271,"end":22276,"value":false,"raw":"false"},"kind":"init"},{"type":"Property","start":22294,"end":22314,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22294,"end":22303,"name":"tokenInfo"},"value":{"type":"Identifier","start":22305,"end":22314,"name":"undefined"},"kind":"init"}]}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":22412,"end":24535,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":22418,"end":22430,"name":"revokeTokens"},"value":{"type":"FunctionExpression","start":22430,"end":24535,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":22433,"end":24535,"body":[{"type":"IfStatement","start":22443,"end":22577,"test":{"type":"UnaryExpression","start":22447,"end":22474,"operator":"!","argument":{"type":"MemberExpression","start":22448,"end":22474,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":22448,"end":22459,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22448,"end":22452},"property":{"type":"Identifier","start":22453,"end":22459,"name":"config"}},"property":{"type":"Identifier","start":22460,"end":22474,"name":"revokeEndpoint"}},"prefix":true},"consequent":{"type":"BlockStatement","start":22476,"end":22577,"body":[{"type":"ExpressionStatement","start":22490,"end":22547,"expression":{"type":"CallExpression","start":22490,"end":22546,"optional":false,"callee":{"type":"MemberExpression","start":22490,"end":22502,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22490,"end":22494},"property":{"type":"Identifier","start":22495,"end":22502,"name":"logInfo"}},"arguments":[{"type":"Literal","start":22503,"end":22545,"value":"Token revocation endpoint not configured","raw":"'Token revocation endpoint not configured'"}]}},{"type":"ReturnStatement","start":22560,"end":22567,"argument":null}]},"alternate":null},{"type":"VariableDeclaration","start":22586,"end":22628,"kind":"const","declarations":[{"type":"VariableDeclarator","start":22592,"end":22627,"id":{"type":"Identifier","start":22592,"end":22603,"name":"accessToken"},"init":{"type":"CallExpression","start":22606,"end":22627,"optional":false,"callee":{"type":"MemberExpression","start":22606,"end":22625,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22606,"end":22610},"property":{"type":"Identifier","start":22611,"end":22625,"name":"getAccessToken"}},"arguments":[]}}]},{"type":"VariableDeclaration","start":22637,"end":22681,"kind":"const","declarations":[{"type":"VariableDeclarator","start":22643,"end":22680,"id":{"type":"Identifier","start":22643,"end":22655,"name":"refreshToken"},"init":{"type":"CallExpression","start":22658,"end":22680,"optional":false,"callee":{"type":"MemberExpression","start":22658,"end":22678,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22658,"end":22662},"property":{"type":"Identifier","start":22663,"end":22678,"name":"getRefreshToken"}},"arguments":[]}}]},{"type":"VariableDeclaration","start":22690,"end":22716,"kind":"const","declarations":[{"type":"VariableDeclarator","start":22696,"end":22715,"id":{"type":"Identifier","start":22696,"end":22710,"name":"revokePromises"},"init":{"type":"ArrayExpression","start":22713,"end":22715,"elements":[]}}]},{"type":"IfStatement","start":22725,"end":23440,"test":{"type":"Identifier","start":22729,"end":22740,"name":"accessToken"},"consequent":{"type":"BlockStatement","start":22742,"end":23440,"body":[{"type":"VariableDeclaration","start":22756,"end":22927,"kind":"const","declarations":[{"type":"VariableDeclarator","start":22762,"end":22926,"id":{"type":"Identifier","start":22762,"end":22775,"name":"revokeRequest"},"init":{"type":"ObjectExpression","start":22778,"end":22926,"properties":[{"type":"Property","start":22796,"end":22814,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22796,"end":22801,"name":"token"},"value":{"type":"Identifier","start":22803,"end":22814,"name":"accessToken"},"kind":"init"},{"type":"Property","start":22832,"end":22863,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22832,"end":22847,"name":"token_type_hint"},"value":{"type":"Literal","start":22849,"end":22863,"value":"access_token","raw":"'access_token'"},"kind":"init"},{"type":"Property","start":22881,"end":22912,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":22881,"end":22890,"name":"client_id"},"value":{"type":"MemberExpression","start":22892,"end":22912,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":22892,"end":22903,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":22892,"end":22896},"property":{"type":"Identifier","start":22897,"end":22903,"name":"config"}},"property":{"type":"Identifier","start":22904,"end":22912,"name":"clientId"}},"kind":"init"}]}}]},{"type":"VariableDeclaration","start":22940,"end":22979,"kind":"const","declarations":[{"type":"VariableDeclarator","start":22946,"end":22978,"id":{"type":"Identifier","start":22946,"end":22954,"name":"formData"},"init":{"type":"NewExpression","start":22957,"end":22978,"callee":{"type":"Identifier","start":22961,"end":22976,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":22992,"end":23186,"expression":{"type":"CallExpression","start":22992,"end":23185,"optional":false,"callee":{"type":"MemberExpression","start":22992,"end":23029,"computed":false,"optional":false,"object":{"type":"CallExpression","start":22992,"end":23021,"optional":false,"callee":{"type":"MemberExpression","start":22992,"end":23006,"computed":false,"optional":false,"object":{"type":"Identifier","start":22992,"end":22998,"name":"Object"},"property":{"type":"Identifier","start":22999,"end":23006,"name":"entries"}},"arguments":[{"type":"Identifier","start":23007,"end":23020,"name":"revokeRequest"}]},"property":{"type":"Identifier","start":23022,"end":23029,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":23030,"end":23184,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":23031,"end":23043,"elements":[{"type":"Identifier","start":23032,"end":23035,"name":"key"},{"type":"Identifier","start":23037,"end":23042,"name":"value"}]}],"body":{"type":"BlockStatement","start":23048,"end":23184,"body":[{"type":"IfStatement","start":23066,"end":23170,"test":{"type":"BinaryExpression","start":23070,"end":23089,"operator":"!==","left":{"type":"Identifier","start":23070,"end":23075,"name":"value"},"right":{"type":"Identifier","start":23080,"end":23089,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":23091,"end":23170,"body":[{"type":"ExpressionStatement","start":23113,"end":23152,"expression":{"type":"CallExpression","start":23113,"end":23151,"optional":false,"callee":{"type":"MemberExpression","start":23113,"end":23128,"computed":false,"optional":false,"object":{"type":"Identifier","start":23113,"end":23121,"name":"formData"},"property":{"type":"Identifier","start":23122,"end":23128,"name":"append"}},"arguments":[{"type":"Identifier","start":23129,"end":23132,"name":"key"},{"type":"CallExpression","start":23134,"end":23150,"optional":false,"callee":{"type":"MemberExpression","start":23134,"end":23148,"computed":false,"optional":false,"object":{"type":"Identifier","start":23134,"end":23139,"name":"value"},"property":{"type":"Identifier","start":23140,"end":23148,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"ExpressionStatement","start":23199,"end":23430,"expression":{"type":"CallExpression","start":23199,"end":23429,"optional":false,"callee":{"type":"MemberExpression","start":23199,"end":23218,"computed":false,"optional":false,"object":{"type":"Identifier","start":23199,"end":23213,"name":"revokePromises"},"property":{"type":"Identifier","start":23214,"end":23218,"name":"push"}},"arguments":[{"type":"CallExpression","start":23219,"end":23428,"optional":false,"callee":{"type":"MemberExpression","start":23219,"end":23426,"computed":false,"optional":false,"object":{"type":"CallExpression","start":23219,"end":23416,"optional":false,"callee":{"type":"MemberExpression","start":23219,"end":23233,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":23219,"end":23228,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":23219,"end":23223},"property":{"type":"Identifier","start":23224,"end":23228,"name":"http"}},"property":{"type":"Identifier","start":23229,"end":23233,"name":"post"}},"arguments":[{"type":"MemberExpression","start":23234,"end":23260,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":23234,"end":23245,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":23234,"end":23238},"property":{"type":"Identifier","start":23239,"end":23245,"name":"config"}},"property":{"type":"Identifier","start":23246,"end":23260,"name":"revokeEndpoint"}},{"type":"CallExpression","start":23262,"end":23281,"optional":false,"callee":{"type":"MemberExpression","start":23262,"end":23279,"computed":false,"optional":false,"object":{"type":"Identifier","start":23262,"end":23270,"name":"formData"},"property":{"type":"Identifier","start":23271,"end":23279,"name":"toString"}},"arguments":[]},{"type":"ObjectExpression","start":23283,"end":23415,"properties":[{"type":"Property","start":23301,"end":23401,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":23301,"end":23308,"name":"headers"},"value":{"type":"ObjectExpression","start":23310,"end":23401,"properties":[{"type":"Property","start":23332,"end":23383,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":23332,"end":23346,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":23348,"end":23383,"value":"application/x-www-form-urlencoded","raw":"'application/x-www-form-urlencoded'"},"kind":"init"}]},"kind":"init"}]}]},"property":{"type":"Identifier","start":23417,"end":23426,"name":"toPromise"}},"arguments":[]}]}}]},"alternate":null},{"type":"IfStatement","start":23449,"end":24167,"test":{"type":"Identifier","start":23453,"end":23465,"name":"refreshToken"},"consequent":{"type":"BlockStatement","start":23467,"end":24167,"body":[{"type":"VariableDeclaration","start":23481,"end":23654,"kind":"const","declarations":[{"type":"VariableDeclarator","start":23487,"end":23653,"id":{"type":"Identifier","start":23487,"end":23500,"name":"revokeRequest"},"init":{"type":"ObjectExpression","start":23503,"end":23653,"properties":[{"type":"Property","start":23521,"end":23540,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":23521,"end":23526,"name":"token"},"value":{"type":"Identifier","start":23528,"end":23540,"name":"refreshToken"},"kind":"init"},{"type":"Property","start":23558,"end":23590,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":23558,"end":23573,"name":"token_type_hint"},"value":{"type":"Literal","start":23575,"end":23590,"value":"refresh_token","raw":"'refresh_token'"},"kind":"init"},{"type":"Property","start":23608,"end":23639,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":23608,"end":23617,"name":"client_id"},"value":{"type":"MemberExpression","start":23619,"end":23639,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":23619,"end":23630,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":23619,"end":23623},"property":{"type":"Identifier","start":23624,"end":23630,"name":"config"}},"property":{"type":"Identifier","start":23631,"end":23639,"name":"clientId"}},"kind":"init"}]}}]},{"type":"VariableDeclaration","start":23667,"end":23706,"kind":"const","declarations":[{"type":"VariableDeclarator","start":23673,"end":23705,"id":{"type":"Identifier","start":23673,"end":23681,"name":"formData"},"init":{"type":"NewExpression","start":23684,"end":23705,"callee":{"type":"Identifier","start":23688,"end":23703,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":23719,"end":23913,"expression":{"type":"CallExpression","start":23719,"end":23912,"optional":false,"callee":{"type":"MemberExpression","start":23719,"end":23756,"computed":false,"optional":false,"object":{"type":"CallExpression","start":23719,"end":23748,"optional":false,"callee":{"type":"MemberExpression","start":23719,"end":23733,"computed":false,"optional":false,"object":{"type":"Identifier","start":23719,"end":23725,"name":"Object"},"property":{"type":"Identifier","start":23726,"end":23733,"name":"entries"}},"arguments":[{"type":"Identifier","start":23734,"end":23747,"name":"revokeRequest"}]},"property":{"type":"Identifier","start":23749,"end":23756,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":23757,"end":23911,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":23758,"end":23770,"elements":[{"type":"Identifier","start":23759,"end":23762,"name":"key"},{"type":"Identifier","start":23764,"end":23769,"name":"value"}]}],"body":{"type":"BlockStatement","start":23775,"end":23911,"body":[{"type":"IfStatement","start":23793,"end":23897,"test":{"type":"BinaryExpression","start":23797,"end":23816,"operator":"!==","left":{"type":"Identifier","start":23797,"end":23802,"name":"value"},"right":{"type":"Identifier","start":23807,"end":23816,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":23818,"end":23897,"body":[{"type":"ExpressionStatement","start":23840,"end":23879,"expression":{"type":"CallExpression","start":23840,"end":23878,"optional":false,"callee":{"type":"MemberExpression","start":23840,"end":23855,"computed":false,"optional":false,"object":{"type":"Identifier","start":23840,"end":23848,"name":"formData"},"property":{"type":"Identifier","start":23849,"end":23855,"name":"append"}},"arguments":[{"type":"Identifier","start":23856,"end":23859,"name":"key"},{"type":"CallExpression","start":23861,"end":23877,"optional":false,"callee":{"type":"MemberExpression","start":23861,"end":23875,"computed":false,"optional":false,"object":{"type":"Identifier","start":23861,"end":23866,"name":"value"},"property":{"type":"Identifier","start":23867,"end":23875,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"ExpressionStatement","start":23926,"end":24157,"expression":{"type":"CallExpression","start":23926,"end":24156,"optional":false,"callee":{"type":"MemberExpression","start":23926,"end":23945,"computed":false,"optional":false,"object":{"type":"Identifier","start":23926,"end":23940,"name":"revokePromises"},"property":{"type":"Identifier","start":23941,"end":23945,"name":"push"}},"arguments":[{"type":"CallExpression","start":23946,"end":24155,"optional":false,"callee":{"type":"MemberExpression","start":23946,"end":24153,"computed":false,"optional":false,"object":{"type":"CallExpression","start":23946,"end":24143,"optional":false,"callee":{"type":"MemberExpression","start":23946,"end":23960,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":23946,"end":23955,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":23946,"end":23950},"property":{"type":"Identifier","start":23951,"end":23955,"name":"http"}},"property":{"type":"Identifier","start":23956,"end":23960,"name":"post"}},"arguments":[{"type":"MemberExpression","start":23961,"end":23987,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":23961,"end":23972,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":23961,"end":23965},"property":{"type":"Identifier","start":23966,"end":23972,"name":"config"}},"property":{"type":"Identifier","start":23973,"end":23987,"name":"revokeEndpoint"}},{"type":"CallExpression","start":23989,"end":24008,"optional":false,"callee":{"type":"MemberExpression","start":23989,"end":24006,"computed":false,"optional":false,"object":{"type":"Identifier","start":23989,"end":23997,"name":"formData"},"property":{"type":"Identifier","start":23998,"end":24006,"name":"toString"}},"arguments":[]},{"type":"ObjectExpression","start":24010,"end":24142,"properties":[{"type":"Property","start":24028,"end":24128,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":24028,"end":24035,"name":"headers"},"value":{"type":"ObjectExpression","start":24037,"end":24128,"properties":[{"type":"Property","start":24059,"end":24110,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":24059,"end":24073,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":24075,"end":24110,"value":"application/x-www-form-urlencoded","raw":"'application/x-www-form-urlencoded'"},"kind":"init"}]},"kind":"init"}]}]},"property":{"type":"Identifier","start":24144,"end":24153,"name":"toPromise"}},"arguments":[]}]}}]},"alternate":null},{"type":"IfStatement","start":24176,"end":24529,"test":{"type":"BinaryExpression","start":24180,"end":24205,"operator":">","left":{"type":"MemberExpression","start":24180,"end":24201,"computed":false,"optional":false,"object":{"type":"Identifier","start":24180,"end":24194,"name":"revokePromises"},"property":{"type":"Identifier","start":24195,"end":24201,"name":"length"}},"right":{"type":"Literal","start":24204,"end":24205,"raw":"0","value":0}},"consequent":{"type":"BlockStatement","start":24207,"end":24529,"body":[{"type":"TryStatement","start":24221,"end":24519,"block":{"type":"BlockStatement","start":24225,"end":24352,"body":[{"type":"ExpressionStatement","start":24243,"end":24277,"expression":{"type":"AwaitExpression","start":24243,"end":24276,"argument":{"type":"CallExpression","start":24249,"end":24276,"optional":false,"callee":{"type":"MemberExpression","start":24249,"end":24260,"computed":false,"optional":false,"object":{"type":"Identifier","start":24249,"end":24256,"name":"Promise"},"property":{"type":"Identifier","start":24257,"end":24260,"name":"all"}},"arguments":[{"type":"Identifier","start":24261,"end":24275,"name":"revokePromises"}]}}},{"type":"ExpressionStatement","start":24294,"end":24338,"expression":{"type":"CallExpression","start":24294,"end":24337,"optional":false,"callee":{"type":"MemberExpression","start":24294,"end":24306,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24294,"end":24298},"property":{"type":"Identifier","start":24299,"end":24306,"name":"logInfo"}},"arguments":[{"type":"Literal","start":24307,"end":24336,"value":"Tokens revoked successfully","raw":"'Tokens revoked successfully'"}]}}]},"handler":{"type":"CatchClause","start":24365,"end":24519,"param":{"type":"Identifier","start":24372,"end":24377,"name":"error"},"body":{"type":"BlockStatement","start":24379,"end":24519,"body":[{"type":"ExpressionStatement","start":24397,"end":24446,"expression":{"type":"CallExpression","start":24397,"end":24445,"optional":false,"callee":{"type":"MemberExpression","start":24397,"end":24410,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24397,"end":24401},"property":{"type":"Identifier","start":24402,"end":24410,"name":"logError"}},"arguments":[{"type":"Literal","start":24411,"end":24437,"value":"Token revocation failed:","raw":"'Token revocation failed:'"},{"type":"Identifier","start":24439,"end":24444,"name":"error"}]}}]}},"finalizer":null}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":24596,"end":25633,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":24596,"end":24610,"name":"storeTokenInfo"},"value":{"type":"FunctionExpression","start":24610,"end":25633,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":24611,"end":24620,"name":"tokenInfo"}],"body":{"type":"BlockStatement","start":24622,"end":25633,"body":[{"type":"TryStatement","start":24632,"end":25627,"block":{"type":"BlockStatement","start":24636,"end":25457,"body":[{"type":"ExpressionStatement","start":24650,"end":24735,"expression":{"type":"CallExpression","start":24650,"end":24734,"optional":false,"callee":{"type":"MemberExpression","start":24650,"end":24677,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":24650,"end":24669,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24650,"end":24654},"property":{"type":"Identifier","start":24655,"end":24669,"name":"storageService"}},"property":{"type":"Identifier","start":24670,"end":24677,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":24678,"end":24710,"computed":false,"optional":false,"object":{"type":"Identifier","start":24678,"end":24697,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":24698,"end":24710,"name":"ACCESS_TOKEN"}},{"type":"MemberExpression","start":24712,"end":24733,"computed":false,"optional":false,"object":{"type":"Identifier","start":24712,"end":24721,"name":"tokenInfo"},"property":{"type":"Identifier","start":24722,"end":24733,"name":"accessToken"}}]}},{"type":"ExpressionStatement","start":24748,"end":24846,"expression":{"type":"CallExpression","start":24748,"end":24845,"optional":false,"callee":{"type":"MemberExpression","start":24748,"end":24775,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":24748,"end":24767,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24748,"end":24752},"property":{"type":"Identifier","start":24753,"end":24767,"name":"storageService"}},"property":{"type":"Identifier","start":24768,"end":24775,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":24776,"end":24812,"computed":false,"optional":false,"object":{"type":"Identifier","start":24776,"end":24795,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":24796,"end":24812,"name":"TOKEN_EXPIRES_AT"}},{"type":"CallExpression","start":24814,"end":24844,"optional":false,"callee":{"type":"MemberExpression","start":24814,"end":24842,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":24814,"end":24833,"computed":false,"optional":false,"object":{"type":"Identifier","start":24814,"end":24823,"name":"tokenInfo"},"property":{"type":"Identifier","start":24824,"end":24833,"name":"expiresAt"}},"property":{"type":"Identifier","start":24834,"end":24842,"name":"toString"}},"arguments":[]}]}},{"type":"ExpressionStatement","start":24859,"end":24940,"expression":{"type":"CallExpression","start":24859,"end":24939,"optional":false,"callee":{"type":"MemberExpression","start":24859,"end":24886,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":24859,"end":24878,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24859,"end":24863},"property":{"type":"Identifier","start":24864,"end":24878,"name":"storageService"}},"property":{"type":"Identifier","start":24879,"end":24886,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":24887,"end":24917,"computed":false,"optional":false,"object":{"type":"Identifier","start":24887,"end":24906,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":24907,"end":24917,"name":"TOKEN_TYPE"}},{"type":"MemberExpression","start":24919,"end":24938,"computed":false,"optional":false,"object":{"type":"Identifier","start":24919,"end":24928,"name":"tokenInfo"},"property":{"type":"Identifier","start":24929,"end":24938,"name":"tokenType"}}]}},{"type":"IfStatement","start":24953,"end":25100,"test":{"type":"MemberExpression","start":24957,"end":24979,"computed":false,"optional":false,"object":{"type":"Identifier","start":24957,"end":24966,"name":"tokenInfo"},"property":{"type":"Identifier","start":24967,"end":24979,"name":"refreshToken"}},"consequent":{"type":"BlockStatement","start":24981,"end":25100,"body":[{"type":"ExpressionStatement","start":24999,"end":25086,"expression":{"type":"CallExpression","start":24999,"end":25085,"optional":false,"callee":{"type":"MemberExpression","start":24999,"end":25026,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":24999,"end":25018,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":24999,"end":25003},"property":{"type":"Identifier","start":25004,"end":25018,"name":"storageService"}},"property":{"type":"Identifier","start":25019,"end":25026,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":25027,"end":25060,"computed":false,"optional":false,"object":{"type":"Identifier","start":25027,"end":25046,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":25047,"end":25060,"name":"REFRESH_TOKEN"}},{"type":"MemberExpression","start":25062,"end":25084,"computed":false,"optional":false,"object":{"type":"Identifier","start":25062,"end":25071,"name":"tokenInfo"},"property":{"type":"Identifier","start":25072,"end":25084,"name":"refreshToken"}}]}}]},"alternate":null},{"type":"IfStatement","start":25113,"end":25238,"test":{"type":"MemberExpression","start":25117,"end":25132,"computed":false,"optional":false,"object":{"type":"Identifier","start":25117,"end":25126,"name":"tokenInfo"},"property":{"type":"Identifier","start":25127,"end":25132,"name":"scope"}},"consequent":{"type":"BlockStatement","start":25134,"end":25238,"body":[{"type":"ExpressionStatement","start":25152,"end":25224,"expression":{"type":"CallExpression","start":25152,"end":25223,"optional":false,"callee":{"type":"MemberExpression","start":25152,"end":25179,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":25152,"end":25171,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25152,"end":25156},"property":{"type":"Identifier","start":25157,"end":25171,"name":"storageService"}},"property":{"type":"Identifier","start":25172,"end":25179,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":25180,"end":25205,"computed":false,"optional":false,"object":{"type":"Identifier","start":25180,"end":25199,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":25200,"end":25205,"name":"SCOPE"}},{"type":"MemberExpression","start":25207,"end":25222,"computed":false,"optional":false,"object":{"type":"Identifier","start":25207,"end":25216,"name":"tokenInfo"},"property":{"type":"Identifier","start":25217,"end":25222,"name":"scope"}}]}}]},"alternate":null},{"type":"IfStatement","start":25251,"end":25383,"test":{"type":"MemberExpression","start":25255,"end":25272,"computed":false,"optional":false,"object":{"type":"Identifier","start":25255,"end":25264,"name":"tokenInfo"},"property":{"type":"Identifier","start":25265,"end":25272,"name":"idToken"}},"consequent":{"type":"BlockStatement","start":25274,"end":25383,"body":[{"type":"ExpressionStatement","start":25292,"end":25369,"expression":{"type":"CallExpression","start":25292,"end":25368,"optional":false,"callee":{"type":"MemberExpression","start":25292,"end":25319,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":25292,"end":25311,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25292,"end":25296},"property":{"type":"Identifier","start":25297,"end":25311,"name":"storageService"}},"property":{"type":"Identifier","start":25312,"end":25319,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":25320,"end":25348,"computed":false,"optional":false,"object":{"type":"Identifier","start":25320,"end":25339,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":25340,"end":25348,"name":"ID_TOKEN"}},{"type":"MemberExpression","start":25350,"end":25367,"computed":false,"optional":false,"object":{"type":"Identifier","start":25350,"end":25359,"name":"tokenInfo"},"property":{"type":"Identifier","start":25360,"end":25367,"name":"idToken"}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":25396,"end":25447,"expression":{"type":"CallExpression","start":25396,"end":25446,"optional":false,"callee":{"type":"MemberExpression","start":25396,"end":25409,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25396,"end":25400},"property":{"type":"Identifier","start":25401,"end":25409,"name":"logDebug"}},"arguments":[{"type":"Literal","start":25410,"end":25445,"value":"Token information stored securely","raw":"'Token information stored securely'"}]}}]},"handler":{"type":"CatchClause","start":25466,"end":25627,"param":{"type":"Identifier","start":25473,"end":25478,"name":"error"},"body":{"type":"BlockStatement","start":25480,"end":25627,"body":[{"type":"ExpressionStatement","start":25494,"end":25551,"expression":{"type":"CallExpression","start":25494,"end":25550,"optional":false,"callee":{"type":"MemberExpression","start":25494,"end":25507,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25494,"end":25498},"property":{"type":"Identifier","start":25499,"end":25507,"name":"logError"}},"arguments":[{"type":"Literal","start":25508,"end":25542,"value":"Error storing token information:","raw":"'Error storing token information:'"},{"type":"Identifier","start":25544,"end":25549,"name":"error"}]}},{"type":"ThrowStatement","start":25564,"end":25617,"argument":{"type":"NewExpression","start":25570,"end":25616,"callee":{"type":"Identifier","start":25574,"end":25579,"name":"Error"},"arguments":[{"type":"Literal","start":25580,"end":25615,"value":"Failed to store token information","raw":"'Failed to store token information'"}]}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":25695,"end":26773,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":25695,"end":25713,"name":"getStoredTokenInfo"},"value":{"type":"FunctionExpression","start":25713,"end":26773,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":25716,"end":26773,"body":[{"type":"IfStatement","start":25726,"end":25802,"test":{"type":"UnaryExpression","start":25730,"end":25764,"operator":"!","argument":{"type":"CallExpression","start":25731,"end":25764,"optional":false,"callee":{"type":"MemberExpression","start":25731,"end":25762,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":25731,"end":25750,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25731,"end":25735},"property":{"type":"Identifier","start":25736,"end":25750,"name":"storageService"}},"property":{"type":"Identifier","start":25751,"end":25762,"name":"isAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":25766,"end":25802,"body":[{"type":"ReturnStatement","start":25780,"end":25792,"argument":{"type":"Literal","start":25787,"end":25791,"raw":"null","value":null}}]},"alternate":null},{"type":"TryStatement","start":25811,"end":26767,"block":{"type":"BlockStatement","start":25815,"end":26628,"body":[{"type":"VariableDeclaration","start":25829,"end":25911,"kind":"const","declarations":[{"type":"VariableDeclarator","start":25835,"end":25910,"id":{"type":"Identifier","start":25835,"end":25846,"name":"accessToken"},"init":{"type":"CallExpression","start":25849,"end":25910,"optional":false,"callee":{"type":"MemberExpression","start":25849,"end":25876,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":25849,"end":25868,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25849,"end":25853},"property":{"type":"Identifier","start":25854,"end":25868,"name":"storageService"}},"property":{"type":"Identifier","start":25869,"end":25876,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":25877,"end":25909,"computed":false,"optional":false,"object":{"type":"Identifier","start":25877,"end":25896,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":25897,"end":25909,"name":"ACCESS_TOKEN"}}]}}]},{"type":"VariableDeclaration","start":25924,"end":26011,"kind":"const","declarations":[{"type":"VariableDeclarator","start":25930,"end":26010,"id":{"type":"Identifier","start":25930,"end":25942,"name":"expiresAtStr"},"init":{"type":"CallExpression","start":25945,"end":26010,"optional":false,"callee":{"type":"MemberExpression","start":25945,"end":25972,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":25945,"end":25964,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":25945,"end":25949},"property":{"type":"Identifier","start":25950,"end":25964,"name":"storageService"}},"property":{"type":"Identifier","start":25965,"end":25972,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":25973,"end":26009,"computed":false,"optional":false,"object":{"type":"Identifier","start":25973,"end":25992,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":25993,"end":26009,"name":"TOKEN_EXPIRES_AT"}}]}}]},{"type":"IfStatement","start":26024,"end":26103,"test":{"type":"LogicalExpression","start":26028,"end":26057,"operator":"||","left":{"type":"UnaryExpression","start":26028,"end":26040,"operator":"!","argument":{"type":"Identifier","start":26029,"end":26040,"name":"accessToken"},"prefix":true},"right":{"type":"UnaryExpression","start":26044,"end":26057,"operator":"!","argument":{"type":"Identifier","start":26045,"end":26057,"name":"expiresAtStr"},"prefix":true}},"consequent":{"type":"BlockStatement","start":26059,"end":26103,"body":[{"type":"ReturnStatement","start":26077,"end":26089,"argument":{"type":"Literal","start":26084,"end":26088,"raw":"null","value":null}}]},"alternate":null},{"type":"ReturnStatement","start":26116,"end":26618,"argument":{"type":"ObjectExpression","start":26123,"end":26617,"properties":[{"type":"Property","start":26141,"end":26152,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":26141,"end":26152,"name":"accessToken"},"value":{"type":"Identifier","start":26141,"end":26152,"name":"accessToken"},"kind":"init"},{"type":"Property","start":26170,"end":26259,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":26170,"end":26182,"name":"refreshToken"},"value":{"type":"LogicalExpression","start":26184,"end":26259,"operator":"||","left":{"type":"CallExpression","start":26184,"end":26246,"optional":false,"callee":{"type":"MemberExpression","start":26184,"end":26211,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":26184,"end":26203,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26184,"end":26188},"property":{"type":"Identifier","start":26189,"end":26203,"name":"storageService"}},"property":{"type":"Identifier","start":26204,"end":26211,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":26212,"end":26245,"computed":false,"optional":false,"object":{"type":"Identifier","start":26212,"end":26231,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":26232,"end":26245,"name":"REFRESH_TOKEN"}}]},"right":{"type":"Identifier","start":26250,"end":26259,"name":"undefined"}},"kind":"init"},{"type":"Property","start":26277,"end":26359,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":26277,"end":26286,"name":"tokenType"},"value":{"type":"LogicalExpression","start":26288,"end":26359,"operator":"||","left":{"type":"CallExpression","start":26288,"end":26347,"optional":false,"callee":{"type":"MemberExpression","start":26288,"end":26315,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":26288,"end":26307,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26288,"end":26292},"property":{"type":"Identifier","start":26293,"end":26307,"name":"storageService"}},"property":{"type":"Identifier","start":26308,"end":26315,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":26316,"end":26346,"computed":false,"optional":false,"object":{"type":"Identifier","start":26316,"end":26335,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":26336,"end":26346,"name":"TOKEN_TYPE"}}]},"right":{"type":"Literal","start":26351,"end":26359,"value":"Bearer","raw":"'Bearer'"}},"kind":"init"},{"type":"Property","start":26377,"end":26414,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":26377,"end":26386,"name":"expiresAt"},"value":{"type":"CallExpression","start":26388,"end":26414,"optional":false,"callee":{"type":"Identifier","start":26388,"end":26396,"name":"parseInt"},"arguments":[{"type":"Identifier","start":26397,"end":26409,"name":"expiresAtStr"},{"type":"Literal","start":26411,"end":26413,"raw":"10","value":10}]},"kind":"init"},{"type":"Property","start":26432,"end":26506,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":26432,"end":26437,"name":"scope"},"value":{"type":"LogicalExpression","start":26439,"end":26506,"operator":"||","left":{"type":"CallExpression","start":26439,"end":26493,"optional":false,"callee":{"type":"MemberExpression","start":26439,"end":26466,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":26439,"end":26458,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26439,"end":26443},"property":{"type":"Identifier","start":26444,"end":26458,"name":"storageService"}},"property":{"type":"Identifier","start":26459,"end":26466,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":26467,"end":26492,"computed":false,"optional":false,"object":{"type":"Identifier","start":26467,"end":26486,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":26487,"end":26492,"name":"SCOPE"}}]},"right":{"type":"Identifier","start":26497,"end":26506,"name":"undefined"}},"kind":"init"},{"type":"Property","start":26524,"end":26603,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":26524,"end":26531,"name":"idToken"},"value":{"type":"LogicalExpression","start":26533,"end":26603,"operator":"||","left":{"type":"CallExpression","start":26533,"end":26590,"optional":false,"callee":{"type":"MemberExpression","start":26533,"end":26560,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":26533,"end":26552,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26533,"end":26537},"property":{"type":"Identifier","start":26538,"end":26552,"name":"storageService"}},"property":{"type":"Identifier","start":26553,"end":26560,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":26561,"end":26589,"computed":false,"optional":false,"object":{"type":"Identifier","start":26561,"end":26580,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":26581,"end":26589,"name":"ID_TOKEN"}}]},"right":{"type":"Identifier","start":26594,"end":26603,"name":"undefined"}},"kind":"init"}]}}]},"handler":{"type":"CatchClause","start":26637,"end":26767,"param":{"type":"Identifier","start":26644,"end":26649,"name":"error"},"body":{"type":"BlockStatement","start":26651,"end":26767,"body":[{"type":"ExpressionStatement","start":26665,"end":26732,"expression":{"type":"CallExpression","start":26665,"end":26731,"optional":false,"callee":{"type":"MemberExpression","start":26665,"end":26678,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26665,"end":26669},"property":{"type":"Identifier","start":26670,"end":26678,"name":"logError"}},"arguments":[{"type":"Literal","start":26679,"end":26723,"value":"Error retrieving stored token information:","raw":"'Error retrieving stored token information:'"},{"type":"Identifier","start":26725,"end":26730,"name":"error"}]}},{"type":"ReturnStatement","start":26745,"end":26757,"argument":{"type":"Literal","start":26752,"end":26756,"raw":"null","value":null}}]}},"finalizer":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":26829,"end":27067,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":26829,"end":26844,"name":"updateAuthState"},"value":{"type":"FunctionExpression","start":26844,"end":27067,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":26845,"end":26853,"name":"newState"}],"body":{"type":"BlockStatement","start":26855,"end":27067,"body":[{"type":"VariableDeclaration","start":26865,"end":26904,"kind":"const","declarations":[{"type":"VariableDeclarator","start":26871,"end":26903,"id":{"type":"Identifier","start":26871,"end":26883,"name":"currentState"},"init":{"type":"CallExpression","start":26886,"end":26903,"optional":false,"callee":{"type":"MemberExpression","start":26886,"end":26901,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26886,"end":26890},"property":{"type":"Identifier","start":26891,"end":26901,"name":"_authState"}},"arguments":[]}}]},{"type":"VariableDeclaration","start":26913,"end":26967,"kind":"const","declarations":[{"type":"VariableDeclarator","start":26919,"end":26966,"id":{"type":"Identifier","start":26919,"end":26931,"name":"updatedState"},"init":{"type":"ObjectExpression","start":26934,"end":26966,"properties":[{"type":"SpreadElement","start":26936,"end":26951,"argument":{"type":"Identifier","start":26939,"end":26951,"name":"currentState"}},{"type":"SpreadElement","start":26953,"end":26964,"argument":{"type":"Identifier","start":26956,"end":26964,"name":"newState"}}]}}]},{"type":"ExpressionStatement","start":26976,"end":27010,"expression":{"type":"CallExpression","start":26976,"end":27009,"optional":false,"callee":{"type":"MemberExpression","start":26976,"end":26995,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":26976,"end":26991,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":26976,"end":26980},"property":{"type":"Identifier","start":26981,"end":26991,"name":"_authState"}},"property":{"type":"Identifier","start":26992,"end":26995,"name":"set"}},"arguments":[{"type":"Identifier","start":26996,"end":27008,"name":"updatedState"}]}},{"type":"ExpressionStatement","start":27019,"end":27061,"expression":{"type":"CallExpression","start":27019,"end":27060,"optional":false,"callee":{"type":"MemberExpression","start":27019,"end":27046,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":27019,"end":27041,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27019,"end":27023},"property":{"type":"Identifier","start":27024,"end":27041,"name":"_authStateSubject"}},"property":{"type":"Identifier","start":27042,"end":27046,"name":"next"}},"arguments":[{"type":"Identifier","start":27047,"end":27059,"name":"updatedState"}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":27109,"end":27258,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":27109,"end":27117,"name":"logDebug"},"value":{"type":"FunctionExpression","start":27117,"end":27258,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":27118,"end":27125,"name":"message"},{"type":"RestElement","start":27127,"end":27134,"argument":{"type":"Identifier","start":27130,"end":27134,"name":"args"}}],"body":{"type":"BlockStatement","start":27136,"end":27258,"body":[{"type":"IfStatement","start":27146,"end":27252,"test":{"type":"BinaryExpression","start":27150,"end":27175,"operator":"===","left":{"type":"MemberExpression","start":27150,"end":27163,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27150,"end":27154},"property":{"type":"Identifier","start":27155,"end":27163,"name":"logLevel"}},"right":{"type":"Literal","start":27168,"end":27175,"value":"debug","raw":"'debug'"}},"consequent":{"type":"BlockStatement","start":27177,"end":27252,"body":[{"type":"ExpressionStatement","start":27191,"end":27242,"expression":{"type":"CallExpression","start":27191,"end":27241,"optional":false,"callee":{"type":"MemberExpression","start":27191,"end":27202,"computed":false,"optional":false,"object":{"type":"Identifier","start":27191,"end":27198,"name":"console"},"property":{"type":"Identifier","start":27199,"end":27202,"name":"log"}},"arguments":[{"type":"TemplateLiteral","start":27203,"end":27231,"quasis":[{"type":"TemplateElement","start":27204,"end":27220,"tail":false,"value":{"cooked":"[OAuth2Service] ","raw":"[OAuth2Service] "}},{"type":"TemplateElement","start":27230,"end":27230,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":27222,"end":27229,"name":"message"}]},{"type":"SpreadElement","start":27233,"end":27240,"argument":{"type":"Identifier","start":27236,"end":27240,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":27299,"end":27464,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":27299,"end":27306,"name":"logInfo"},"value":{"type":"FunctionExpression","start":27306,"end":27464,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":27307,"end":27314,"name":"message"},{"type":"RestElement","start":27316,"end":27323,"argument":{"type":"Identifier","start":27319,"end":27323,"name":"args"}}],"body":{"type":"BlockStatement","start":27325,"end":27464,"body":[{"type":"IfStatement","start":27335,"end":27458,"test":{"type":"CallExpression","start":27339,"end":27380,"optional":false,"callee":{"type":"MemberExpression","start":27339,"end":27365,"computed":false,"optional":false,"object":{"type":"ArrayExpression","start":27339,"end":27356,"elements":[{"type":"Literal","start":27340,"end":27347,"value":"debug","raw":"'debug'"},{"type":"Literal","start":27349,"end":27355,"value":"info","raw":"'info'"}]},"property":{"type":"Identifier","start":27357,"end":27365,"name":"includes"}},"arguments":[{"type":"MemberExpression","start":27366,"end":27379,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27366,"end":27370},"property":{"type":"Identifier","start":27371,"end":27379,"name":"logLevel"}}]},"consequent":{"type":"BlockStatement","start":27382,"end":27458,"body":[{"type":"ExpressionStatement","start":27396,"end":27448,"expression":{"type":"CallExpression","start":27396,"end":27447,"optional":false,"callee":{"type":"MemberExpression","start":27396,"end":27408,"computed":false,"optional":false,"object":{"type":"Identifier","start":27396,"end":27403,"name":"console"},"property":{"type":"Identifier","start":27404,"end":27408,"name":"info"}},"arguments":[{"type":"TemplateLiteral","start":27409,"end":27437,"quasis":[{"type":"TemplateElement","start":27410,"end":27426,"tail":false,"value":{"cooked":"[OAuth2Service] ","raw":"[OAuth2Service] "}},{"type":"TemplateElement","start":27436,"end":27436,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":27428,"end":27435,"name":"message"}]},{"type":"SpreadElement","start":27439,"end":27446,"argument":{"type":"Identifier","start":27442,"end":27446,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":27508,"end":27681,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":27508,"end":27515,"name":"logWarn"},"value":{"type":"FunctionExpression","start":27515,"end":27681,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":27516,"end":27523,"name":"message"},{"type":"RestElement","start":27525,"end":27532,"argument":{"type":"Identifier","start":27528,"end":27532,"name":"args"}}],"body":{"type":"BlockStatement","start":27534,"end":27681,"body":[{"type":"IfStatement","start":27544,"end":27675,"test":{"type":"CallExpression","start":27548,"end":27597,"optional":false,"callee":{"type":"MemberExpression","start":27548,"end":27582,"computed":false,"optional":false,"object":{"type":"ArrayExpression","start":27548,"end":27573,"elements":[{"type":"Literal","start":27549,"end":27556,"value":"debug","raw":"'debug'"},{"type":"Literal","start":27558,"end":27564,"value":"info","raw":"'info'"},{"type":"Literal","start":27566,"end":27572,"value":"warn","raw":"'warn'"}]},"property":{"type":"Identifier","start":27574,"end":27582,"name":"includes"}},"arguments":[{"type":"MemberExpression","start":27583,"end":27596,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27583,"end":27587},"property":{"type":"Identifier","start":27588,"end":27596,"name":"logLevel"}}]},"consequent":{"type":"BlockStatement","start":27599,"end":27675,"body":[{"type":"ExpressionStatement","start":27613,"end":27665,"expression":{"type":"CallExpression","start":27613,"end":27664,"optional":false,"callee":{"type":"MemberExpression","start":27613,"end":27625,"computed":false,"optional":false,"object":{"type":"Identifier","start":27613,"end":27620,"name":"console"},"property":{"type":"Identifier","start":27621,"end":27625,"name":"warn"}},"arguments":[{"type":"TemplateLiteral","start":27626,"end":27654,"quasis":[{"type":"TemplateElement","start":27627,"end":27643,"tail":false,"value":{"cooked":"[OAuth2Service] ","raw":"[OAuth2Service] "}},{"type":"TemplateElement","start":27653,"end":27653,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":27645,"end":27652,"name":"message"}]},{"type":"SpreadElement","start":27656,"end":27663,"argument":{"type":"Identifier","start":27659,"end":27663,"name":"args"}}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":27723,"end":27869,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":27723,"end":27731,"name":"logError"},"value":{"type":"FunctionExpression","start":27731,"end":27869,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":27732,"end":27739,"name":"message"},{"type":"Identifier","start":27741,"end":27746,"name":"error"}],"body":{"type":"BlockStatement","start":27748,"end":27869,"body":[{"type":"IfStatement","start":27758,"end":27863,"test":{"type":"BinaryExpression","start":27762,"end":27786,"operator":"!==","left":{"type":"MemberExpression","start":27762,"end":27775,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27762,"end":27766},"property":{"type":"Identifier","start":27767,"end":27775,"name":"logLevel"}},"right":{"type":"Literal","start":27780,"end":27786,"value":"none","raw":"'none'"}},"consequent":{"type":"BlockStatement","start":27788,"end":27863,"body":[{"type":"ExpressionStatement","start":27802,"end":27853,"expression":{"type":"CallExpression","start":27802,"end":27852,"optional":false,"callee":{"type":"MemberExpression","start":27802,"end":27815,"computed":false,"optional":false,"object":{"type":"Identifier","start":27802,"end":27809,"name":"console"},"property":{"type":"Identifier","start":27810,"end":27815,"name":"error"}},"arguments":[{"type":"TemplateLiteral","start":27816,"end":27844,"quasis":[{"type":"TemplateElement","start":27817,"end":27833,"tail":false,"value":{"cooked":"[OAuth2Service] ","raw":"[OAuth2Service] "}},{"type":"TemplateElement","start":27843,"end":27843,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":27835,"end":27842,"name":"message"}]},{"type":"Identifier","start":27846,"end":27851,"name":"error"}]}}]},"alternate":null}]},"expression":false},"kind":"method"},{"type":"StaticBlock","start":27874,"end":28150,"body":[{"type":"ExpressionStatement","start":27883,"end":28148,"expression":{"type":"AssignmentExpression","start":27883,"end":28147,"operator":"=","left":{"type":"MemberExpression","start":27883,"end":27892,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":27883,"end":27887},"property":{"type":"Identifier","start":27888,"end":27892,"name":"ɵfac"}},"right":{"type":"FunctionExpression","start":27895,"end":28147,"async":false,"generator":false,"id":{"type":"Identifier","start":27904,"end":27925,"name":"OAuth2Service_Factory"},"params":[{"type":"Identifier","start":27926,"end":27943,"name":"__ngFactoryType__"}],"body":{"type":"BlockStatement","start":27945,"end":28147,"body":[{"type":"ReturnStatement","start":27947,"end":28145,"argument":{"type":"NewExpression","start":27954,"end":28144,"callee":{"type":"LogicalExpression","start":27959,"end":27993,"operator":"||","left":{"type":"Identifier","start":27959,"end":27976,"name":"__ngFactoryType__"},"right":{"type":"Identifier","start":27980,"end":27993,"name":"OAuth2Service"}},"arguments":[{"type":"CallExpression","start":27995,"end":28027,"optional":false,"callee":{"type":"MemberExpression","start":27995,"end":28006,"computed":false,"optional":false,"object":{"type":"Identifier","start":27995,"end":27997,"name":"i0"},"property":{"type":"Identifier","start":27998,"end":28006,"name":"ɵɵinject"}},"arguments":[{"type":"Identifier","start":28007,"end":28026,"name":"OAUTH2_CONFIG_TOKEN"}]},{"type":"CallExpression","start":28029,"end":28053,"optional":false,"callee":{"type":"MemberExpression","start":28029,"end":28040,"computed":false,"optional":false,"object":{"type":"Identifier","start":28029,"end":28031,"name":"i0"},"property":{"type":"Identifier","start":28032,"end":28040,"name":"ɵɵinject"}},"arguments":[{"type":"Identifier","start":28041,"end":28052,"name":"PLATFORM_ID"}]},{"type":"CallExpression","start":28055,"end":28081,"optional":false,"callee":{"type":"MemberExpression","start":28055,"end":28066,"computed":false,"optional":false,"object":{"type":"Identifier","start":28055,"end":28057,"name":"i0"},"property":{"type":"Identifier","start":28058,"end":28066,"name":"ɵɵinject"}},"arguments":[{"type":"MemberExpression","start":28067,"end":28080,"computed":false,"optional":false,"object":{"type":"Identifier","start":28067,"end":28069,"name":"i1"},"property":{"type":"Identifier","start":28070,"end":28080,"name":"HttpClient"}}]},{"type":"CallExpression","start":28083,"end":28105,"optional":false,"callee":{"type":"MemberExpression","start":28083,"end":28094,"computed":false,"optional":false,"object":{"type":"Identifier","start":28083,"end":28085,"name":"i0"},"property":{"type":"Identifier","start":28086,"end":28094,"name":"ɵɵinject"}},"arguments":[{"type":"MemberExpression","start":28095,"end":28104,"computed":false,"optional":false,"object":{"type":"Identifier","start":28095,"end":28097,"name":"i2"},"property":{"type":"Identifier","start":28098,"end":28104,"name":"Router"}}]},{"type":"CallExpression","start":28107,"end":28143,"optional":false,"callee":{"type":"MemberExpression","start":28107,"end":28118,"computed":false,"optional":false,"object":{"type":"Identifier","start":28107,"end":28109,"name":"i0"},"property":{"type":"Identifier","start":28110,"end":28118,"name":"ɵɵinject"}},"arguments":[{"type":"MemberExpression","start":28119,"end":28142,"computed":false,"optional":false,"object":{"type":"Identifier","start":28119,"end":28121,"name":"i3"},"property":{"type":"Identifier","start":28122,"end":28142,"name":"OAuth2StorageService"}}]}]}}]},"expression":false}}}]},{"type":"StaticBlock","start":28155,"end":28290,"body":[{"type":"ExpressionStatement","start":28164,"end":28288,"expression":{"type":"AssignmentExpression","start":28164,"end":28287,"operator":"=","left":{"type":"MemberExpression","start":28164,"end":28174,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":28164,"end":28168},"property":{"type":"Identifier","start":28169,"end":28174,"name":"ɵprov"}},"right":{"type":"CallExpression","start":28191,"end":28287,"optional":false,"_rollupAnnotations":[{"end":28190,"start":28177,"type":"pure"}],"callee":{"type":"MemberExpression","start":28191,"end":28212,"computed":false,"optional":false,"object":{"type":"Identifier","start":28191,"end":28193,"name":"i0"},"property":{"type":"Identifier","start":28194,"end":28212,"name":"ɵɵdefineInjectable"}},"arguments":[{"type":"ObjectExpression","start":28213,"end":28286,"properties":[{"type":"Property","start":28215,"end":28235,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28215,"end":28220,"name":"token"},"value":{"type":"Identifier","start":28222,"end":28235,"name":"OAuth2Service"},"kind":"init"},{"type":"Property","start":28237,"end":28264,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28237,"end":28244,"name":"factory"},"value":{"type":"MemberExpression","start":28246,"end":28264,"computed":false,"optional":false,"object":{"type":"Identifier","start":28246,"end":28259,"name":"OAuth2Service"},"property":{"type":"Identifier","start":28260,"end":28264,"name":"ɵfac"}},"kind":"init"},{"type":"Property","start":28266,"end":28284,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28266,"end":28276,"name":"providedIn"},"value":{"type":"Literal","start":28278,"end":28284,"value":"root","raw":"'root'"},"kind":"init"}]}]}}}]}]}}},{"type":"ExpressionStatement","start":28293,"end":28835,"expression":{"type":"CallExpression","start":28293,"end":28834,"optional":false,"callee":{"type":"ArrowFunctionExpression","start":28294,"end":28831,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":28300,"end":28831,"body":[{"type":"ExpressionStatement","start":28302,"end":28829,"expression":{"type":"LogicalExpression","start":28302,"end":28828,"operator":"&&","left":{"type":"LogicalExpression","start":28303,"end":28348,"operator":"||","left":{"type":"BinaryExpression","start":28303,"end":28335,"operator":"===","left":{"type":"UnaryExpression","start":28303,"end":28319,"operator":"typeof","argument":{"type":"Identifier","start":28310,"end":28319,"name":"ngDevMode"},"prefix":true},"right":{"type":"Literal","start":28324,"end":28335,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":28339,"end":28348,"name":"ngDevMode"}},"right":{"type":"CallExpression","start":28353,"end":28828,"optional":false,"callee":{"type":"MemberExpression","start":28353,"end":28373,"computed":false,"optional":false,"object":{"type":"Identifier","start":28353,"end":28355,"name":"i0"},"property":{"type":"Identifier","start":28356,"end":28373,"name":"ɵsetClassMetadata"}},"arguments":[{"type":"Identifier","start":28374,"end":28387,"name":"OAuth2Service"},{"type":"ArrayExpression","start":28389,"end":28491,"elements":[{"type":"ObjectExpression","start":28390,"end":28490,"properties":[{"type":"Property","start":28400,"end":28416,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28400,"end":28404,"name":"type"},"value":{"type":"Identifier","start":28406,"end":28416,"name":"Injectable"},"kind":"init"},{"type":"Property","start":28426,"end":28484,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28426,"end":28430,"name":"args"},"value":{"type":"ArrayExpression","start":28432,"end":28484,"elements":[{"type":"ObjectExpression","start":28433,"end":28483,"properties":[{"type":"Property","start":28451,"end":28469,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28451,"end":28461,"name":"providedIn"},"value":{"type":"Literal","start":28463,"end":28469,"value":"root","raw":"'root'"},"kind":"init"}]}]},"kind":"init"}]}]},{"type":"ArrowFunctionExpression","start":28493,"end":28821,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"ArrayExpression","start":28499,"end":28821,"elements":[{"type":"ObjectExpression","start":28500,"end":28624,"properties":[{"type":"Property","start":28502,"end":28517,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28502,"end":28506,"name":"type"},"value":{"type":"Identifier","start":28508,"end":28517,"name":"undefined"},"kind":"init"},{"type":"Property","start":28519,"end":28622,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28519,"end":28529,"name":"decorators"},"value":{"type":"ArrayExpression","start":28531,"end":28622,"elements":[{"type":"ObjectExpression","start":28532,"end":28621,"properties":[{"type":"Property","start":28550,"end":28562,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28550,"end":28554,"name":"type"},"value":{"type":"Identifier","start":28556,"end":28562,"name":"Inject"},"kind":"init"},{"type":"Property","start":28580,"end":28607,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28580,"end":28584,"name":"args"},"value":{"type":"ArrayExpression","start":28586,"end":28607,"elements":[{"type":"Identifier","start":28587,"end":28606,"name":"OAUTH2_CONFIG_TOKEN"}]},"kind":"init"}]}]},"kind":"init"}]},{"type":"ObjectExpression","start":28626,"end":28739,"properties":[{"type":"Property","start":28628,"end":28640,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28628,"end":28632,"name":"type"},"value":{"type":"Identifier","start":28634,"end":28640,"name":"Object"},"kind":"init"},{"type":"Property","start":28642,"end":28737,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28642,"end":28652,"name":"decorators"},"value":{"type":"ArrayExpression","start":28654,"end":28737,"elements":[{"type":"ObjectExpression","start":28655,"end":28736,"properties":[{"type":"Property","start":28673,"end":28685,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28673,"end":28677,"name":"type"},"value":{"type":"Identifier","start":28679,"end":28685,"name":"Inject"},"kind":"init"},{"type":"Property","start":28703,"end":28722,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28703,"end":28707,"name":"args"},"value":{"type":"ArrayExpression","start":28709,"end":28722,"elements":[{"type":"Identifier","start":28710,"end":28721,"name":"PLATFORM_ID"}]},"kind":"init"}]}]},"kind":"init"}]},{"type":"ObjectExpression","start":28741,"end":28764,"properties":[{"type":"Property","start":28743,"end":28762,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28743,"end":28747,"name":"type"},"value":{"type":"MemberExpression","start":28749,"end":28762,"computed":false,"optional":false,"object":{"type":"Identifier","start":28749,"end":28751,"name":"i1"},"property":{"type":"Identifier","start":28752,"end":28762,"name":"HttpClient"}},"kind":"init"}]},{"type":"ObjectExpression","start":28766,"end":28785,"properties":[{"type":"Property","start":28768,"end":28783,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28768,"end":28772,"name":"type"},"value":{"type":"MemberExpression","start":28774,"end":28783,"computed":false,"optional":false,"object":{"type":"Identifier","start":28774,"end":28776,"name":"i2"},"property":{"type":"Identifier","start":28777,"end":28783,"name":"Router"}},"kind":"init"}]},{"type":"ObjectExpression","start":28787,"end":28820,"properties":[{"type":"Property","start":28789,"end":28818,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":28789,"end":28793,"name":"type"},"value":{"type":"MemberExpression","start":28795,"end":28818,"computed":false,"optional":false,"object":{"type":"Identifier","start":28795,"end":28797,"name":"i3"},"property":{"type":"Identifier","start":28798,"end":28818,"name":"OAuth2StorageService"}},"kind":"init"}]}]},"id":null},{"type":"Literal","start":28823,"end":28827,"raw":"null","value":null}]}}}]},"id":null},"arguments":[]}}],"_rollupRemoved":[{"end":95718,"start":28836,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { Injectable, Inject, PLATFORM_ID, signal } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { BehaviorSubject } from 'rxjs';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"./oauth2-storage.service\";\n/**\n * OAuth2 Service with PKCE Support\n * Handles OAuth2 authorization flow, token management, and user authentication\n */\nexport class OAuth2Service {\n    constructor(config, platformId, http, router, storageService) {\n        this.config = config;\n        this.platformId = platformId;\n        this.http = http;\n        this.router = router;\n        this.storageService = storageService;\n        this._authState = signal({\n            isAuthenticated: false,\n            isLoading: false\n        });\n        this._authStateSubject = new BehaviorSubject({\n            isAuthenticated: false,\n            isLoading: false\n        });\n        this.authState$ = this._authStateSubject.asObservable();\n        this.authState = this._authState.asReadonly();\n        this.logLevel = config.logLevel || 'warn';\n        this.initializeAuthState();\n    }\n    /**\n     * Initialize authentication state from stored tokens\n     */\n    initializeAuthState() {\n        if (!isPlatformBrowser(this.platformId)) {\n            return;\n        }\n        try {\n            const tokenInfo = this.getStoredTokenInfo();\n            if (tokenInfo && this.isTokenValid(tokenInfo)) {\n                this.updateAuthState({\n                    isAuthenticated: true,\n                    isLoading: false,\n                    tokenInfo\n                });\n                this.logInfo('Authentication state initialized from stored tokens');\n            }\n            else if (tokenInfo && tokenInfo.refreshToken) {\n                // Access token is expired but refresh token exists\n                this.logInfo('Access token expired but refresh token available - preserving for refresh flow');\n                this.updateAuthState({\n                    isAuthenticated: false,\n                    isLoading: false,\n                    tokenInfo: undefined\n                });\n            }\n            else {\n                // No tokens or no refresh token available - clear everything\n                this.storageService.clearTokens();\n                this.logInfo('No valid stored tokens found');\n            }\n        }\n        catch (error) {\n            this.logError('Error initializing auth state:', error);\n            this.storageService.clearTokens();\n        }\n    }\n    /**\n     * Generate cryptographically secure PKCE challenge\n     */\n    async generatePKCEChallenge() {\n        const codeVerifier = this.generateSecureCodeVerifier();\n        const codeChallenge = await this.createCodeChallenge(codeVerifier);\n        return {\n            codeVerifier,\n            codeChallenge,\n            codeChallengeMethod: this.config.codeChallengeMethod || 'S256'\n        };\n    }\n    /**\n     * Generate cryptographically secure 6-digit code verifier\n     */\n    generateSecureCodeVerifier() {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Code verifier generation requires browser environment');\n        }\n        // Generate 6 cryptographically secure random digits\n        const array = new Uint8Array(6);\n        crypto.getRandomValues(array);\n        // Convert to 6-digit string (000000-999999)\n        const codeVerifier = Array.from(array)\n            .map(byte => (byte % 10).toString())\n            .join('');\n        this.logDebug('Generated secure 6-digit code verifier');\n        return codeVerifier;\n    }\n    /**\n     * Create SHA-256 hash and base64 encode for code challenge\n     */\n    async createCodeChallenge(codeVerifier) {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Code challenge creation requires browser environment');\n        }\n        try {\n            // Encode the code verifier as UTF-8\n            const encoder = new TextEncoder();\n            const data = encoder.encode(codeVerifier);\n            // Create SHA-256 hash\n            const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n            // Convert to base64url encoding\n            const hashArray = new Uint8Array(hashBuffer);\n            const base64String = btoa(String.fromCharCode(...hashArray))\n                .replace(/\\+/g, '-')\n                .replace(/\\//g, '_')\n                .replace(/=/g, '');\n            this.logDebug('Generated code challenge from verifier');\n            return base64String;\n        }\n        catch (error) {\n            this.logError('Error creating code challenge:', error);\n            throw new Error('Failed to create code challenge');\n        }\n    }\n    /**\n     * Generate cryptographically secure state parameter for CSRF protection\n     */\n    generateState() {\n        if (!isPlatformBrowser(this.platformId)) {\n            return 'fallback-state';\n        }\n        const array = new Uint8Array(32);\n        crypto.getRandomValues(array);\n        return btoa(String.fromCharCode(...array))\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=/g, '');\n    }\n    /**\n     * Generate nonce if not provided in config\n     */\n    generateNonce() {\n        if (this.config.nonce) {\n            return this.config.nonce;\n        }\n        if (!isPlatformBrowser(this.platformId)) {\n            return 'fallback-nonce';\n        }\n        const array = new Uint8Array(16);\n        crypto.getRandomValues(array);\n        return btoa(String.fromCharCode(...array))\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=/g, '');\n    }\n    /**\n     * Start OAuth2 PKCE authorization flow\n     */\n    async startAuthorization() {\n        if (!isPlatformBrowser(this.platformId)) {\n            this.logError('Authorization attempted in non-browser environment', 'SSR or server context detected');\n            this.updateAuthState({\n                isLoading: false,\n                error: 'Authentication not available in server environment'\n            });\n            return;\n        }\n        try {\n            this.updateAuthState({ isLoading: true, error: undefined });\n            // Generate PKCE challenge\n            const pkceChallenge = await this.generatePKCEChallenge();\n            // Generate state for CSRF protection\n            const state = this.generateState();\n            // Generate nonce\n            const nonce = this.generateNonce();\n            // Store code verifier, state, and nonce securely\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER, pkceChallenge.codeVerifier);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.STATE, state);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.NONCE, nonce);\n            // Build authorization request\n            const authRequest = {\n                client_id: this.config.clientId,\n                redirect_uri: this.config.redirectUri,\n                response_type: this.config.responseType || 'code',\n                nonce,\n                audience: this.config.audience,\n                scope: this.config.scope,\n                code_challenge_method: pkceChallenge.codeChallengeMethod,\n                code_challenge: pkceChallenge.codeChallenge,\n                state\n            };\n            // Build authorization URL\n            const authUrl = this.buildAuthorizationUrl(authRequest);\n            this.logInfo('Starting OAuth2 PKCE authorization flow');\n            this.logDebug('Authorization URL:', authUrl);\n            // Redirect to authorization server\n            window.location.href = authUrl;\n        }\n        catch (error) {\n            this.logError('Error starting authorization:', error);\n            this.updateAuthState({\n                isLoading: false,\n                error: 'Failed to start authorization flow'\n            });\n            throw error;\n        }\n    }\n    /**\n     * Build authorization URL with parameters\n     */\n    buildAuthorizationUrl(request) {\n        const params = new URLSearchParams();\n        Object.entries(request).forEach(([key, value]) => {\n            if (value !== undefined) {\n                params.append(key, value.toString());\n            }\n        });\n        return `${this.config.authorizationEndpoint}?${params.toString()}`;\n    }\n    /**\n     * Handle OAuth2 callback and extract tokens\n     */\n    async handleCallback() {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Callback handling requires browser environment');\n        }\n        try {\n            this.updateAuthState({ isLoading: true, error: undefined });\n            const currentUrl = window.location.href;\n            this.logInfo('Handling OAuth2 callback:', currentUrl);\n            // Check for error in callback\n            const error = this.extractErrorFromCallback();\n            if (error) {\n                throw new Error(`OAuth2 Error: ${error.error} - ${error.error_description || 'Unknown error'}`);\n            }\n            // Extract authorization code from query parameters or hash fragment\n            const authCode = this.extractAuthorizationCode();\n            this.logDebug('Extracted authorization code:', authCode ? 'Found' : 'Not found');\n            if (authCode) {\n                await this.exchangeCodeForTokens(authCode);\n                return;\n            }\n            // Extract tokens from URL fragment (implicit flow)\n            const tokens = this.extractTokensFromFragment();\n            this.logDebug('Extracted tokens from fragment:', tokens ? 'Found' : 'Not found');\n            if (tokens) {\n                await this.handleTokenResponse(tokens);\n                return;\n            }\n            throw new Error('No authorization code or tokens found in callback');\n        }\n        catch (error) {\n            this.logError('Error handling callback:', error);\n            this.updateAuthState({\n                isLoading: false,\n                error: error instanceof Error ? error.message : 'Callback handling failed'\n            });\n            this.storageService.clearAll();\n            throw error;\n        }\n    }\n    /**\n     * Extract error from callback URL\n     */\n    extractErrorFromCallback() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const hashParams = new URLSearchParams(window.location.hash.substring(1));\n        const error = urlParams.get('error') || hashParams.get('error');\n        if (error) {\n            return {\n                error,\n                error_description: urlParams.get('error_description') || hashParams.get('error_description') || undefined,\n                error_uri: urlParams.get('error_uri') || hashParams.get('error_uri') || undefined,\n                state: urlParams.get('state') || hashParams.get('state') || undefined\n            };\n        }\n        return null;\n    }\n    /**\n     * Extract authorization code from query parameters\n     */\n    extractAuthorizationCode() {\n        // First check query parameters\n        const urlParams = new URLSearchParams(window.location.search);\n        let code = urlParams.get('code');\n        // If not found in query params, check hash fragment\n        if (!code && window.location.hash) {\n            const hashParams = new URLSearchParams(window.location.hash.substring(1));\n            code = hashParams.get('code');\n        }\n        if (code) {\n            this.logDebug('Authorization code extracted from callback');\n            return code;\n        }\n        return null;\n    }\n    /**\n     * Extract tokens from URL fragment\n     */\n    extractTokensFromFragment() {\n        const fragment = window.location.hash.substring(1);\n        if (!fragment) {\n            return null;\n        }\n        const params = new URLSearchParams(fragment);\n        const accessToken = params.get('access_token');\n        if (accessToken) {\n            this.logDebug('Tokens extracted from URL fragment');\n            return {\n                access_token: accessToken,\n                refresh_token: params.get('refresh_token') || undefined,\n                token_type: params.get('token_type') || 'Bearer',\n                expires_in: parseInt(params.get('expires_in') || '3600', 10),\n                scope: params.get('scope') || undefined,\n                id_token: params.get('id_token') || undefined\n            };\n        }\n        return null;\n    }\n    /**\n     * Exchange authorization code for tokens\n     */\n    async exchangeCodeForTokens(authCode) {\n        const codeVerifier = this.storageService.getItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\n        if (!codeVerifier) {\n            this.logError('Code verifier not found in storage');\n            throw new Error('Code verifier not found in storage');\n        }\n        const tokenRequest = {\n            grant_type: 'authorization_code',\n            redirect_uri: this.config.redirectUri,\n            client_id: this.config.clientId,\n            code: authCode,\n            code_verifier: codeVerifier\n        };\n        this.logInfo('Exchanging authorization code for tokens');\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequest).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        try {\n            const tokenResponse = await this.http.post(this.config.tokenEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise();\n            if (tokenResponse) {\n                await this.handleTokenResponse(tokenResponse);\n            }\n            else {\n                throw new Error('No token response received');\n            }\n        }\n        catch (error) {\n            this.logError('Token exchange failed:', error);\n            throw new Error('Failed to exchange authorization code for tokens');\n        }\n    }\n    /**\n     * Handle token response and store tokens securely\n     */\n    async handleTokenResponse(tokenResponse) {\n        try {\n            // Validate state parameter for CSRF protection\n            await this.validateState();\n            // Create token info\n            const tokenInfo = {\n                accessToken: tokenResponse.access_token,\n                refreshToken: tokenResponse.refresh_token,\n                tokenType: tokenResponse.token_type || 'Bearer',\n                expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\n                scope: tokenResponse.scope,\n                idToken: tokenResponse.id_token\n            };\n            // Store tokens securely\n            this.storeTokenInfo(tokenInfo);\n            // Update authentication state\n            this.updateAuthState({\n                isAuthenticated: true,\n                isLoading: false,\n                tokenInfo,\n                error: undefined\n            });\n            // Clean up temporary storage\n            this.storageService.clearTemporary();\n            this.logInfo('Tokens stored successfully, user authenticated');\n        }\n        catch (error) {\n            this.logError('Error handling token response:', error);\n            throw error;\n        }\n    }\n    /**\n     * Validate state parameter for CSRF protection\n     */\n    async validateState() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const hashParams = new URLSearchParams(window.location.hash.substring(1));\n        const receivedState = urlParams.get('state') || hashParams.get('state');\n        const storedState = this.storageService.getItem(OAUTH2_STORAGE_KEYS.STATE);\n        if (!receivedState || !storedState || receivedState !== storedState) {\n            throw new Error('Invalid state parameter - possible CSRF attack');\n        }\n        this.logDebug('State parameter validated successfully');\n    }\n    /**\n     * Get current access token (only if valid/not expired)\n     */\n    getAccessToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        if (tokenInfo && this.isTokenValid(tokenInfo)) {\n            return tokenInfo.accessToken;\n        }\n        return null;\n    }\n    /**\n     * Get raw access token (even if expired) - used for refresh flow\n     */\n    getRawAccessToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo?.accessToken || null;\n    }\n    /**\n     * Get current refresh token\n     */\n    getRefreshToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo?.refreshToken || null;\n    }\n    /**\n     * Check if user is authenticated\n     */\n    isAuthenticated() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo ? this.isTokenValid(tokenInfo) : false;\n    }\n    /**\n     * Check if authentication is available in current environment\n     */\n    isAuthenticationAvailable() {\n        return isPlatformBrowser(this.platformId);\n    }\n    /**\n     * Fetch user information from OIDC userinfo endpoint\n     */\n    async getUserInfo() {\n        if (!this.config.userInfoEndpoint) {\n            throw new Error('UserInfo endpoint not configured');\n        }\n        const accessToken = this.getAccessToken();\n        if (!accessToken) {\n            throw new Error('No access token available');\n        }\n        this.logInfo('Fetching user info from OIDC userinfo endpoint');\n        try {\n            const userInfo = await this.http.get(this.config.userInfoEndpoint, {\n                headers: {\n                    'Authorization': `Bearer ${accessToken}`\n                }\n            }).toPromise();\n            if (userInfo) {\n                this.logDebug('User info retrieved successfully:', userInfo);\n                return userInfo;\n            }\n            else {\n                throw new Error('No user info response received');\n            }\n        }\n        catch (error) {\n            this.logError('Failed to fetch user info:', error);\n            throw new Error('Failed to fetch user information');\n        }\n    }\n    /**\n     * Check if token is valid (not expired)\n     */\n    isTokenValid(tokenInfo) {\n        const threshold = (this.config.refreshThreshold || 300) * 1000; // Convert to milliseconds\n        return Date.now() < (tokenInfo.expiresAt - threshold);\n    }\n    /**\n     * Refresh access token using refresh token\n     */\n    async refreshAccessToken() {\n        const refreshToken = this.getRefreshToken();\n        if (!refreshToken) {\n            throw new Error('No refresh token available');\n        }\n        this.logInfo('Refreshing access token');\n        const tokenRequest = {\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: this.config.clientId\n        };\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequest).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        try {\n            const tokenResponse = await this.http.post(this.config.tokenEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise();\n            if (tokenResponse) {\n                const tokenInfo = {\n                    accessToken: tokenResponse.access_token,\n                    refreshToken: tokenResponse.refresh_token || refreshToken,\n                    tokenType: tokenResponse.token_type || 'Bearer',\n                    expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\n                    scope: tokenResponse.scope,\n                    idToken: tokenResponse.id_token\n                };\n                this.storeTokenInfo(tokenInfo);\n                this.updateAuthState({\n                    isAuthenticated: true,\n                    isLoading: false,\n                    tokenInfo\n                });\n                this.logInfo('Access token refreshed successfully');\n                return tokenResponse.access_token;\n            }\n            else {\n                throw new Error('No token response received');\n            }\n        }\n        catch (error) {\n            this.logError('Token refresh failed:', error);\n            // Only logout if it's a 400/401 error indicating invalid refresh token\n            if (error instanceof Error && 'status' in error) {\n                const httpError = error;\n                if (httpError.status === 400 || httpError.status === 401) {\n                    this.logInfo('Refresh token is invalid, logging out');\n                    this.logout();\n                }\n            }\n            else {\n                this.logInfo('Network or server error during token refresh, will retry later');\n            }\n            throw new Error('Failed to refresh access token');\n        }\n    }\n    /**\n     * Logout user and clean up all stored data\n     */\n    async logout() {\n        try {\n            this.updateAuthState({ isLoading: true });\n            // Revoke tokens if supported\n            await this.revokeTokens();\n            // Clear all stored authentication data\n            this.storageService.clearAll();\n            // Update authentication state\n            this.updateAuthState({\n                isAuthenticated: false,\n                isLoading: false,\n                tokenInfo: undefined,\n                error: undefined\n            });\n            this.logInfo('User logged out successfully');\n        }\n        catch (error) {\n            this.logError('Error during logout:', error);\n            // Still clear local data even if revocation fails\n            this.storageService.clearAll();\n            this.updateAuthState({\n                isAuthenticated: false,\n                isLoading: false,\n                tokenInfo: undefined\n            });\n        }\n    }\n    /**\n     * Revoke tokens at authorization server\n     */\n    async revokeTokens() {\n        if (!this.config.revokeEndpoint) {\n            this.logInfo('Token revocation endpoint not configured');\n            return;\n        }\n        const accessToken = this.getAccessToken();\n        const refreshToken = this.getRefreshToken();\n        const revokePromises = [];\n        if (accessToken) {\n            const revokeRequest = {\n                token: accessToken,\n                token_type_hint: 'access_token',\n                client_id: this.config.clientId\n            };\n            const formData = new URLSearchParams();\n            Object.entries(revokeRequest).forEach(([key, value]) => {\n                if (value !== undefined) {\n                    formData.append(key, value.toString());\n                }\n            });\n            revokePromises.push(this.http.post(this.config.revokeEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise());\n        }\n        if (refreshToken) {\n            const revokeRequest = {\n                token: refreshToken,\n                token_type_hint: 'refresh_token',\n                client_id: this.config.clientId\n            };\n            const formData = new URLSearchParams();\n            Object.entries(revokeRequest).forEach(([key, value]) => {\n                if (value !== undefined) {\n                    formData.append(key, value.toString());\n                }\n            });\n            revokePromises.push(this.http.post(this.config.revokeEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise());\n        }\n        if (revokePromises.length > 0) {\n            try {\n                await Promise.all(revokePromises);\n                this.logInfo('Tokens revoked successfully');\n            }\n            catch (error) {\n                this.logError('Token revocation failed:', error);\n                // Don't throw error, continue with logout\n            }\n        }\n    }\n    /**\n     * Store token information securely\n     */\n    storeTokenInfo(tokenInfo) {\n        try {\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenInfo.accessToken);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, tokenInfo.expiresAt.toString());\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE, tokenInfo.tokenType);\n            if (tokenInfo.refreshToken) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenInfo.refreshToken);\n            }\n            if (tokenInfo.scope) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.SCOPE, tokenInfo.scope);\n            }\n            if (tokenInfo.idToken) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.ID_TOKEN, tokenInfo.idToken);\n            }\n            this.logDebug('Token information stored securely');\n        }\n        catch (error) {\n            this.logError('Error storing token information:', error);\n            throw new Error('Failed to store token information');\n        }\n    }\n    /**\n     * Retrieve stored token information\n     */\n    getStoredTokenInfo() {\n        if (!this.storageService.isAvailable()) {\n            return null;\n        }\n        try {\n            const accessToken = this.storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\n            const expiresAtStr = this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\n            if (!accessToken || !expiresAtStr) {\n                return null;\n            }\n            return {\n                accessToken,\n                refreshToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN) || undefined,\n                tokenType: this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE) || 'Bearer',\n                expiresAt: parseInt(expiresAtStr, 10),\n                scope: this.storageService.getItem(OAUTH2_STORAGE_KEYS.SCOPE) || undefined,\n                idToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.ID_TOKEN) || undefined\n            };\n        }\n        catch (error) {\n            this.logError('Error retrieving stored token information:', error);\n            return null;\n        }\n    }\n    /**\n     * Update authentication state\n     */\n    updateAuthState(newState) {\n        const currentState = this._authState();\n        const updatedState = { ...currentState, ...newState };\n        this._authState.set(updatedState);\n        this._authStateSubject.next(updatedState);\n    }\n    /**\n     * Debug logging\n     */\n    logDebug(message, ...args) {\n        if (this.logLevel === 'debug') {\n            console.log(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Info logging\n     */\n    logInfo(message, ...args) {\n        if (['debug', 'info'].includes(this.logLevel)) {\n            console.info(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Warning logging\n     */\n    logWarn(message, ...args) {\n        if (['debug', 'info', 'warn'].includes(this.logLevel)) {\n            console.warn(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Error logging\n     */\n    logError(message, error) {\n        if (this.logLevel !== 'none') {\n            console.error(`[OAuth2Service] ${message}`, error);\n        }\n    }\n    static { this.ɵfac = function OAuth2Service_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2Service)(i0.ɵɵinject(OAUTH2_CONFIG_TOKEN), i0.ɵɵinject(PLATFORM_ID), i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.OAuth2StorageService)); }; }\n    static { this.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: OAuth2Service, factory: OAuth2Service.ɵfac, providedIn: 'root' }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2Service, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], () => [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [OAUTH2_CONFIG_TOKEN]\n            }] }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }, { type: i1.HttpClient }, { type: i2.Router }, { type: i3.OAuth2StorageService }], null); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL3NlcnZpY2VzL29hdXRoMi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFHcEQsT0FBTyxFQUFjLGVBQWUsRUFBa0IsTUFBTSxNQUFNLENBQUM7QUFJbkUsT0FBTyxFQVFMLG1CQUFtQixFQUdwQixNQUFNLDhCQUE4QixDQUFDO0FBQ3RDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7OztBQUdwRTs7O0dBR0c7QUFJSCxNQUFNLE9BQU8sYUFBYTtJQWdCeEIsWUFDdUMsTUFBb0IsRUFDNUIsVUFBa0IsRUFDdkMsSUFBZ0IsRUFDaEIsTUFBYyxFQUNkLGNBQW9DO1FBSlAsV0FBTSxHQUFOLE1BQU0sQ0FBYztRQUM1QixlQUFVLEdBQVYsVUFBVSxDQUFRO1FBQ3ZDLFNBQUksR0FBSixJQUFJLENBQVk7UUFDaEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLG1CQUFjLEdBQWQsY0FBYyxDQUFzQjtRQXBCdEMsZUFBVSxHQUFHLE1BQU0sQ0FBWTtZQUNyQyxlQUFlLEVBQUUsS0FBSztZQUN0QixTQUFTLEVBQUUsS0FBSztTQUNqQixDQUFDLENBQUM7UUFFSyxzQkFBaUIsR0FBRyxJQUFJLGVBQWUsQ0FBWTtZQUN6RCxlQUFlLEVBQUUsS0FBSztZQUN0QixTQUFTLEVBQUUsS0FBSztTQUNqQixDQUFDLENBQUM7UUFFSSxlQUFVLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO1FBQzFDLGNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFD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O0lBRUQ7O09BRUc7SUFDSyxPQUFPLENBQUMsT0FBZSxFQUFFLEdBQUcsSUFBVztRQUM3QyxJQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7WUFDdEQsT0FBTyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsT0FBTyxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUN0RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ssUUFBUSxDQUFDLE9BQWUsRUFBRSxLQUFXO1FBQzNDLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxNQUFNLEVBQUUsQ0FBQztZQUM3QixPQUFPLENBQUMsS0FBSyxDQUFDLG1CQUFtQixPQUFPLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyRCxDQUFDO0lBQ0gsQ0FBQzs4R0E1MEJVLGFBQWEsY0FpQmQsbUJBQW1CLGVBQ25CLFdBQVc7dUVBbEJWLGFBQWEsV0FBYixhQUFhLG1CQUZaLE1BQU07O2lGQUVQLGFBQWE7Y0FIekIsVUFBVTtlQUFDO2dCQUNWLFVBQVUsRUFBRSxNQUFNO2FBQ25COztzQkFrQkksTUFBTTt1QkFBQyxtQkFBbUI7O3NCQUMxQixNQUFNO3VCQUFDLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIFBMQVRGT1JNX0lELCBzaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBCZWhhdmlvclN1YmplY3QsIHRocm93RXJyb3IsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IG1hcCwgY2F0Y2hFcnJvciwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQge1xyXG4gIFBLQ0VDaGFsbGVuZ2UsXHJcbiAgQXV0aG9yaXphdGlvblJlcXVlc3QsXHJcbiAgVG9rZW5SZXF1ZXN0LFxyXG4gIFRva2VuUmVzcG9uc2UsXHJcbiAgVG9rZW5JbmZvLFxyXG4gIEF1dGhTdGF0ZSxcclxuICBPQXV0aDJFcnJvcixcclxuICBPQVVUSDJfU1RPUkFHRV9LRVlTLFxyXG4gIFVzZXJJbmZvUmVzcG9uc2UsXHJcbiAgT0F1dGgyTG9nTGV2ZWxcclxufSBmcm9tICcuLi9tb2RlbHMvb2F1dGgyLXR5cGVzLm1vZGVsJztcclxuaW1wb3J0IHsgT0FVVEgyX0NPTkZJR19UT0tFTiB9IGZyb20gJy4uL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuaW1wb3J0IHsgT0F1dGgyU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuL29hdXRoMi1zdG9yYWdlLnNlcnZpY2UnO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBTZXJ2aWNlIHdpdGggUEtDRSBTdXBwb3J0XHJcbiAqIEhhbmRsZXMgT0F1dGgyIGF1dGhvcml6YXRpb24gZmxvdywgdG9rZW4gbWFuYWdlbWVudCwgYW5kIHVzZXIgYXV0aGVudGljYXRpb25cclxuICovXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIE9BdXRoMlNlcnZpY2Uge1xyXG4gIHByaXZhdGUgX2F1dGhTdGF0ZSA9IHNpZ25hbDxBdXRoU3RhdGU+KHtcclxuICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXHJcbiAgICBpc0xvYWRpbmc6IGZhbHNlXHJcbiAgfSk7XHJcblxyXG4gIHByaXZhdGUgX2F1dGhTdGF0ZVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEF1dGhTdGF0ZT4oe1xyXG4gICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgIGlzTG9hZGluZzogZmFsc2VcclxuICB9KTtcclxuXHJcbiAgcHVibGljIGF1dGhTdGF0ZSQgPSB0aGlzLl9hdXRoU3RhdGVTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIHB1YmxpYyByZWFkb25seSBhdXRoU3RhdGUgPSB0aGlzLl9hdXRoU3RhdGUuYXNSZWFkb25seSgpO1xyXG5cclxuICBwcml2YXRlIGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbDtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBASW5qZWN0KE9BVVRIMl9DT05GSUdfVE9LRU4pIHByaXZhdGUgY29uZmlnOiBPQXV0aDJDb25maWcsXHJcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcbiAgICBwcml2YXRlIHN0b3JhZ2VTZXJ2aWNlOiBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gICkge1xyXG4gICAgdGhpcy5sb2dMZXZlbCA9IGNvbmZpZy5sb2dMZXZlbCB8fCAnd2Fybic7XHJcbiAgICB0aGlzLmluaXRpYWxpemVBdXRoU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgYXV0aGVudGljYXRpb24gc3RhdGUgZnJvbSBzdG9yZWQgdG9rZW5zXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplQXV0aFN0YXRlKCk6IHZvaWQge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0b2tlbkluZm8gPSB0aGlzLmdldFN0b3JlZFRva2VuSW5mbygpO1xyXG4gICAgICBpZiAodG9rZW5JbmZvICYmIHRoaXMuaXNUb2tlblZhbGlkKHRva2VuSW5mbykpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgdG9rZW5JbmZvXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdBdXRoZW50aWNhdGlvbiBzdGF0ZSBpbml0aWFsaXplZCBmcm9tIHN0b3JlZCB0b2tlbnMnKTtcclxuICAgICAgfSBlbHNlIGlmICh0b2tlbkluZm8gJiYgdG9rZW5JbmZvLnJlZnJlc2hUb2tlbikge1xyXG4gICAgICAgIC8vIEFjY2VzcyB0b2tlbiBpcyBleHBpcmVkIGJ1dCByZWZyZXNoIHRva2VuIGV4aXN0c1xyXG4gICAgICAgIHRoaXMubG9nSW5mbygnQWNjZXNzIHRva2VuIGV4cGlyZWQgYnV0IHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlIC0gcHJlc2VydmluZyBmb3IgcmVmcmVzaCBmbG93Jyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoe1xyXG4gICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgICB0b2tlbkluZm86IHVuZGVmaW5lZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIE5vIHRva2VucyBvciBubyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZSAtIGNsZWFyIGV2ZXJ5dGhpbmdcclxuICAgICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmNsZWFyVG9rZW5zKCk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdObyB2YWxpZCBzdG9yZWQgdG9rZW5zIGZvdW5kJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBhdXRoIHN0YXRlOicsIGVycm9yKTtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhclRva2VucygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgY3J5cHRvZ3JhcGhpY2FsbHkgc2VjdXJlIFBLQ0UgY2hhbGxlbmdlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTogUHJvbWlzZTxQS0NFQ2hhbGxlbmdlPiB7XHJcbiAgICBjb25zdCBjb2RlVmVyaWZpZXIgPSB0aGlzLmdlbmVyYXRlU2VjdXJlQ29kZVZlcmlmaWVyKCk7XHJcbiAgICBjb25zdCBjb2RlQ2hhbGxlbmdlID0gYXdhaXQgdGhpcy5jcmVhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcik7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvZGVWZXJpZmllcixcclxuICAgICAgY29kZUNoYWxsZW5nZSxcclxuICAgICAgY29kZUNoYWxsZW5nZU1ldGhvZDogdGhpcy5jb25maWcuY29kZUNoYWxsZW5nZU1ldGhvZCB8fCAnUzI1NidcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgNi1kaWdpdCBjb2RlIHZlcmlmaWVyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNlY3VyZUNvZGVWZXJpZmllcigpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ29kZSB2ZXJpZmllciBnZW5lcmF0aW9uIHJlcXVpcmVzIGJyb3dzZXIgZW52aXJvbm1lbnQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSA2IGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZSByYW5kb20gZGlnaXRzXHJcbiAgICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KDYpO1xyXG4gICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnJheSk7XHJcbiAgICBcclxuICAgIC8vIENvbnZlcnQgdG8gNi1kaWdpdCBzdHJpbmcgKDAwMDAwMC05OTk5OTkpXHJcbiAgICBjb25zdCBjb2RlVmVyaWZpZXIgPSBBcnJheS5mcm9tKGFycmF5KVxyXG4gICAgICAubWFwKGJ5dGUgPT4gKGJ5dGUgJSAxMCkudG9TdHJpbmcoKSlcclxuICAgICAgLmpvaW4oJycpO1xyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0RlYnVnKCdHZW5lcmF0ZWQgc2VjdXJlIDYtZGlnaXQgY29kZSB2ZXJpZmllcicpO1xyXG4gICAgcmV0dXJuIGNvZGVWZXJpZmllcjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBTSEEtMjU2IGhhc2ggYW5kIGJhc2U2NCBlbmNvZGUgZm9yIGNvZGUgY2hhbGxlbmdlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvZGUgY2hhbGxlbmdlIGNyZWF0aW9uIHJlcXVpcmVzIGJyb3dzZXIgZW52aXJvbm1lbnQnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBFbmNvZGUgdGhlIGNvZGUgdmVyaWZpZXIgYXMgVVRGLThcclxuICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xyXG4gICAgICBjb25zdCBkYXRhID0gZW5jb2Rlci5lbmNvZGUoY29kZVZlcmlmaWVyKTtcclxuICAgICAgXHJcbiAgICAgIC8vIENyZWF0ZSBTSEEtMjU2IGhhc2hcclxuICAgICAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb252ZXJ0IHRvIGJhc2U2NHVybCBlbmNvZGluZ1xyXG4gICAgICBjb25zdCBoYXNoQXJyYXkgPSBuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKTtcclxuICAgICAgY29uc3QgYmFzZTY0U3RyaW5nID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLmhhc2hBcnJheSkpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcKy9nLCAnLScpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnXycpXHJcbiAgICAgICAgLnJlcGxhY2UoLz0vZywgJycpO1xyXG4gICAgICBcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnR2VuZXJhdGVkIGNvZGUgY2hhbGxlbmdlIGZyb20gdmVyaWZpZXInKTtcclxuICAgICAgcmV0dXJuIGJhc2U2NFN0cmluZztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvZGUgY2hhbGxlbmdlOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGNvZGUgY2hhbGxlbmdlJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgc3RhdGUgcGFyYW1ldGVyIGZvciBDU1JGIHByb3RlY3Rpb25cclxuICAgKi9cclxuICBwcml2YXRlIGdlbmVyYXRlU3RhdGUoKTogc3RyaW5nIHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICByZXR1cm4gJ2ZhbGxiYWNrLXN0YXRlJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KDMyKTtcclxuICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoYXJyYXkpO1xyXG4gICAgcmV0dXJuIGJ0b2EoU3RyaW5nLmZyb21DaGFyQ29kZSguLi5hcnJheSkpXHJcbiAgICAgIC5yZXBsYWNlKC9cXCsvZywgJy0nKVxyXG4gICAgICAucmVwbGFjZSgvXFwvL2csICdfJylcclxuICAgICAgLnJlcGxhY2UoLz0vZywgJycpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgbm9uY2UgaWYgbm90IHByb3ZpZGVkIGluIGNvbmZpZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVOb25jZSgpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRoaXMuY29uZmlnLm5vbmNlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5ub25jZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcclxuICAgICAgcmV0dXJuICdmYWxsYmFjay1ub25jZSc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheSgxNik7XHJcbiAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcclxuICAgIHJldHVybiBidG9hKFN0cmluZy5mcm9tQ2hhckNvZGUoLi4uYXJyYXkpKVxyXG4gICAgICAucmVwbGFjZSgvXFwrL2csICctJylcclxuICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnXycpXHJcbiAgICAgIC5yZXBsYWNlKC89L2csICcnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IE9BdXRoMiBQS0NFIGF1dGhvcml6YXRpb24gZmxvd1xyXG4gICAqL1xyXG4gIGFzeW5jIHN0YXJ0QXV0aG9yaXphdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdBdXRob3JpemF0aW9uIGF0dGVtcHRlZCBpbiBub24tYnJvd3NlciBlbnZpcm9ubWVudCcsICdTU1Igb3Igc2VydmVyIGNvbnRleHQgZGV0ZWN0ZWQnKTtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoe1xyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiBub3QgYXZhaWxhYmxlIGluIHNlcnZlciBlbnZpcm9ubWVudCdcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7IGlzTG9hZGluZzogdHJ1ZSwgZXJyb3I6IHVuZGVmaW5lZCB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdlbmVyYXRlIFBLQ0UgY2hhbGxlbmdlXHJcbiAgICAgIGNvbnN0IHBrY2VDaGFsbGVuZ2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUEtDRUNoYWxsZW5nZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2VuZXJhdGUgc3RhdGUgZm9yIENTUkYgcHJvdGVjdGlvblxyXG4gICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZ2VuZXJhdGVTdGF0ZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2VuZXJhdGUgbm9uY2VcclxuICAgICAgY29uc3Qgbm9uY2UgPSB0aGlzLmdlbmVyYXRlTm9uY2UoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFN0b3JlIGNvZGUgdmVyaWZpZXIsIHN0YXRlLCBhbmQgbm9uY2Ugc2VjdXJlbHlcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQ09ERV9WRVJJRklFUiwgcGtjZUNoYWxsZW5nZS5jb2RlVmVyaWZpZXIpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TVEFURSwgc3RhdGUpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5OT05DRSwgbm9uY2UpO1xyXG4gICAgICBcclxuICAgICAgLy8gQnVpbGQgYXV0aG9yaXphdGlvbiByZXF1ZXN0XHJcbiAgICAgIGNvbnN0IGF1dGhSZXF1ZXN0OiBBdXRob3JpemF0aW9uUmVxdWVzdCA9IHtcclxuICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY29uZmlnLmNsaWVudElkLFxyXG4gICAgICAgIHJlZGlyZWN0X3VyaTogdGhpcy5jb25maWcucmVkaXJlY3RVcmksXHJcbiAgICAgICAgcmVzcG9uc2VfdHlwZTogdGhpcy5jb25maWcucmVzcG9uc2VUeXBlIHx8ICdjb2RlJyxcclxuICAgICAgICBub25jZSxcclxuICAgICAgICBhdWRpZW5jZTogdGhpcy5jb25maWcuYXVkaWVuY2UsXHJcbiAgICAgICAgc2NvcGU6IHRoaXMuY29uZmlnLnNjb3BlLFxyXG4gICAgICAgIGNvZGVfY2hhbGxlbmdlX21ldGhvZDogcGtjZUNoYWxsZW5nZS5jb2RlQ2hhbGxlbmdlTWV0aG9kLFxyXG4gICAgICAgIGNvZGVfY2hhbGxlbmdlOiBwa2NlQ2hhbGxlbmdlLmNvZGVDaGFsbGVuZ2UsXHJcbiAgICAgICAgc3RhdGVcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIC8vIEJ1aWxkIGF1dGhvcml6YXRpb24gVVJMXHJcbiAgICAgIGNvbnN0IGF1dGhVcmwgPSB0aGlzLmJ1aWxkQXV0aG9yaXphdGlvblVybChhdXRoUmVxdWVzdCk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1N0YXJ0aW5nIE9BdXRoMiBQS0NFIGF1dGhvcml6YXRpb24gZmxvdycpO1xyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdBdXRob3JpemF0aW9uIFVSTDonLCBhdXRoVXJsKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlZGlyZWN0IHRvIGF1dGhvcml6YXRpb24gc2VydmVyXHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYXV0aFVybDtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBzdGFydGluZyBhdXRob3JpemF0aW9uOicsIGVycm9yKTtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLCBcclxuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzdGFydCBhdXRob3JpemF0aW9uIGZsb3cnIFxyXG4gICAgICB9KTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBhdXRob3JpemF0aW9uIFVSTCB3aXRoIHBhcmFtZXRlcnNcclxuICAgKi9cclxuICBwcml2YXRlIGJ1aWxkQXV0aG9yaXphdGlvblVybChyZXF1ZXN0OiBBdXRob3JpemF0aW9uUmVxdWVzdCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcbiAgICBcclxuICAgIE9iamVjdC5lbnRyaWVzKHJlcXVlc3QpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xyXG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHBhcmFtcy5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZy5hdXRob3JpemF0aW9uRW5kcG9pbnR9PyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSBPQXV0aDIgY2FsbGJhY2sgYW5kIGV4dHJhY3QgdG9rZW5zXHJcbiAgICovXHJcbiAgYXN5bmMgaGFuZGxlQ2FsbGJhY2soKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAoIWlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYWxsYmFjayBoYW5kbGluZyByZXF1aXJlcyBicm93c2VyIGVudmlyb25tZW50Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBpc0xvYWRpbmc6IHRydWUsIGVycm9yOiB1bmRlZmluZWQgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBjdXJyZW50VXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgIHRoaXMubG9nSW5mbygnSGFuZGxpbmcgT0F1dGgyIGNhbGxiYWNrOicsIGN1cnJlbnRVcmwpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIGVycm9yIGluIGNhbGxiYWNrXHJcbiAgICAgIGNvbnN0IGVycm9yID0gdGhpcy5leHRyYWN0RXJyb3JGcm9tQ2FsbGJhY2soKTtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPQXV0aDIgRXJyb3I6ICR7ZXJyb3IuZXJyb3J9IC0gJHtlcnJvci5lcnJvcl9kZXNjcmlwdGlvbiB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEV4dHJhY3QgYXV0aG9yaXphdGlvbiBjb2RlIGZyb20gcXVlcnkgcGFyYW1ldGVycyBvciBoYXNoIGZyYWdtZW50XHJcbiAgICAgIGNvbnN0IGF1dGhDb2RlID0gdGhpcy5leHRyYWN0QXV0aG9yaXphdGlvbkNvZGUoKTtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnRXh0cmFjdGVkIGF1dGhvcml6YXRpb24gY29kZTonLCBhdXRoQ29kZSA/ICdGb3VuZCcgOiAnTm90IGZvdW5kJyk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXV0aENvZGUpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmV4Y2hhbmdlQ29kZUZvclRva2VucyhhdXRoQ29kZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBFeHRyYWN0IHRva2VucyBmcm9tIFVSTCBmcmFnbWVudCAoaW1wbGljaXQgZmxvdylcclxuICAgICAgY29uc3QgdG9rZW5zID0gdGhpcy5leHRyYWN0VG9rZW5zRnJvbUZyYWdtZW50KCk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoJ0V4dHJhY3RlZCB0b2tlbnMgZnJvbSBmcmFnbWVudDonLCB0b2tlbnMgPyAnRm91bmQnIDogJ05vdCBmb3VuZCcpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHRva2Vucykge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlVG9rZW5SZXNwb25zZSh0b2tlbnMpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdXRob3JpemF0aW9uIGNvZGUgb3IgdG9rZW5zIGZvdW5kIGluIGNhbGxiYWNrJyk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgaGFuZGxpbmcgY2FsbGJhY2s6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7IFxyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdDYWxsYmFjayBoYW5kbGluZyBmYWlsZWQnIFxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4dHJhY3QgZXJyb3IgZnJvbSBjYWxsYmFjayBVUkxcclxuICAgKi9cclxuICBwcml2YXRlIGV4dHJhY3RFcnJvckZyb21DYWxsYmFjaygpOiBPQXV0aDJFcnJvciB8IG51bGwge1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcclxuICAgIGNvbnN0IGhhc2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGVycm9yID0gdXJsUGFyYW1zLmdldCgnZXJyb3InKSB8fCBoYXNoUGFyYW1zLmdldCgnZXJyb3InKTtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVycm9yLFxyXG4gICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiB1cmxQYXJhbXMuZ2V0KCdlcnJvcl9kZXNjcmlwdGlvbicpIHx8IGhhc2hQYXJhbXMuZ2V0KCdlcnJvcl9kZXNjcmlwdGlvbicpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICBlcnJvcl91cmk6IHVybFBhcmFtcy5nZXQoJ2Vycm9yX3VyaScpIHx8IGhhc2hQYXJhbXMuZ2V0KCdlcnJvcl91cmknKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgc3RhdGU6IHVybFBhcmFtcy5nZXQoJ3N0YXRlJykgfHwgaGFzaFBhcmFtcy5nZXQoJ3N0YXRlJykgfHwgdW5kZWZpbmVkXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdCBhdXRob3JpemF0aW9uIGNvZGUgZnJvbSBxdWVyeSBwYXJhbWV0ZXJzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBleHRyYWN0QXV0aG9yaXphdGlvbkNvZGUoKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICAvLyBGaXJzdCBjaGVjayBxdWVyeSBwYXJhbWV0ZXJzXHJcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG4gICAgbGV0IGNvZGUgPSB1cmxQYXJhbXMuZ2V0KCdjb2RlJyk7XHJcbiAgICBcclxuICAgIC8vIElmIG5vdCBmb3VuZCBpbiBxdWVyeSBwYXJhbXMsIGNoZWNrIGhhc2ggZnJhZ21lbnRcclxuICAgIGlmICghY29kZSAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCkge1xyXG4gICAgICBjb25zdCBoYXNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkpO1xyXG4gICAgICBjb2RlID0gaGFzaFBhcmFtcy5nZXQoJ2NvZGUnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGNvZGUpIHtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnQXV0aG9yaXphdGlvbiBjb2RlIGV4dHJhY3RlZCBmcm9tIGNhbGxiYWNrJyk7XHJcbiAgICAgIHJldHVybiBjb2RlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4dHJhY3QgdG9rZW5zIGZyb20gVVJMIGZyYWdtZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBleHRyYWN0VG9rZW5zRnJvbUZyYWdtZW50KCk6IFRva2VuUmVzcG9uc2UgfCBudWxsIHtcclxuICAgIGNvbnN0IGZyYWdtZW50ID0gd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpO1xyXG4gICAgaWYgKCFmcmFnbWVudCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhmcmFnbWVudCk7XHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHBhcmFtcy5nZXQoJ2FjY2Vzc190b2tlbicpO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnVG9rZW5zIGV4dHJhY3RlZCBmcm9tIFVSTCBmcmFnbWVudCcpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFjY2Vzc190b2tlbjogYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgcmVmcmVzaF90b2tlbjogcGFyYW1zLmdldCgncmVmcmVzaF90b2tlbicpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB0b2tlbl90eXBlOiBwYXJhbXMuZ2V0KCd0b2tlbl90eXBlJykgfHwgJ0JlYXJlcicsXHJcbiAgICAgICAgZXhwaXJlc19pbjogcGFyc2VJbnQocGFyYW1zLmdldCgnZXhwaXJlc19pbicpIHx8ICczNjAwJywgMTApLFxyXG4gICAgICAgIHNjb3BlOiBwYXJhbXMuZ2V0KCdzY29wZScpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICBpZF90b2tlbjogcGFyYW1zLmdldCgnaWRfdG9rZW4nKSB8fCB1bmRlZmluZWRcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGNoYW5nZSBhdXRob3JpemF0aW9uIGNvZGUgZm9yIHRva2Vuc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhjaGFuZ2VDb2RlRm9yVG9rZW5zKGF1dGhDb2RlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IGNvZGVWZXJpZmllciA9IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLkNPREVfVkVSSUZJRVIpO1xyXG4gICAgXHJcbiAgICBpZiAoIWNvZGVWZXJpZmllcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdDb2RlIHZlcmlmaWVyIG5vdCBmb3VuZCBpbiBzdG9yYWdlJyk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ29kZSB2ZXJpZmllciBub3QgZm91bmQgaW4gc3RvcmFnZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB0b2tlblJlcXVlc3Q6IFRva2VuUmVxdWVzdCA9IHtcclxuICAgICAgZ3JhbnRfdHlwZTogJ2F1dGhvcml6YXRpb25fY29kZScsXHJcbiAgICAgIHJlZGlyZWN0X3VyaTogdGhpcy5jb25maWcucmVkaXJlY3RVcmksXHJcbiAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWQsXHJcbiAgICAgIGNvZGU6IGF1dGhDb2RlLFxyXG4gICAgICBjb2RlX3ZlcmlmaWVyOiBjb2RlVmVyaWZpZXJcclxuICAgIH07XHJcbiAgICBcclxuICAgIHRoaXMubG9nSW5mbygnRXhjaGFuZ2luZyBhdXRob3JpemF0aW9uIGNvZGUgZm9yIHRva2VucycpO1xyXG4gICAgXHJcbiAgICAvLyBDb252ZXJ0IHRvIFVSTC1lbmNvZGVkIGZvcm0gZGF0YSBhcyBwZXIgT0F1dGggMi4wIHN0YW5kYXJkXHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgIE9iamVjdC5lbnRyaWVzKHRva2VuUmVxdWVzdCkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsdWUudG9TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0b2tlblJlc3BvbnNlID0gYXdhaXQgdGhpcy5odHRwLnBvc3Q8VG9rZW5SZXNwb25zZT4oXHJcbiAgICAgICAgdGhpcy5jb25maWcudG9rZW5FbmRwb2ludCxcclxuICAgICAgICBmb3JtRGF0YS50b1N0cmluZygpLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICApLnRvUHJvbWlzZSgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHRva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVRva2VuUmVzcG9uc2UodG9rZW5SZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB0b2tlbiByZXNwb25zZSByZWNlaXZlZCcpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignVG9rZW4gZXhjaGFuZ2UgZmFpbGVkOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZXhjaGFuZ2UgYXV0aG9yaXphdGlvbiBjb2RlIGZvciB0b2tlbnMnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSB0b2tlbiByZXNwb25zZSBhbmQgc3RvcmUgdG9rZW5zIHNlY3VyZWx5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVUb2tlblJlc3BvbnNlKHRva2VuUmVzcG9uc2U6IFRva2VuUmVzcG9uc2UpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFZhbGlkYXRlIHN0YXRlIHBhcmFtZXRlciBmb3IgQ1NSRiBwcm90ZWN0aW9uXHJcbiAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVTdGF0ZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ3JlYXRlIHRva2VuIGluZm9cclxuICAgICAgY29uc3QgdG9rZW5JbmZvOiBUb2tlbkluZm8gPSB7XHJcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxyXG4gICAgICAgIHJlZnJlc2hUb2tlbjogdG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuLFxyXG4gICAgICAgIHRva2VuVHlwZTogdG9rZW5SZXNwb25zZS50b2tlbl90eXBlIHx8ICdCZWFyZXInLFxyXG4gICAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArICh0b2tlblJlc3BvbnNlLmV4cGlyZXNfaW4gKiAxMDAwKSxcclxuICAgICAgICBzY29wZTogdG9rZW5SZXNwb25zZS5zY29wZSxcclxuICAgICAgICBpZFRva2VuOiB0b2tlblJlc3BvbnNlLmlkX3Rva2VuXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICAvLyBTdG9yZSB0b2tlbnMgc2VjdXJlbHlcclxuICAgICAgdGhpcy5zdG9yZVRva2VuSW5mbyh0b2tlbkluZm8pO1xyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIGF1dGhlbnRpY2F0aW9uIHN0YXRlXHJcbiAgICAgIHRoaXMudXBkYXRlQXV0aFN0YXRlKHtcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICB0b2tlbkluZm8sXHJcbiAgICAgICAgZXJyb3I6IHVuZGVmaW5lZFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIENsZWFuIHVwIHRlbXBvcmFyeSBzdG9yYWdlXHJcbiAgICAgIHRoaXMuc3RvcmFnZVNlcnZpY2UuY2xlYXJUZW1wb3JhcnkoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMubG9nSW5mbygnVG9rZW5zIHN0b3JlZCBzdWNjZXNzZnVsbHksIHVzZXIgYXV0aGVudGljYXRlZCcpO1xyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGhhbmRsaW5nIHRva2VuIHJlc3BvbnNlOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBzdGF0ZSBwYXJhbWV0ZXIgZm9yIENTUkYgcHJvdGVjdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICBjb25zdCBoYXNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkpO1xyXG4gICAgXHJcbiAgICBjb25zdCByZWNlaXZlZFN0YXRlID0gdXJsUGFyYW1zLmdldCgnc3RhdGUnKSB8fCBoYXNoUGFyYW1zLmdldCgnc3RhdGUnKTtcclxuICAgIGNvbnN0IHN0b3JlZFN0YXRlID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuU1RBVEUpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlY2VpdmVkU3RhdGUgfHwgIXN0b3JlZFN0YXRlIHx8IHJlY2VpdmVkU3RhdGUgIT09IHN0b3JlZFN0YXRlKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdGF0ZSBwYXJhbWV0ZXIgLSBwb3NzaWJsZSBDU1JGIGF0dGFjaycpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0RlYnVnKCdTdGF0ZSBwYXJhbWV0ZXIgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGN1cnJlbnQgYWNjZXNzIHRva2VuIChvbmx5IGlmIHZhbGlkL25vdCBleHBpcmVkKVxyXG4gICAqL1xyXG4gIGdldEFjY2Vzc1Rva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIGlmICh0b2tlbkluZm8gJiYgdGhpcy5pc1Rva2VuVmFsaWQodG9rZW5JbmZvKSkge1xyXG4gICAgICByZXR1cm4gdG9rZW5JbmZvLmFjY2Vzc1Rva2VuO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcmF3IGFjY2VzcyB0b2tlbiAoZXZlbiBpZiBleHBpcmVkKSAtIHVzZWQgZm9yIHJlZnJlc2ggZmxvd1xyXG4gICAqL1xyXG4gIGdldFJhd0FjY2Vzc1Rva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8/LmFjY2Vzc1Rva2VuIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgY3VycmVudCByZWZyZXNoIHRva2VuXHJcbiAgICovXHJcbiAgZ2V0UmVmcmVzaFRva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8/LnJlZnJlc2hUb2tlbiB8fCBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkXHJcbiAgICovXHJcbiAgaXNBdXRoZW50aWNhdGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8gPyB0aGlzLmlzVG9rZW5WYWxpZCh0b2tlbkluZm8pIDogZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBhdXRoZW50aWNhdGlvbiBpcyBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudFxyXG4gICAqL1xyXG4gIGlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHVzZXIgaW5mb3JtYXRpb24gZnJvbSBPSURDIHVzZXJpbmZvIGVuZHBvaW50XHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0VXNlckluZm8oKTogUHJvbWlzZTxVc2VySW5mb1Jlc3BvbnNlPiB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLnVzZXJJbmZvRW5kcG9pbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VySW5mbyBlbmRwb2ludCBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gdGhpcy5nZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgaWYgKCFhY2Nlc3NUb2tlbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGFjY2VzcyB0b2tlbiBhdmFpbGFibGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmxvZ0luZm8oJ0ZldGNoaW5nIHVzZXIgaW5mbyBmcm9tIE9JREMgdXNlcmluZm8gZW5kcG9pbnQnKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQ8VXNlckluZm9SZXNwb25zZT4oXHJcbiAgICAgICAgdGhpcy5jb25maWcudXNlckluZm9FbmRwb2ludCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FjY2Vzc1Rva2VufWBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICkudG9Qcm9taXNlKCk7XHJcblxyXG4gICAgICBpZiAodXNlckluZm8pIHtcclxuICAgICAgICB0aGlzLmxvZ0RlYnVnKCdVc2VyIGluZm8gcmV0cmlldmVkIHN1Y2Nlc3NmdWxseTonLCB1c2VySW5mbyk7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBpbmZvIHJlc3BvbnNlIHJlY2VpdmVkJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm86JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm9ybWF0aW9uJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiB0b2tlbiBpcyB2YWxpZCAobm90IGV4cGlyZWQpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc1Rva2VuVmFsaWQodG9rZW5JbmZvOiBUb2tlbkluZm8pOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHRocmVzaG9sZCA9ICh0aGlzLmNvbmZpZy5yZWZyZXNoVGhyZXNob2xkIHx8IDMwMCkgKiAxMDAwOyAvLyBDb252ZXJ0IHRvIG1pbGxpc2Vjb25kc1xyXG4gICAgcmV0dXJuIERhdGUubm93KCkgPCAodG9rZW5JbmZvLmV4cGlyZXNBdCAtIHRocmVzaG9sZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWZyZXNoIGFjY2VzcyB0b2tlbiB1c2luZyByZWZyZXNoIHRva2VuXHJcbiAgICovXHJcbiAgYXN5bmMgcmVmcmVzaEFjY2Vzc1Rva2VuKCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICBjb25zdCByZWZyZXNoVG9rZW4gPSB0aGlzLmdldFJlZnJlc2hUb2tlbigpO1xyXG4gICAgaWYgKCFyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0luZm8oJ1JlZnJlc2hpbmcgYWNjZXNzIHRva2VuJyk7XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2VuUmVxdWVzdCA9IHtcclxuICAgICAgZ3JhbnRfdHlwZTogJ3JlZnJlc2hfdG9rZW4nLFxyXG4gICAgICByZWZyZXNoX3Rva2VuOiByZWZyZXNoVG9rZW4sXHJcbiAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWRcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIENvbnZlcnQgdG8gVVJMLWVuY29kZWQgZm9ybSBkYXRhIGFzIHBlciBPQXV0aCAyLjAgc3RhbmRhcmRcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgT2JqZWN0LmVudHJpZXModG9rZW5SZXF1ZXN0KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmh0dHAucG9zdDxUb2tlblJlc3BvbnNlPihcclxuICAgICAgICB0aGlzLmNvbmZpZy50b2tlbkVuZHBvaW50LFxyXG4gICAgICAgIGZvcm1EYXRhLnRvU3RyaW5nKCksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICkudG9Qcm9taXNlKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAodG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgIGNvbnN0IHRva2VuSW5mbzogVG9rZW5JbmZvID0ge1xyXG4gICAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxyXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiB0b2tlblJlc3BvbnNlLnJlZnJlc2hfdG9rZW4gfHwgcmVmcmVzaFRva2VuLFxyXG4gICAgICAgICAgdG9rZW5UeXBlOiB0b2tlblJlc3BvbnNlLnRva2VuX3R5cGUgfHwgJ0JlYXJlcicsXHJcbiAgICAgICAgICBleHBpcmVzQXQ6IERhdGUubm93KCkgKyAodG9rZW5SZXNwb25zZS5leHBpcmVzX2luICogMTAwMCksXHJcbiAgICAgICAgICBzY29wZTogdG9rZW5SZXNwb25zZS5zY29wZSxcclxuICAgICAgICAgIGlkVG9rZW46IHRva2VuUmVzcG9uc2UuaWRfdG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc3RvcmVUb2tlbkluZm8odG9rZW5JbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgdG9rZW5JbmZvXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdBY2Nlc3MgdG9rZW4gcmVmcmVzaGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgICAgIHJldHVybiB0b2tlblJlc3BvbnNlLmFjY2Vzc190b2tlbjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRva2VuIHJlc3BvbnNlIHJlY2VpdmVkJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPbmx5IGxvZ291dCBpZiBpdCdzIGEgNDAwLzQwMSBlcnJvciBpbmRpY2F0aW5nIGludmFsaWQgcmVmcmVzaCB0b2tlblxyXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiAnc3RhdHVzJyBpbiBlcnJvcikge1xyXG4gICAgICAgIGNvbnN0IGh0dHBFcnJvciA9IGVycm9yIGFzIGFueTtcclxuICAgICAgICBpZiAoaHR0cEVycm9yLnN0YXR1cyA9PT0gNDAwIHx8IGh0dHBFcnJvci5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgdGhpcy5sb2dJbmZvKCdSZWZyZXNoIHRva2VuIGlzIGludmFsaWQsIGxvZ2dpbmcgb3V0Jyk7XHJcbiAgICAgICAgICB0aGlzLmxvZ291dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmxvZ0luZm8oJ05ldHdvcmsgb3Igc2VydmVyIGVycm9yIGR1cmluZyB0b2tlbiByZWZyZXNoLCB3aWxsIHJldHJ5IGxhdGVyJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlZnJlc2ggYWNjZXNzIHRva2VuJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2dvdXQgdXNlciBhbmQgY2xlYW4gdXAgYWxsIHN0b3JlZCBkYXRhXHJcbiAgICovXHJcbiAgYXN5bmMgbG9nb3V0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBpc0xvYWRpbmc6IHRydWUgfSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXZva2UgdG9rZW5zIGlmIHN1cHBvcnRlZFxyXG4gICAgICBhd2FpdCB0aGlzLnJldm9rZVRva2VucygpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2xlYXIgYWxsIHN0b3JlZCBhdXRoZW50aWNhdGlvbiBkYXRhXHJcbiAgICAgIHRoaXMuc3RvcmFnZVNlcnZpY2UuY2xlYXJBbGwoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFVwZGF0ZSBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIHRva2VuSW5mbzogdW5kZWZpbmVkLFxyXG4gICAgICAgIGVycm9yOiB1bmRlZmluZWRcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1VzZXIgbG9nZ2VkIG91dCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBkdXJpbmcgbG9nb3V0OicsIGVycm9yKTtcclxuICAgICAgLy8gU3RpbGwgY2xlYXIgbG9jYWwgZGF0YSBldmVuIGlmIHJldm9jYXRpb24gZmFpbHNcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIHRva2VuSW5mbzogdW5kZWZpbmVkXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV2b2tlIHRva2VucyBhdCBhdXRob3JpemF0aW9uIHNlcnZlclxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcmV2b2tlVG9rZW5zKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5yZXZva2VFbmRwb2ludCkge1xyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1Rva2VuIHJldm9jYXRpb24gZW5kcG9pbnQgbm90IGNvbmZpZ3VyZWQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHRoaXMuZ2V0UmVmcmVzaFRva2VuKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJldm9rZVByb21pc2VzOiBQcm9taXNlPGFueT5bXSA9IFtdO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgY29uc3QgcmV2b2tlUmVxdWVzdCA9IHtcclxuICAgICAgICB0b2tlbjogYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgdG9rZW5fdHlwZV9oaW50OiAnYWNjZXNzX3Rva2VuJyxcclxuICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY29uZmlnLmNsaWVudElkXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgICAgT2JqZWN0LmVudHJpZXMocmV2b2tlUmVxdWVzdCkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIHZhbHVlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXZva2VQcm9taXNlcy5wdXNoKFxyXG4gICAgICAgIHRoaXMuaHR0cC5wb3N0KHRoaXMuY29uZmlnLnJldm9rZUVuZHBvaW50LCBmb3JtRGF0YS50b1N0cmluZygpLCB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLnRvUHJvbWlzZSgpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgY29uc3QgcmV2b2tlUmVxdWVzdCA9IHtcclxuICAgICAgICB0b2tlbjogcmVmcmVzaFRva2VuLFxyXG4gICAgICAgIHRva2VuX3R5cGVfaGludDogJ3JlZnJlc2hfdG9rZW4nLFxyXG4gICAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWRcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgICBPYmplY3QuZW50cmllcyhyZXZva2VSZXF1ZXN0KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsdWUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIHJldm9rZVByb21pc2VzLnB1c2goXHJcbiAgICAgICAgdGhpcy5odHRwLnBvc3QodGhpcy5jb25maWcucmV2b2tlRW5kcG9pbnQsIGZvcm1EYXRhLnRvU3RyaW5nKCksIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSkudG9Qcm9taXNlKClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHJldm9rZVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChyZXZva2VQcm9taXNlcyk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdUb2tlbnMgcmV2b2tlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmxvZ0Vycm9yKCdUb2tlbiByZXZvY2F0aW9uIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgICAgLy8gRG9uJ3QgdGhyb3cgZXJyb3IsIGNvbnRpbnVlIHdpdGggbG9nb3V0XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3JlIHRva2VuIGluZm9ybWF0aW9uIHNlY3VyZWx5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdG9yZVRva2VuSW5mbyh0b2tlbkluZm86IFRva2VuSW5mbyk6IHZvaWQge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQUNDRVNTX1RPS0VOLCB0b2tlbkluZm8uYWNjZXNzVG9rZW4pO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULCB0b2tlbkluZm8uZXhwaXJlc0F0LnRvU3RyaW5nKCkpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9UWVBFLCB0b2tlbkluZm8udG9rZW5UeXBlKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh0b2tlbkluZm8ucmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuUkVGUkVTSF9UT0tFTiwgdG9rZW5JbmZvLnJlZnJlc2hUb2tlbik7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmICh0b2tlbkluZm8uc2NvcGUpIHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TQ09QRSwgdG9rZW5JbmZvLnNjb3BlKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKHRva2VuSW5mby5pZFRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU4sIHRva2VuSW5mby5pZFRva2VuKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnVG9rZW4gaW5mb3JtYXRpb24gc3RvcmVkIHNlY3VyZWx5Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBzdG9yaW5nIHRva2VuIGluZm9ybWF0aW9uOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc3RvcmUgdG9rZW4gaW5mb3JtYXRpb24nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIHN0b3JlZCB0b2tlbiBpbmZvcm1hdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0U3RvcmVkVG9rZW5JbmZvKCk6IFRva2VuSW5mbyB8IG51bGwge1xyXG4gICAgaWYgKCF0aGlzLnN0b3JhZ2VTZXJ2aWNlLmlzQXZhaWxhYmxlKCkpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQUNDRVNTX1RPS0VOKTtcclxuICAgICAgY29uc3QgZXhwaXJlc0F0U3RyID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fRVhQSVJFU19BVCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIWFjY2Vzc1Rva2VuIHx8ICFleHBpcmVzQXRTdHIpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhY2Nlc3NUb2tlbixcclxuICAgICAgICByZWZyZXNoVG9rZW46IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4pIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB0b2tlblR5cGU6IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlRPS0VOX1RZUEUpIHx8ICdCZWFyZXInLFxyXG4gICAgICAgIGV4cGlyZXNBdDogcGFyc2VJbnQoZXhwaXJlc0F0U3RyLCAxMCksXHJcbiAgICAgICAgc2NvcGU6IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlNDT1BFKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgaWRUb2tlbjogdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU4pIHx8IHVuZGVmaW5lZFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgcmV0cmlldmluZyBzdG9yZWQgdG9rZW4gaW5mb3JtYXRpb246JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQXV0aFN0YXRlKG5ld1N0YXRlOiBQYXJ0aWFsPEF1dGhTdGF0ZT4pOiB2b2lkIHtcclxuICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHRoaXMuX2F1dGhTdGF0ZSgpO1xyXG4gICAgY29uc3QgdXBkYXRlZFN0YXRlID0geyAuLi5jdXJyZW50U3RhdGUsIC4uLm5ld1N0YXRlIH07XHJcbiAgICBcclxuICAgIHRoaXMuX2F1dGhTdGF0ZS5zZXQodXBkYXRlZFN0YXRlKTtcclxuICAgIHRoaXMuX2F1dGhTdGF0ZVN1YmplY3QubmV4dCh1cGRhdGVkU3RhdGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVidWcgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgbG9nRGVidWcobWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmZvIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0luZm8obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbyddLmluY2x1ZGVzKHRoaXMubG9nTGV2ZWwpKSB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMlNlcnZpY2VdICR7bWVzc2FnZX1gLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdhcm5pbmcgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgbG9nV2FybihtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgICBpZiAoWydkZWJ1ZycsICdpbmZvJywgJ3dhcm4nXS5pbmNsdWRlcyh0aGlzLmxvZ0xldmVsKSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFcnJvciBsb2dnaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2dFcnJvcihtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogYW55KTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5sb2dMZXZlbCAhPT0gJ25vbmUnKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxufSJdfQ==","customTransformCache":false,"dependencies":["@angular/core","@angular/common","rxjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","@angular/common/http","@angular/router","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { Injectable, Inject, PLATFORM_ID, signal } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { BehaviorSubject } from 'rxjs';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"./oauth2-storage.service\";\n/**\n * OAuth2 Service with PKCE Support\n * Handles OAuth2 authorization flow, token management, and user authentication\n */\nexport class OAuth2Service {\n    constructor(config, platformId, http, router, storageService) {\n        this.config = config;\n        this.platformId = platformId;\n        this.http = http;\n        this.router = router;\n        this.storageService = storageService;\n        this._authState = signal({\n            isAuthenticated: false,\n            isLoading: false\n        });\n        this._authStateSubject = new BehaviorSubject({\n            isAuthenticated: false,\n            isLoading: false\n        });\n        this.authState$ = this._authStateSubject.asObservable();\n        this.authState = this._authState.asReadonly();\n        this.logLevel = config.logLevel || 'warn';\n        this.initializeAuthState();\n    }\n    /**\n     * Initialize authentication state from stored tokens\n     */\n    initializeAuthState() {\n        if (!isPlatformBrowser(this.platformId)) {\n            return;\n        }\n        try {\n            const tokenInfo = this.getStoredTokenInfo();\n            if (tokenInfo && this.isTokenValid(tokenInfo)) {\n                this.updateAuthState({\n                    isAuthenticated: true,\n                    isLoading: false,\n                    tokenInfo\n                });\n                this.logInfo('Authentication state initialized from stored tokens');\n            }\n            else if (tokenInfo && tokenInfo.refreshToken) {\n                // Access token is expired but refresh token exists\n                this.logInfo('Access token expired but refresh token available - preserving for refresh flow');\n                this.updateAuthState({\n                    isAuthenticated: false,\n                    isLoading: false,\n                    tokenInfo: undefined\n                });\n            }\n            else {\n                // No tokens or no refresh token available - clear everything\n                this.storageService.clearTokens();\n                this.logInfo('No valid stored tokens found');\n            }\n        }\n        catch (error) {\n            this.logError('Error initializing auth state:', error);\n            this.storageService.clearTokens();\n        }\n    }\n    /**\n     * Generate cryptographically secure PKCE challenge\n     */\n    async generatePKCEChallenge() {\n        const codeVerifier = this.generateSecureCodeVerifier();\n        const codeChallenge = await this.createCodeChallenge(codeVerifier);\n        return {\n            codeVerifier,\n            codeChallenge,\n            codeChallengeMethod: this.config.codeChallengeMethod || 'S256'\n        };\n    }\n    /**\n     * Generate cryptographically secure 6-digit code verifier\n     */\n    generateSecureCodeVerifier() {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Code verifier generation requires browser environment');\n        }\n        // Generate 6 cryptographically secure random digits\n        const array = new Uint8Array(6);\n        crypto.getRandomValues(array);\n        // Convert to 6-digit string (000000-999999)\n        const codeVerifier = Array.from(array)\n            .map(byte => (byte % 10).toString())\n            .join('');\n        this.logDebug('Generated secure 6-digit code verifier');\n        return codeVerifier;\n    }\n    /**\n     * Create SHA-256 hash and base64 encode for code challenge\n     */\n    async createCodeChallenge(codeVerifier) {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Code challenge creation requires browser environment');\n        }\n        try {\n            // Encode the code verifier as UTF-8\n            const encoder = new TextEncoder();\n            const data = encoder.encode(codeVerifier);\n            // Create SHA-256 hash\n            const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n            // Convert to base64url encoding\n            const hashArray = new Uint8Array(hashBuffer);\n            const base64String = btoa(String.fromCharCode(...hashArray))\n                .replace(/\\+/g, '-')\n                .replace(/\\//g, '_')\n                .replace(/=/g, '');\n            this.logDebug('Generated code challenge from verifier');\n            return base64String;\n        }\n        catch (error) {\n            this.logError('Error creating code challenge:', error);\n            throw new Error('Failed to create code challenge');\n        }\n    }\n    /**\n     * Generate cryptographically secure state parameter for CSRF protection\n     */\n    generateState() {\n        if (!isPlatformBrowser(this.platformId)) {\n            return 'fallback-state';\n        }\n        const array = new Uint8Array(32);\n        crypto.getRandomValues(array);\n        return btoa(String.fromCharCode(...array))\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=/g, '');\n    }\n    /**\n     * Generate nonce if not provided in config\n     */\n    generateNonce() {\n        if (this.config.nonce) {\n            return this.config.nonce;\n        }\n        if (!isPlatformBrowser(this.platformId)) {\n            return 'fallback-nonce';\n        }\n        const array = new Uint8Array(16);\n        crypto.getRandomValues(array);\n        return btoa(String.fromCharCode(...array))\n            .replace(/\\+/g, '-')\n            .replace(/\\//g, '_')\n            .replace(/=/g, '');\n    }\n    /**\n     * Start OAuth2 PKCE authorization flow\n     */\n    async startAuthorization() {\n        if (!isPlatformBrowser(this.platformId)) {\n            this.logError('Authorization attempted in non-browser environment', 'SSR or server context detected');\n            this.updateAuthState({\n                isLoading: false,\n                error: 'Authentication not available in server environment'\n            });\n            return;\n        }\n        try {\n            this.updateAuthState({ isLoading: true, error: undefined });\n            // Generate PKCE challenge\n            const pkceChallenge = await this.generatePKCEChallenge();\n            // Generate state for CSRF protection\n            const state = this.generateState();\n            // Generate nonce\n            const nonce = this.generateNonce();\n            // Store code verifier, state, and nonce securely\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER, pkceChallenge.codeVerifier);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.STATE, state);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.NONCE, nonce);\n            // Build authorization request\n            const authRequest = {\n                client_id: this.config.clientId,\n                redirect_uri: this.config.redirectUri,\n                response_type: this.config.responseType || 'code',\n                nonce,\n                audience: this.config.audience,\n                scope: this.config.scope,\n                code_challenge_method: pkceChallenge.codeChallengeMethod,\n                code_challenge: pkceChallenge.codeChallenge,\n                state\n            };\n            // Build authorization URL\n            const authUrl = this.buildAuthorizationUrl(authRequest);\n            this.logInfo('Starting OAuth2 PKCE authorization flow');\n            this.logDebug('Authorization URL:', authUrl);\n            // Redirect to authorization server\n            window.location.href = authUrl;\n        }\n        catch (error) {\n            this.logError('Error starting authorization:', error);\n            this.updateAuthState({\n                isLoading: false,\n                error: 'Failed to start authorization flow'\n            });\n            throw error;\n        }\n    }\n    /**\n     * Build authorization URL with parameters\n     */\n    buildAuthorizationUrl(request) {\n        const params = new URLSearchParams();\n        Object.entries(request).forEach(([key, value]) => {\n            if (value !== undefined) {\n                params.append(key, value.toString());\n            }\n        });\n        return `${this.config.authorizationEndpoint}?${params.toString()}`;\n    }\n    /**\n     * Handle OAuth2 callback and extract tokens\n     */\n    async handleCallback() {\n        if (!isPlatformBrowser(this.platformId)) {\n            throw new Error('Callback handling requires browser environment');\n        }\n        try {\n            this.updateAuthState({ isLoading: true, error: undefined });\n            const currentUrl = window.location.href;\n            this.logInfo('Handling OAuth2 callback:', currentUrl);\n            // Check for error in callback\n            const error = this.extractErrorFromCallback();\n            if (error) {\n                throw new Error(`OAuth2 Error: ${error.error} - ${error.error_description || 'Unknown error'}`);\n            }\n            // Extract authorization code from query parameters or hash fragment\n            const authCode = this.extractAuthorizationCode();\n            this.logDebug('Extracted authorization code:', authCode ? 'Found' : 'Not found');\n            if (authCode) {\n                await this.exchangeCodeForTokens(authCode);\n                return;\n            }\n            // Extract tokens from URL fragment (implicit flow)\n            const tokens = this.extractTokensFromFragment();\n            this.logDebug('Extracted tokens from fragment:', tokens ? 'Found' : 'Not found');\n            if (tokens) {\n                await this.handleTokenResponse(tokens);\n                return;\n            }\n            throw new Error('No authorization code or tokens found in callback');\n        }\n        catch (error) {\n            this.logError('Error handling callback:', error);\n            this.updateAuthState({\n                isLoading: false,\n                error: error instanceof Error ? error.message : 'Callback handling failed'\n            });\n            this.storageService.clearAll();\n            throw error;\n        }\n    }\n    /**\n     * Extract error from callback URL\n     */\n    extractErrorFromCallback() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const hashParams = new URLSearchParams(window.location.hash.substring(1));\n        const error = urlParams.get('error') || hashParams.get('error');\n        if (error) {\n            return {\n                error,\n                error_description: urlParams.get('error_description') || hashParams.get('error_description') || undefined,\n                error_uri: urlParams.get('error_uri') || hashParams.get('error_uri') || undefined,\n                state: urlParams.get('state') || hashParams.get('state') || undefined\n            };\n        }\n        return null;\n    }\n    /**\n     * Extract authorization code from query parameters\n     */\n    extractAuthorizationCode() {\n        // First check query parameters\n        const urlParams = new URLSearchParams(window.location.search);\n        let code = urlParams.get('code');\n        // If not found in query params, check hash fragment\n        if (!code && window.location.hash) {\n            const hashParams = new URLSearchParams(window.location.hash.substring(1));\n            code = hashParams.get('code');\n        }\n        if (code) {\n            this.logDebug('Authorization code extracted from callback');\n            return code;\n        }\n        return null;\n    }\n    /**\n     * Extract tokens from URL fragment\n     */\n    extractTokensFromFragment() {\n        const fragment = window.location.hash.substring(1);\n        if (!fragment) {\n            return null;\n        }\n        const params = new URLSearchParams(fragment);\n        const accessToken = params.get('access_token');\n        if (accessToken) {\n            this.logDebug('Tokens extracted from URL fragment');\n            return {\n                access_token: accessToken,\n                refresh_token: params.get('refresh_token') || undefined,\n                token_type: params.get('token_type') || 'Bearer',\n                expires_in: parseInt(params.get('expires_in') || '3600', 10),\n                scope: params.get('scope') || undefined,\n                id_token: params.get('id_token') || undefined\n            };\n        }\n        return null;\n    }\n    /**\n     * Exchange authorization code for tokens\n     */\n    async exchangeCodeForTokens(authCode) {\n        const codeVerifier = this.storageService.getItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\n        if (!codeVerifier) {\n            this.logError('Code verifier not found in storage');\n            throw new Error('Code verifier not found in storage');\n        }\n        const tokenRequest = {\n            grant_type: 'authorization_code',\n            redirect_uri: this.config.redirectUri,\n            client_id: this.config.clientId,\n            code: authCode,\n            code_verifier: codeVerifier\n        };\n        this.logInfo('Exchanging authorization code for tokens');\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequest).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        try {\n            const tokenResponse = await this.http.post(this.config.tokenEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise();\n            if (tokenResponse) {\n                await this.handleTokenResponse(tokenResponse);\n            }\n            else {\n                throw new Error('No token response received');\n            }\n        }\n        catch (error) {\n            this.logError('Token exchange failed:', error);\n            throw new Error('Failed to exchange authorization code for tokens');\n        }\n    }\n    /**\n     * Handle token response and store tokens securely\n     */\n    async handleTokenResponse(tokenResponse) {\n        try {\n            // Validate state parameter for CSRF protection\n            await this.validateState();\n            // Create token info\n            const tokenInfo = {\n                accessToken: tokenResponse.access_token,\n                refreshToken: tokenResponse.refresh_token,\n                tokenType: tokenResponse.token_type || 'Bearer',\n                expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\n                scope: tokenResponse.scope,\n                idToken: tokenResponse.id_token\n            };\n            // Store tokens securely\n            this.storeTokenInfo(tokenInfo);\n            // Update authentication state\n            this.updateAuthState({\n                isAuthenticated: true,\n                isLoading: false,\n                tokenInfo,\n                error: undefined\n            });\n            // Clean up temporary storage\n            this.storageService.clearTemporary();\n            this.logInfo('Tokens stored successfully, user authenticated');\n        }\n        catch (error) {\n            this.logError('Error handling token response:', error);\n            throw error;\n        }\n    }\n    /**\n     * Validate state parameter for CSRF protection\n     */\n    async validateState() {\n        const urlParams = new URLSearchParams(window.location.search);\n        const hashParams = new URLSearchParams(window.location.hash.substring(1));\n        const receivedState = urlParams.get('state') || hashParams.get('state');\n        const storedState = this.storageService.getItem(OAUTH2_STORAGE_KEYS.STATE);\n        if (!receivedState || !storedState || receivedState !== storedState) {\n            throw new Error('Invalid state parameter - possible CSRF attack');\n        }\n        this.logDebug('State parameter validated successfully');\n    }\n    /**\n     * Get current access token (only if valid/not expired)\n     */\n    getAccessToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        if (tokenInfo && this.isTokenValid(tokenInfo)) {\n            return tokenInfo.accessToken;\n        }\n        return null;\n    }\n    /**\n     * Get raw access token (even if expired) - used for refresh flow\n     */\n    getRawAccessToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo?.accessToken || null;\n    }\n    /**\n     * Get current refresh token\n     */\n    getRefreshToken() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo?.refreshToken || null;\n    }\n    /**\n     * Check if user is authenticated\n     */\n    isAuthenticated() {\n        const tokenInfo = this.getStoredTokenInfo();\n        return tokenInfo ? this.isTokenValid(tokenInfo) : false;\n    }\n    /**\n     * Check if authentication is available in current environment\n     */\n    isAuthenticationAvailable() {\n        return isPlatformBrowser(this.platformId);\n    }\n    /**\n     * Fetch user information from OIDC userinfo endpoint\n     */\n    async getUserInfo() {\n        if (!this.config.userInfoEndpoint) {\n            throw new Error('UserInfo endpoint not configured');\n        }\n        const accessToken = this.getAccessToken();\n        if (!accessToken) {\n            throw new Error('No access token available');\n        }\n        this.logInfo('Fetching user info from OIDC userinfo endpoint');\n        try {\n            const userInfo = await this.http.get(this.config.userInfoEndpoint, {\n                headers: {\n                    'Authorization': `Bearer ${accessToken}`\n                }\n            }).toPromise();\n            if (userInfo) {\n                this.logDebug('User info retrieved successfully:', userInfo);\n                return userInfo;\n            }\n            else {\n                throw new Error('No user info response received');\n            }\n        }\n        catch (error) {\n            this.logError('Failed to fetch user info:', error);\n            throw new Error('Failed to fetch user information');\n        }\n    }\n    /**\n     * Check if token is valid (not expired)\n     */\n    isTokenValid(tokenInfo) {\n        const threshold = (this.config.refreshThreshold || 300) * 1000; // Convert to milliseconds\n        return Date.now() < (tokenInfo.expiresAt - threshold);\n    }\n    /**\n     * Refresh access token using refresh token\n     */\n    async refreshAccessToken() {\n        const refreshToken = this.getRefreshToken();\n        if (!refreshToken) {\n            throw new Error('No refresh token available');\n        }\n        this.logInfo('Refreshing access token');\n        const tokenRequest = {\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: this.config.clientId\n        };\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequest).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        try {\n            const tokenResponse = await this.http.post(this.config.tokenEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise();\n            if (tokenResponse) {\n                const tokenInfo = {\n                    accessToken: tokenResponse.access_token,\n                    refreshToken: tokenResponse.refresh_token || refreshToken,\n                    tokenType: tokenResponse.token_type || 'Bearer',\n                    expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\n                    scope: tokenResponse.scope,\n                    idToken: tokenResponse.id_token\n                };\n                this.storeTokenInfo(tokenInfo);\n                this.updateAuthState({\n                    isAuthenticated: true,\n                    isLoading: false,\n                    tokenInfo\n                });\n                this.logInfo('Access token refreshed successfully');\n                return tokenResponse.access_token;\n            }\n            else {\n                throw new Error('No token response received');\n            }\n        }\n        catch (error) {\n            this.logError('Token refresh failed:', error);\n            // Only logout if it's a 400/401 error indicating invalid refresh token\n            if (error instanceof Error && 'status' in error) {\n                const httpError = error;\n                if (httpError.status === 400 || httpError.status === 401) {\n                    this.logInfo('Refresh token is invalid, logging out');\n                    this.logout();\n                }\n            }\n            else {\n                this.logInfo('Network or server error during token refresh, will retry later');\n            }\n            throw new Error('Failed to refresh access token');\n        }\n    }\n    /**\n     * Logout user and clean up all stored data\n     */\n    async logout() {\n        try {\n            this.updateAuthState({ isLoading: true });\n            // Revoke tokens if supported\n            await this.revokeTokens();\n            // Clear all stored authentication data\n            this.storageService.clearAll();\n            // Update authentication state\n            this.updateAuthState({\n                isAuthenticated: false,\n                isLoading: false,\n                tokenInfo: undefined,\n                error: undefined\n            });\n            this.logInfo('User logged out successfully');\n        }\n        catch (error) {\n            this.logError('Error during logout:', error);\n            // Still clear local data even if revocation fails\n            this.storageService.clearAll();\n            this.updateAuthState({\n                isAuthenticated: false,\n                isLoading: false,\n                tokenInfo: undefined\n            });\n        }\n    }\n    /**\n     * Revoke tokens at authorization server\n     */\n    async revokeTokens() {\n        if (!this.config.revokeEndpoint) {\n            this.logInfo('Token revocation endpoint not configured');\n            return;\n        }\n        const accessToken = this.getAccessToken();\n        const refreshToken = this.getRefreshToken();\n        const revokePromises = [];\n        if (accessToken) {\n            const revokeRequest = {\n                token: accessToken,\n                token_type_hint: 'access_token',\n                client_id: this.config.clientId\n            };\n            const formData = new URLSearchParams();\n            Object.entries(revokeRequest).forEach(([key, value]) => {\n                if (value !== undefined) {\n                    formData.append(key, value.toString());\n                }\n            });\n            revokePromises.push(this.http.post(this.config.revokeEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise());\n        }\n        if (refreshToken) {\n            const revokeRequest = {\n                token: refreshToken,\n                token_type_hint: 'refresh_token',\n                client_id: this.config.clientId\n            };\n            const formData = new URLSearchParams();\n            Object.entries(revokeRequest).forEach(([key, value]) => {\n                if (value !== undefined) {\n                    formData.append(key, value.toString());\n                }\n            });\n            revokePromises.push(this.http.post(this.config.revokeEndpoint, formData.toString(), {\n                headers: {\n                    'Content-Type': 'application/x-www-form-urlencoded'\n                }\n            }).toPromise());\n        }\n        if (revokePromises.length > 0) {\n            try {\n                await Promise.all(revokePromises);\n                this.logInfo('Tokens revoked successfully');\n            }\n            catch (error) {\n                this.logError('Token revocation failed:', error);\n                // Don't throw error, continue with logout\n            }\n        }\n    }\n    /**\n     * Store token information securely\n     */\n    storeTokenInfo(tokenInfo) {\n        try {\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenInfo.accessToken);\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, tokenInfo.expiresAt.toString());\n            this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE, tokenInfo.tokenType);\n            if (tokenInfo.refreshToken) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenInfo.refreshToken);\n            }\n            if (tokenInfo.scope) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.SCOPE, tokenInfo.scope);\n            }\n            if (tokenInfo.idToken) {\n                this.storageService.setItem(OAUTH2_STORAGE_KEYS.ID_TOKEN, tokenInfo.idToken);\n            }\n            this.logDebug('Token information stored securely');\n        }\n        catch (error) {\n            this.logError('Error storing token information:', error);\n            throw new Error('Failed to store token information');\n        }\n    }\n    /**\n     * Retrieve stored token information\n     */\n    getStoredTokenInfo() {\n        if (!this.storageService.isAvailable()) {\n            return null;\n        }\n        try {\n            const accessToken = this.storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\n            const expiresAtStr = this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\n            if (!accessToken || !expiresAtStr) {\n                return null;\n            }\n            return {\n                accessToken,\n                refreshToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN) || undefined,\n                tokenType: this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE) || 'Bearer',\n                expiresAt: parseInt(expiresAtStr, 10),\n                scope: this.storageService.getItem(OAUTH2_STORAGE_KEYS.SCOPE) || undefined,\n                idToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.ID_TOKEN) || undefined\n            };\n        }\n        catch (error) {\n            this.logError('Error retrieving stored token information:', error);\n            return null;\n        }\n    }\n    /**\n     * Update authentication state\n     */\n    updateAuthState(newState) {\n        const currentState = this._authState();\n        const updatedState = { ...currentState, ...newState };\n        this._authState.set(updatedState);\n        this._authStateSubject.next(updatedState);\n    }\n    /**\n     * Debug logging\n     */\n    logDebug(message, ...args) {\n        if (this.logLevel === 'debug') {\n            console.log(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Info logging\n     */\n    logInfo(message, ...args) {\n        if (['debug', 'info'].includes(this.logLevel)) {\n            console.info(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Warning logging\n     */\n    logWarn(message, ...args) {\n        if (['debug', 'info', 'warn'].includes(this.logLevel)) {\n            console.warn(`[OAuth2Service] ${message}`, ...args);\n        }\n    }\n    /**\n     * Error logging\n     */\n    logError(message, error) {\n        if (this.logLevel !== 'none') {\n            console.error(`[OAuth2Service] ${message}`, error);\n        }\n    }\n    static { this.ɵfac = function OAuth2Service_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2Service)(i0.ɵɵinject(OAUTH2_CONFIG_TOKEN), i0.ɵɵinject(PLATFORM_ID), i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.OAuth2StorageService)); }; }\n    static { this.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: OAuth2Service, factory: OAuth2Service.ɵfac, providedIn: 'root' }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2Service, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'root'\n            }]\n    }], () => [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [OAUTH2_CONFIG_TOKEN]\n            }] }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }, { type: i1.HttpClient }, { type: i2.Router }, { type: i3.OAuth2StorageService }], null); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL3NlcnZpY2VzL29hdXRoMi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDeEUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFHcEQsT0FBTyxFQUFjLGVBQWUsRUFBa0IsTUFBTSxNQUFNLENBQUM7QUFJbkUsT0FBTyxFQVFMLG1CQUFtQixFQUdwQixNQUFNLDhCQUE4QixDQUFDO0FBQ3RDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLCtCQUErQixDQUFDOzs7OztBQUdwRTs7O0dBR0c7QUFJSCxNQUFNLE9BQU8sYUFBYTtJQWdCeEIsWUFDdUMsTUFBb0IsRUFDNUIsVUFBa0IsRUFDdkMsSUFBZ0IsRUFDaEIsTUFBYyxFQUNkLGNBQW9DO1FBSlAsV0FBTSxHQUFOLE1BQU0sQ0FBYztRQUM1QixlQUFVLEdBQVYsVUFBVSxDQUFRO1FBQ3ZDLFNBQUksR0FBSixJQUFJLENBQVk7UUFDaEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLG1CQUFjLEdBQWQsY0FBYyxDQUFzQjtRQXBCdEMsZUFBVSxHQUFHLE1BQU0sQ0FBWTtZQUNyQyxlQUFlLEVBQUUsS0FBSztZQUN0QixTQUFTLEVBQUUsS0FBSztTQUNqQixDQUFDLENBQUM7UUFFSyxzQkFBaUIsR0FBRyxJQUFJLGVBQWUsQ0FBWTtZQUN6RCxlQUFlLEVBQUUsS0FBSztZQUN0QixTQUFTLEVBQUUsS0FBSztTQUNqQixDQUFDLENBQUM7UUFFSSxlQUFVLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLFlBQVksRUFBRSxDQUFDO1FBQzFDLGNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLFVBQVUsRUFBRSxDQUFD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O0lBRUQ7O09BRUc7SUFDSyxPQUFPLENBQUMsT0FBZSxFQUFFLEdBQUcsSUFBVztRQUM3QyxJQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7WUFDdEQsT0FBTyxDQUFDLElBQUksQ0FBQyxtQkFBbUIsT0FBTyxFQUFFLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUN0RCxDQUFDO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ssUUFBUSxDQUFDLE9BQWUsRUFBRSxLQUFXO1FBQzNDLElBQUksSUFBSSxDQUFDLFFBQVEsS0FBSyxNQUFNLEVBQUUsQ0FBQztZQUM3QixPQUFPLENBQUMsS0FBSyxDQUFDLG1CQUFtQixPQUFPLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNyRCxDQUFDO0lBQ0gsQ0FBQzs4R0E1MEJVLGFBQWEsY0FpQmQsbUJBQW1CLGVBQ25CLFdBQVc7dUVBbEJWLGFBQWEsV0FBYixhQUFhLG1CQUZaLE1BQU07O2lGQUVQLGFBQWE7Y0FIekIsVUFBVTtlQUFDO2dCQUNWLFVBQVUsRUFBRSxNQUFNO2FBQ25COztzQkFrQkksTUFBTTt1QkFBQyxtQkFBbUI7O3NCQUMxQixNQUFNO3VCQUFDLFdBQVciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3QsIFBMQVRGT1JNX0lELCBzaWduYWwgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBCZWhhdmlvclN1YmplY3QsIHRocm93RXJyb3IsIG9mIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IG1hcCwgY2F0Y2hFcnJvciwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQge1xyXG4gIFBLQ0VDaGFsbGVuZ2UsXHJcbiAgQXV0aG9yaXphdGlvblJlcXVlc3QsXHJcbiAgVG9rZW5SZXF1ZXN0LFxyXG4gIFRva2VuUmVzcG9uc2UsXHJcbiAgVG9rZW5JbmZvLFxyXG4gIEF1dGhTdGF0ZSxcclxuICBPQXV0aDJFcnJvcixcclxuICBPQVVUSDJfU1RPUkFHRV9LRVlTLFxyXG4gIFVzZXJJbmZvUmVzcG9uc2UsXHJcbiAgT0F1dGgyTG9nTGV2ZWxcclxufSBmcm9tICcuLi9tb2RlbHMvb2F1dGgyLXR5cGVzLm1vZGVsJztcclxuaW1wb3J0IHsgT0FVVEgyX0NPTkZJR19UT0tFTiB9IGZyb20gJy4uL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuaW1wb3J0IHsgT0F1dGgyU3RvcmFnZVNlcnZpY2UgfSBmcm9tICcuL29hdXRoMi1zdG9yYWdlLnNlcnZpY2UnO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBTZXJ2aWNlIHdpdGggUEtDRSBTdXBwb3J0XHJcbiAqIEhhbmRsZXMgT0F1dGgyIGF1dGhvcml6YXRpb24gZmxvdywgdG9rZW4gbWFuYWdlbWVudCwgYW5kIHVzZXIgYXV0aGVudGljYXRpb25cclxuICovXHJcbkBJbmplY3RhYmxlKHtcclxuICBwcm92aWRlZEluOiAncm9vdCdcclxufSlcclxuZXhwb3J0IGNsYXNzIE9BdXRoMlNlcnZpY2Uge1xyXG4gIHByaXZhdGUgX2F1dGhTdGF0ZSA9IHNpZ25hbDxBdXRoU3RhdGU+KHtcclxuICAgIGlzQXV0aGVudGljYXRlZDogZmFsc2UsXHJcbiAgICBpc0xvYWRpbmc6IGZhbHNlXHJcbiAgfSk7XHJcblxyXG4gIHByaXZhdGUgX2F1dGhTdGF0ZVN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEF1dGhTdGF0ZT4oe1xyXG4gICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgIGlzTG9hZGluZzogZmFsc2VcclxuICB9KTtcclxuXHJcbiAgcHVibGljIGF1dGhTdGF0ZSQgPSB0aGlzLl9hdXRoU3RhdGVTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xyXG4gIHB1YmxpYyByZWFkb25seSBhdXRoU3RhdGUgPSB0aGlzLl9hdXRoU3RhdGUuYXNSZWFkb25seSgpO1xyXG5cclxuICBwcml2YXRlIGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbDtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBASW5qZWN0KE9BVVRIMl9DT05GSUdfVE9LRU4pIHByaXZhdGUgY29uZmlnOiBPQXV0aDJDb25maWcsXHJcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtSWQ6IE9iamVjdCxcclxuICAgIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcclxuICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXHJcbiAgICBwcml2YXRlIHN0b3JhZ2VTZXJ2aWNlOiBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gICkge1xyXG4gICAgdGhpcy5sb2dMZXZlbCA9IGNvbmZpZy5sb2dMZXZlbCB8fCAnd2Fybic7XHJcbiAgICB0aGlzLmluaXRpYWxpemVBdXRoU3RhdGUoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluaXRpYWxpemUgYXV0aGVudGljYXRpb24gc3RhdGUgZnJvbSBzdG9yZWQgdG9rZW5zXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpbml0aWFsaXplQXV0aFN0YXRlKCk6IHZvaWQge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0b2tlbkluZm8gPSB0aGlzLmdldFN0b3JlZFRva2VuSW5mbygpO1xyXG4gICAgICBpZiAodG9rZW5JbmZvICYmIHRoaXMuaXNUb2tlblZhbGlkKHRva2VuSW5mbykpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgdG9rZW5JbmZvXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdBdXRoZW50aWNhdGlvbiBzdGF0ZSBpbml0aWFsaXplZCBmcm9tIHN0b3JlZCB0b2tlbnMnKTtcclxuICAgICAgfSBlbHNlIGlmICh0b2tlbkluZm8gJiYgdG9rZW5JbmZvLnJlZnJlc2hUb2tlbikge1xyXG4gICAgICAgIC8vIEFjY2VzcyB0b2tlbiBpcyBleHBpcmVkIGJ1dCByZWZyZXNoIHRva2VuIGV4aXN0c1xyXG4gICAgICAgIHRoaXMubG9nSW5mbygnQWNjZXNzIHRva2VuIGV4cGlyZWQgYnV0IHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlIC0gcHJlc2VydmluZyBmb3IgcmVmcmVzaCBmbG93Jyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoe1xyXG4gICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgICB0b2tlbkluZm86IHVuZGVmaW5lZFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIE5vIHRva2VucyBvciBubyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZSAtIGNsZWFyIGV2ZXJ5dGhpbmdcclxuICAgICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLmNsZWFyVG9rZW5zKCk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdObyB2YWxpZCBzdG9yZWQgdG9rZW5zIGZvdW5kJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBhdXRoIHN0YXRlOicsIGVycm9yKTtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhclRva2VucygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgY3J5cHRvZ3JhcGhpY2FsbHkgc2VjdXJlIFBLQ0UgY2hhbGxlbmdlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTogUHJvbWlzZTxQS0NFQ2hhbGxlbmdlPiB7XHJcbiAgICBjb25zdCBjb2RlVmVyaWZpZXIgPSB0aGlzLmdlbmVyYXRlU2VjdXJlQ29kZVZlcmlmaWVyKCk7XHJcbiAgICBjb25zdCBjb2RlQ2hhbGxlbmdlID0gYXdhaXQgdGhpcy5jcmVhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcik7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGNvZGVWZXJpZmllcixcclxuICAgICAgY29kZUNoYWxsZW5nZSxcclxuICAgICAgY29kZUNoYWxsZW5nZU1ldGhvZDogdGhpcy5jb25maWcuY29kZUNoYWxsZW5nZU1ldGhvZCB8fCAnUzI1NidcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgNi1kaWdpdCBjb2RlIHZlcmlmaWVyXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBnZW5lcmF0ZVNlY3VyZUNvZGVWZXJpZmllcigpOiBzdHJpbmcge1xyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ29kZSB2ZXJpZmllciBnZW5lcmF0aW9uIHJlcXVpcmVzIGJyb3dzZXIgZW52aXJvbm1lbnQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSA2IGNyeXB0b2dyYXBoaWNhbGx5IHNlY3VyZSByYW5kb20gZGlnaXRzXHJcbiAgICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KDYpO1xyXG4gICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyhhcnJheSk7XHJcbiAgICBcclxuICAgIC8vIENvbnZlcnQgdG8gNi1kaWdpdCBzdHJpbmcgKDAwMDAwMC05OTk5OTkpXHJcbiAgICBjb25zdCBjb2RlVmVyaWZpZXIgPSBBcnJheS5mcm9tKGFycmF5KVxyXG4gICAgICAubWFwKGJ5dGUgPT4gKGJ5dGUgJSAxMCkudG9TdHJpbmcoKSlcclxuICAgICAgLmpvaW4oJycpO1xyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0RlYnVnKCdHZW5lcmF0ZWQgc2VjdXJlIDYtZGlnaXQgY29kZSB2ZXJpZmllcicpO1xyXG4gICAgcmV0dXJuIGNvZGVWZXJpZmllcjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBTSEEtMjU2IGhhc2ggYW5kIGJhc2U2NCBlbmNvZGUgZm9yIGNvZGUgY2hhbGxlbmdlXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBjcmVhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcjogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvZGUgY2hhbGxlbmdlIGNyZWF0aW9uIHJlcXVpcmVzIGJyb3dzZXIgZW52aXJvbm1lbnQnKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBFbmNvZGUgdGhlIGNvZGUgdmVyaWZpZXIgYXMgVVRGLThcclxuICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xyXG4gICAgICBjb25zdCBkYXRhID0gZW5jb2Rlci5lbmNvZGUoY29kZVZlcmlmaWVyKTtcclxuICAgICAgXHJcbiAgICAgIC8vIENyZWF0ZSBTSEEtMjU2IGhhc2hcclxuICAgICAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb252ZXJ0IHRvIGJhc2U2NHVybCBlbmNvZGluZ1xyXG4gICAgICBjb25zdCBoYXNoQXJyYXkgPSBuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKTtcclxuICAgICAgY29uc3QgYmFzZTY0U3RyaW5nID0gYnRvYShTdHJpbmcuZnJvbUNoYXJDb2RlKC4uLmhhc2hBcnJheSkpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcKy9nLCAnLScpXHJcbiAgICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnXycpXHJcbiAgICAgICAgLnJlcGxhY2UoLz0vZywgJycpO1xyXG4gICAgICBcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnR2VuZXJhdGVkIGNvZGUgY2hhbGxlbmdlIGZyb20gdmVyaWZpZXInKTtcclxuICAgICAgcmV0dXJuIGJhc2U2NFN0cmluZztcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvZGUgY2hhbGxlbmdlOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGNvZGUgY2hhbGxlbmdlJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZW5lcmF0ZSBjcnlwdG9ncmFwaGljYWxseSBzZWN1cmUgc3RhdGUgcGFyYW1ldGVyIGZvciBDU1JGIHByb3RlY3Rpb25cclxuICAgKi9cclxuICBwcml2YXRlIGdlbmVyYXRlU3RhdGUoKTogc3RyaW5nIHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICByZXR1cm4gJ2ZhbGxiYWNrLXN0YXRlJztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhcnJheSA9IG5ldyBVaW50OEFycmF5KDMyKTtcclxuICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoYXJyYXkpO1xyXG4gICAgcmV0dXJuIGJ0b2EoU3RyaW5nLmZyb21DaGFyQ29kZSguLi5hcnJheSkpXHJcbiAgICAgIC5yZXBsYWNlKC9cXCsvZywgJy0nKVxyXG4gICAgICAucmVwbGFjZSgvXFwvL2csICdfJylcclxuICAgICAgLnJlcGxhY2UoLz0vZywgJycpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGUgbm9uY2UgaWYgbm90IHByb3ZpZGVkIGluIGNvbmZpZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2VuZXJhdGVOb25jZSgpOiBzdHJpbmcge1xyXG4gICAgaWYgKHRoaXMuY29uZmlnLm5vbmNlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5ub25jZTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcclxuICAgICAgcmV0dXJuICdmYWxsYmFjay1ub25jZSc7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgYXJyYXkgPSBuZXcgVWludDhBcnJheSgxNik7XHJcbiAgICBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKGFycmF5KTtcclxuICAgIHJldHVybiBidG9hKFN0cmluZy5mcm9tQ2hhckNvZGUoLi4uYXJyYXkpKVxyXG4gICAgICAucmVwbGFjZSgvXFwrL2csICctJylcclxuICAgICAgLnJlcGxhY2UoL1xcLy9nLCAnXycpXHJcbiAgICAgIC5yZXBsYWNlKC89L2csICcnKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0IE9BdXRoMiBQS0NFIGF1dGhvcml6YXRpb24gZmxvd1xyXG4gICAqL1xyXG4gIGFzeW5jIHN0YXJ0QXV0aG9yaXphdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGlmICghaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdBdXRob3JpemF0aW9uIGF0dGVtcHRlZCBpbiBub24tYnJvd3NlciBlbnZpcm9ubWVudCcsICdTU1Igb3Igc2VydmVyIGNvbnRleHQgZGV0ZWN0ZWQnKTtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoe1xyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdBdXRoZW50aWNhdGlvbiBub3QgYXZhaWxhYmxlIGluIHNlcnZlciBlbnZpcm9ubWVudCdcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7IGlzTG9hZGluZzogdHJ1ZSwgZXJyb3I6IHVuZGVmaW5lZCB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdlbmVyYXRlIFBLQ0UgY2hhbGxlbmdlXHJcbiAgICAgIGNvbnN0IHBrY2VDaGFsbGVuZ2UgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUEtDRUNoYWxsZW5nZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2VuZXJhdGUgc3RhdGUgZm9yIENTUkYgcHJvdGVjdGlvblxyXG4gICAgICBjb25zdCBzdGF0ZSA9IHRoaXMuZ2VuZXJhdGVTdGF0ZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gR2VuZXJhdGUgbm9uY2VcclxuICAgICAgY29uc3Qgbm9uY2UgPSB0aGlzLmdlbmVyYXRlTm9uY2UoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFN0b3JlIGNvZGUgdmVyaWZpZXIsIHN0YXRlLCBhbmQgbm9uY2Ugc2VjdXJlbHlcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQ09ERV9WRVJJRklFUiwgcGtjZUNoYWxsZW5nZS5jb2RlVmVyaWZpZXIpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TVEFURSwgc3RhdGUpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5OT05DRSwgbm9uY2UpO1xyXG4gICAgICBcclxuICAgICAgLy8gQnVpbGQgYXV0aG9yaXphdGlvbiByZXF1ZXN0XHJcbiAgICAgIGNvbnN0IGF1dGhSZXF1ZXN0OiBBdXRob3JpemF0aW9uUmVxdWVzdCA9IHtcclxuICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY29uZmlnLmNsaWVudElkLFxyXG4gICAgICAgIHJlZGlyZWN0X3VyaTogdGhpcy5jb25maWcucmVkaXJlY3RVcmksXHJcbiAgICAgICAgcmVzcG9uc2VfdHlwZTogdGhpcy5jb25maWcucmVzcG9uc2VUeXBlIHx8ICdjb2RlJyxcclxuICAgICAgICBub25jZSxcclxuICAgICAgICBhdWRpZW5jZTogdGhpcy5jb25maWcuYXVkaWVuY2UsXHJcbiAgICAgICAgc2NvcGU6IHRoaXMuY29uZmlnLnNjb3BlLFxyXG4gICAgICAgIGNvZGVfY2hhbGxlbmdlX21ldGhvZDogcGtjZUNoYWxsZW5nZS5jb2RlQ2hhbGxlbmdlTWV0aG9kLFxyXG4gICAgICAgIGNvZGVfY2hhbGxlbmdlOiBwa2NlQ2hhbGxlbmdlLmNvZGVDaGFsbGVuZ2UsXHJcbiAgICAgICAgc3RhdGVcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIC8vIEJ1aWxkIGF1dGhvcml6YXRpb24gVVJMXHJcbiAgICAgIGNvbnN0IGF1dGhVcmwgPSB0aGlzLmJ1aWxkQXV0aG9yaXphdGlvblVybChhdXRoUmVxdWVzdCk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1N0YXJ0aW5nIE9BdXRoMiBQS0NFIGF1dGhvcml6YXRpb24gZmxvdycpO1xyXG4gICAgICB0aGlzLmxvZ0RlYnVnKCdBdXRob3JpemF0aW9uIFVSTDonLCBhdXRoVXJsKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFJlZGlyZWN0IHRvIGF1dGhvcml6YXRpb24gc2VydmVyXHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYXV0aFVybDtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBzdGFydGluZyBhdXRob3JpemF0aW9uOicsIGVycm9yKTtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLCBcclxuICAgICAgICBlcnJvcjogJ0ZhaWxlZCB0byBzdGFydCBhdXRob3JpemF0aW9uIGZsb3cnIFxyXG4gICAgICB9KTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBCdWlsZCBhdXRob3JpemF0aW9uIFVSTCB3aXRoIHBhcmFtZXRlcnNcclxuICAgKi9cclxuICBwcml2YXRlIGJ1aWxkQXV0aG9yaXphdGlvblVybChyZXF1ZXN0OiBBdXRob3JpemF0aW9uUmVxdWVzdCk6IHN0cmluZyB7XHJcbiAgICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcbiAgICBcclxuICAgIE9iamVjdC5lbnRyaWVzKHJlcXVlc3QpLmZvckVhY2goKFtrZXksIHZhbHVlXSkgPT4ge1xyXG4gICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHBhcmFtcy5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiBgJHt0aGlzLmNvbmZpZy5hdXRob3JpemF0aW9uRW5kcG9pbnR9PyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSBPQXV0aDIgY2FsbGJhY2sgYW5kIGV4dHJhY3QgdG9rZW5zXHJcbiAgICovXHJcbiAgYXN5bmMgaGFuZGxlQ2FsbGJhY2soKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICBpZiAoIWlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYWxsYmFjayBoYW5kbGluZyByZXF1aXJlcyBicm93c2VyIGVudmlyb25tZW50Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBpc0xvYWRpbmc6IHRydWUsIGVycm9yOiB1bmRlZmluZWQgfSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBjdXJyZW50VXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgIHRoaXMubG9nSW5mbygnSGFuZGxpbmcgT0F1dGgyIGNhbGxiYWNrOicsIGN1cnJlbnRVcmwpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgZm9yIGVycm9yIGluIGNhbGxiYWNrXHJcbiAgICAgIGNvbnN0IGVycm9yID0gdGhpcy5leHRyYWN0RXJyb3JGcm9tQ2FsbGJhY2soKTtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPQXV0aDIgRXJyb3I6ICR7ZXJyb3IuZXJyb3J9IC0gJHtlcnJvci5lcnJvcl9kZXNjcmlwdGlvbiB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vIEV4dHJhY3QgYXV0aG9yaXphdGlvbiBjb2RlIGZyb20gcXVlcnkgcGFyYW1ldGVycyBvciBoYXNoIGZyYWdtZW50XHJcbiAgICAgIGNvbnN0IGF1dGhDb2RlID0gdGhpcy5leHRyYWN0QXV0aG9yaXphdGlvbkNvZGUoKTtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnRXh0cmFjdGVkIGF1dGhvcml6YXRpb24gY29kZTonLCBhdXRoQ29kZSA/ICdGb3VuZCcgOiAnTm90IGZvdW5kJyk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoYXV0aENvZGUpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmV4Y2hhbmdlQ29kZUZvclRva2VucyhhdXRoQ29kZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBFeHRyYWN0IHRva2VucyBmcm9tIFVSTCBmcmFnbWVudCAoaW1wbGljaXQgZmxvdylcclxuICAgICAgY29uc3QgdG9rZW5zID0gdGhpcy5leHRyYWN0VG9rZW5zRnJvbUZyYWdtZW50KCk7XHJcbiAgICAgIHRoaXMubG9nRGVidWcoJ0V4dHJhY3RlZCB0b2tlbnMgZnJvbSBmcmFnbWVudDonLCB0b2tlbnMgPyAnRm91bmQnIDogJ05vdCBmb3VuZCcpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHRva2Vucykge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlVG9rZW5SZXNwb25zZSh0b2tlbnMpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBhdXRob3JpemF0aW9uIGNvZGUgb3IgdG9rZW5zIGZvdW5kIGluIGNhbGxiYWNrJyk7XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgaGFuZGxpbmcgY2FsbGJhY2s6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7IFxyXG4gICAgICAgIGlzTG9hZGluZzogZmFsc2UsIFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdDYWxsYmFjayBoYW5kbGluZyBmYWlsZWQnIFxyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICB0aHJvdyBlcnJvcjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4dHJhY3QgZXJyb3IgZnJvbSBjYWxsYmFjayBVUkxcclxuICAgKi9cclxuICBwcml2YXRlIGV4dHJhY3RFcnJvckZyb21DYWxsYmFjaygpOiBPQXV0aDJFcnJvciB8IG51bGwge1xyXG4gICAgY29uc3QgdXJsUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcclxuICAgIGNvbnN0IGhhc2hQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGVycm9yID0gdXJsUGFyYW1zLmdldCgnZXJyb3InKSB8fCBoYXNoUGFyYW1zLmdldCgnZXJyb3InKTtcclxuICAgIGlmIChlcnJvcikge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGVycm9yLFxyXG4gICAgICAgIGVycm9yX2Rlc2NyaXB0aW9uOiB1cmxQYXJhbXMuZ2V0KCdlcnJvcl9kZXNjcmlwdGlvbicpIHx8IGhhc2hQYXJhbXMuZ2V0KCdlcnJvcl9kZXNjcmlwdGlvbicpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICBlcnJvcl91cmk6IHVybFBhcmFtcy5nZXQoJ2Vycm9yX3VyaScpIHx8IGhhc2hQYXJhbXMuZ2V0KCdlcnJvcl91cmknKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgc3RhdGU6IHVybFBhcmFtcy5nZXQoJ3N0YXRlJykgfHwgaGFzaFBhcmFtcy5nZXQoJ3N0YXRlJykgfHwgdW5kZWZpbmVkXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdCBhdXRob3JpemF0aW9uIGNvZGUgZnJvbSBxdWVyeSBwYXJhbWV0ZXJzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBleHRyYWN0QXV0aG9yaXphdGlvbkNvZGUoKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICAvLyBGaXJzdCBjaGVjayBxdWVyeSBwYXJhbWV0ZXJzXHJcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG4gICAgbGV0IGNvZGUgPSB1cmxQYXJhbXMuZ2V0KCdjb2RlJyk7XHJcbiAgICBcclxuICAgIC8vIElmIG5vdCBmb3VuZCBpbiBxdWVyeSBwYXJhbXMsIGNoZWNrIGhhc2ggZnJhZ21lbnRcclxuICAgIGlmICghY29kZSAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCkge1xyXG4gICAgICBjb25zdCBoYXNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkpO1xyXG4gICAgICBjb2RlID0gaGFzaFBhcmFtcy5nZXQoJ2NvZGUnKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGNvZGUpIHtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnQXV0aG9yaXphdGlvbiBjb2RlIGV4dHJhY3RlZCBmcm9tIGNhbGxiYWNrJyk7XHJcbiAgICAgIHJldHVybiBjb2RlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEV4dHJhY3QgdG9rZW5zIGZyb20gVVJMIGZyYWdtZW50XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBleHRyYWN0VG9rZW5zRnJvbUZyYWdtZW50KCk6IFRva2VuUmVzcG9uc2UgfCBudWxsIHtcclxuICAgIGNvbnN0IGZyYWdtZW50ID0gd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpO1xyXG4gICAgaWYgKCFmcmFnbWVudCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyhmcmFnbWVudCk7XHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHBhcmFtcy5nZXQoJ2FjY2Vzc190b2tlbicpO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnVG9rZW5zIGV4dHJhY3RlZCBmcm9tIFVSTCBmcmFnbWVudCcpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFjY2Vzc190b2tlbjogYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgcmVmcmVzaF90b2tlbjogcGFyYW1zLmdldCgncmVmcmVzaF90b2tlbicpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB0b2tlbl90eXBlOiBwYXJhbXMuZ2V0KCd0b2tlbl90eXBlJykgfHwgJ0JlYXJlcicsXHJcbiAgICAgICAgZXhwaXJlc19pbjogcGFyc2VJbnQocGFyYW1zLmdldCgnZXhwaXJlc19pbicpIHx8ICczNjAwJywgMTApLFxyXG4gICAgICAgIHNjb3BlOiBwYXJhbXMuZ2V0KCdzY29wZScpIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICBpZF90b2tlbjogcGFyYW1zLmdldCgnaWRfdG9rZW4nKSB8fCB1bmRlZmluZWRcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFeGNoYW5nZSBhdXRob3JpemF0aW9uIGNvZGUgZm9yIHRva2Vuc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgZXhjaGFuZ2VDb2RlRm9yVG9rZW5zKGF1dGhDb2RlOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IGNvZGVWZXJpZmllciA9IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLkNPREVfVkVSSUZJRVIpO1xyXG4gICAgXHJcbiAgICBpZiAoIWNvZGVWZXJpZmllcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdDb2RlIHZlcmlmaWVyIG5vdCBmb3VuZCBpbiBzdG9yYWdlJyk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ29kZSB2ZXJpZmllciBub3QgZm91bmQgaW4gc3RvcmFnZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCB0b2tlblJlcXVlc3Q6IFRva2VuUmVxdWVzdCA9IHtcclxuICAgICAgZ3JhbnRfdHlwZTogJ2F1dGhvcml6YXRpb25fY29kZScsXHJcbiAgICAgIHJlZGlyZWN0X3VyaTogdGhpcy5jb25maWcucmVkaXJlY3RVcmksXHJcbiAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWQsXHJcbiAgICAgIGNvZGU6IGF1dGhDb2RlLFxyXG4gICAgICBjb2RlX3ZlcmlmaWVyOiBjb2RlVmVyaWZpZXJcclxuICAgIH07XHJcbiAgICBcclxuICAgIHRoaXMubG9nSW5mbygnRXhjaGFuZ2luZyBhdXRob3JpemF0aW9uIGNvZGUgZm9yIHRva2VucycpO1xyXG4gICAgXHJcbiAgICAvLyBDb252ZXJ0IHRvIFVSTC1lbmNvZGVkIGZvcm0gZGF0YSBhcyBwZXIgT0F1dGggMi4wIHN0YW5kYXJkXHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgIE9iamVjdC5lbnRyaWVzKHRva2VuUmVxdWVzdCkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsdWUudG9TdHJpbmcoKSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB0b2tlblJlc3BvbnNlID0gYXdhaXQgdGhpcy5odHRwLnBvc3Q8VG9rZW5SZXNwb25zZT4oXHJcbiAgICAgICAgdGhpcy5jb25maWcudG9rZW5FbmRwb2ludCxcclxuICAgICAgICBmb3JtRGF0YS50b1N0cmluZygpLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICApLnRvUHJvbWlzZSgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKHRva2VuUmVzcG9uc2UpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZVRva2VuUmVzcG9uc2UodG9rZW5SZXNwb25zZSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB0b2tlbiByZXNwb25zZSByZWNlaXZlZCcpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignVG9rZW4gZXhjaGFuZ2UgZmFpbGVkOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gZXhjaGFuZ2UgYXV0aG9yaXphdGlvbiBjb2RlIGZvciB0b2tlbnMnKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEhhbmRsZSB0b2tlbiByZXNwb25zZSBhbmQgc3RvcmUgdG9rZW5zIHNlY3VyZWx5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVUb2tlblJlc3BvbnNlKHRva2VuUmVzcG9uc2U6IFRva2VuUmVzcG9uc2UpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIFZhbGlkYXRlIHN0YXRlIHBhcmFtZXRlciBmb3IgQ1NSRiBwcm90ZWN0aW9uXHJcbiAgICAgIGF3YWl0IHRoaXMudmFsaWRhdGVTdGF0ZSgpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ3JlYXRlIHRva2VuIGluZm9cclxuICAgICAgY29uc3QgdG9rZW5JbmZvOiBUb2tlbkluZm8gPSB7XHJcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxyXG4gICAgICAgIHJlZnJlc2hUb2tlbjogdG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuLFxyXG4gICAgICAgIHRva2VuVHlwZTogdG9rZW5SZXNwb25zZS50b2tlbl90eXBlIHx8ICdCZWFyZXInLFxyXG4gICAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArICh0b2tlblJlc3BvbnNlLmV4cGlyZXNfaW4gKiAxMDAwKSxcclxuICAgICAgICBzY29wZTogdG9rZW5SZXNwb25zZS5zY29wZSxcclxuICAgICAgICBpZFRva2VuOiB0b2tlblJlc3BvbnNlLmlkX3Rva2VuXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICAvLyBTdG9yZSB0b2tlbnMgc2VjdXJlbHlcclxuICAgICAgdGhpcy5zdG9yZVRva2VuSW5mbyh0b2tlbkluZm8pO1xyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIGF1dGhlbnRpY2F0aW9uIHN0YXRlXHJcbiAgICAgIHRoaXMudXBkYXRlQXV0aFN0YXRlKHtcclxuICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSxcclxuICAgICAgICB0b2tlbkluZm8sXHJcbiAgICAgICAgZXJyb3I6IHVuZGVmaW5lZFxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIC8vIENsZWFuIHVwIHRlbXBvcmFyeSBzdG9yYWdlXHJcbiAgICAgIHRoaXMuc3RvcmFnZVNlcnZpY2UuY2xlYXJUZW1wb3JhcnkoKTtcclxuICAgICAgXHJcbiAgICAgIHRoaXMubG9nSW5mbygnVG9rZW5zIHN0b3JlZCBzdWNjZXNzZnVsbHksIHVzZXIgYXV0aGVudGljYXRlZCcpO1xyXG4gICAgICBcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0Vycm9yIGhhbmRsaW5nIHRva2VuIHJlc3BvbnNlOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWYWxpZGF0ZSBzdGF0ZSBwYXJhbWV0ZXIgZm9yIENTUkYgcHJvdGVjdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgdmFsaWRhdGVTdGF0ZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIGNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICBjb25zdCBoYXNoUGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkpO1xyXG4gICAgXHJcbiAgICBjb25zdCByZWNlaXZlZFN0YXRlID0gdXJsUGFyYW1zLmdldCgnc3RhdGUnKSB8fCBoYXNoUGFyYW1zLmdldCgnc3RhdGUnKTtcclxuICAgIGNvbnN0IHN0b3JlZFN0YXRlID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuU1RBVEUpO1xyXG4gICAgXHJcbiAgICBpZiAoIXJlY2VpdmVkU3RhdGUgfHwgIXN0b3JlZFN0YXRlIHx8IHJlY2VpdmVkU3RhdGUgIT09IHN0b3JlZFN0YXRlKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBzdGF0ZSBwYXJhbWV0ZXIgLSBwb3NzaWJsZSBDU1JGIGF0dGFjaycpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0RlYnVnKCdTdGF0ZSBwYXJhbWV0ZXIgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGN1cnJlbnQgYWNjZXNzIHRva2VuIChvbmx5IGlmIHZhbGlkL25vdCBleHBpcmVkKVxyXG4gICAqL1xyXG4gIGdldEFjY2Vzc1Rva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIGlmICh0b2tlbkluZm8gJiYgdGhpcy5pc1Rva2VuVmFsaWQodG9rZW5JbmZvKSkge1xyXG4gICAgICByZXR1cm4gdG9rZW5JbmZvLmFjY2Vzc1Rva2VuO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgcmF3IGFjY2VzcyB0b2tlbiAoZXZlbiBpZiBleHBpcmVkKSAtIHVzZWQgZm9yIHJlZnJlc2ggZmxvd1xyXG4gICAqL1xyXG4gIGdldFJhd0FjY2Vzc1Rva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8/LmFjY2Vzc1Rva2VuIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgY3VycmVudCByZWZyZXNoIHRva2VuXHJcbiAgICovXHJcbiAgZ2V0UmVmcmVzaFRva2VuKCk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8/LnJlZnJlc2hUb2tlbiB8fCBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQ2hlY2sgaWYgdXNlciBpcyBhdXRoZW50aWNhdGVkXHJcbiAgICovXHJcbiAgaXNBdXRoZW50aWNhdGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgdG9rZW5JbmZvID0gdGhpcy5nZXRTdG9yZWRUb2tlbkluZm8oKTtcclxuICAgIHJldHVybiB0b2tlbkluZm8gPyB0aGlzLmlzVG9rZW5WYWxpZCh0b2tlbkluZm8pIDogZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiBhdXRoZW50aWNhdGlvbiBpcyBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudFxyXG4gICAqL1xyXG4gIGlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHVzZXIgaW5mb3JtYXRpb24gZnJvbSBPSURDIHVzZXJpbmZvIGVuZHBvaW50XHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0VXNlckluZm8oKTogUHJvbWlzZTxVc2VySW5mb1Jlc3BvbnNlPiB7XHJcbiAgICBpZiAoIXRoaXMuY29uZmlnLnVzZXJJbmZvRW5kcG9pbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdVc2VySW5mbyBlbmRwb2ludCBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gdGhpcy5nZXRBY2Nlc3NUb2tlbigpO1xyXG4gICAgaWYgKCFhY2Nlc3NUb2tlbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGFjY2VzcyB0b2tlbiBhdmFpbGFibGUnKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmxvZ0luZm8oJ0ZldGNoaW5nIHVzZXIgaW5mbyBmcm9tIE9JREMgdXNlcmluZm8gZW5kcG9pbnQnKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHRoaXMuaHR0cC5nZXQ8VXNlckluZm9SZXNwb25zZT4oXHJcbiAgICAgICAgdGhpcy5jb25maWcudXNlckluZm9FbmRwb2ludCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FjY2Vzc1Rva2VufWBcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICkudG9Qcm9taXNlKCk7XHJcblxyXG4gICAgICBpZiAodXNlckluZm8pIHtcclxuICAgICAgICB0aGlzLmxvZ0RlYnVnKCdVc2VyIGluZm8gcmV0cmlldmVkIHN1Y2Nlc3NmdWxseTonLCB1c2VySW5mbyk7XHJcbiAgICAgICAgcmV0dXJuIHVzZXJJbmZvO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciBpbmZvIHJlc3BvbnNlIHJlY2VpdmVkJyk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm86JywgZXJyb3IpO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm9ybWF0aW9uJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDaGVjayBpZiB0b2tlbiBpcyB2YWxpZCAobm90IGV4cGlyZWQpXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBpc1Rva2VuVmFsaWQodG9rZW5JbmZvOiBUb2tlbkluZm8pOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHRocmVzaG9sZCA9ICh0aGlzLmNvbmZpZy5yZWZyZXNoVGhyZXNob2xkIHx8IDMwMCkgKiAxMDAwOyAvLyBDb252ZXJ0IHRvIG1pbGxpc2Vjb25kc1xyXG4gICAgcmV0dXJuIERhdGUubm93KCkgPCAodG9rZW5JbmZvLmV4cGlyZXNBdCAtIHRocmVzaG9sZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZWZyZXNoIGFjY2VzcyB0b2tlbiB1c2luZyByZWZyZXNoIHRva2VuXHJcbiAgICovXHJcbiAgYXN5bmMgcmVmcmVzaEFjY2Vzc1Rva2VuKCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICBjb25zdCByZWZyZXNoVG9rZW4gPSB0aGlzLmdldFJlZnJlc2hUb2tlbigpO1xyXG4gICAgaWYgKCFyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZScpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICB0aGlzLmxvZ0luZm8oJ1JlZnJlc2hpbmcgYWNjZXNzIHRva2VuJyk7XHJcbiAgICBcclxuICAgIGNvbnN0IHRva2VuUmVxdWVzdCA9IHtcclxuICAgICAgZ3JhbnRfdHlwZTogJ3JlZnJlc2hfdG9rZW4nLFxyXG4gICAgICByZWZyZXNoX3Rva2VuOiByZWZyZXNoVG9rZW4sXHJcbiAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWRcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIENvbnZlcnQgdG8gVVJMLWVuY29kZWQgZm9ybSBkYXRhIGFzIHBlciBPQXV0aCAyLjAgc3RhbmRhcmRcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgT2JqZWN0LmVudHJpZXModG9rZW5SZXF1ZXN0KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHRva2VuUmVzcG9uc2UgPSBhd2FpdCB0aGlzLmh0dHAucG9zdDxUb2tlblJlc3BvbnNlPihcclxuICAgICAgICB0aGlzLmNvbmZpZy50b2tlbkVuZHBvaW50LFxyXG4gICAgICAgIGZvcm1EYXRhLnRvU3RyaW5nKCksXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICkudG9Qcm9taXNlKCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAodG9rZW5SZXNwb25zZSkge1xyXG4gICAgICAgIGNvbnN0IHRva2VuSW5mbzogVG9rZW5JbmZvID0ge1xyXG4gICAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuLFxyXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiB0b2tlblJlc3BvbnNlLnJlZnJlc2hfdG9rZW4gfHwgcmVmcmVzaFRva2VuLFxyXG4gICAgICAgICAgdG9rZW5UeXBlOiB0b2tlblJlc3BvbnNlLnRva2VuX3R5cGUgfHwgJ0JlYXJlcicsXHJcbiAgICAgICAgICBleHBpcmVzQXQ6IERhdGUubm93KCkgKyAodG9rZW5SZXNwb25zZS5leHBpcmVzX2luICogMTAwMCksXHJcbiAgICAgICAgICBzY29wZTogdG9rZW5SZXNwb25zZS5zY29wZSxcclxuICAgICAgICAgIGlkVG9rZW46IHRva2VuUmVzcG9uc2UuaWRfdG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc3RvcmVUb2tlbkluZm8odG9rZW5JbmZvKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgICAgdG9rZW5JbmZvXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdBY2Nlc3MgdG9rZW4gcmVmcmVzaGVkIHN1Y2Nlc3NmdWxseScpO1xyXG4gICAgICAgIHJldHVybiB0b2tlblJlc3BvbnNlLmFjY2Vzc190b2tlbjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRva2VuIHJlc3BvbnNlIHJlY2VpdmVkJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPbmx5IGxvZ291dCBpZiBpdCdzIGEgNDAwLzQwMSBlcnJvciBpbmRpY2F0aW5nIGludmFsaWQgcmVmcmVzaCB0b2tlblxyXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciAmJiAnc3RhdHVzJyBpbiBlcnJvcikge1xyXG4gICAgICAgIGNvbnN0IGh0dHBFcnJvciA9IGVycm9yIGFzIGFueTtcclxuICAgICAgICBpZiAoaHR0cEVycm9yLnN0YXR1cyA9PT0gNDAwIHx8IGh0dHBFcnJvci5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgICAgdGhpcy5sb2dJbmZvKCdSZWZyZXNoIHRva2VuIGlzIGludmFsaWQsIGxvZ2dpbmcgb3V0Jyk7XHJcbiAgICAgICAgICB0aGlzLmxvZ291dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmxvZ0luZm8oJ05ldHdvcmsgb3Igc2VydmVyIGVycm9yIGR1cmluZyB0b2tlbiByZWZyZXNoLCB3aWxsIHJldHJ5IGxhdGVyJyk7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlZnJlc2ggYWNjZXNzIHRva2VuJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBMb2dvdXQgdXNlciBhbmQgY2xlYW4gdXAgYWxsIHN0b3JlZCBkYXRhXHJcbiAgICovXHJcbiAgYXN5bmMgbG9nb3V0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy51cGRhdGVBdXRoU3RhdGUoeyBpc0xvYWRpbmc6IHRydWUgfSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBSZXZva2UgdG9rZW5zIGlmIHN1cHBvcnRlZFxyXG4gICAgICBhd2FpdCB0aGlzLnJldm9rZVRva2VucygpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2xlYXIgYWxsIHN0b3JlZCBhdXRoZW50aWNhdGlvbiBkYXRhXHJcbiAgICAgIHRoaXMuc3RvcmFnZVNlcnZpY2UuY2xlYXJBbGwoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFVwZGF0ZSBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIHRva2VuSW5mbzogdW5kZWZpbmVkLFxyXG4gICAgICAgIGVycm9yOiB1bmRlZmluZWRcclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1VzZXIgbG9nZ2VkIG91dCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBkdXJpbmcgbG9nb3V0OicsIGVycm9yKTtcclxuICAgICAgLy8gU3RpbGwgY2xlYXIgbG9jYWwgZGF0YSBldmVuIGlmIHJldm9jYXRpb24gZmFpbHNcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICB0aGlzLnVwZGF0ZUF1dGhTdGF0ZSh7XHJcbiAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICBpc0xvYWRpbmc6IGZhbHNlLFxyXG4gICAgICAgIHRva2VuSW5mbzogdW5kZWZpbmVkXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV2b2tlIHRva2VucyBhdCBhdXRob3JpemF0aW9uIHNlcnZlclxyXG4gICAqL1xyXG4gIHByaXZhdGUgYXN5bmMgcmV2b2tlVG9rZW5zKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgaWYgKCF0aGlzLmNvbmZpZy5yZXZva2VFbmRwb2ludCkge1xyXG4gICAgICB0aGlzLmxvZ0luZm8oJ1Rva2VuIHJldm9jYXRpb24gZW5kcG9pbnQgbm90IGNvbmZpZ3VyZWQnKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKTtcclxuICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHRoaXMuZ2V0UmVmcmVzaFRva2VuKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHJldm9rZVByb21pc2VzOiBQcm9taXNlPGFueT5bXSA9IFtdO1xyXG4gICAgXHJcbiAgICBpZiAoYWNjZXNzVG9rZW4pIHtcclxuICAgICAgY29uc3QgcmV2b2tlUmVxdWVzdCA9IHtcclxuICAgICAgICB0b2tlbjogYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgdG9rZW5fdHlwZV9oaW50OiAnYWNjZXNzX3Rva2VuJyxcclxuICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY29uZmlnLmNsaWVudElkXHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgICAgT2JqZWN0LmVudHJpZXMocmV2b2tlUmVxdWVzdCkuZm9yRWFjaCgoW2tleSwgdmFsdWVdKSA9PiB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChrZXksIHZhbHVlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICByZXZva2VQcm9taXNlcy5wdXNoKFxyXG4gICAgICAgIHRoaXMuaHR0cC5wb3N0KHRoaXMuY29uZmlnLnJldm9rZUVuZHBvaW50LCBmb3JtRGF0YS50b1N0cmluZygpLCB7XHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pLnRvUHJvbWlzZSgpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgY29uc3QgcmV2b2tlUmVxdWVzdCA9IHtcclxuICAgICAgICB0b2tlbjogcmVmcmVzaFRva2VuLFxyXG4gICAgICAgIHRva2VuX3R5cGVfaGludDogJ3JlZnJlc2hfdG9rZW4nLFxyXG4gICAgICAgIGNsaWVudF9pZDogdGhpcy5jb25maWcuY2xpZW50SWRcclxuICAgICAgfTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xyXG4gICAgICBPYmplY3QuZW50cmllcyhyZXZva2VSZXF1ZXN0KS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdmFsdWUudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICAgIHJldm9rZVByb21pc2VzLnB1c2goXHJcbiAgICAgICAgdGhpcy5odHRwLnBvc3QodGhpcy5jb25maWcucmV2b2tlRW5kcG9pbnQsIGZvcm1EYXRhLnRvU3RyaW5nKCksIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSkudG9Qcm9taXNlKClcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKHJldm9rZVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChyZXZva2VQcm9taXNlcyk7XHJcbiAgICAgICAgdGhpcy5sb2dJbmZvKCdUb2tlbnMgcmV2b2tlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICB0aGlzLmxvZ0Vycm9yKCdUb2tlbiByZXZvY2F0aW9uIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgICAgLy8gRG9uJ3QgdGhyb3cgZXJyb3IsIGNvbnRpbnVlIHdpdGggbG9nb3V0XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3JlIHRva2VuIGluZm9ybWF0aW9uIHNlY3VyZWx5XHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdG9yZVRva2VuSW5mbyh0b2tlbkluZm86IFRva2VuSW5mbyk6IHZvaWQge1xyXG4gICAgdHJ5IHtcclxuICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQUNDRVNTX1RPS0VOLCB0b2tlbkluZm8uYWNjZXNzVG9rZW4pO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULCB0b2tlbkluZm8uZXhwaXJlc0F0LnRvU3RyaW5nKCkpO1xyXG4gICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9UWVBFLCB0b2tlbkluZm8udG9rZW5UeXBlKTtcclxuICAgICAgXHJcbiAgICAgIGlmICh0b2tlbkluZm8ucmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuUkVGUkVTSF9UT0tFTiwgdG9rZW5JbmZvLnJlZnJlc2hUb2tlbik7XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGlmICh0b2tlbkluZm8uc2NvcGUpIHtcclxuICAgICAgICB0aGlzLnN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5TQ09QRSwgdG9rZW5JbmZvLnNjb3BlKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYgKHRva2VuSW5mby5pZFRva2VuKSB7XHJcbiAgICAgICAgdGhpcy5zdG9yYWdlU2VydmljZS5zZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU4sIHRva2VuSW5mby5pZFRva2VuKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgdGhpcy5sb2dEZWJ1ZygnVG9rZW4gaW5mb3JtYXRpb24gc3RvcmVkIHNlY3VyZWx5Jyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICB0aGlzLmxvZ0Vycm9yKCdFcnJvciBzdG9yaW5nIHRva2VuIGluZm9ybWF0aW9uOicsIGVycm9yKTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc3RvcmUgdG9rZW4gaW5mb3JtYXRpb24nKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJldHJpZXZlIHN0b3JlZCB0b2tlbiBpbmZvcm1hdGlvblxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0U3RvcmVkVG9rZW5JbmZvKCk6IFRva2VuSW5mbyB8IG51bGwge1xyXG4gICAgaWYgKCF0aGlzLnN0b3JhZ2VTZXJ2aWNlLmlzQXZhaWxhYmxlKCkpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuQUNDRVNTX1RPS0VOKTtcclxuICAgICAgY29uc3QgZXhwaXJlc0F0U3RyID0gdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fRVhQSVJFU19BVCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIWFjY2Vzc1Rva2VuIHx8ICFleHBpcmVzQXRTdHIpIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhY2Nlc3NUb2tlbixcclxuICAgICAgICByZWZyZXNoVG9rZW46IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4pIHx8IHVuZGVmaW5lZCxcclxuICAgICAgICB0b2tlblR5cGU6IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlRPS0VOX1RZUEUpIHx8ICdCZWFyZXInLFxyXG4gICAgICAgIGV4cGlyZXNBdDogcGFyc2VJbnQoZXhwaXJlc0F0U3RyLCAxMCksXHJcbiAgICAgICAgc2NvcGU6IHRoaXMuc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlNDT1BFKSB8fCB1bmRlZmluZWQsXHJcbiAgICAgICAgaWRUb2tlbjogdGhpcy5zdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuSURfVE9LRU4pIHx8IHVuZGVmaW5lZFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgdGhpcy5sb2dFcnJvcignRXJyb3IgcmV0cmlldmluZyBzdG9yZWQgdG9rZW4gaW5mb3JtYXRpb246JywgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlQXV0aFN0YXRlKG5ld1N0YXRlOiBQYXJ0aWFsPEF1dGhTdGF0ZT4pOiB2b2lkIHtcclxuICAgIGNvbnN0IGN1cnJlbnRTdGF0ZSA9IHRoaXMuX2F1dGhTdGF0ZSgpO1xyXG4gICAgY29uc3QgdXBkYXRlZFN0YXRlID0geyAuLi5jdXJyZW50U3RhdGUsIC4uLm5ld1N0YXRlIH07XHJcbiAgICBcclxuICAgIHRoaXMuX2F1dGhTdGF0ZS5zZXQodXBkYXRlZFN0YXRlKTtcclxuICAgIHRoaXMuX2F1dGhTdGF0ZVN1YmplY3QubmV4dCh1cGRhdGVkU3RhdGUpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGVidWcgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgbG9nRGVidWcobWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMubG9nTGV2ZWwgPT09ICdkZWJ1ZycpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmZvIGxvZ2dpbmdcclxuICAgKi9cclxuICBwcml2YXRlIGxvZ0luZm8obWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gICAgaWYgKFsnZGVidWcnLCAnaW5mbyddLmluY2x1ZGVzKHRoaXMubG9nTGV2ZWwpKSB7XHJcbiAgICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMlNlcnZpY2VdICR7bWVzc2FnZX1gLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFdhcm5pbmcgbG9nZ2luZ1xyXG4gICAqL1xyXG4gIHByaXZhdGUgbG9nV2FybihtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgICBpZiAoWydkZWJ1ZycsICdpbmZvJywgJ3dhcm4nXS5pbmNsdWRlcyh0aGlzLmxvZ0xldmVsKSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFcnJvciBsb2dnaW5nXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBsb2dFcnJvcihtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogYW55KTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5sb2dMZXZlbCAhPT0gJ25vbmUnKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFtPQXV0aDJTZXJ2aWNlXSAke21lc3NhZ2V9YCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxufSJdfQ==","originalSourcemap":{"version":3,"file":"oauth2.service.js","sourceRoot":"","sources":["../../../../../src/lib/services/oauth2.service.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[19,0,0,19],[21,0,0,21],[27,0,0,27],[29,0,0,29],[40,0,0,40],[42,0,0,42],[48,0,0,48],[50,0,0,50],[56,0,0,56],[71,0,0,71],[72,0,0,72]],[[0,0,1,0],[7,0,1,7],[9,0,1,9],[26,0,1,26],[28,0,1,28],[34,0,1,34],[51,0,1,51],[52,0,1,52]],[[0,0,4,0],[7,0,4,7],[9,0,4,21],[24,0,4,36],[26,0,4,54],[32,0,4,60],[38,0,4,66],[39,0,4,67]],[[0,0,8,0],[7,0,8,7],[9,0,16,2],[28,0,16,21],[30,0,19,1],[36,0,19,7],[66,0,19,37],[67,0,19,38]],[[0,0,20,0],[7,0,20,7],[9,0,20,9],[28,0,20,28],[30,0,20,30],[36,0,20,36],[67,0,20,67],[68,0,20,68]],[],[],[],[],[[0,0,23,0]],[],[],[[3,0,26,3]],[[0,0,30,0],[6,0,30,6],[13,0,30,13],[26,0,30,26]],[[4,0,46,2],[16,0,47,41],[22,0,47,61],[24,0,48,33],[34,0,48,51],[36,0,49,12],[40,0,49,28],[42,0,50,12],[48,0,50,26],[50,0,51,12],[64,0,51,48]],[[8,0,47,41],[19,0,47,47],[22,0,47,41],[28,0,47,47],[29,0,47,61]],[[8,0,48,33],[23,0,48,43],[26,0,48,33],[36,0,48,43],[37,0,48,51]],[[8,0,49,12],[17,0,49,16],[20,0,49,12],[24,0,49,16],[25,0,49,28]],[[8,0,50,12],[19,0,50,18],[22,0,50,12],[28,0,50,18],[29,0,50,26]],[[8,0,51,12],[27,0,51,26],[30,0,51,12],[44,0,51,26],[45,0,51,48]],[[8,0,31,10],[23,0,31,20],[26,0,31,23],[32,0,31,29],[33,0,31,41]],[[12,0,32,4],[27,0,32,19],[29,0,32,21],[34,0,32,26]],[[12,0,33,4],[21,0,33,13],[23,0,33,15],[28,0,33,20]],[[9,0,34,3],[10,0,34,4],[11,0,34,5]],[[8,0,36,10],[30,0,36,27],[33,0,36,30],[37,0,36,34],[52,0,36,49],[53,0,36,61]],[[12,0,37,4],[27,0,37,19],[29,0,37,21],[34,0,37,26]],[[12,0,38,4],[21,0,38,13],[23,0,38,15],[28,0,38,20]],[[9,0,39,3],[10,0,39,4],[11,0,39,5]],[[8,0,41,9],[23,0,41,19],[26,0,41,22],[30,0,41,26],[31,0,41,27],[48,0,41,44],[49,0,41,45],[61,0,41,57],[63,0,41,59],[64,0,41,60]],[[8,0,42,18],[22,0,42,27],[25,0,42,30],[29,0,42,34],[30,0,42,35],[40,0,42,45],[41,0,42,46],[51,0,42,56],[53,0,42,58],[54,0,42,59]],[[8,0,53,4],[12,0,53,8],[13,0,53,9],[21,0,53,17],[24,0,53,20],[30,0,53,26],[31,0,53,27],[39,0,53,35],[43,0,53,39],[49,0,53,45],[50,0,53,46]],[[8,0,54,4],[12,0,54,8],[13,0,54,9],[32,0,54,28],[34,0,54,30],[35,0,54,31]],[[4,0,55,2],[5,0,55,3]],[[4,0,57,2]],[],[[7,0,59,5]],[[4,0,60,10],[23,0,60,29]],[[8,0,61,4],[12,0,61,8],[13,0,61,9],[30,0,61,26],[31,0,61,27],[35,0,61,31],[36,0,61,32],[46,0,61,42],[47,0,61,43],[49,0,61,45],[50,0,61,46]],[[12,0,62,6],[19,0,62,13]],[[8,0,63,4],[9,0,63,5]],[[8,0,65,4],[12,0,65,8],[13,0,65,9]],[[12,0,66,6],[18,0,66,12],[27,0,66,21],[30,0,66,24],[34,0,66,28],[35,0,66,29],[53,0,66,47],[55,0,66,49],[56,0,66,50]],[[12,0,67,6],[16,0,67,10],[25,0,67,19],[29,0,67,23],[33,0,67,27],[34,0,67,28],[46,0,67,40],[47,0,67,41],[56,0,67,50],[57,0,67,51],[59,0,67,53],[60,0,67,54]],[[16,0,68,8],[20,0,68,12],[21,0,68,13],[36,0,68,28],[37,0,68,29]],[[20,0,69,10],[35,0,69,25],[37,0,69,27],[41,0,69,31]],[[20,0,70,10],[29,0,70,19],[31,0,70,21],[36,0,70,26]],[[20,0,71,10],[29,0,71,19]],[[17,0,72,9],[18,0,72,10],[19,0,72,11]],[[16,0,73,8],[20,0,73,12],[21,0,73,13],[28,0,73,20],[29,0,73,21],[82,0,73,74],[83,0,73,75],[84,0,73,76]],[[12,0,74,6],[13,0,74,7]],[[17,0,74,13],[21,0,74,17],[30,0,74,26],[34,0,74,30],[43,0,74,39],[44,0,74,40],[56,0,74,52],[58,0,74,54],[59,0,74,55]],[[16,0,75,8],[67,0,75,59]],[[16,0,76,8],[20,0,76,12],[21,0,76,13],[28,0,76,20],[29,0,76,21],[109,0,76,101],[110,0,76,102],[111,0,76,103]],[[16,0,77,8],[20,0,77,12],[21,0,77,13],[36,0,77,28],[37,0,77,29]],[[20,0,78,10],[35,0,78,25],[37,0,78,27],[42,0,78,32]],[[20,0,79,10],[29,0,79,19],[31,0,79,21],[36,0,79,26]],[[20,0,80,10],[29,0,80,19],[31,0,80,21],[40,0,80,30]],[[17,0,81,9],[18,0,81,10],[19,0,81,11]],[[12,0,82,6],[13,0,82,7]],[[17,0,82,13],[18,0,82,14]],[[16,0,83,8],[77,0,83,69]],[[16,0,84,8],[20,0,84,12],[21,0,84,13],[35,0,84,27],[36,0,84,28],[47,0,84,39],[49,0,84,41],[50,0,84,42]],[[16,0,85,8],[20,0,85,12],[21,0,85,13],[28,0,85,20],[29,0,85,21],[59,0,85,51],[60,0,85,52],[61,0,85,53]],[[12,0,86,6],[13,0,86,7]],[[8,0,87,4],[9,0,87,5]],[[8,0,87,6],[15,0,87,13],[20,0,87,18],[22,0,87,20],[23,0,87,21]],[[12,0,88,6],[16,0,88,10],[17,0,88,11],[25,0,88,19],[26,0,88,20],[58,0,88,52],[60,0,88,54],[65,0,88,59],[66,0,88,60],[67,0,88,61]],[[12,0,89,6],[16,0,89,10],[17,0,89,11],[31,0,89,25],[32,0,89,26],[43,0,89,37],[45,0,89,39],[46,0,89,40]],[[8,0,90,4],[9,0,90,5]],[[4,0,91,2],[5,0,91,3]],[[4,0,93,2]],[],[[7,0,95,5]],[[4,0,96,10],[9,0,96,15],[10,0,96,16],[31,0,96,37]],[[8,0,97,4],[14,0,97,10],[26,0,97,22],[29,0,97,25],[33,0,97,29],[34,0,97,30],[60,0,97,56],[62,0,97,58],[63,0,97,59]],[[8,0,98,4],[14,0,98,10],[27,0,98,23],[30,0,98,26],[36,0,98,32],[40,0,98,36],[41,0,98,37],[60,0,98,56],[61,0,98,57],[73,0,98,69],[74,0,98,70],[75,0,98,71]],[[8,0,100,4],[15,0,100,11]],[[12,0,101,6],[24,0,101,18]],[[12,0,102,6],[25,0,102,19]],[[12,0,103,6],[31,0,103,25],[33,0,103,27],[37,0,103,31],[38,0,103,32],[44,0,103,38],[45,0,103,39],[64,0,103,58],[68,0,103,62],[74,0,103,68]],[[9,0,104,5],[10,0,104,6]],[[4,0,105,2],[5,0,105,3]],[[4,0,107,2]],[],[[7,0,109,5]],[[4,0,110,10],[30,0,110,36]],[[8,0,111,4],[12,0,111,8],[13,0,111,9],[30,0,111,26],[31,0,111,27],[35,0,111,31],[36,0,111,32],[46,0,111,42],[47,0,111,43],[49,0,111,45],[50,0,111,46]],[[12,0,112,6],[18,0,112,12],[22,0,112,16],[27,0,112,21],[28,0,112,22],[83,0,112,77],[84,0,112,78],[85,0,112,79]],[[8,0,113,4],[9,0,113,5]],[[8,0,115,4],[60,0,115,56]],[[8,0,116,4],[14,0,116,10],[19,0,116,15],[22,0,116,18],[26,0,116,22],[36,0,116,32],[37,0,116,33],[38,0,116,34],[39,0,116,35],[40,0,116,36]],[[8,0,117,4],[14,0,117,10],[15,0,117,11],[30,0,117,26],[31,0,117,27],[36,0,117,32],[37,0,117,33],[38,0,117,34]],[[8,0,119,4],[52,0,119,48]],[[8,0,120,4],[14,0,120,10],[26,0,120,22],[29,0,120,25],[34,0,120,30],[35,0,120,31],[39,0,120,35],[40,0,120,36],[45,0,120,41],[46,0,120,42]],[[13,0,121,7],[16,0,121,10],[17,0,121,11],[21,0,121,15],[22,0,121,16],[24,0,121,18],[25,0,121,19],[26,0,121,20],[30,0,121,24],[33,0,121,27],[35,0,121,29],[36,0,121,30],[37,0,121,31],[45,0,121,39],[47,0,121,41],[48,0,121,42]],[[13,0,122,7],[17,0,122,11],[18,0,122,12],[20,0,122,14],[21,0,122,15],[22,0,122,16]],[[8,0,124,4],[12,0,124,8],[13,0,124,9],[21,0,124,17],[22,0,124,18],[62,0,124,58],[63,0,124,59],[64,0,124,60]],[[8,0,125,4],[15,0,125,11],[27,0,125,23],[28,0,125,24]],[[4,0,126,2],[5,0,126,3]],[[4,0,128,2]],[],[[7,0,130,5]],[[4,0,131,10],[9,0,131,15],[10,0,131,16],[29,0,131,35],[30,0,131,36],[42,0,131,56]],[[8,0,132,4],[12,0,132,8],[13,0,132,9],[30,0,132,26],[31,0,132,27],[35,0,132,31],[36,0,132,32],[46,0,132,42],[47,0,132,43],[49,0,132,45],[50,0,132,46]],[[12,0,133,6],[18,0,133,12],[22,0,133,16],[27,0,133,21],[28,0,133,22],[82,0,133,76],[83,0,133,77],[84,0,133,78]],[[8,0,134,4],[9,0,134,5]],[[8,0,136,4],[12,0,136,8],[13,0,136,9]],[[12,0,137,6],[48,0,137,42]],[[12,0,138,6],[18,0,138,12],[25,0,138,19],[28,0,138,22],[32,0,138,26],[43,0,138,37],[45,0,138,39],[46,0,138,40]],[[12,0,139,6],[18,0,139,12],[22,0,139,16],[25,0,139,19],[32,0,139,26],[33,0,139,27],[39,0,139,33],[40,0,139,34],[52,0,139,46],[53,0,139,47],[54,0,139,48]],[[12,0,141,6],[34,0,141,28]],[[12,0,142,6],[18,0,142,12],[28,0,142,22],[31,0,142,25],[37,0,142,31],[43,0,142,37],[44,0,142,38],[50,0,142,44],[51,0,142,45],[57,0,142,51],[58,0,142,52],[67,0,142,61],[69,0,142,63],[73,0,142,67],[74,0,142,68],[75,0,142,69]],[[12,0,144,6],[44,0,144,38]],[[12,0,145,6],[18,0,145,12],[27,0,145,21],[30,0,145,24],[34,0,145,28],[44,0,145,38],[45,0,145,39],[55,0,145,49],[56,0,145,50],[57,0,145,51]],[[12,0,146,6],[18,0,146,12],[30,0,146,24],[33,0,146,27],[37,0,146,31],[38,0,146,32],[44,0,146,38],[45,0,146,39],[57,0,146,51],[58,0,146,52],[61,0,146,55],[70,0,146,64],[71,0,146,65],[72,0,146,66]],[[17,0,147,9],[24,0,147,16],[25,0,147,17],[30,0,147,22],[32,0,147,24],[35,0,147,27],[36,0,147,28]],[[17,0,148,9],[24,0,148,16],[25,0,148,17],[30,0,148,22],[32,0,148,24],[35,0,148,27],[36,0,148,28]],[[17,0,149,9],[24,0,149,16],[25,0,149,17],[29,0,149,21],[31,0,149,23],[33,0,149,25],[34,0,149,26],[35,0,149,27]],[[12,0,151,6],[16,0,151,10],[17,0,151,11],[25,0,151,19],[26,0,151,20],[66,0,151,60],[67,0,151,61],[68,0,151,62]],[[12,0,152,6],[19,0,152,13],[31,0,152,25],[32,0,152,26]],[[8,0,153,4],[9,0,153,5]],[[8,0,153,6],[15,0,153,13],[20,0,153,18],[22,0,153,20],[23,0,153,21]],[[12,0,154,6],[16,0,154,10],[17,0,154,11],[25,0,154,19],[26,0,154,20],[58,0,154,52],[60,0,154,54],[65,0,154,59],[66,0,154,60],[67,0,154,61]],[[12,0,155,6],[18,0,155,12],[22,0,155,16],[27,0,155,21],[28,0,155,22],[61,0,155,55],[62,0,155,56],[63,0,155,57]],[[8,0,156,4],[9,0,156,5]],[[4,0,157,2],[5,0,157,3]],[[4,0,159,2]],[],[[7,0,161,5]],[[4,0,162,10],[17,0,162,23]],[[8,0,163,4],[12,0,163,8],[13,0,163,9],[30,0,163,26],[31,0,163,27],[35,0,163,31],[36,0,163,32],[46,0,163,42],[47,0,163,43],[49,0,163,45],[50,0,163,46]],[[12,0,164,6],[19,0,164,13],[35,0,164,29],[36,0,164,30]],[[8,0,165,4],[9,0,165,5]],[[8,0,167,4],[14,0,167,10],[19,0,167,15],[22,0,167,18],[26,0,167,22],[36,0,167,32],[37,0,167,33],[39,0,167,35],[40,0,167,36],[41,0,167,37]],[[8,0,168,4],[14,0,168,10],[15,0,168,11],[30,0,168,26],[31,0,168,27],[36,0,168,32],[37,0,168,33],[38,0,168,34]],[[8,0,169,4],[15,0,169,11],[19,0,169,15],[20,0,169,16],[26,0,169,22],[27,0,169,23],[39,0,169,35],[40,0,169,36],[43,0,169,39],[48,0,169,44],[49,0,169,45],[50,0,169,46]],[[13,0,170,7],[20,0,170,14],[21,0,170,15],[26,0,170,20],[28,0,170,22],[31,0,170,25],[32,0,170,26]],[[13,0,171,7],[20,0,171,14],[21,0,171,15],[26,0,171,20],[28,0,171,22],[31,0,171,25],[32,0,171,26]],[[13,0,172,7],[20,0,172,14],[21,0,172,15],[25,0,172,19],[27,0,172,21],[29,0,172,23],[30,0,172,24],[31,0,172,25]],[[4,0,173,2],[5,0,173,3]],[[4,0,175,2]],[],[[7,0,177,5]],[[4,0,178,10],[17,0,178,23]],[[8,0,179,4],[12,0,179,8],[16,0,179,12],[17,0,179,13],[23,0,179,19],[24,0,179,20],[29,0,179,25],[31,0,179,27],[32,0,179,28]],[[12,0,180,6],[19,0,180,13],[23,0,180,17],[24,0,180,18],[30,0,180,24],[31,0,180,25],[36,0,180,30],[37,0,180,31]],[[8,0,181,4],[9,0,181,5]],[[8,0,183,4],[12,0,183,8],[13,0,183,9],[30,0,183,26],[31,0,183,27],[35,0,183,31],[36,0,183,32],[46,0,183,42],[47,0,183,43],[49,0,183,45],[50,0,183,46]],[[12,0,184,6],[19,0,184,13],[35,0,184,29],[36,0,184,30]],[[8,0,185,4],[9,0,185,5]],[[8,0,187,4],[14,0,187,10],[19,0,187,15],[22,0,187,18],[26,0,187,22],[36,0,187,32],[37,0,187,33],[39,0,187,35],[40,0,187,36],[41,0,187,37]],[[8,0,188,4],[14,0,188,10],[15,0,188,11],[30,0,188,26],[31,0,188,27],[36,0,188,32],[37,0,188,33],[38,0,188,34]],[[8,0,189,4],[15,0,189,11],[19,0,189,15],[20,0,189,16],[26,0,189,22],[27,0,189,23],[39,0,189,35],[40,0,189,36],[43,0,189,39],[48,0,189,44],[49,0,189,45],[50,0,189,46]],[[13,0,190,7],[20,0,190,14],[21,0,190,15],[26,0,190,20],[28,0,190,22],[31,0,190,25],[32,0,190,26]],[[13,0,191,7],[20,0,191,14],[21,0,191,15],[26,0,191,20],[28,0,191,22],[31,0,191,25],[32,0,191,26]],[[13,0,192,7],[20,0,192,14],[21,0,192,15],[25,0,192,19],[27,0,192,21],[29,0,192,23],[30,0,192,24],[31,0,192,25]],[[4,0,193,2],[5,0,193,3]],[[4,0,195,2]],[],[[7,0,197,5]],[[4,0,198,2],[9,0,198,7],[10,0,198,8],[28,0,198,26]],[[8,0,199,4],[12,0,199,8],[13,0,199,9],[30,0,199,26],[31,0,199,27],[35,0,199,31],[36,0,199,32],[46,0,199,42],[47,0,199,43],[49,0,199,45],[50,0,199,46]],[[12,0,200,6],[16,0,200,10],[17,0,200,11],[25,0,200,19],[26,0,200,20],[78,0,200,72],[80,0,200,74],[112,0,200,106],[113,0,200,107],[114,0,200,108]],[[12,0,201,6],[16,0,201,10],[17,0,201,11],[32,0,201,26],[33,0,201,27]],[[16,0,202,8],[25,0,202,17],[27,0,202,19],[32,0,202,24]],[[16,0,203,8],[21,0,203,13],[23,0,203,15],[75,0,203,67]],[[13,0,204,7],[14,0,204,8],[15,0,204,9]],[[12,0,205,6],[19,0,205,13]],[[8,0,206,4],[9,0,206,5]],[[8,0,208,4],[12,0,208,8],[13,0,208,9]],[[12,0,209,6],[16,0,209,10],[17,0,209,11],[32,0,209,26],[33,0,209,27],[35,0,209,29],[44,0,209,38],[46,0,209,40],[50,0,209,44],[52,0,209,46],[57,0,209,51],[59,0,209,53],[68,0,209,62],[70,0,209,64],[71,0,209,65],[72,0,209,66]],[[12,0,211,6],[38,0,211,32]],[[12,0,212,6],[18,0,212,12],[31,0,212,25],[34,0,212,28],[40,0,212,34],[44,0,212,38],[45,0,212,39],[66,0,212,60],[68,0,212,62],[69,0,212,63]],[[12,0,214,6],[49,0,214,43]],[[12,0,215,6],[18,0,215,12],[23,0,215,17],[26,0,215,20],[30,0,215,24],[31,0,215,25],[44,0,215,38],[46,0,215,40],[47,0,215,41]],[[12,0,217,6],[29,0,217,23]],[[12,0,218,6],[18,0,218,12],[23,0,218,17],[26,0,218,20],[30,0,218,24],[31,0,218,25],[44,0,218,38],[46,0,218,40],[47,0,218,41]],[[12,0,220,6],[61,0,220,55]],[[12,0,221,6],[16,0,221,10],[17,0,221,11],[31,0,221,25],[32,0,221,26],[39,0,221,33],[40,0,221,34],[59,0,221,53],[60,0,221,54],[73,0,221,67],[75,0,221,69],[88,0,221,82],[89,0,221,83],[101,0,221,95],[102,0,221,96],[103,0,221,97]],[[12,0,222,6],[16,0,222,10],[17,0,222,11],[31,0,222,25],[32,0,222,26],[39,0,222,33],[40,0,222,34],[59,0,222,53],[60,0,222,54],[65,0,222,59],[67,0,222,61],[72,0,222,66],[73,0,222,67],[74,0,222,68]],[[12,0,223,6],[16,0,223,10],[17,0,223,11],[31,0,223,25],[32,0,223,26],[39,0,223,33],[40,0,223,34],[59,0,223,53],[60,0,223,54],[65,0,223,59],[67,0,223,61],[72,0,223,66],[73,0,223,67],[74,0,223,68]],[[12,0,225,6],[42,0,225,36]],[[12,0,226,6],[18,0,226,12],[29,0,226,23],[32,0,226,48]],[[16,0,227,8],[25,0,227,17],[27,0,227,19],[31,0,227,23],[32,0,227,24],[38,0,227,30],[39,0,227,31],[47,0,227,39]],[[16,0,228,8],[28,0,228,20],[30,0,228,22],[34,0,228,26],[35,0,228,27],[41,0,228,33],[42,0,228,34],[53,0,228,45]],[[16,0,229,8],[29,0,229,21],[31,0,229,23],[35,0,229,27],[36,0,229,28],[42,0,229,34],[43,0,229,35],[55,0,229,47],[59,0,229,51],[65,0,229,57]],[[16,0,230,8],[21,0,230,13]],[[16,0,231,8],[24,0,231,16],[26,0,231,18],[30,0,231,22],[31,0,231,23],[37,0,231,29],[38,0,231,30],[46,0,231,38]],[[16,0,232,8],[21,0,232,13],[23,0,232,15],[27,0,232,19],[28,0,232,20],[34,0,232,26],[35,0,232,27],[40,0,232,32]],[[16,0,233,8],[37,0,233,29],[39,0,233,31],[52,0,233,44],[53,0,233,45],[72,0,233,64]],[[16,0,234,8],[30,0,234,22],[32,0,234,24],[45,0,234,37],[46,0,234,38],[59,0,234,51]],[[16,0,235,8],[21,0,235,13]],[[13,0,236,7],[14,0,236,8]],[[12,0,238,6],[38,0,238,32]],[[12,0,239,6],[18,0,239,12],[25,0,239,19],[28,0,239,22],[32,0,239,26],[33,0,239,27],[54,0,239,48],[55,0,239,49],[66,0,239,60],[67,0,239,61],[68,0,239,62]],[[12,0,241,6],[16,0,241,10],[17,0,241,11],[24,0,241,18],[25,0,241,19],[66,0,241,60],[67,0,241,61],[68,0,241,62]],[[12,0,242,6],[16,0,242,10],[17,0,242,11],[25,0,242,19],[26,0,242,20],[46,0,242,40],[48,0,242,42],[55,0,242,49],[56,0,242,50],[57,0,242,51]],[[12,0,244,6],[47,0,244,41]],[[12,0,245,6],[18,0,245,12],[19,0,245,13],[27,0,245,21],[28,0,245,22],[32,0,245,26],[35,0,245,29],[42,0,245,36],[43,0,245,37]],[[8,0,247,4],[9,0,247,5]],[[8,0,247,6],[15,0,247,13],[20,0,247,18],[22,0,247,20],[23,0,247,21]],[[12,0,248,6],[16,0,248,10],[17,0,248,11],[25,0,248,19],[26,0,248,20],[57,0,248,51],[59,0,248,53],[64,0,248,58],[65,0,248,59],[66,0,248,60]],[[12,0,249,6],[16,0,249,10],[17,0,249,11],[32,0,249,26],[33,0,249,27]],[[16,0,250,8],[25,0,250,17],[27,0,250,19],[32,0,250,24]],[[16,0,251,8],[21,0,251,13],[23,0,251,15],[59,0,251,51]],[[13,0,252,7],[14,0,252,8],[15,0,252,9]],[[12,0,253,6],[18,0,253,12],[23,0,253,17],[24,0,253,18]],[[8,0,254,4],[9,0,254,5]],[[4,0,255,2],[5,0,255,3]],[[4,0,257,2]],[],[[7,0,259,5]],[[4,0,260,10],[25,0,260,31],[26,0,260,32],[33,0,260,61]],[[8,0,261,4],[14,0,261,10],[20,0,261,16],[23,0,261,19],[27,0,261,23],[42,0,261,38],[44,0,261,40],[45,0,261,41]],[[8,0,263,4],[14,0,263,10],[15,0,263,11],[22,0,263,18],[23,0,263,19],[30,0,263,26],[31,0,263,27],[32,0,263,28],[39,0,263,35],[40,0,263,36],[41,0,263,37],[42,0,263,38],[45,0,263,41],[47,0,263,43],[52,0,263,48],[53,0,263,49],[55,0,263,51],[57,0,263,53]],[[12,0,264,6],[16,0,264,10],[21,0,264,15],[26,0,264,20],[35,0,264,29],[37,0,264,31],[38,0,264,32]],[[16,0,265,8],[22,0,265,14],[23,0,265,15],[29,0,265,21],[30,0,265,22],[33,0,265,25],[35,0,265,27],[40,0,265,32],[41,0,265,33],[49,0,265,41],[51,0,265,43],[52,0,265,44],[53,0,265,45]],[[12,0,266,6],[13,0,266,7]],[[8,0,267,4],[9,0,267,5],[10,0,267,6],[11,0,267,7]],[[8,0,269,4],[15,0,269,11],[18,0,269,14],[22,0,269,18],[23,0,269,19],[29,0,269,25],[30,0,269,26],[51,0,269,47],[55,0,269,51],[61,0,269,57],[62,0,269,58],[70,0,269,66],[72,0,269,68],[74,0,269,70],[75,0,269,71]],[[4,0,270,2],[5,0,270,3]],[[4,0,272,2]],[],[[7,0,274,5]],[[4,0,275,2],[9,0,275,7],[10,0,275,8],[24,0,275,22]],[[8,0,276,4],[12,0,276,8],[13,0,276,9],[30,0,276,26],[31,0,276,27],[35,0,276,31],[36,0,276,32],[46,0,276,42],[47,0,276,43],[49,0,276,45],[50,0,276,46]],[[12,0,277,6],[18,0,277,12],[22,0,277,16],[27,0,277,21],[28,0,277,22],[76,0,277,70],[77,0,277,71],[78,0,277,72]],[[8,0,278,4],[9,0,278,5]],[[8,0,280,4],[12,0,280,8],[13,0,280,9]],[[12,0,281,6],[16,0,281,10],[17,0,281,11],[32,0,281,26],[33,0,281,27],[35,0,281,29],[44,0,281,38],[46,0,281,40],[50,0,281,44],[52,0,281,46],[57,0,281,51],[59,0,281,53],[68,0,281,62],[70,0,281,64],[71,0,281,65],[72,0,281,66]],[[12,0,283,6],[18,0,283,12],[28,0,283,22],[31,0,283,25],[37,0,283,31],[38,0,283,32],[46,0,283,40],[47,0,283,41],[51,0,283,45],[52,0,283,46]],[[12,0,284,6],[16,0,284,10],[17,0,284,11],[24,0,284,18],[25,0,284,19],[52,0,284,46],[54,0,284,48],[64,0,284,58],[65,0,284,59],[66,0,284,60]],[[12,0,286,6],[42,0,286,36]],[[12,0,287,6],[18,0,287,12],[23,0,287,17],[26,0,287,20],[30,0,287,24],[31,0,287,25],[55,0,287,49],[57,0,287,51],[58,0,287,52]],[[12,0,288,6],[16,0,288,10],[21,0,288,15],[23,0,288,17],[24,0,288,18]],[[16,0,289,8],[22,0,289,14],[26,0,289,18],[31,0,289,23],[32,0,289,24],[49,0,289,41],[54,0,289,46],[55,0,289,47],[60,0,289,52],[66,0,289,58],[71,0,289,63],[72,0,289,64],[89,0,289,81],[93,0,289,85],[108,0,289,100],[110,0,289,102],[111,0,289,103],[112,0,289,104]],[[12,0,290,6],[13,0,290,7]],[[12,0,292,6],[80,0,292,74]],[[12,0,293,6],[18,0,293,12],[26,0,293,20],[29,0,293,23],[33,0,293,27],[34,0,293,28],[58,0,293,52],[60,0,293,54],[61,0,293,55]],[[12,0,294,6],[16,0,294,10],[17,0,294,11],[25,0,294,19],[26,0,294,20],[57,0,294,51],[59,0,294,53],[67,0,294,61],[68,0,294,62],[69,0,294,63],[70,0,294,64],[77,0,294,71],[78,0,294,72],[79,0,294,73],[80,0,294,74],[91,0,294,85],[92,0,294,86],[93,0,294,87]],[[12,0,296,6],[16,0,296,10],[24,0,296,18],[26,0,296,20],[27,0,296,21]],[[16,0,297,8],[22,0,297,14],[26,0,297,18],[27,0,297,19],[48,0,297,40],[49,0,297,41],[57,0,297,49],[58,0,297,50],[59,0,297,51]],[[16,0,298,8],[23,0,298,15]],[[12,0,299,6],[13,0,299,7]],[[12,0,301,6],[63,0,301,57]],[[12,0,302,6],[18,0,302,12],[24,0,302,18],[27,0,302,21],[31,0,302,25],[32,0,302,26],[57,0,302,51],[59,0,302,53],[60,0,302,54]],[[12,0,303,6],[16,0,303,10],[17,0,303,11],[25,0,303,19],[26,0,303,20],[59,0,303,53],[61,0,303,55],[67,0,303,61],[68,0,303,62],[69,0,303,63],[70,0,303,64],[77,0,303,71],[78,0,303,72],[79,0,303,73],[80,0,303,74],[91,0,303,85],[92,0,303,86],[93,0,303,87]],[[12,0,305,6],[16,0,305,10],[22,0,305,16],[24,0,305,18],[25,0,305,19]],[[16,0,306,8],[22,0,306,14],[26,0,306,18],[27,0,306,19],[46,0,306,38],[47,0,306,39],[53,0,306,45],[54,0,306,46],[55,0,306,47]],[[16,0,307,8],[23,0,307,15]],[[12,0,308,6],[13,0,308,7]],[[12,0,310,6],[18,0,310,12],[22,0,310,16],[27,0,310,21],[28,0,310,22],[79,0,310,73],[80,0,310,74],[81,0,310,75]],[[8,0,312,4],[9,0,312,5]],[[8,0,312,6],[15,0,312,13],[20,0,312,18],[22,0,312,20],[23,0,312,21]],[[12,0,313,6],[16,0,313,10],[17,0,313,11],[25,0,313,19],[26,0,313,20],[52,0,313,46],[54,0,313,48],[59,0,313,53],[60,0,313,54],[61,0,313,55]],[[12,0,314,6],[16,0,314,10],[17,0,314,11],[32,0,314,26],[33,0,314,27]],[[16,0,315,8],[25,0,315,17],[27,0,315,19],[32,0,315,24]],[[16,0,316,8],[21,0,316,13],[23,0,316,15],[28,0,316,20],[40,0,316,32],[45,0,316,37],[46,0,316,38],[47,0,316,39],[48,0,316,40],[53,0,316,45],[54,0,316,46],[61,0,316,53],[62,0,316,54],[63,0,316,55],[64,0,316,56],[90,0,316,82]],[[13,0,317,7],[14,0,317,8],[15,0,317,9]],[[12,0,318,6],[16,0,318,10],[17,0,318,11],[31,0,318,25],[32,0,318,26],[40,0,318,34],[42,0,318,36],[43,0,318,37]],[[12,0,319,6],[18,0,319,12],[23,0,319,17],[24,0,319,18]],[[8,0,320,4],[9,0,320,5]],[[4,0,321,2],[5,0,321,3]],[[4,0,323,2]],[],[[7,0,325,5]],[[4,0,326,10],[28,0,326,34]],[[8,0,327,4],[14,0,327,10],[23,0,327,19],[26,0,327,22],[30,0,327,26],[45,0,327,41],[46,0,327,42],[52,0,327,48],[53,0,327,49],[61,0,327,57],[62,0,327,58],[68,0,327,64],[69,0,327,65],[70,0,327,66]],[[8,0,328,4],[14,0,328,10],[24,0,328,20],[27,0,328,23],[31,0,328,27],[46,0,328,42],[47,0,328,43],[53,0,328,49],[54,0,328,50],[62,0,328,58],[63,0,328,59],[67,0,328,63],[68,0,328,64],[77,0,328,73],[78,0,328,74],[79,0,328,75],[80,0,328,76],[81,0,328,77],[82,0,328,78]],[[8,0,330,4],[14,0,330,10],[19,0,330,15],[22,0,330,18],[31,0,330,27],[32,0,330,28],[35,0,330,31],[36,0,330,32],[43,0,330,39],[44,0,330,40],[48,0,330,44],[58,0,330,54],[59,0,330,55],[62,0,330,58],[63,0,330,59],[70,0,330,66],[71,0,330,67],[72,0,330,68]],[[8,0,331,4],[12,0,331,8],[17,0,331,13],[19,0,331,15],[20,0,331,16]],[[12,0,332,6],[19,0,332,13]],[[16,0,333,8],[21,0,333,13]],[[16,0,334,8],[33,0,334,25],[35,0,334,27],[44,0,334,36],[45,0,334,37],[48,0,334,40],[49,0,334,41],[68,0,334,60],[69,0,334,61],[73,0,334,65],[83,0,334,75],[84,0,334,76],[87,0,334,79],[88,0,334,80],[107,0,334,99],[108,0,334,100],[112,0,334,104],[121,0,334,113]],[[16,0,335,8],[25,0,335,17],[27,0,335,19],[36,0,335,28],[37,0,335,29],[40,0,335,32],[41,0,335,33],[52,0,335,44],[53,0,335,45],[57,0,335,49],[67,0,335,59],[68,0,335,60],[71,0,335,63],[72,0,335,64],[83,0,335,75],[84,0,335,76],[88,0,335,80],[97,0,335,89]],[[16,0,336,8],[21,0,336,13],[23,0,336,15],[32,0,336,24],[33,0,336,25],[36,0,336,28],[37,0,336,29],[44,0,336,36],[45,0,336,37],[49,0,336,41],[59,0,336,51],[60,0,336,52],[63,0,336,55],[64,0,336,56],[71,0,336,63],[72,0,336,64],[76,0,336,68],[85,0,336,77]],[[13,0,337,7],[14,0,337,8]],[[8,0,338,4],[9,0,338,5]],[[8,0,340,4],[15,0,340,11],[19,0,340,15],[20,0,340,16]],[[4,0,341,2],[5,0,341,3]],[[4,0,343,2]],[],[[7,0,345,5]],[[4,0,346,10],[28,0,346,34]],[[8,0,347,4],[39,0,347,35]],[[8,0,348,4],[14,0,348,10],[23,0,348,19],[26,0,348,22],[30,0,348,26],[45,0,348,41],[46,0,348,42],[52,0,348,48],[53,0,348,49],[61,0,348,57],[62,0,348,58],[68,0,348,64],[69,0,348,65],[70,0,348,66]],[[8,0,349,4],[12,0,349,8],[16,0,349,12],[19,0,349,15],[28,0,349,24],[29,0,349,25],[32,0,349,28],[33,0,349,29],[39,0,349,35],[40,0,349,36],[41,0,349,37]],[[8,0,351,4],[60,0,351,56]],[[8,0,352,4],[12,0,352,8],[13,0,352,9],[17,0,352,13],[21,0,352,17],[27,0,352,23],[28,0,352,24],[36,0,352,32],[37,0,352,33],[41,0,352,37],[43,0,352,39],[44,0,352,40]],[[12,0,353,6],[18,0,353,12],[28,0,353,22],[31,0,353,25],[35,0,353,29],[50,0,353,44],[51,0,353,45],[57,0,353,51],[58,0,353,52],[66,0,353,60],[67,0,353,61],[71,0,353,65],[72,0,353,66],[81,0,353,75],[82,0,353,76],[83,0,353,77],[84,0,353,78],[85,0,353,79],[86,0,353,80]],[[12,0,354,6],[16,0,354,10],[19,0,354,13],[29,0,354,23],[30,0,354,24],[33,0,354,27],[34,0,354,28],[40,0,354,34],[41,0,354,35],[42,0,354,36]],[[8,0,355,4],[9,0,355,5]],[[8,0,357,4],[12,0,357,8],[16,0,357,12],[18,0,357,14],[19,0,357,15]],[[12,0,358,6],[16,0,358,10],[17,0,358,11],[25,0,358,19],[26,0,358,20],[70,0,358,64],[71,0,358,65],[72,0,358,66]],[[12,0,359,6],[19,0,359,13],[23,0,359,17],[24,0,359,18]],[[8,0,360,4],[9,0,360,5]],[[8,0,362,4],[15,0,362,11],[19,0,362,15],[20,0,362,16]],[[4,0,363,2],[5,0,363,3]],[[4,0,365,2]],[],[[7,0,367,5]],[[4,0,368,10],[29,0,368,35]],[[8,0,369,4],[14,0,369,10],[22,0,369,18],[25,0,369,21],[31,0,369,27],[32,0,369,28],[40,0,369,36],[41,0,369,37],[45,0,369,41],[46,0,369,42],[55,0,369,51],[56,0,369,52],[57,0,369,53],[58,0,369,54],[59,0,369,55]],[[8,0,370,4],[12,0,370,8],[13,0,370,9],[21,0,370,17],[23,0,370,19],[24,0,370,20]],[[12,0,371,6],[19,0,371,13],[23,0,371,17],[24,0,371,18]],[[8,0,372,4],[9,0,372,5]],[[8,0,374,4],[14,0,374,10],[20,0,374,16],[23,0,374,19],[27,0,374,23],[42,0,374,38],[43,0,374,39],[51,0,374,47],[52,0,374,48],[53,0,374,49]],[[8,0,375,4],[14,0,375,10],[25,0,375,21],[28,0,375,24],[34,0,375,30],[35,0,375,31],[38,0,375,34],[39,0,375,35],[53,0,375,49],[54,0,375,50],[55,0,375,51]],[[8,0,377,4],[12,0,377,8],[23,0,377,19],[25,0,377,21],[26,0,377,22]],[[12,0,378,6],[16,0,378,10],[17,0,378,11],[25,0,378,19],[26,0,378,20],[62,0,378,56],[63,0,378,57],[64,0,378,58]],[[12,0,379,6],[19,0,379,13]],[[16,0,380,8],[28,0,380,20],[30,0,380,22],[41,0,380,33]],[[16,0,381,8],[29,0,381,21],[31,0,381,23],[37,0,381,29],[38,0,381,30],[41,0,381,33],[42,0,381,34],[57,0,381,49],[58,0,381,50],[62,0,381,54],[71,0,381,63]],[[16,0,382,8],[26,0,382,18],[28,0,382,20],[34,0,382,26],[35,0,382,27],[38,0,382,30],[39,0,382,31],[51,0,382,43],[52,0,382,44],[56,0,382,48],[64,0,382,56]],[[16,0,383,8],[26,0,383,18],[28,0,383,20],[36,0,383,28],[37,0,383,29],[43,0,383,35],[44,0,383,36],[47,0,383,39],[48,0,383,40],[60,0,383,52],[61,0,383,53],[65,0,383,57],[71,0,383,63],[73,0,383,65],[75,0,383,67],[76,0,383,68]],[[16,0,384,8],[21,0,384,13],[23,0,384,15],[29,0,384,21],[30,0,384,22],[33,0,384,25],[34,0,384,26],[41,0,384,33],[42,0,384,34],[46,0,384,38],[55,0,384,47]],[[16,0,385,8],[24,0,385,16],[26,0,385,18],[32,0,385,24],[33,0,385,25],[36,0,385,28],[37,0,385,29],[47,0,385,39],[48,0,385,40],[52,0,385,44],[61,0,385,53]],[[13,0,386,7],[14,0,386,8]],[[8,0,387,4],[9,0,387,5]],[[8,0,389,4],[15,0,389,11],[19,0,389,15],[20,0,389,16]],[[4,0,390,2],[5,0,390,3]],[[4,0,392,2]],[],[[7,0,394,5]],[[4,0,395,10],[9,0,395,15],[10,0,395,16],[31,0,395,37],[32,0,395,38],[40,0,395,54]],[[8,0,396,4],[14,0,396,10],[26,0,396,22],[29,0,396,25],[33,0,396,29],[34,0,396,30],[48,0,396,44],[49,0,396,45],[56,0,396,52],[57,0,396,53],[76,0,396,72],[77,0,396,73],[90,0,396,86],[91,0,396,87],[92,0,396,88]],[[8,0,398,4],[12,0,398,8],[13,0,398,9],[25,0,398,21],[27,0,398,23],[28,0,398,24]],[[12,0,399,6],[16,0,399,10],[17,0,399,11],[25,0,399,19],[26,0,399,20],[62,0,399,56],[63,0,399,57],[64,0,399,58]],[[12,0,400,6],[18,0,400,12],[22,0,400,16],[27,0,400,21],[28,0,400,22],[64,0,400,58],[65,0,400,59],[66,0,400,60]],[[8,0,401,4],[9,0,401,5]],[[8,0,403,4],[14,0,403,10],[26,0,403,22],[29,0,403,39]],[[12,0,404,6],[22,0,404,16],[24,0,404,18],[44,0,404,38]],[[12,0,405,6],[24,0,405,18],[26,0,405,20],[30,0,405,24],[31,0,405,25],[37,0,405,31],[38,0,405,32],[49,0,405,43]],[[12,0,406,6],[21,0,406,15],[23,0,406,17],[27,0,406,21],[28,0,406,22],[34,0,406,28],[35,0,406,29],[43,0,406,37]],[[12,0,407,6],[16,0,407,10],[18,0,407,12],[26,0,407,20]],[[12,0,408,6],[25,0,408,19],[27,0,408,21],[39,0,408,33]],[[9,0,409,5],[10,0,409,6]],[[8,0,411,4],[12,0,411,8],[13,0,411,9],[20,0,411,16],[21,0,411,17],[63,0,411,59],[64,0,411,60],[65,0,411,61]],[[8,0,413,4],[69,0,413,65]],[[8,0,414,4],[14,0,414,10],[22,0,414,18],[25,0,414,21],[29,0,414,25],[44,0,414,40],[46,0,414,42],[47,0,414,43]],[[8,0,415,4],[14,0,415,10],[15,0,415,11],[22,0,415,18],[23,0,415,19],[35,0,415,31],[36,0,415,32],[37,0,415,33],[44,0,415,40],[45,0,415,41],[46,0,415,42],[47,0,415,43],[50,0,415,46],[52,0,415,48],[57,0,415,53],[58,0,415,54],[60,0,415,56],[62,0,415,58]],[[12,0,416,6],[16,0,416,10],[21,0,416,15],[26,0,416,20],[35,0,416,29],[37,0,416,31],[38,0,416,32]],[[16,0,417,8],[24,0,417,16],[25,0,417,17],[31,0,417,23],[32,0,417,24],[35,0,417,27],[37,0,417,29],[42,0,417,34],[43,0,417,35],[51,0,417,43],[53,0,417,45],[54,0,417,46],[55,0,417,47]],[[12,0,418,6],[13,0,418,7]],[[8,0,419,4],[9,0,419,5],[10,0,419,6],[11,0,419,7]],[[8,0,421,4],[12,0,421,8],[13,0,421,9]],[[12,0,422,6],[18,0,422,12],[31,0,422,25],[34,0,422,28],[40,0,422,34],[44,0,422,38],[45,0,422,39],[49,0,422,43],[50,0,422,44],[54,0,422,48],[55,0,423,8],[59,0,423,12],[60,0,423,13],[66,0,423,19],[67,0,423,20],[80,0,423,33],[82,0,424,8],[90,0,424,16],[91,0,424,17],[99,0,424,25],[101,0,424,27],[103,0,425,8]],[[16,0,426,10],[23,0,426,17],[25,0,426,19]],[[20,0,427,12],[34,0,427,26],[36,0,427,28],[71,0,427,63]],[[17,0,428,11]],[[13,0,429,9],[14,0,430,7],[15,0,430,8],[24,0,430,17],[26,0,430,19],[27,0,430,20]],[[12,0,432,6],[16,0,432,10],[29,0,432,23],[31,0,432,25],[32,0,432,26]],[[16,0,433,8],[22,0,433,14],[26,0,433,18],[27,0,433,19],[46,0,433,38],[47,0,433,39],[60,0,433,52],[61,0,433,53],[62,0,433,54]],[[12,0,434,6],[13,0,434,7]],[[17,0,434,13],[18,0,434,14]],[[16,0,435,8],[22,0,435,14],[26,0,435,18],[31,0,435,23],[32,0,435,24],[60,0,435,52],[61,0,435,53],[62,0,435,54]],[[12,0,436,6],[13,0,436,7]],[[8,0,438,4],[9,0,438,5]],[[8,0,438,6],[15,0,438,13],[20,0,438,18],[22,0,438,20],[23,0,438,21]],[[12,0,439,6],[16,0,439,10],[17,0,439,11],[25,0,439,19],[26,0,439,20],[50,0,439,44],[52,0,439,46],[57,0,439,51],[58,0,439,52],[59,0,439,53]],[[12,0,440,6],[18,0,440,12],[22,0,440,16],[27,0,440,21],[28,0,440,22],[78,0,440,72],[79,0,440,73],[80,0,440,74]],[[8,0,441,4],[9,0,441,5]],[[4,0,442,2],[5,0,442,3]],[[4,0,444,2]],[],[[7,0,446,5]],[[4,0,447,10],[9,0,447,15],[10,0,447,16],[29,0,447,35],[30,0,447,36],[43,0,447,64]],[[8,0,448,4],[12,0,448,8],[13,0,448,9]],[[12,0,449,6],[59,0,449,53]],[[12,0,450,6],[18,0,450,12],[22,0,450,16],[23,0,450,17],[36,0,450,30],[38,0,450,32],[39,0,450,33]],[[12,0,452,6],[32,0,452,26]],[[12,0,453,6],[18,0,453,12],[27,0,453,21],[30,0,453,35]],[[16,0,454,8],[27,0,454,19],[29,0,454,21],[42,0,454,34],[43,0,454,35],[55,0,454,47]],[[16,0,455,8],[28,0,455,20],[30,0,455,22],[43,0,455,35],[44,0,455,36],[57,0,455,49]],[[16,0,456,8],[25,0,456,17],[27,0,456,19],[40,0,456,32],[41,0,456,33],[51,0,456,43],[55,0,456,47],[63,0,456,55]],[[16,0,457,8],[25,0,457,17],[27,0,457,19],[31,0,457,23],[32,0,457,24],[35,0,457,27],[37,0,457,29],[40,0,457,32],[41,0,457,33],[54,0,457,46],[55,0,457,47],[65,0,457,57],[68,0,457,60],[72,0,457,64],[73,0,457,65]],[[16,0,458,8],[21,0,458,13],[23,0,458,15],[36,0,458,28],[37,0,458,29],[42,0,458,34]],[[16,0,459,8],[23,0,459,15],[25,0,459,17],[38,0,459,30],[39,0,459,31],[47,0,459,39]],[[13,0,460,7],[14,0,460,8]],[[12,0,462,6],[36,0,462,30]],[[12,0,463,6],[16,0,463,10],[17,0,463,11],[31,0,463,25],[32,0,463,26],[41,0,463,35],[42,0,463,36],[43,0,463,37]],[[12,0,465,6],[42,0,465,36]],[[12,0,466,6],[16,0,466,10],[17,0,466,11],[32,0,466,26],[33,0,466,27]],[[16,0,467,8],[31,0,467,23],[33,0,467,25],[37,0,467,29]],[[16,0,468,8],[25,0,468,17],[27,0,468,19],[32,0,468,24]],[[16,0,469,8],[25,0,469,17]],[[16,0,470,8],[21,0,470,13],[23,0,470,15],[32,0,470,24]],[[13,0,471,7],[14,0,471,8],[15,0,471,9]],[[12,0,473,6],[41,0,473,35]],[[12,0,474,6],[16,0,474,10],[17,0,474,11],[31,0,474,25],[32,0,474,26],[46,0,474,40],[48,0,474,42],[49,0,474,43]],[[12,0,476,6],[16,0,476,10],[17,0,476,11],[24,0,476,18],[25,0,476,19],[73,0,476,67],[74,0,476,68],[75,0,476,69]],[[8,0,478,4],[9,0,478,5]],[[8,0,478,6],[15,0,478,13],[20,0,478,18],[22,0,478,20],[23,0,478,21]],[[12,0,479,6],[16,0,479,10],[17,0,479,11],[25,0,479,19],[26,0,479,20],[58,0,479,52],[60,0,479,54],[65,0,479,59],[66,0,479,60],[67,0,479,61]],[[12,0,480,6],[18,0,480,12],[23,0,480,17],[24,0,480,18]],[[8,0,481,4],[9,0,481,5]],[[4,0,482,2],[5,0,482,3]],[[4,0,484,2]],[],[[7,0,486,5]],[[4,0,487,10],[9,0,487,15],[10,0,487,16],[23,0,487,29]],[[8,0,488,4],[14,0,488,10],[23,0,488,19],[26,0,488,22],[30,0,488,26],[45,0,488,41],[46,0,488,42],[52,0,488,48],[53,0,488,49],[61,0,488,57],[62,0,488,58],[68,0,488,64],[69,0,488,65],[70,0,488,66]],[[8,0,489,4],[14,0,489,10],[24,0,489,20],[27,0,489,23],[31,0,489,27],[46,0,489,42],[47,0,489,43],[53,0,489,49],[54,0,489,50],[62,0,489,58],[63,0,489,59],[67,0,489,63],[68,0,489,64],[77,0,489,73],[78,0,489,74],[79,0,489,75],[80,0,489,76],[81,0,489,77],[82,0,489,78]],[[8,0,491,4],[14,0,491,10],[27,0,491,23],[30,0,491,26],[39,0,491,35],[40,0,491,36],[43,0,491,39],[44,0,491,40],[51,0,491,47],[52,0,491,48],[56,0,491,52],[66,0,491,62],[67,0,491,63],[70,0,491,66],[71,0,491,67],[78,0,491,74],[79,0,491,75],[80,0,491,76]],[[8,0,492,4],[14,0,492,10],[25,0,492,21],[28,0,492,24],[32,0,492,28],[33,0,492,29],[47,0,492,43],[48,0,492,44],[55,0,492,51],[56,0,492,52],[75,0,492,71],[76,0,492,72],[81,0,492,77],[82,0,492,78],[83,0,492,79]],[[8,0,494,4],[12,0,494,8],[13,0,494,9],[26,0,494,22],[30,0,494,26],[31,0,494,27],[42,0,494,38],[46,0,494,42],[59,0,494,55],[64,0,494,60],[75,0,494,71],[77,0,494,73],[78,0,494,74]],[[12,0,495,6],[18,0,495,12],[22,0,495,16],[27,0,495,21],[28,0,495,22],[76,0,495,70],[77,0,495,71],[78,0,495,72]],[[8,0,496,4],[9,0,496,5]],[[8,0,498,4],[12,0,498,8],[13,0,498,9],[21,0,498,17],[22,0,498,18],[62,0,498,58],[63,0,498,59],[64,0,498,60]],[[4,0,499,2],[5,0,499,3]],[[4,0,501,2]],[],[[7,0,503,5]],[[4,0,504,2],[18,0,504,16]],[[8,0,505,4],[14,0,505,10],[23,0,505,19],[26,0,505,22],[30,0,505,26],[31,0,505,27],[49,0,505,45],[51,0,505,47],[52,0,505,48]],[[8,0,506,4],[12,0,506,8],[21,0,506,17],[25,0,506,21],[29,0,506,25],[30,0,506,26],[42,0,506,38],[43,0,506,39],[52,0,506,48],[53,0,506,49],[55,0,506,51],[56,0,506,52]],[[12,0,507,6],[19,0,507,13],[28,0,507,22],[29,0,507,23],[40,0,507,34],[41,0,507,35]],[[8,0,508,4],[9,0,508,5]],[[8,0,509,4],[15,0,509,11],[19,0,509,15],[20,0,509,16]],[[4,0,510,2],[5,0,510,3]],[[4,0,512,2]],[],[[7,0,514,5]],[[4,0,515,2],[21,0,515,19]],[[8,0,516,4],[14,0,516,10],[23,0,516,19],[26,0,516,22],[30,0,516,26],[31,0,516,27],[49,0,516,45],[51,0,516,47],[52,0,516,48]],[[8,0,517,4],[15,0,517,11],[24,0,517,20],[26,0,517,22],[37,0,517,33],[41,0,517,37],[45,0,517,41],[46,0,517,42]],[[4,0,518,2],[5,0,518,3]],[[4,0,520,2]],[],[[7,0,522,5]],[[4,0,523,2],[19,0,523,17]],[[8,0,524,4],[14,0,524,10],[23,0,524,19],[26,0,524,22],[30,0,524,26],[31,0,524,27],[49,0,524,45],[51,0,524,47],[52,0,524,48]],[[8,0,525,4],[15,0,525,11],[24,0,525,20],[26,0,525,22],[38,0,525,34],[42,0,525,38],[46,0,525,42],[47,0,525,43]],[[4,0,526,2],[5,0,526,3]],[[4,0,528,2]],[],[[7,0,530,5]],[[4,0,531,2],[19,0,531,17]],[[8,0,532,4],[14,0,532,10],[23,0,532,19],[26,0,532,22],[30,0,532,26],[31,0,532,27],[49,0,532,45],[51,0,532,47],[52,0,532,48]],[[8,0,533,4],[15,0,533,11],[24,0,533,20],[25,0,533,21],[26,0,533,22],[27,0,533,23],[31,0,533,27],[32,0,533,28],[44,0,533,40],[45,0,533,41],[54,0,533,50],[55,0,533,51],[56,0,533,52],[57,0,533,53],[58,0,533,54],[63,0,533,59],[64,0,533,60]],[[4,0,534,2],[5,0,534,3]],[[4,0,536,2]],[],[[7,0,538,5]],[[4,0,539,2],[29,0,539,27]],[[8,0,540,4],[15,0,540,11],[32,0,540,28],[33,0,540,29],[37,0,540,33],[38,0,540,34],[48,0,540,44],[49,0,540,45],[50,0,540,46]],[[4,0,541,2],[5,0,541,3]],[[4,0,543,2]],[],[[7,0,545,5]],[[4,0,546,2],[9,0,546,7],[10,0,546,8],[21,0,546,19]],[[8,0,547,4],[12,0,547,8],[13,0,547,9],[17,0,547,13],[18,0,547,14],[24,0,547,20],[25,0,547,21],[41,0,547,37],[43,0,547,39],[44,0,547,40]],[[12,0,548,6],[18,0,548,12],[22,0,548,16],[27,0,548,21],[28,0,548,22],[62,0,548,56],[63,0,548,57],[64,0,548,58]],[[8,0,549,4],[9,0,549,5]],[[8,0,551,4],[14,0,551,10],[25,0,551,21],[28,0,551,24],[32,0,551,28],[33,0,551,29],[47,0,551,43],[49,0,551,45],[50,0,551,46]],[[8,0,552,4],[12,0,552,8],[13,0,552,9],[24,0,552,20],[26,0,552,22],[27,0,552,23]],[[12,0,553,6],[18,0,553,12],[22,0,553,16],[27,0,553,21],[28,0,553,22],[55,0,553,49],[56,0,553,50],[57,0,553,51]],[[8,0,554,4],[9,0,554,5]],[[8,0,556,4],[12,0,556,8],[13,0,556,9],[20,0,556,16],[21,0,556,17],[69,0,556,65],[70,0,556,66],[71,0,556,67]],[[8,0,558,4],[12,0,558,8],[13,0,558,9]],[[12,0,559,6],[18,0,559,12],[26,0,559,20],[29,0,559,23],[35,0,559,29],[39,0,559,33],[40,0,559,34],[44,0,559,38],[45,0,559,39],[48,0,559,42],[49,0,560,8],[53,0,560,12],[54,0,560,13],[60,0,560,19],[61,0,560,20],[77,0,560,36],[79,0,561,8]],[[16,0,562,10],[23,0,562,17],[25,0,562,19]],[[20,0,563,12],[35,0,563,27],[37,0,563,29],[47,0,563,39],[58,0,563,50],[60,0,563,52]],[[17,0,564,11]],[[13,0,565,9],[14,0,566,7],[15,0,566,8],[24,0,566,17],[26,0,566,19],[27,0,566,20]],[[12,0,568,6],[16,0,568,10],[24,0,568,18],[26,0,568,20],[27,0,568,21]],[[16,0,569,8],[20,0,569,12],[21,0,569,13],[29,0,569,21],[30,0,569,22],[65,0,569,57],[67,0,569,59],[75,0,569,67],[76,0,569,68],[77,0,569,69]],[[16,0,570,8],[23,0,570,15],[31,0,570,23],[32,0,570,24]],[[12,0,571,6],[13,0,571,7]],[[17,0,571,13],[18,0,571,14]],[[16,0,572,8],[22,0,572,14],[26,0,572,18],[31,0,572,23],[32,0,572,24],[64,0,572,56],[65,0,572,57],[66,0,572,58]],[[12,0,573,6],[13,0,573,7]],[[8,0,574,4],[9,0,574,5]],[[8,0,574,6],[15,0,574,13],[20,0,574,18],[22,0,574,20],[23,0,574,21]],[[12,0,575,6],[16,0,575,10],[17,0,575,11],[25,0,575,19],[26,0,575,20],[54,0,575,48],[56,0,575,50],[61,0,575,55],[62,0,575,56],[63,0,575,57]],[[12,0,576,6],[18,0,576,12],[22,0,576,16],[27,0,576,21],[28,0,576,22],[62,0,576,56],[63,0,576,57],[64,0,576,58]],[[8,0,577,4],[9,0,577,5]],[[4,0,578,2],[5,0,578,3]],[[4,0,580,2]],[],[[7,0,582,5]],[[4,0,583,10],[16,0,583,22],[17,0,583,23],[26,0,583,43]],[[8,0,584,4],[14,0,584,10],[23,0,584,19],[26,0,584,22],[27,0,584,23],[31,0,584,27],[32,0,584,28],[38,0,584,34],[39,0,584,35],[55,0,584,51],[59,0,584,55],[62,0,584,58],[63,0,584,59],[66,0,584,62],[70,0,584,66],[71,0,584,67],[72,0,584,68],[98,0,584,94]],[[8,0,585,4],[15,0,585,11],[19,0,585,15],[20,0,585,16],[23,0,585,19],[25,0,585,21],[28,0,585,24],[29,0,585,25],[38,0,585,34],[39,0,585,35],[48,0,585,44],[51,0,585,47],[60,0,585,56],[61,0,585,57],[62,0,585,58]],[[4,0,586,2],[5,0,586,3]],[[4,0,588,2]],[],[[7,0,590,5]],[[4,0,591,2],[9,0,591,7],[10,0,591,8],[28,0,591,26]],[[8,0,592,4],[14,0,592,10],[26,0,592,22],[29,0,592,25],[33,0,592,29],[34,0,592,30],[49,0,592,45],[51,0,592,47],[52,0,592,48]],[[8,0,593,4],[12,0,593,8],[13,0,593,9],[25,0,593,21],[27,0,593,23],[28,0,593,24]],[[12,0,594,6],[18,0,594,12],[22,0,594,16],[27,0,594,21],[28,0,594,22],[56,0,594,50],[57,0,594,51],[58,0,594,52]],[[8,0,595,4],[9,0,595,5]],[[8,0,597,4],[12,0,597,8],[13,0,597,9],[20,0,597,16],[21,0,597,17],[46,0,597,42],[47,0,597,43],[48,0,597,44]],[[8,0,599,4],[14,0,599,10],[26,0,599,22],[29,0,599,25]],[[12,0,600,6],[22,0,600,16],[24,0,600,18],[39,0,600,33]],[[12,0,601,6],[25,0,601,19],[27,0,601,21],[39,0,601,33]],[[12,0,602,6],[21,0,602,15],[23,0,602,17],[27,0,602,21],[28,0,602,22],[34,0,602,28],[35,0,602,29],[43,0,602,37]],[[9,0,603,5],[10,0,603,6]],[[8,0,605,4],[69,0,605,65]],[[8,0,606,4],[14,0,606,10],[22,0,606,18],[25,0,606,21],[29,0,606,25],[44,0,606,40],[46,0,606,42],[47,0,606,43]],[[8,0,607,4],[14,0,607,10],[15,0,607,11],[22,0,607,18],[23,0,607,19],[35,0,607,31],[36,0,607,32],[37,0,607,33],[44,0,607,40],[45,0,607,41],[46,0,607,42],[47,0,607,43],[50,0,607,46],[52,0,607,48],[57,0,607,53],[58,0,607,54],[60,0,607,56],[62,0,607,58]],[[12,0,608,6],[16,0,608,10],[21,0,608,15],[26,0,608,20],[35,0,608,29],[37,0,608,31],[38,0,608,32]],[[16,0,609,8],[24,0,609,16],[25,0,609,17],[31,0,609,23],[32,0,609,24],[35,0,609,27],[37,0,609,29],[42,0,609,34],[43,0,609,35],[51,0,609,43],[53,0,609,45],[54,0,609,46],[55,0,609,47]],[[12,0,610,6],[13,0,610,7]],[[8,0,611,4],[9,0,611,5],[10,0,611,6],[11,0,611,7]],[[8,0,613,4],[12,0,613,8],[13,0,613,9]],[[12,0,614,6],[18,0,614,12],[31,0,614,25],[34,0,614,28],[40,0,614,34],[44,0,614,38],[45,0,614,39],[49,0,614,43],[50,0,614,44],[54,0,614,48],[55,0,615,8],[59,0,615,12],[60,0,615,13],[66,0,615,19],[67,0,615,20],[80,0,615,33],[82,0,616,8],[90,0,616,16],[91,0,616,17],[99,0,616,25],[101,0,616,27],[103,0,617,8]],[[16,0,618,10],[23,0,618,17],[25,0,618,19]],[[20,0,619,12],[34,0,619,26],[36,0,619,28],[71,0,619,63]],[[17,0,620,11]],[[13,0,621,9],[14,0,622,7],[15,0,622,8],[24,0,622,17],[26,0,622,19],[27,0,622,20]],[[12,0,624,6],[16,0,624,10],[29,0,624,23],[31,0,624,25],[32,0,624,26]],[[16,0,625,8],[22,0,625,14],[31,0,625,23],[34,0,625,37]],[[20,0,626,10],[31,0,626,21],[33,0,626,23],[46,0,626,36],[47,0,626,37],[59,0,626,49]],[[20,0,627,10],[32,0,627,22],[34,0,627,24],[47,0,627,37],[48,0,627,38],[61,0,627,51],[65,0,627,55],[77,0,627,67]],[[20,0,628,10],[29,0,628,19],[31,0,628,21],[44,0,628,34],[45,0,628,35],[55,0,628,45],[59,0,628,49],[67,0,628,57]],[[20,0,629,10],[29,0,629,19],[31,0,629,21],[35,0,629,25],[36,0,629,26],[39,0,629,29],[41,0,629,31],[44,0,629,34],[45,0,629,35],[58,0,629,48],[59,0,629,49],[69,0,629,59],[72,0,629,62],[76,0,629,66],[77,0,629,67]],[[20,0,630,10],[25,0,630,15],[27,0,630,17],[40,0,630,30],[41,0,630,31],[46,0,630,36]],[[20,0,631,10],[27,0,631,17],[29,0,631,19],[42,0,631,32],[43,0,631,33],[51,0,631,41]],[[17,0,632,9],[18,0,632,10]],[[16,0,634,8],[20,0,634,12],[21,0,634,13],[35,0,634,27],[36,0,634,28],[45,0,634,37],[46,0,634,38],[47,0,634,39]],[[16,0,635,8],[20,0,635,12],[21,0,635,13],[36,0,635,28],[37,0,635,29]],[[20,0,636,10],[35,0,636,25],[37,0,636,27],[41,0,636,31]],[[20,0,637,10],[29,0,637,19],[31,0,637,21],[36,0,637,26]],[[20,0,638,10],[29,0,638,19]],[[17,0,639,9],[18,0,639,10],[19,0,639,11]],[[16,0,641,8],[20,0,641,12],[21,0,641,13],[28,0,641,20],[29,0,641,21],[66,0,641,58],[67,0,641,59],[68,0,641,60]],[[16,0,642,8],[23,0,642,15],[36,0,642,28],[37,0,642,29],[49,0,642,41],[50,0,642,42]],[[12,0,643,6],[13,0,643,7]],[[17,0,643,13],[18,0,643,14]],[[16,0,644,8],[22,0,644,14],[26,0,644,18],[31,0,644,23],[32,0,644,24],[60,0,644,52],[61,0,644,53],[62,0,644,54]],[[12,0,645,6],[13,0,645,7]],[[8,0,647,4],[9,0,647,5]],[[8,0,647,6],[15,0,647,13],[20,0,647,18],[22,0,647,20],[23,0,647,21]],[[12,0,648,6],[16,0,648,10],[17,0,648,11],[25,0,648,19],[26,0,648,20],[49,0,648,43],[51,0,648,45],[56,0,648,50],[57,0,648,51],[58,0,648,52]],[[12,0,650,6],[83,0,650,77]],[[12,0,651,6],[16,0,651,10],[21,0,651,15],[33,0,651,27],[38,0,651,32],[42,0,651,36],[50,0,651,44],[54,0,651,48],[59,0,651,53],[61,0,651,55],[62,0,651,56]],[[16,0,652,8],[22,0,652,14],[31,0,652,23],[34,0,652,26],[39,0,652,38],[40,0,652,39]],[[16,0,653,8],[20,0,653,12],[29,0,653,21],[30,0,653,22],[36,0,653,28],[41,0,653,33],[44,0,653,36],[48,0,653,40],[57,0,653,49],[58,0,653,50],[64,0,653,56],[69,0,653,61],[72,0,653,64],[74,0,653,66],[75,0,653,67]],[[20,0,654,10],[24,0,654,14],[25,0,654,15],[32,0,654,22],[33,0,654,23],[72,0,654,62],[73,0,654,63],[74,0,654,64]],[[20,0,655,10],[24,0,655,14],[25,0,655,15],[31,0,655,21],[33,0,655,23],[34,0,655,24]],[[16,0,656,8],[17,0,656,9]],[[12,0,657,6],[13,0,657,7]],[[17,0,657,13],[18,0,657,14]],[[16,0,658,8],[20,0,658,12],[21,0,658,13],[28,0,658,20],[29,0,658,21],[93,0,658,85],[94,0,658,86],[95,0,658,87]],[[12,0,659,6],[13,0,659,7]],[[12,0,661,6],[18,0,661,12],[22,0,661,16],[27,0,661,21],[28,0,661,22],[60,0,661,54],[61,0,661,55],[62,0,661,56]],[[8,0,662,4],[9,0,662,5]],[[4,0,663,2],[5,0,663,3]],[[4,0,665,2]],[],[[7,0,667,5]],[[4,0,668,2],[9,0,668,7],[10,0,668,8],[16,0,668,14]],[[8,0,669,4],[12,0,669,8],[13,0,669,9]],[[12,0,670,6],[16,0,670,10],[17,0,670,11],[32,0,670,26],[33,0,670,27],[35,0,670,29],[44,0,670,38],[46,0,670,40],[50,0,670,44],[52,0,670,46],[53,0,670,47],[54,0,670,48]],[[12,0,672,6],[41,0,672,35]],[[12,0,673,6],[18,0,673,12],[22,0,673,16],[23,0,673,17],[35,0,673,29],[37,0,673,31],[38,0,673,32]],[[12,0,675,6],[51,0,675,45]],[[12,0,676,6],[16,0,676,10],[17,0,676,11],[31,0,676,25],[32,0,676,26],[40,0,676,34],[42,0,676,36],[43,0,676,37]],[[12,0,678,6],[42,0,678,36]],[[12,0,679,6],[16,0,679,10],[17,0,679,11],[32,0,679,26],[33,0,679,27]],[[16,0,680,8],[31,0,680,23],[33,0,680,25],[38,0,680,30]],[[16,0,681,8],[25,0,681,17],[27,0,681,19],[32,0,681,24]],[[16,0,682,8],[25,0,682,17],[27,0,682,19],[36,0,682,28]],[[16,0,683,8],[21,0,683,13],[23,0,683,15],[32,0,683,24]],[[13,0,684,7],[14,0,684,8],[15,0,684,9]],[[12,0,686,6],[16,0,686,10],[17,0,686,11],[24,0,686,18],[25,0,686,19],[55,0,686,49],[56,0,686,50],[57,0,686,51]],[[8,0,688,4],[9,0,688,5]],[[8,0,688,6],[15,0,688,13],[20,0,688,18],[22,0,688,20],[23,0,688,21]],[[12,0,689,6],[16,0,689,10],[17,0,689,11],[25,0,689,19],[26,0,689,20],[48,0,689,42],[50,0,689,44],[55,0,689,49],[56,0,689,50],[57,0,689,51]],[[12,0,690,6],[62,0,690,56]],[[12,0,691,6],[16,0,691,10],[17,0,691,11],[31,0,691,25],[32,0,691,26],[40,0,691,34],[42,0,691,36],[43,0,691,37]],[[12,0,692,6],[16,0,692,10],[17,0,692,11],[32,0,692,26],[33,0,692,27]],[[16,0,693,8],[31,0,693,23],[33,0,693,25],[38,0,693,30]],[[16,0,694,8],[25,0,694,17],[27,0,694,19],[32,0,694,24]],[[16,0,695,8],[25,0,695,17],[27,0,695,19],[36,0,695,28]],[[13,0,696,7],[14,0,696,8],[15,0,696,9]],[[8,0,697,4],[9,0,697,5]],[[4,0,698,2],[5,0,698,3]],[[4,0,700,2]],[],[[7,0,702,5]],[[4,0,703,10],[9,0,703,15],[10,0,703,16],[22,0,703,28]],[[8,0,704,4],[12,0,704,8],[13,0,704,9],[17,0,704,13],[18,0,704,14],[24,0,704,20],[25,0,704,21],[39,0,704,35],[41,0,704,37],[42,0,704,38]],[[12,0,705,6],[16,0,705,10],[17,0,705,11],[24,0,705,18],[25,0,705,19],[67,0,705,61],[68,0,705,62],[69,0,705,63]],[[12,0,706,6],[19,0,706,13]],[[8,0,707,4],[9,0,707,5]],[[8,0,709,4],[14,0,709,10],[25,0,709,21],[28,0,709,24],[32,0,709,28],[33,0,709,29],[47,0,709,43],[49,0,709,45],[50,0,709,46]],[[8,0,710,4],[14,0,710,10],[26,0,710,22],[29,0,710,25],[33,0,710,29],[34,0,710,30],[49,0,710,45],[51,0,710,47],[52,0,710,48]],[[8,0,712,4],[14,0,712,10],[28,0,712,24],[31,0,712,43],[33,0,712,45],[34,0,712,46]],[[8,0,714,4],[12,0,714,8],[23,0,714,19],[25,0,714,21],[26,0,714,22]],[[12,0,715,6],[18,0,715,12],[31,0,715,25],[34,0,715,28]],[[16,0,716,8],[21,0,716,13],[23,0,716,15],[34,0,716,26]],[[16,0,717,8],[31,0,717,23],[33,0,717,25],[47,0,717,39]],[[16,0,718,8],[25,0,718,17],[27,0,718,19],[31,0,718,23],[32,0,718,24],[38,0,718,30],[39,0,718,31],[47,0,718,39]],[[13,0,719,7],[14,0,719,8]],[[12,0,721,6],[18,0,721,12],[26,0,721,20],[29,0,721,23],[33,0,721,27],[48,0,721,42],[50,0,721,44],[51,0,721,45]],[[12,0,722,6],[18,0,722,12],[19,0,722,13],[26,0,722,20],[27,0,722,21],[40,0,722,34],[41,0,722,35],[42,0,722,36],[49,0,722,43],[50,0,722,44],[51,0,722,45],[52,0,722,46],[55,0,722,49],[57,0,722,51],[62,0,722,56],[63,0,722,57],[65,0,722,59],[67,0,722,61]],[[16,0,723,8],[20,0,723,12],[25,0,723,17],[30,0,723,22],[39,0,723,31],[41,0,723,33],[42,0,723,34]],[[20,0,724,10],[28,0,724,18],[29,0,724,19],[35,0,724,25],[36,0,724,26],[39,0,724,29],[41,0,724,31],[46,0,724,36],[47,0,724,37],[55,0,724,45],[57,0,724,47],[58,0,724,48],[59,0,724,49]],[[16,0,725,8],[17,0,725,9]],[[12,0,726,6],[13,0,726,7],[14,0,726,8],[15,0,726,9]],[[12,0,728,6],[26,0,728,20],[27,0,728,21],[31,0,728,25],[32,0,729,8],[36,0,729,12],[37,0,729,13],[41,0,729,17],[42,0,729,18],[46,0,729,22],[47,0,729,23],[51,0,729,27],[52,0,729,28],[58,0,729,34],[59,0,729,35],[73,0,729,49],[75,0,729,51],[83,0,729,59],[84,0,729,60],[92,0,729,68],[94,0,729,70],[96,0,729,72]],[[16,0,730,10],[23,0,730,17],[25,0,730,19]],[[20,0,731,12],[34,0,731,26],[36,0,731,28],[71,0,731,63]],[[17,0,732,11]],[[13,0,733,9],[14,0,733,10],[15,0,733,11],[24,0,733,20],[26,0,733,22],[27,0,734,7],[28,0,734,8]],[[8,0,735,4],[9,0,735,5]],[[8,0,737,4],[12,0,737,8],[24,0,737,20],[26,0,737,22],[27,0,737,23]],[[12,0,738,6],[18,0,738,12],[31,0,738,25],[34,0,738,28]],[[16,0,739,8],[21,0,739,13],[23,0,739,15],[35,0,739,27]],[[16,0,740,8],[31,0,740,23],[33,0,740,25],[48,0,740,40]],[[16,0,741,8],[25,0,741,17],[27,0,741,19],[31,0,741,23],[32,0,741,24],[38,0,741,30],[39,0,741,31],[47,0,741,39]],[[13,0,742,7],[14,0,742,8]],[[12,0,744,6],[18,0,744,12],[26,0,744,20],[29,0,744,23],[33,0,744,27],[48,0,744,42],[50,0,744,44],[51,0,744,45]],[[12,0,745,6],[18,0,745,12],[19,0,745,13],[26,0,745,20],[27,0,745,21],[40,0,745,34],[41,0,745,35],[42,0,745,36],[49,0,745,43],[50,0,745,44],[51,0,745,45],[52,0,745,46],[55,0,745,49],[57,0,745,51],[62,0,745,56],[63,0,745,57],[65,0,745,59],[67,0,745,61]],[[16,0,746,8],[20,0,746,12],[25,0,746,17],[30,0,746,22],[39,0,746,31],[41,0,746,33],[42,0,746,34]],[[20,0,747,10],[28,0,747,18],[29,0,747,19],[35,0,747,25],[36,0,747,26],[39,0,747,29],[41,0,747,31],[46,0,747,36],[47,0,747,37],[55,0,747,45],[57,0,747,47],[58,0,747,48],[59,0,747,49]],[[16,0,748,8],[17,0,748,9]],[[12,0,749,6],[13,0,749,7],[14,0,749,8],[15,0,749,9]],[[12,0,751,6],[26,0,751,20],[27,0,751,21],[31,0,751,25],[32,0,752,8],[36,0,752,12],[37,0,752,13],[41,0,752,17],[42,0,752,18],[46,0,752,22],[47,0,752,23],[51,0,752,27],[52,0,752,28],[58,0,752,34],[59,0,752,35],[73,0,752,49],[75,0,752,51],[83,0,752,59],[84,0,752,60],[92,0,752,68],[94,0,752,70],[96,0,752,72]],[[16,0,753,10],[23,0,753,17],[25,0,753,19]],[[20,0,754,12],[34,0,754,26],[36,0,754,28],[71,0,754,63]],[[17,0,755,11]],[[13,0,756,9],[14,0,756,10],[15,0,756,11],[24,0,756,20],[26,0,756,22],[27,0,757,7],[28,0,757,8]],[[8,0,758,4],[9,0,758,5]],[[8,0,760,4],[12,0,760,8],[26,0,760,22],[27,0,760,23],[33,0,760,29],[36,0,760,32],[37,0,760,33],[39,0,760,35],[40,0,760,36]],[[12,0,761,6],[16,0,761,10],[17,0,761,11]],[[16,0,762,8],[22,0,762,14],[29,0,762,21],[30,0,762,22],[33,0,762,25],[34,0,762,26],[48,0,762,40],[49,0,762,41],[50,0,762,42]],[[16,0,763,8],[20,0,763,12],[21,0,763,13],[28,0,763,20],[29,0,763,21],[58,0,763,50],[59,0,763,51],[60,0,763,52]],[[12,0,764,6],[13,0,764,7]],[[12,0,764,8],[19,0,764,15],[24,0,764,20],[26,0,764,22],[27,0,764,23]],[[16,0,765,8],[20,0,765,12],[21,0,765,13],[29,0,765,21],[30,0,765,22],[56,0,765,48],[58,0,765,50],[63,0,765,55],[64,0,765,56],[65,0,765,57]],[[16,0,766,8],[58,0,766,50]],[[12,0,767,6],[13,0,767,7]],[[8,0,768,4],[9,0,768,5]],[[4,0,769,2],[5,0,769,3]],[[4,0,771,2]],[],[[7,0,773,5]],[[4,0,774,10],[18,0,774,24],[19,0,774,25],[28,0,774,45]],[[8,0,775,4],[12,0,775,8],[13,0,775,9]],[[12,0,776,6],[16,0,776,10],[17,0,776,11],[31,0,776,25],[32,0,776,26],[39,0,776,33],[40,0,776,34],[59,0,776,53],[60,0,776,54],[72,0,776,66],[74,0,776,68],[83,0,776,77],[84,0,776,78],[95,0,776,89],[96,0,776,90],[97,0,776,91]],[[12,0,777,6],[16,0,777,10],[17,0,777,11],[31,0,777,25],[32,0,777,26],[39,0,777,33],[40,0,777,34],[59,0,777,53],[60,0,777,54],[76,0,777,70],[78,0,777,72],[87,0,777,81],[88,0,777,82],[97,0,777,91],[98,0,777,92],[106,0,777,100],[108,0,777,102],[109,0,777,103],[110,0,777,104]],[[12,0,778,6],[16,0,778,10],[17,0,778,11],[31,0,778,25],[32,0,778,26],[39,0,778,33],[40,0,778,34],[59,0,778,53],[60,0,778,54],[70,0,778,64],[72,0,778,66],[81,0,778,75],[82,0,778,76],[91,0,778,85],[92,0,778,86],[93,0,778,87]],[[12,0,780,6],[16,0,780,10],[25,0,780,19],[26,0,780,20],[38,0,780,32],[40,0,780,34],[41,0,780,35]],[[16,0,781,8],[20,0,781,12],[21,0,781,13],[35,0,781,27],[36,0,781,28],[43,0,781,35],[44,0,781,36],[63,0,781,55],[64,0,781,56],[77,0,781,69],[79,0,781,71],[88,0,781,80],[89,0,781,81],[101,0,781,93],[102,0,781,94],[103,0,781,95]],[[12,0,782,6],[13,0,782,7]],[[12,0,784,6],[16,0,784,10],[25,0,784,19],[26,0,784,20],[31,0,784,25],[33,0,784,27],[34,0,784,28]],[[16,0,785,8],[20,0,785,12],[21,0,785,13],[35,0,785,27],[36,0,785,28],[43,0,785,35],[44,0,785,36],[63,0,785,55],[64,0,785,56],[69,0,785,61],[71,0,785,63],[80,0,785,72],[81,0,785,73],[86,0,785,78],[87,0,785,79],[88,0,785,80]],[[12,0,786,6],[13,0,786,7]],[[12,0,788,6],[16,0,788,10],[25,0,788,19],[26,0,788,20],[33,0,788,27],[35,0,788,29],[36,0,788,30]],[[16,0,789,8],[20,0,789,12],[21,0,789,13],[35,0,789,27],[36,0,789,28],[43,0,789,35],[44,0,789,36],[63,0,789,55],[64,0,789,56],[72,0,789,64],[74,0,789,66],[83,0,789,75],[84,0,789,76],[91,0,789,83],[92,0,789,84],[93,0,789,85]],[[12,0,790,6],[13,0,790,7]],[[12,0,792,6],[16,0,792,10],[17,0,792,11],[25,0,792,19],[26,0,792,20],[61,0,792,55],[62,0,792,56],[63,0,792,57]],[[8,0,793,4],[9,0,793,5]],[[8,0,793,6],[15,0,793,13],[20,0,793,18],[22,0,793,20],[23,0,793,21]],[[12,0,794,6],[16,0,794,10],[17,0,794,11],[25,0,794,19],[26,0,794,20],[60,0,794,54],[62,0,794,56],[67,0,794,61],[68,0,794,62],[69,0,794,63]],[[12,0,795,6],[18,0,795,12],[22,0,795,16],[27,0,795,21],[28,0,795,22],[63,0,795,57],[64,0,795,58],[65,0,795,59]],[[8,0,796,4],[9,0,796,5]],[[4,0,797,2],[5,0,797,3]],[[4,0,799,2]],[],[[7,0,801,5]],[[4,0,802,10],[22,0,802,28]],[[8,0,803,4],[12,0,803,8],[13,0,803,9],[17,0,803,13],[18,0,803,14],[32,0,803,28],[33,0,803,29],[44,0,803,40],[46,0,803,42],[48,0,803,44],[49,0,803,45]],[[12,0,804,6],[19,0,804,13],[23,0,804,17],[24,0,804,18]],[[8,0,805,4],[9,0,805,5]],[[8,0,807,4],[12,0,807,8],[13,0,807,9]],[[12,0,808,6],[18,0,808,12],[29,0,808,23],[32,0,808,26],[36,0,808,30],[37,0,808,31],[51,0,808,45],[52,0,808,46],[59,0,808,53],[60,0,808,54],[79,0,808,73],[80,0,808,74],[92,0,808,86],[93,0,808,87],[94,0,808,88]],[[12,0,809,6],[18,0,809,12],[30,0,809,24],[33,0,809,27],[37,0,809,31],[38,0,809,32],[52,0,809,46],[53,0,809,47],[60,0,809,54],[61,0,809,55],[80,0,809,74],[81,0,809,75],[97,0,809,91],[98,0,809,92],[99,0,809,93]],[[12,0,811,6],[16,0,811,10],[17,0,811,11],[28,0,811,22],[32,0,811,26],[33,0,811,27],[45,0,811,39],[47,0,811,41],[48,0,811,42]],[[16,0,812,8],[23,0,812,15],[27,0,812,19],[28,0,812,20]],[[12,0,813,6],[13,0,813,7]],[[12,0,815,6],[19,0,815,13]],[[16,0,816,8],[27,0,816,19]],[[16,0,817,8],[28,0,817,20],[30,0,817,22],[34,0,817,26],[35,0,817,27],[49,0,817,41],[50,0,817,42],[57,0,817,49],[58,0,817,50],[77,0,817,69],[78,0,817,70],[91,0,817,83],[92,0,817,84],[96,0,817,88],[105,0,817,97]],[[16,0,818,8],[25,0,818,17],[27,0,818,19],[31,0,818,23],[32,0,818,24],[46,0,818,38],[47,0,818,39],[54,0,818,46],[55,0,818,47],[74,0,818,66],[75,0,818,67],[85,0,818,77],[86,0,818,78],[90,0,818,82],[98,0,818,90]],[[16,0,819,8],[25,0,819,17],[27,0,819,19],[35,0,819,27],[36,0,819,28],[48,0,819,40],[50,0,819,42],[52,0,819,44],[53,0,819,45]],[[16,0,820,8],[21,0,820,13],[23,0,820,15],[27,0,820,19],[28,0,820,20],[42,0,820,34],[43,0,820,35],[50,0,820,42],[51,0,820,43],[70,0,820,62],[71,0,820,63],[76,0,820,68],[77,0,820,69],[81,0,820,73],[90,0,820,82]],[[16,0,821,8],[23,0,821,15],[25,0,821,17],[29,0,821,21],[30,0,821,22],[44,0,821,36],[45,0,821,37],[52,0,821,44],[53,0,821,45],[72,0,821,64],[73,0,821,65],[81,0,821,73],[82,0,821,74],[86,0,821,78],[95,0,821,87]],[[13,0,822,7],[14,0,822,8]],[[8,0,823,4],[9,0,823,5]],[[8,0,823,6],[15,0,823,13],[20,0,823,18],[22,0,823,20],[23,0,823,21]],[[12,0,824,6],[16,0,824,10],[17,0,824,11],[25,0,824,19],[26,0,824,20],[70,0,824,64],[72,0,824,66],[77,0,824,71],[78,0,824,72],[79,0,824,73]],[[12,0,825,6],[19,0,825,13],[23,0,825,17],[24,0,825,18]],[[8,0,826,4],[9,0,826,5]],[[4,0,827,2],[5,0,827,3]],[[4,0,829,2]],[],[[7,0,831,5]],[[4,0,832,10],[19,0,832,25],[20,0,832,26],[28,0,832,54]],[[8,0,833,4],[14,0,833,10],[26,0,833,22],[29,0,833,25],[33,0,833,29],[34,0,833,30],[44,0,833,40],[46,0,833,42],[47,0,833,43]],[[8,0,834,4],[14,0,834,10],[26,0,834,22],[29,0,834,25],[31,0,834,27],[34,0,834,30],[46,0,834,42],[48,0,834,44],[51,0,834,47],[59,0,834,55],[61,0,834,57],[62,0,834,58]],[[8,0,836,4],[12,0,836,8],[13,0,836,9],[23,0,836,19],[24,0,836,20],[27,0,836,23],[28,0,836,24],[40,0,836,36],[41,0,836,37],[42,0,836,38]],[[8,0,837,4],[12,0,837,8],[13,0,837,9],[30,0,837,26],[31,0,837,27],[35,0,837,31],[36,0,837,32],[48,0,837,44],[49,0,837,45],[50,0,837,46]],[[4,0,838,2],[5,0,838,3]],[[4,0,840,2]],[],[[7,0,842,5]],[[4,0,843,10],[12,0,843,18],[13,0,843,19],[20,0,843,34],[22,0,843,36],[25,0,843,39],[29,0,843,50]],[[8,0,844,4],[12,0,844,8],[16,0,844,12],[17,0,844,13],[25,0,844,21],[30,0,844,26],[37,0,844,33],[39,0,844,35],[40,0,844,36]],[[12,0,845,6],[19,0,845,13],[20,0,845,14],[23,0,845,17],[24,0,845,18],[43,0,845,37],[50,0,845,44],[52,0,845,46],[54,0,845,48],[57,0,845,51],[61,0,845,55],[62,0,845,56],[63,0,845,57]],[[8,0,846,4],[9,0,846,5]],[[4,0,847,2],[5,0,847,3]],[[4,0,849,2]],[],[[7,0,851,5]],[[4,0,852,10],[11,0,852,17],[12,0,852,18],[19,0,852,33],[21,0,852,35],[24,0,852,38],[28,0,852,49]],[[8,0,853,4],[12,0,853,8],[13,0,853,9],[20,0,853,16],[22,0,853,18],[28,0,853,24],[29,0,853,25],[30,0,853,26],[38,0,853,34],[39,0,853,35],[43,0,853,39],[44,0,853,40],[52,0,853,48],[53,0,853,49],[55,0,853,51],[56,0,853,52]],[[12,0,854,6],[19,0,854,13],[20,0,854,14],[24,0,854,18],[25,0,854,19],[44,0,854,38],[51,0,854,45],[53,0,854,47],[55,0,854,49],[58,0,854,52],[62,0,854,56],[63,0,854,57],[64,0,854,58]],[[8,0,855,4],[9,0,855,5]],[[4,0,856,2],[5,0,856,3]],[[4,0,858,2]],[],[[7,0,860,5]],[[4,0,861,10],[11,0,861,17],[12,0,861,18],[19,0,861,33],[21,0,861,35],[24,0,861,38],[28,0,861,49]],[[8,0,862,4],[12,0,862,8],[13,0,862,9],[20,0,862,16],[22,0,862,18],[28,0,862,24],[30,0,862,26],[36,0,862,32],[37,0,862,33],[38,0,862,34],[46,0,862,42],[47,0,862,43],[51,0,862,47],[52,0,862,48],[60,0,862,56],[61,0,862,57],[63,0,862,59],[64,0,862,60]],[[12,0,863,6],[19,0,863,13],[20,0,863,14],[24,0,863,18],[25,0,863,19],[44,0,863,38],[51,0,863,45],[53,0,863,47],[55,0,863,49],[58,0,863,52],[62,0,863,56],[63,0,863,57],[64,0,863,58]],[[8,0,864,4],[9,0,864,5]],[[4,0,865,2],[5,0,865,3]],[[4,0,867,2]],[],[[7,0,869,5]],[[4,0,870,10],[12,0,870,18],[13,0,870,19],[20,0,870,34],[22,0,870,36],[27,0,870,47]],[[8,0,871,4],[12,0,871,8],[16,0,871,12],[17,0,871,13],[25,0,871,21],[30,0,871,26],[36,0,871,32],[38,0,871,34],[39,0,871,35]],[[12,0,872,6],[19,0,872,13],[20,0,872,14],[25,0,872,19],[26,0,872,20],[45,0,872,39],[52,0,872,46],[54,0,872,48],[56,0,872,50],[61,0,872,55],[62,0,872,56],[63,0,872,57]],[[8,0,873,4],[9,0,873,5]],[[4,0,874,2],[5,0,874,3]],[[110,0,30,13],[123,0,30,26],[137,0,47,12],[156,0,47,31],[171,0,48,12],[182,0,48,23]],[[71,0,30,13],[84,0,30,26],[95,0,30,13],[108,0,30,26],[127,0,28,14],[133,0,28,20]],[],[[81,0,30,13],[94,0,30,26]],[[14,0,27,1],[24,0,27,11]],[[15,0,27,12]],[[16,0,28,2],[26,0,28,12],[28,0,28,14],[34,0,28,20]],[[13,0,29,1]],[],[[22,0,47,5],[28,0,47,11]],[[23,0,47,12],[42,0,47,31]],[],[[22,0,48,5],[28,0,48,11]],[[23,0,48,12],[34,0,48,23]]],"sourcesContent":["import { Injectable, Inject, PLATFORM_ID, signal } from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Router } from '@angular/router';\r\nimport { Observable, BehaviorSubject, throwError, of } from 'rxjs';\r\nimport { map, catchError, tap } from 'rxjs/operators';\r\n\r\nimport { OAuth2Config } from '../models/oauth2-config.model';\r\nimport {\r\n  PKCEChallenge,\r\n  AuthorizationRequest,\r\n  TokenRequest,\r\n  TokenResponse,\r\n  TokenInfo,\r\n  AuthState,\r\n  OAuth2Error,\r\n  OAUTH2_STORAGE_KEYS,\r\n  UserInfoResponse,\r\n  OAuth2LogLevel\r\n} from '../models/oauth2-types.model';\r\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\r\nimport { OAuth2StorageService } from './oauth2-storage.service';\r\n\r\n/**\r\n * OAuth2 Service with PKCE Support\r\n * Handles OAuth2 authorization flow, token management, and user authentication\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OAuth2Service {\r\n  private _authState = signal<AuthState>({\r\n    isAuthenticated: false,\r\n    isLoading: false\r\n  });\r\n\r\n  private _authStateSubject = new BehaviorSubject<AuthState>({\r\n    isAuthenticated: false,\r\n    isLoading: false\r\n  });\r\n\r\n  public authState$ = this._authStateSubject.asObservable();\r\n  public readonly authState = this._authState.asReadonly();\r\n\r\n  private logLevel: OAuth2LogLevel;\r\n\r\n  constructor(\r\n    @Inject(OAUTH2_CONFIG_TOKEN) private config: OAuth2Config,\r\n    @Inject(PLATFORM_ID) private platformId: Object,\r\n    private http: HttpClient,\r\n    private router: Router,\r\n    private storageService: OAuth2StorageService\r\n  ) {\r\n    this.logLevel = config.logLevel || 'warn';\r\n    this.initializeAuthState();\r\n  }\r\n\r\n  /**\r\n   * Initialize authentication state from stored tokens\r\n   */\r\n  private initializeAuthState(): void {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const tokenInfo = this.getStoredTokenInfo();\r\n      if (tokenInfo && this.isTokenValid(tokenInfo)) {\r\n        this.updateAuthState({\r\n          isAuthenticated: true,\r\n          isLoading: false,\r\n          tokenInfo\r\n        });\r\n        this.logInfo('Authentication state initialized from stored tokens');\r\n      } else if (tokenInfo && tokenInfo.refreshToken) {\r\n        // Access token is expired but refresh token exists\r\n        this.logInfo('Access token expired but refresh token available - preserving for refresh flow');\r\n        this.updateAuthState({\r\n          isAuthenticated: false,\r\n          isLoading: false,\r\n          tokenInfo: undefined\r\n        });\r\n      } else {\r\n        // No tokens or no refresh token available - clear everything\r\n        this.storageService.clearTokens();\r\n        this.logInfo('No valid stored tokens found');\r\n      }\r\n    } catch (error) {\r\n      this.logError('Error initializing auth state:', error);\r\n      this.storageService.clearTokens();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate cryptographically secure PKCE challenge\r\n   */\r\n  private async generatePKCEChallenge(): Promise<PKCEChallenge> {\r\n    const codeVerifier = this.generateSecureCodeVerifier();\r\n    const codeChallenge = await this.createCodeChallenge(codeVerifier);\r\n    \r\n    return {\r\n      codeVerifier,\r\n      codeChallenge,\r\n      codeChallengeMethod: this.config.codeChallengeMethod || 'S256'\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate cryptographically secure 6-digit code verifier\r\n   */\r\n  private generateSecureCodeVerifier(): string {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      throw new Error('Code verifier generation requires browser environment');\r\n    }\r\n\r\n    // Generate 6 cryptographically secure random digits\r\n    const array = new Uint8Array(6);\r\n    crypto.getRandomValues(array);\r\n    \r\n    // Convert to 6-digit string (000000-999999)\r\n    const codeVerifier = Array.from(array)\r\n      .map(byte => (byte % 10).toString())\r\n      .join('');\r\n    \r\n    this.logDebug('Generated secure 6-digit code verifier');\r\n    return codeVerifier;\r\n  }\r\n\r\n  /**\r\n   * Create SHA-256 hash and base64 encode for code challenge\r\n   */\r\n  private async createCodeChallenge(codeVerifier: string): Promise<string> {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      throw new Error('Code challenge creation requires browser environment');\r\n    }\r\n\r\n    try {\r\n      // Encode the code verifier as UTF-8\r\n      const encoder = new TextEncoder();\r\n      const data = encoder.encode(codeVerifier);\r\n      \r\n      // Create SHA-256 hash\r\n      const hashBuffer = await crypto.subtle.digest('SHA-256', data);\r\n      \r\n      // Convert to base64url encoding\r\n      const hashArray = new Uint8Array(hashBuffer);\r\n      const base64String = btoa(String.fromCharCode(...hashArray))\r\n        .replace(/\\+/g, '-')\r\n        .replace(/\\//g, '_')\r\n        .replace(/=/g, '');\r\n      \r\n      this.logDebug('Generated code challenge from verifier');\r\n      return base64String;\r\n    } catch (error) {\r\n      this.logError('Error creating code challenge:', error);\r\n      throw new Error('Failed to create code challenge');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Generate cryptographically secure state parameter for CSRF protection\r\n   */\r\n  private generateState(): string {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      return 'fallback-state';\r\n    }\r\n\r\n    const array = new Uint8Array(32);\r\n    crypto.getRandomValues(array);\r\n    return btoa(String.fromCharCode(...array))\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      .replace(/=/g, '');\r\n  }\r\n\r\n  /**\r\n   * Generate nonce if not provided in config\r\n   */\r\n  private generateNonce(): string {\r\n    if (this.config.nonce) {\r\n      return this.config.nonce;\r\n    }\r\n\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      return 'fallback-nonce';\r\n    }\r\n\r\n    const array = new Uint8Array(16);\r\n    crypto.getRandomValues(array);\r\n    return btoa(String.fromCharCode(...array))\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      .replace(/=/g, '');\r\n  }\r\n\r\n  /**\r\n   * Start OAuth2 PKCE authorization flow\r\n   */\r\n  async startAuthorization(): Promise<void> {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      this.logError('Authorization attempted in non-browser environment', 'SSR or server context detected');\r\n      this.updateAuthState({\r\n        isLoading: false,\r\n        error: 'Authentication not available in server environment'\r\n      });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      this.updateAuthState({ isLoading: true, error: undefined });\r\n      \r\n      // Generate PKCE challenge\r\n      const pkceChallenge = await this.generatePKCEChallenge();\r\n      \r\n      // Generate state for CSRF protection\r\n      const state = this.generateState();\r\n      \r\n      // Generate nonce\r\n      const nonce = this.generateNonce();\r\n      \r\n      // Store code verifier, state, and nonce securely\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER, pkceChallenge.codeVerifier);\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.STATE, state);\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.NONCE, nonce);\r\n      \r\n      // Build authorization request\r\n      const authRequest: AuthorizationRequest = {\r\n        client_id: this.config.clientId,\r\n        redirect_uri: this.config.redirectUri,\r\n        response_type: this.config.responseType || 'code',\r\n        nonce,\r\n        audience: this.config.audience,\r\n        scope: this.config.scope,\r\n        code_challenge_method: pkceChallenge.codeChallengeMethod,\r\n        code_challenge: pkceChallenge.codeChallenge,\r\n        state\r\n      };\r\n      \r\n      // Build authorization URL\r\n      const authUrl = this.buildAuthorizationUrl(authRequest);\r\n      \r\n      this.logInfo('Starting OAuth2 PKCE authorization flow');\r\n      this.logDebug('Authorization URL:', authUrl);\r\n      \r\n      // Redirect to authorization server\r\n      window.location.href = authUrl;\r\n      \r\n    } catch (error) {\r\n      this.logError('Error starting authorization:', error);\r\n      this.updateAuthState({ \r\n        isLoading: false, \r\n        error: 'Failed to start authorization flow' \r\n      });\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Build authorization URL with parameters\r\n   */\r\n  private buildAuthorizationUrl(request: AuthorizationRequest): string {\r\n    const params = new URLSearchParams();\r\n    \r\n    Object.entries(request).forEach(([key, value]) => {\r\n      if (value !== undefined) {\r\n        params.append(key, value.toString());\r\n      }\r\n    });\r\n    \r\n    return `${this.config.authorizationEndpoint}?${params.toString()}`;\r\n  }\r\n\r\n  /**\r\n   * Handle OAuth2 callback and extract tokens\r\n   */\r\n  async handleCallback(): Promise<void> {\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      throw new Error('Callback handling requires browser environment');\r\n    }\r\n\r\n    try {\r\n      this.updateAuthState({ isLoading: true, error: undefined });\r\n      \r\n      const currentUrl = window.location.href;\r\n      this.logInfo('Handling OAuth2 callback:', currentUrl);\r\n      \r\n      // Check for error in callback\r\n      const error = this.extractErrorFromCallback();\r\n      if (error) {\r\n        throw new Error(`OAuth2 Error: ${error.error} - ${error.error_description || 'Unknown error'}`);\r\n      }\r\n      \r\n      // Extract authorization code from query parameters or hash fragment\r\n      const authCode = this.extractAuthorizationCode();\r\n      this.logDebug('Extracted authorization code:', authCode ? 'Found' : 'Not found');\r\n      \r\n      if (authCode) {\r\n        await this.exchangeCodeForTokens(authCode);\r\n        return;\r\n      }\r\n      \r\n      // Extract tokens from URL fragment (implicit flow)\r\n      const tokens = this.extractTokensFromFragment();\r\n      this.logDebug('Extracted tokens from fragment:', tokens ? 'Found' : 'Not found');\r\n      \r\n      if (tokens) {\r\n        await this.handleTokenResponse(tokens);\r\n        return;\r\n      }\r\n      \r\n      throw new Error('No authorization code or tokens found in callback');\r\n      \r\n    } catch (error) {\r\n      this.logError('Error handling callback:', error);\r\n      this.updateAuthState({ \r\n        isLoading: false, \r\n        error: error instanceof Error ? error.message : 'Callback handling failed' \r\n      });\r\n      this.storageService.clearAll();\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extract error from callback URL\r\n   */\r\n  private extractErrorFromCallback(): OAuth2Error | null {\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const hashParams = new URLSearchParams(window.location.hash.substring(1));\r\n    \r\n    const error = urlParams.get('error') || hashParams.get('error');\r\n    if (error) {\r\n      return {\r\n        error,\r\n        error_description: urlParams.get('error_description') || hashParams.get('error_description') || undefined,\r\n        error_uri: urlParams.get('error_uri') || hashParams.get('error_uri') || undefined,\r\n        state: urlParams.get('state') || hashParams.get('state') || undefined\r\n      };\r\n    }\r\n    \r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Extract authorization code from query parameters\r\n   */\r\n  private extractAuthorizationCode(): string | null {\r\n    // First check query parameters\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    let code = urlParams.get('code');\r\n    \r\n    // If not found in query params, check hash fragment\r\n    if (!code && window.location.hash) {\r\n      const hashParams = new URLSearchParams(window.location.hash.substring(1));\r\n      code = hashParams.get('code');\r\n    }\r\n    \r\n    if (code) {\r\n      this.logDebug('Authorization code extracted from callback');\r\n      return code;\r\n    }\r\n    \r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Extract tokens from URL fragment\r\n   */\r\n  private extractTokensFromFragment(): TokenResponse | null {\r\n    const fragment = window.location.hash.substring(1);\r\n    if (!fragment) {\r\n      return null;\r\n    }\r\n    \r\n    const params = new URLSearchParams(fragment);\r\n    const accessToken = params.get('access_token');\r\n    \r\n    if (accessToken) {\r\n      this.logDebug('Tokens extracted from URL fragment');\r\n      return {\r\n        access_token: accessToken,\r\n        refresh_token: params.get('refresh_token') || undefined,\r\n        token_type: params.get('token_type') || 'Bearer',\r\n        expires_in: parseInt(params.get('expires_in') || '3600', 10),\r\n        scope: params.get('scope') || undefined,\r\n        id_token: params.get('id_token') || undefined\r\n      };\r\n    }\r\n    \r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Exchange authorization code for tokens\r\n   */\r\n  private async exchangeCodeForTokens(authCode: string): Promise<void> {\r\n    const codeVerifier = this.storageService.getItem(OAUTH2_STORAGE_KEYS.CODE_VERIFIER);\r\n    \r\n    if (!codeVerifier) {\r\n      this.logError('Code verifier not found in storage');\r\n      throw new Error('Code verifier not found in storage');\r\n    }\r\n    \r\n    const tokenRequest: TokenRequest = {\r\n      grant_type: 'authorization_code',\r\n      redirect_uri: this.config.redirectUri,\r\n      client_id: this.config.clientId,\r\n      code: authCode,\r\n      code_verifier: codeVerifier\r\n    };\r\n    \r\n    this.logInfo('Exchanging authorization code for tokens');\r\n    \r\n    // Convert to URL-encoded form data as per OAuth 2.0 standard\r\n    const formData = new URLSearchParams();\r\n    Object.entries(tokenRequest).forEach(([key, value]) => {\r\n      if (value !== undefined) {\r\n        formData.append(key, value.toString());\r\n      }\r\n    });\r\n    \r\n    try {\r\n      const tokenResponse = await this.http.post<TokenResponse>(\r\n        this.config.tokenEndpoint,\r\n        formData.toString(),\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }\r\n      ).toPromise();\r\n      \r\n      if (tokenResponse) {\r\n        await this.handleTokenResponse(tokenResponse);\r\n      } else {\r\n        throw new Error('No token response received');\r\n      }\r\n      \r\n    } catch (error) {\r\n      this.logError('Token exchange failed:', error);\r\n      throw new Error('Failed to exchange authorization code for tokens');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle token response and store tokens securely\r\n   */\r\n  private async handleTokenResponse(tokenResponse: TokenResponse): Promise<void> {\r\n    try {\r\n      // Validate state parameter for CSRF protection\r\n      await this.validateState();\r\n      \r\n      // Create token info\r\n      const tokenInfo: TokenInfo = {\r\n        accessToken: tokenResponse.access_token,\r\n        refreshToken: tokenResponse.refresh_token,\r\n        tokenType: tokenResponse.token_type || 'Bearer',\r\n        expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\r\n        scope: tokenResponse.scope,\r\n        idToken: tokenResponse.id_token\r\n      };\r\n      \r\n      // Store tokens securely\r\n      this.storeTokenInfo(tokenInfo);\r\n      \r\n      // Update authentication state\r\n      this.updateAuthState({\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        tokenInfo,\r\n        error: undefined\r\n      });\r\n      \r\n      // Clean up temporary storage\r\n      this.storageService.clearTemporary();\r\n      \r\n      this.logInfo('Tokens stored successfully, user authenticated');\r\n      \r\n    } catch (error) {\r\n      this.logError('Error handling token response:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Validate state parameter for CSRF protection\r\n   */\r\n  private async validateState(): Promise<void> {\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const hashParams = new URLSearchParams(window.location.hash.substring(1));\r\n    \r\n    const receivedState = urlParams.get('state') || hashParams.get('state');\r\n    const storedState = this.storageService.getItem(OAUTH2_STORAGE_KEYS.STATE);\r\n    \r\n    if (!receivedState || !storedState || receivedState !== storedState) {\r\n      throw new Error('Invalid state parameter - possible CSRF attack');\r\n    }\r\n    \r\n    this.logDebug('State parameter validated successfully');\r\n  }\r\n\r\n  /**\r\n   * Get current access token (only if valid/not expired)\r\n   */\r\n  getAccessToken(): string | null {\r\n    const tokenInfo = this.getStoredTokenInfo();\r\n    if (tokenInfo && this.isTokenValid(tokenInfo)) {\r\n      return tokenInfo.accessToken;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Get raw access token (even if expired) - used for refresh flow\r\n   */\r\n  getRawAccessToken(): string | null {\r\n    const tokenInfo = this.getStoredTokenInfo();\r\n    return tokenInfo?.accessToken || null;\r\n  }\r\n\r\n  /**\r\n   * Get current refresh token\r\n   */\r\n  getRefreshToken(): string | null {\r\n    const tokenInfo = this.getStoredTokenInfo();\r\n    return tokenInfo?.refreshToken || null;\r\n  }\r\n\r\n  /**\r\n   * Check if user is authenticated\r\n   */\r\n  isAuthenticated(): boolean {\r\n    const tokenInfo = this.getStoredTokenInfo();\r\n    return tokenInfo ? this.isTokenValid(tokenInfo) : false;\r\n  }\r\n\r\n  /**\r\n   * Check if authentication is available in current environment\r\n   */\r\n  isAuthenticationAvailable(): boolean {\r\n    return isPlatformBrowser(this.platformId);\r\n  }\r\n\r\n  /**\r\n   * Fetch user information from OIDC userinfo endpoint\r\n   */\r\n  async getUserInfo(): Promise<UserInfoResponse> {\r\n    if (!this.config.userInfoEndpoint) {\r\n      throw new Error('UserInfo endpoint not configured');\r\n    }\r\n\r\n    const accessToken = this.getAccessToken();\r\n    if (!accessToken) {\r\n      throw new Error('No access token available');\r\n    }\r\n\r\n    this.logInfo('Fetching user info from OIDC userinfo endpoint');\r\n\r\n    try {\r\n      const userInfo = await this.http.get<UserInfoResponse>(\r\n        this.config.userInfoEndpoint,\r\n        {\r\n          headers: {\r\n            'Authorization': `Bearer ${accessToken}`\r\n          }\r\n        }\r\n      ).toPromise();\r\n\r\n      if (userInfo) {\r\n        this.logDebug('User info retrieved successfully:', userInfo);\r\n        return userInfo;\r\n      } else {\r\n        throw new Error('No user info response received');\r\n      }\r\n    } catch (error) {\r\n      this.logError('Failed to fetch user info:', error);\r\n      throw new Error('Failed to fetch user information');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if token is valid (not expired)\r\n   */\r\n  private isTokenValid(tokenInfo: TokenInfo): boolean {\r\n    const threshold = (this.config.refreshThreshold || 300) * 1000; // Convert to milliseconds\r\n    return Date.now() < (tokenInfo.expiresAt - threshold);\r\n  }\r\n\r\n  /**\r\n   * Refresh access token using refresh token\r\n   */\r\n  async refreshAccessToken(): Promise<string> {\r\n    const refreshToken = this.getRefreshToken();\r\n    if (!refreshToken) {\r\n      throw new Error('No refresh token available');\r\n    }\r\n    \r\n    this.logInfo('Refreshing access token');\r\n    \r\n    const tokenRequest = {\r\n      grant_type: 'refresh_token',\r\n      refresh_token: refreshToken,\r\n      client_id: this.config.clientId\r\n    };\r\n    \r\n    // Convert to URL-encoded form data as per OAuth 2.0 standard\r\n    const formData = new URLSearchParams();\r\n    Object.entries(tokenRequest).forEach(([key, value]) => {\r\n      if (value !== undefined) {\r\n        formData.append(key, value.toString());\r\n      }\r\n    });\r\n    \r\n    try {\r\n      const tokenResponse = await this.http.post<TokenResponse>(\r\n        this.config.tokenEndpoint,\r\n        formData.toString(),\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }\r\n      ).toPromise();\r\n      \r\n      if (tokenResponse) {\r\n        const tokenInfo: TokenInfo = {\r\n          accessToken: tokenResponse.access_token,\r\n          refreshToken: tokenResponse.refresh_token || refreshToken,\r\n          tokenType: tokenResponse.token_type || 'Bearer',\r\n          expiresAt: Date.now() + (tokenResponse.expires_in * 1000),\r\n          scope: tokenResponse.scope,\r\n          idToken: tokenResponse.id_token\r\n        };\r\n        \r\n        this.storeTokenInfo(tokenInfo);\r\n        this.updateAuthState({\r\n          isAuthenticated: true,\r\n          isLoading: false,\r\n          tokenInfo\r\n        });\r\n        \r\n        this.logInfo('Access token refreshed successfully');\r\n        return tokenResponse.access_token;\r\n      } else {\r\n        throw new Error('No token response received');\r\n      }\r\n      \r\n    } catch (error) {\r\n      this.logError('Token refresh failed:', error);\r\n      \r\n      // Only logout if it's a 400/401 error indicating invalid refresh token\r\n      if (error instanceof Error && 'status' in error) {\r\n        const httpError = error as any;\r\n        if (httpError.status === 400 || httpError.status === 401) {\r\n          this.logInfo('Refresh token is invalid, logging out');\r\n          this.logout();\r\n        }\r\n      } else {\r\n        this.logInfo('Network or server error during token refresh, will retry later');\r\n      }\r\n      \r\n      throw new Error('Failed to refresh access token');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Logout user and clean up all stored data\r\n   */\r\n  async logout(): Promise<void> {\r\n    try {\r\n      this.updateAuthState({ isLoading: true });\r\n      \r\n      // Revoke tokens if supported\r\n      await this.revokeTokens();\r\n      \r\n      // Clear all stored authentication data\r\n      this.storageService.clearAll();\r\n      \r\n      // Update authentication state\r\n      this.updateAuthState({\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        tokenInfo: undefined,\r\n        error: undefined\r\n      });\r\n      \r\n      this.logInfo('User logged out successfully');\r\n      \r\n    } catch (error) {\r\n      this.logError('Error during logout:', error);\r\n      // Still clear local data even if revocation fails\r\n      this.storageService.clearAll();\r\n      this.updateAuthState({\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        tokenInfo: undefined\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Revoke tokens at authorization server\r\n   */\r\n  private async revokeTokens(): Promise<void> {\r\n    if (!this.config.revokeEndpoint) {\r\n      this.logInfo('Token revocation endpoint not configured');\r\n      return;\r\n    }\r\n    \r\n    const accessToken = this.getAccessToken();\r\n    const refreshToken = this.getRefreshToken();\r\n    \r\n    const revokePromises: Promise<any>[] = [];\r\n    \r\n    if (accessToken) {\r\n      const revokeRequest = {\r\n        token: accessToken,\r\n        token_type_hint: 'access_token',\r\n        client_id: this.config.clientId\r\n      };\r\n      \r\n      const formData = new URLSearchParams();\r\n      Object.entries(revokeRequest).forEach(([key, value]) => {\r\n        if (value !== undefined) {\r\n          formData.append(key, value.toString());\r\n        }\r\n      });\r\n      \r\n      revokePromises.push(\r\n        this.http.post(this.config.revokeEndpoint, formData.toString(), {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }).toPromise()\r\n      );\r\n    }\r\n    \r\n    if (refreshToken) {\r\n      const revokeRequest = {\r\n        token: refreshToken,\r\n        token_type_hint: 'refresh_token',\r\n        client_id: this.config.clientId\r\n      };\r\n      \r\n      const formData = new URLSearchParams();\r\n      Object.entries(revokeRequest).forEach(([key, value]) => {\r\n        if (value !== undefined) {\r\n          formData.append(key, value.toString());\r\n        }\r\n      });\r\n      \r\n      revokePromises.push(\r\n        this.http.post(this.config.revokeEndpoint, formData.toString(), {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded'\r\n          }\r\n        }).toPromise()\r\n      );\r\n    }\r\n    \r\n    if (revokePromises.length > 0) {\r\n      try {\r\n        await Promise.all(revokePromises);\r\n        this.logInfo('Tokens revoked successfully');\r\n      } catch (error) {\r\n        this.logError('Token revocation failed:', error);\r\n        // Don't throw error, continue with logout\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Store token information securely\r\n   */\r\n  private storeTokenInfo(tokenInfo: TokenInfo): void {\r\n    try {\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenInfo.accessToken);\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, tokenInfo.expiresAt.toString());\r\n      this.storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE, tokenInfo.tokenType);\r\n      \r\n      if (tokenInfo.refreshToken) {\r\n        this.storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenInfo.refreshToken);\r\n      }\r\n      \r\n      if (tokenInfo.scope) {\r\n        this.storageService.setItem(OAUTH2_STORAGE_KEYS.SCOPE, tokenInfo.scope);\r\n      }\r\n      \r\n      if (tokenInfo.idToken) {\r\n        this.storageService.setItem(OAUTH2_STORAGE_KEYS.ID_TOKEN, tokenInfo.idToken);\r\n      }\r\n      \r\n      this.logDebug('Token information stored securely');\r\n    } catch (error) {\r\n      this.logError('Error storing token information:', error);\r\n      throw new Error('Failed to store token information');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Retrieve stored token information\r\n   */\r\n  private getStoredTokenInfo(): TokenInfo | null {\r\n    if (!this.storageService.isAvailable()) {\r\n      return null;\r\n    }\r\n    \r\n    try {\r\n      const accessToken = this.storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\r\n      const expiresAtStr = this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\r\n      \r\n      if (!accessToken || !expiresAtStr) {\r\n        return null;\r\n      }\r\n      \r\n      return {\r\n        accessToken,\r\n        refreshToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN) || undefined,\r\n        tokenType: this.storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_TYPE) || 'Bearer',\r\n        expiresAt: parseInt(expiresAtStr, 10),\r\n        scope: this.storageService.getItem(OAUTH2_STORAGE_KEYS.SCOPE) || undefined,\r\n        idToken: this.storageService.getItem(OAUTH2_STORAGE_KEYS.ID_TOKEN) || undefined\r\n      };\r\n    } catch (error) {\r\n      this.logError('Error retrieving stored token information:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update authentication state\r\n   */\r\n  private updateAuthState(newState: Partial<AuthState>): void {\r\n    const currentState = this._authState();\r\n    const updatedState = { ...currentState, ...newState };\r\n    \r\n    this._authState.set(updatedState);\r\n    this._authStateSubject.next(updatedState);\r\n  }\r\n\r\n  /**\r\n   * Debug logging\r\n   */\r\n  private logDebug(message: string, ...args: any[]): void {\r\n    if (this.logLevel === 'debug') {\r\n      console.log(`[OAuth2Service] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Info logging\r\n   */\r\n  private logInfo(message: string, ...args: any[]): void {\r\n    if (['debug', 'info'].includes(this.logLevel)) {\r\n      console.info(`[OAuth2Service] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Warning logging\r\n   */\r\n  private logWarn(message: string, ...args: any[]): void {\r\n    if (['debug', 'info', 'warn'].includes(this.logLevel)) {\r\n      console.warn(`[OAuth2Service] ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Error logging\r\n   */\r\n  private logError(message: string, error?: any): void {\r\n    if (this.logLevel !== 'none') {\r\n      console.error(`[OAuth2Service] ${message}`, error);\r\n    }\r\n  }\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common":{"attributes":{},"external":true,"id":"@angular/common","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"rxjs":{"attributes":{},"external":true,"id":"rxjs","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common/http":{"attributes":{},"external":true,"id":"@angular/common/http","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/router":{"attributes":{},"external":true,"id":"@angular/router","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"../models/oauth2-types.model":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"../tokens/oauth2-config.token":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./oauth2-storage.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":28004,"body":[{"type":"ImportDeclaration","start":0,"end":52,"specifiers":[{"type":"ImportSpecifier","start":9,"end":15,"imported":{"type":"Identifier","start":9,"end":15,"name":"inject"},"local":{"type":"Identifier","start":9,"end":15,"name":"inject"}},{"type":"ImportSpecifier","start":17,"end":28,"imported":{"type":"Identifier","start":17,"end":28,"name":"PLATFORM_ID"},"local":{"type":"Identifier","start":17,"end":28,"name":"PLATFORM_ID"}}],"source":{"type":"Literal","start":36,"end":51,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":53,"end":131,"specifiers":[{"type":"ImportSpecifier","start":62,"end":73,"imported":{"type":"Identifier","start":62,"end":73,"name":"HttpRequest"},"local":{"type":"Identifier","start":62,"end":73,"name":"HttpRequest"}},{"type":"ImportSpecifier","start":75,"end":87,"imported":{"type":"Identifier","start":75,"end":87,"name":"HttpResponse"},"local":{"type":"Identifier","start":75,"end":87,"name":"HttpResponse"}},{"type":"ImportSpecifier","start":89,"end":100,"imported":{"type":"Identifier","start":89,"end":100,"name":"HttpHeaders"},"local":{"type":"Identifier","start":89,"end":100,"name":"HttpHeaders"}}],"source":{"type":"Literal","start":108,"end":130,"value":"@angular/common/http","raw":"'@angular/common/http'"},"attributes":[]},{"type":"ImportDeclaration","start":132,"end":183,"specifiers":[{"type":"ImportSpecifier","start":141,"end":151,"imported":{"type":"Identifier","start":141,"end":151,"name":"throwError"},"local":{"type":"Identifier","start":141,"end":151,"name":"throwError"}},{"type":"ImportSpecifier","start":153,"end":168,"imported":{"type":"Identifier","start":153,"end":168,"name":"BehaviorSubject"},"local":{"type":"Identifier","start":153,"end":168,"name":"BehaviorSubject"}}],"source":{"type":"Literal","start":176,"end":182,"value":"rxjs","raw":"'rxjs'"},"attributes":[]},{"type":"ImportDeclaration","start":184,"end":253,"specifiers":[{"type":"ImportSpecifier","start":193,"end":203,"imported":{"type":"Identifier","start":193,"end":203,"name":"catchError"},"local":{"type":"Identifier","start":193,"end":203,"name":"catchError"}},{"type":"ImportSpecifier","start":205,"end":214,"imported":{"type":"Identifier","start":205,"end":214,"name":"switchMap"},"local":{"type":"Identifier","start":205,"end":214,"name":"switchMap"}},{"type":"ImportSpecifier","start":216,"end":222,"imported":{"type":"Identifier","start":216,"end":222,"name":"filter"},"local":{"type":"Identifier","start":216,"end":222,"name":"filter"}},{"type":"ImportSpecifier","start":224,"end":228,"imported":{"type":"Identifier","start":224,"end":228,"name":"take"},"local":{"type":"Identifier","start":224,"end":228,"name":"take"}}],"source":{"type":"Literal","start":236,"end":252,"value":"rxjs/operators","raw":"'rxjs/operators'"},"attributes":[]},{"type":"ImportDeclaration","start":254,"end":321,"specifiers":[{"type":"ImportSpecifier","start":263,"end":282,"imported":{"type":"Identifier","start":263,"end":282,"name":"OAUTH2_STORAGE_KEYS"},"local":{"type":"Identifier","start":263,"end":282,"name":"OAUTH2_STORAGE_KEYS"}}],"source":{"type":"Literal","start":290,"end":320,"value":"../models/oauth2-types.model","raw":"'../models/oauth2-types.model'"},"attributes":[]},{"type":"ImportDeclaration","start":322,"end":390,"specifiers":[{"type":"ImportSpecifier","start":331,"end":350,"imported":{"type":"Identifier","start":331,"end":350,"name":"OAUTH2_CONFIG_TOKEN"},"local":{"type":"Identifier","start":331,"end":350,"name":"OAUTH2_CONFIG_TOKEN"}}],"source":{"type":"Literal","start":358,"end":389,"value":"../tokens/oauth2-config.token","raw":"'../tokens/oauth2-config.token'"},"attributes":[]},{"type":"ImportDeclaration","start":391,"end":465,"specifiers":[{"type":"ImportSpecifier","start":400,"end":420,"imported":{"type":"Identifier","start":400,"end":420,"name":"OAuth2StorageService"},"local":{"type":"Identifier","start":400,"end":420,"name":"OAuth2StorageService"}}],"source":{"type":"Literal","start":428,"end":464,"value":"../services/oauth2-storage.service","raw":"'../services/oauth2-storage.service'"},"attributes":[]},{"type":"VariableDeclaration","start":500,"end":525,"kind":"let","declarations":[{"type":"VariableDeclarator","start":504,"end":524,"id":{"type":"Identifier","start":504,"end":516,"name":"isRefreshing"},"init":{"type":"Literal","start":519,"end":524,"value":false,"raw":"false"}}]},{"type":"VariableDeclaration","start":526,"end":578,"kind":"let","declarations":[{"type":"VariableDeclarator","start":530,"end":577,"id":{"type":"Identifier","start":530,"end":549,"name":"refreshTokenSubject"},"init":{"type":"NewExpression","start":552,"end":577,"callee":{"type":"Identifier","start":556,"end":571,"name":"BehaviorSubject"},"arguments":[{"type":"Literal","start":572,"end":576,"raw":"null","value":null}]}}]},{"type":"ExportNamedDeclaration","start":697,"end":2665,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"VariableDeclaration","start":704,"end":2665,"kind":"const","declarations":[{"type":"VariableDeclarator","start":710,"end":2664,"id":{"type":"Identifier","start":710,"end":729,"name":"oauth2InterceptorFn"},"init":{"type":"ArrowFunctionExpression","start":732,"end":2664,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":733,"end":740,"name":"request"},{"type":"Identifier","start":742,"end":746,"name":"next"}],"body":{"type":"BlockStatement","start":751,"end":2664,"body":[{"type":"VariableDeclaration","start":757,"end":796,"kind":"const","declarations":[{"type":"VariableDeclarator","start":763,"end":795,"id":{"type":"Identifier","start":763,"end":773,"name":"platformId"},"init":{"type":"CallExpression","start":776,"end":795,"optional":false,"callee":{"type":"Identifier","start":776,"end":782,"name":"inject"},"arguments":[{"type":"Identifier","start":783,"end":794,"name":"PLATFORM_ID"}]}}]},{"type":"VariableDeclaration","start":801,"end":844,"kind":"const","declarations":[{"type":"VariableDeclarator","start":807,"end":843,"id":{"type":"Identifier","start":807,"end":813,"name":"config"},"init":{"type":"CallExpression","start":816,"end":843,"optional":false,"callee":{"type":"Identifier","start":816,"end":822,"name":"inject"},"arguments":[{"type":"Identifier","start":823,"end":842,"name":"OAUTH2_CONFIG_TOKEN"}]}}]},{"type":"VariableDeclaration","start":849,"end":901,"kind":"const","declarations":[{"type":"VariableDeclarator","start":855,"end":900,"id":{"type":"Identifier","start":855,"end":869,"name":"storageService"},"init":{"type":"CallExpression","start":872,"end":900,"optional":false,"callee":{"type":"Identifier","start":872,"end":878,"name":"inject"},"arguments":[{"type":"Identifier","start":879,"end":899,"name":"OAuth2StorageService"}]}}]},{"type":"VariableDeclaration","start":906,"end":949,"kind":"const","declarations":[{"type":"VariableDeclarator","start":912,"end":948,"id":{"type":"Identifier","start":912,"end":920,"name":"logLevel"},"init":{"type":"LogicalExpression","start":923,"end":948,"operator":"||","left":{"type":"MemberExpression","start":923,"end":938,"computed":false,"optional":false,"object":{"type":"Identifier","start":923,"end":929,"name":"config"},"property":{"type":"Identifier","start":930,"end":938,"name":"logLevel"}},"right":{"type":"Literal","start":942,"end":948,"value":"warn","raw":"'warn'"}}}]},{"type":"IfStatement","start":1016,"end":1099,"test":{"type":"UnaryExpression","start":1020,"end":1060,"operator":"!","argument":{"type":"CallExpression","start":1021,"end":1060,"optional":false,"callee":{"type":"Identifier","start":1021,"end":1043,"name":"shouldInterceptRequest"},"arguments":[{"type":"Identifier","start":1044,"end":1051,"name":"request"},{"type":"Identifier","start":1053,"end":1059,"name":"config"}]},"prefix":true},"consequent":{"type":"BlockStatement","start":1062,"end":1099,"body":[{"type":"ReturnStatement","start":1072,"end":1093,"argument":{"type":"CallExpression","start":1079,"end":1092,"optional":false,"callee":{"type":"Identifier","start":1079,"end":1083,"name":"next"},"arguments":[{"type":"Identifier","start":1084,"end":1091,"name":"request"}]}}]},"alternate":null},{"type":"VariableDeclaration","start":1179,"end":1254,"kind":"let","declarations":[{"type":"VariableDeclarator","start":1183,"end":1253,"id":{"type":"Identifier","start":1183,"end":1194,"name":"accessToken"},"init":{"type":"CallExpression","start":1197,"end":1253,"optional":false,"callee":{"type":"MemberExpression","start":1197,"end":1219,"computed":false,"optional":false,"object":{"type":"Identifier","start":1197,"end":1211,"name":"storageService"},"property":{"type":"Identifier","start":1212,"end":1219,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":1220,"end":1252,"computed":false,"optional":false,"object":{"type":"Identifier","start":1220,"end":1239,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":1240,"end":1252,"name":"ACCESS_TOKEN"}}]}}]},{"type":"VariableDeclaration","start":1259,"end":1325,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1265,"end":1324,"id":{"type":"Identifier","start":1265,"end":1278,"name":"hasValidToken"},"init":{"type":"LogicalExpression","start":1281,"end":1324,"operator":"&&","left":{"type":"Identifier","start":1281,"end":1292,"name":"accessToken"},"right":{"type":"CallExpression","start":1296,"end":1324,"optional":false,"callee":{"type":"Identifier","start":1296,"end":1308,"name":"isTokenValid"},"arguments":[{"type":"Identifier","start":1309,"end":1323,"name":"storageService"}]}}}]},{"type":"ExpressionStatement","start":1330,"end":1443,"expression":{"type":"CallExpression","start":1330,"end":1442,"optional":false,"callee":{"type":"Identifier","start":1330,"end":1338,"name":"logDebug"},"arguments":[{"type":"Identifier","start":1339,"end":1347,"name":"logLevel"},{"type":"Literal","start":1349,"end":1374,"value":"Access token retrieved:","raw":"'Access token retrieved:'"},{"type":"ConditionalExpression","start":1376,"end":1441,"test":{"type":"Identifier","start":1376,"end":1387,"name":"accessToken"},"consequent":{"type":"ConditionalExpression","start":1391,"end":1426,"test":{"type":"Identifier","start":1391,"end":1404,"name":"hasValidToken"},"consequent":{"type":"Literal","start":1407,"end":1414,"value":"Valid","raw":"'Valid'"},"alternate":{"type":"Literal","start":1417,"end":1426,"value":"Expired","raw":"'Expired'"}},"alternate":{"type":"Literal","start":1430,"end":1441,"value":"Not found","raw":"'Not found'"}}]}},{"type":"ExpressionStatement","start":1448,"end":1496,"expression":{"type":"CallExpression","start":1448,"end":1495,"optional":false,"callee":{"type":"Identifier","start":1448,"end":1456,"name":"logDebug"},"arguments":[{"type":"Identifier","start":1457,"end":1465,"name":"logLevel"},{"type":"Literal","start":1467,"end":1481,"value":"Request URL:","raw":"'Request URL:'"},{"type":"MemberExpression","start":1483,"end":1494,"computed":false,"optional":false,"object":{"type":"Identifier","start":1483,"end":1490,"name":"request"},"property":{"type":"Identifier","start":1491,"end":1494,"name":"url"}}]}},{"type":"IfStatement","start":1594,"end":1861,"test":{"type":"Identifier","start":1598,"end":1609,"name":"accessToken"},"consequent":{"type":"BlockStatement","start":1611,"end":1746,"body":[{"type":"ExpressionStatement","start":1621,"end":1671,"expression":{"type":"AssignmentExpression","start":1621,"end":1670,"operator":"=","left":{"type":"Identifier","start":1621,"end":1628,"name":"request"},"right":{"type":"CallExpression","start":1631,"end":1670,"optional":false,"callee":{"type":"Identifier","start":1631,"end":1648,"name":"addTokenToRequest"},"arguments":[{"type":"Identifier","start":1649,"end":1656,"name":"request"},{"type":"Identifier","start":1658,"end":1669,"name":"accessToken"}]}}},{"type":"ExpressionStatement","start":1680,"end":1740,"expression":{"type":"CallExpression","start":1680,"end":1739,"optional":false,"callee":{"type":"Identifier","start":1680,"end":1688,"name":"logDebug"},"arguments":[{"type":"Identifier","start":1689,"end":1697,"name":"logLevel"},{"type":"Literal","start":1699,"end":1738,"value":"Authorization header added to request","raw":"'Authorization header added to request'"}]}}]},"alternate":{"type":"BlockStatement","start":1756,"end":1861,"body":[{"type":"ExpressionStatement","start":1766,"end":1855,"expression":{"type":"CallExpression","start":1766,"end":1854,"optional":false,"callee":{"type":"Identifier","start":1766,"end":1774,"name":"logDebug"},"arguments":[{"type":"Identifier","start":1775,"end":1783,"name":"logLevel"},{"type":"Literal","start":1785,"end":1853,"value":"No access token available, proceeding without Authorization header","raw":"'No access token available, proceeding without Authorization header'"}]}}]}},{"type":"ReturnStatement","start":1866,"end":2662,"argument":{"type":"CallExpression","start":1873,"end":2661,"optional":false,"callee":{"type":"MemberExpression","start":1873,"end":1891,"computed":false,"optional":false,"object":{"type":"CallExpression","start":1873,"end":1886,"optional":false,"callee":{"type":"Identifier","start":1873,"end":1877,"name":"next"},"arguments":[{"type":"Identifier","start":1878,"end":1885,"name":"request"}]},"property":{"type":"Identifier","start":1887,"end":1891,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":1892,"end":2660,"optional":false,"callee":{"type":"Identifier","start":1892,"end":1902,"name":"catchError"},"arguments":[{"type":"ArrowFunctionExpression","start":1903,"end":2659,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":1904,"end":1909,"name":"error"}],"body":{"type":"BlockStatement","start":1914,"end":2659,"body":[{"type":"IfStatement","start":2025,"end":2613,"test":{"type":"BinaryExpression","start":2029,"end":2049,"operator":"===","left":{"type":"MemberExpression","start":2029,"end":2041,"computed":false,"optional":false,"object":{"type":"Identifier","start":2029,"end":2034,"name":"error"},"property":{"type":"Identifier","start":2035,"end":2041,"name":"status"}},"right":{"type":"Literal","start":2046,"end":2049,"raw":"401","value":401}},"consequent":{"type":"BlockStatement","start":2051,"end":2613,"body":[{"type":"VariableDeclaration","start":2065,"end":2144,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2071,"end":2143,"id":{"type":"Identifier","start":2071,"end":2083,"name":"refreshToken"},"init":{"type":"CallExpression","start":2086,"end":2143,"optional":false,"callee":{"type":"MemberExpression","start":2086,"end":2108,"computed":false,"optional":false,"object":{"type":"Identifier","start":2086,"end":2100,"name":"storageService"},"property":{"type":"Identifier","start":2101,"end":2108,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":2109,"end":2142,"computed":false,"optional":false,"object":{"type":"Identifier","start":2109,"end":2128,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":2129,"end":2142,"name":"REFRESH_TOKEN"}}]}}]},{"type":"IfStatement","start":2157,"end":2603,"test":{"type":"LogicalExpression","start":2161,"end":2188,"operator":"||","left":{"type":"Identifier","start":2161,"end":2172,"name":"accessToken"},"right":{"type":"Identifier","start":2176,"end":2188,"name":"refreshToken"}},"consequent":{"type":"BlockStatement","start":2190,"end":2486,"body":[{"type":"ExpressionStatement","start":2208,"end":2274,"expression":{"type":"CallExpression","start":2208,"end":2273,"optional":false,"callee":{"type":"Identifier","start":2208,"end":2215,"name":"logInfo"},"arguments":[{"type":"Identifier","start":2216,"end":2224,"name":"logLevel"},{"type":"Literal","start":2226,"end":2272,"value":"401 error detected, attempting token refresh","raw":"'401 error detected, attempting token refresh'"}]}},{"type":"ExpressionStatement","start":2291,"end":2384,"expression":{"type":"CallExpression","start":2291,"end":2383,"optional":false,"callee":{"type":"Identifier","start":2291,"end":2299,"name":"logDebug"},"arguments":[{"type":"Identifier","start":2300,"end":2308,"name":"logLevel"},{"type":"Literal","start":2310,"end":2329,"value":"Has access token:","raw":"'Has access token:'"},{"type":"UnaryExpression","start":2331,"end":2344,"operator":"!","argument":{"type":"UnaryExpression","start":2332,"end":2344,"operator":"!","argument":{"type":"Identifier","start":2333,"end":2344,"name":"accessToken"},"prefix":true},"prefix":true},{"type":"Literal","start":2346,"end":2366,"value":"Has refresh token:","raw":"'Has refresh token:'"},{"type":"UnaryExpression","start":2368,"end":2382,"operator":"!","argument":{"type":"UnaryExpression","start":2369,"end":2382,"operator":"!","argument":{"type":"Identifier","start":2370,"end":2382,"name":"refreshToken"},"prefix":true},"prefix":true}]}},{"type":"ReturnStatement","start":2401,"end":2472,"argument":{"type":"CallExpression","start":2408,"end":2471,"optional":false,"callee":{"type":"Identifier","start":2408,"end":2422,"name":"handle401Error"},"arguments":[{"type":"Identifier","start":2423,"end":2430,"name":"request"},{"type":"Identifier","start":2432,"end":2436,"name":"next"},{"type":"Identifier","start":2438,"end":2444,"name":"config"},{"type":"Identifier","start":2446,"end":2460,"name":"storageService"},{"type":"Identifier","start":2462,"end":2470,"name":"logLevel"}]}}]},"alternate":{"type":"BlockStatement","start":2504,"end":2603,"body":[{"type":"ExpressionStatement","start":2522,"end":2589,"expression":{"type":"CallExpression","start":2522,"end":2588,"optional":false,"callee":{"type":"Identifier","start":2522,"end":2529,"name":"logInfo"},"arguments":[{"type":"Identifier","start":2530,"end":2538,"name":"logLevel"},{"type":"Literal","start":2540,"end":2587,"value":"401 error but no tokens available for refresh","raw":"'401 error but no tokens available for refresh'"}]}}]}}]},"alternate":null},{"type":"ReturnStatement","start":2622,"end":2653,"argument":{"type":"CallExpression","start":2629,"end":2652,"optional":false,"callee":{"type":"Identifier","start":2629,"end":2639,"name":"throwError"},"arguments":[{"type":"ArrowFunctionExpression","start":2640,"end":2651,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"Identifier","start":2646,"end":2651,"name":"error"},"id":null}]}}]},"id":null}]}]}}]},"id":null}}]}},{"type":"FunctionDeclaration","start":2715,"end":2981,"async":false,"generator":false,"id":{"type":"Identifier","start":2724,"end":2736,"name":"isTokenValid"},"params":[{"type":"Identifier","start":2737,"end":2751,"name":"storageService"}],"body":{"type":"BlockStatement","start":2753,"end":2981,"body":[{"type":"VariableDeclaration","start":2759,"end":2841,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2765,"end":2840,"id":{"type":"Identifier","start":2765,"end":2777,"name":"expiresAtStr"},"init":{"type":"CallExpression","start":2780,"end":2840,"optional":false,"callee":{"type":"MemberExpression","start":2780,"end":2802,"computed":false,"optional":false,"object":{"type":"Identifier","start":2780,"end":2794,"name":"storageService"},"property":{"type":"Identifier","start":2795,"end":2802,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":2803,"end":2839,"computed":false,"optional":false,"object":{"type":"Identifier","start":2803,"end":2822,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":2823,"end":2839,"name":"TOKEN_EXPIRES_AT"}}]}}]},{"type":"IfStatement","start":2846,"end":2894,"test":{"type":"UnaryExpression","start":2850,"end":2863,"operator":"!","argument":{"type":"Identifier","start":2851,"end":2863,"name":"expiresAtStr"},"prefix":true},"consequent":{"type":"BlockStatement","start":2865,"end":2894,"body":[{"type":"ReturnStatement","start":2875,"end":2888,"argument":{"type":"Literal","start":2882,"end":2887,"value":false,"raw":"false"}}]},"alternate":null},{"type":"VariableDeclaration","start":2899,"end":2944,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2905,"end":2943,"id":{"type":"Identifier","start":2905,"end":2914,"name":"expiresAt"},"init":{"type":"CallExpression","start":2917,"end":2943,"optional":false,"callee":{"type":"Identifier","start":2917,"end":2925,"name":"parseInt"},"arguments":[{"type":"Identifier","start":2926,"end":2938,"name":"expiresAtStr"},{"type":"Literal","start":2940,"end":2942,"raw":"10","value":10}]}}]},{"type":"ReturnStatement","start":2949,"end":2979,"argument":{"type":"BinaryExpression","start":2956,"end":2978,"operator":"<","left":{"type":"CallExpression","start":2956,"end":2966,"optional":false,"callee":{"type":"MemberExpression","start":2956,"end":2964,"computed":false,"optional":false,"object":{"type":"Identifier","start":2956,"end":2960,"name":"Date"},"property":{"type":"Identifier","start":2961,"end":2964,"name":"now"}},"arguments":[]},"right":{"type":"Identifier","start":2969,"end":2978,"name":"expiresAt"}}}]},"expression":false},{"type":"FunctionDeclaration","start":3032,"end":3506,"async":false,"generator":false,"id":{"type":"Identifier","start":3041,"end":3063,"name":"shouldInterceptRequest"},"params":[{"type":"Identifier","start":3064,"end":3071,"name":"request"},{"type":"Identifier","start":3073,"end":3079,"name":"config"}],"body":{"type":"BlockStatement","start":3081,"end":3506,"body":[{"type":"IfStatement","start":3154,"end":3225,"test":{"type":"BinaryExpression","start":3158,"end":3194,"operator":"===","left":{"type":"MemberExpression","start":3158,"end":3169,"computed":false,"optional":false,"object":{"type":"Identifier","start":3158,"end":3165,"name":"request"},"property":{"type":"Identifier","start":3166,"end":3169,"name":"url"}},"right":{"type":"MemberExpression","start":3174,"end":3194,"computed":false,"optional":false,"object":{"type":"Identifier","start":3174,"end":3180,"name":"config"},"property":{"type":"Identifier","start":3181,"end":3194,"name":"tokenEndpoint"}}},"consequent":{"type":"BlockStatement","start":3196,"end":3225,"body":[{"type":"ReturnStatement","start":3206,"end":3219,"argument":{"type":"Literal","start":3213,"end":3218,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":3261,"end":3358,"test":{"type":"LogicalExpression","start":3265,"end":3327,"operator":"&&","left":{"type":"MemberExpression","start":3265,"end":3286,"computed":false,"optional":false,"object":{"type":"Identifier","start":3265,"end":3271,"name":"config"},"property":{"type":"Identifier","start":3272,"end":3286,"name":"revokeEndpoint"}},"right":{"type":"BinaryExpression","start":3290,"end":3327,"operator":"===","left":{"type":"MemberExpression","start":3290,"end":3301,"computed":false,"optional":false,"object":{"type":"Identifier","start":3290,"end":3297,"name":"request"},"property":{"type":"Identifier","start":3298,"end":3301,"name":"url"}},"right":{"type":"MemberExpression","start":3306,"end":3327,"computed":false,"optional":false,"object":{"type":"Identifier","start":3306,"end":3312,"name":"config"},"property":{"type":"Identifier","start":3313,"end":3327,"name":"revokeEndpoint"}}}},"consequent":{"type":"BlockStatement","start":3329,"end":3358,"body":[{"type":"ReturnStatement","start":3339,"end":3352,"argument":{"type":"Literal","start":3346,"end":3351,"value":false,"raw":"false"}}]},"alternate":null},{"type":"ReturnStatement","start":3492,"end":3504,"argument":{"type":"Literal","start":3499,"end":3503,"value":true,"raw":"true"}}]},"expression":false},{"type":"FunctionDeclaration","start":3554,"end":3712,"async":false,"generator":false,"id":{"type":"Identifier","start":3563,"end":3580,"name":"addTokenToRequest"},"params":[{"type":"Identifier","start":3581,"end":3588,"name":"request"},{"type":"Identifier","start":3590,"end":3595,"name":"token"}],"body":{"type":"BlockStatement","start":3597,"end":3712,"body":[{"type":"ReturnStatement","start":3603,"end":3710,"argument":{"type":"CallExpression","start":3610,"end":3709,"optional":false,"callee":{"type":"MemberExpression","start":3610,"end":3623,"computed":false,"optional":false,"object":{"type":"Identifier","start":3610,"end":3617,"name":"request"},"property":{"type":"Identifier","start":3618,"end":3623,"name":"clone"}},"arguments":[{"type":"ObjectExpression","start":3624,"end":3708,"properties":[{"type":"Property","start":3634,"end":3702,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3634,"end":3644,"name":"setHeaders"},"value":{"type":"ObjectExpression","start":3646,"end":3702,"properties":[{"type":"Property","start":3660,"end":3692,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":3660,"end":3673,"name":"Authorization"},"value":{"type":"TemplateLiteral","start":3675,"end":3692,"quasis":[{"type":"TemplateElement","start":3676,"end":3683,"tail":false,"value":{"cooked":"Bearer ","raw":"Bearer "}},{"type":"TemplateElement","start":3691,"end":3691,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":3685,"end":3690,"name":"token"}]},"kind":"init"}]},"kind":"init"}]}]}}]},"expression":false},{"type":"FunctionDeclaration","start":3783,"end":7218,"async":false,"generator":false,"id":{"type":"Identifier","start":3792,"end":3806,"name":"handle401Error"},"params":[{"type":"Identifier","start":3807,"end":3814,"name":"request"},{"type":"Identifier","start":3816,"end":3820,"name":"next"},{"type":"Identifier","start":3822,"end":3828,"name":"config"},{"type":"Identifier","start":3830,"end":3844,"name":"storageService"},{"type":"Identifier","start":3846,"end":3854,"name":"logLevel"}],"body":{"type":"BlockStatement","start":3856,"end":7218,"body":[{"type":"IfStatement","start":3862,"end":7216,"test":{"type":"UnaryExpression","start":3866,"end":3879,"operator":"!","argument":{"type":"Identifier","start":3867,"end":3879,"name":"isRefreshing"},"prefix":true},"consequent":{"type":"BlockStatement","start":3881,"end":6996,"body":[{"type":"ExpressionStatement","start":3891,"end":3911,"expression":{"type":"AssignmentExpression","start":3891,"end":3910,"operator":"=","left":{"type":"Identifier","start":3891,"end":3903,"name":"isRefreshing"},"right":{"type":"Literal","start":3906,"end":3910,"value":true,"raw":"true"}}},{"type":"ExpressionStatement","start":3920,"end":3951,"expression":{"type":"CallExpression","start":3920,"end":3950,"optional":false,"callee":{"type":"MemberExpression","start":3920,"end":3944,"computed":false,"optional":false,"object":{"type":"Identifier","start":3920,"end":3939,"name":"refreshTokenSubject"},"property":{"type":"Identifier","start":3940,"end":3944,"name":"next"}},"arguments":[{"type":"Literal","start":3945,"end":3949,"raw":"null","value":null}]}},{"type":"VariableDeclaration","start":3960,"end":4039,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3966,"end":4038,"id":{"type":"Identifier","start":3966,"end":3978,"name":"refreshToken"},"init":{"type":"CallExpression","start":3981,"end":4038,"optional":false,"callee":{"type":"MemberExpression","start":3981,"end":4003,"computed":false,"optional":false,"object":{"type":"Identifier","start":3981,"end":3995,"name":"storageService"},"property":{"type":"Identifier","start":3996,"end":4003,"name":"getItem"}},"arguments":[{"type":"MemberExpression","start":4004,"end":4037,"computed":false,"optional":false,"object":{"type":"Identifier","start":4004,"end":4023,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":4024,"end":4037,"name":"REFRESH_TOKEN"}}]}}]},{"type":"IfStatement","start":4048,"end":4251,"test":{"type":"UnaryExpression","start":4052,"end":4065,"operator":"!","argument":{"type":"Identifier","start":4053,"end":4065,"name":"refreshToken"},"prefix":true},"consequent":{"type":"BlockStatement","start":4067,"end":4251,"body":[{"type":"ExpressionStatement","start":4081,"end":4102,"expression":{"type":"AssignmentExpression","start":4081,"end":4101,"operator":"=","left":{"type":"Identifier","start":4081,"end":4093,"name":"isRefreshing"},"right":{"type":"Literal","start":4096,"end":4101,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":4115,"end":4163,"expression":{"type":"CallExpression","start":4115,"end":4162,"optional":false,"callee":{"type":"Identifier","start":4115,"end":4122,"name":"logInfo"},"arguments":[{"type":"Identifier","start":4123,"end":4131,"name":"logLevel"},{"type":"Literal","start":4133,"end":4161,"value":"No refresh token available","raw":"'No refresh token available'"}]}},{"type":"ReturnStatement","start":4176,"end":4241,"argument":{"type":"CallExpression","start":4183,"end":4240,"optional":false,"callee":{"type":"Identifier","start":4183,"end":4193,"name":"throwError"},"arguments":[{"type":"ArrowFunctionExpression","start":4194,"end":4239,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"NewExpression","start":4200,"end":4239,"callee":{"type":"Identifier","start":4204,"end":4209,"name":"Error"},"arguments":[{"type":"Literal","start":4210,"end":4238,"value":"No refresh token available","raw":"'No refresh token available'"}]},"id":null}]}}]},"alternate":null},{"type":"VariableDeclaration","start":4327,"end":4485,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4333,"end":4484,"id":{"type":"Identifier","start":4333,"end":4349,"name":"tokenRequestData"},"init":{"type":"ObjectExpression","start":4352,"end":4484,"properties":[{"type":"Property","start":4366,"end":4393,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4366,"end":4376,"name":"grant_type"},"value":{"type":"Literal","start":4378,"end":4393,"value":"refresh_token","raw":"'refresh_token'"},"kind":"init"},{"type":"Property","start":4407,"end":4434,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4407,"end":4420,"name":"refresh_token"},"value":{"type":"Identifier","start":4422,"end":4434,"name":"refreshToken"},"kind":"init"},{"type":"Property","start":4448,"end":4474,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4448,"end":4457,"name":"client_id"},"value":{"type":"MemberExpression","start":4459,"end":4474,"computed":false,"optional":false,"object":{"type":"Identifier","start":4459,"end":4465,"name":"config"},"property":{"type":"Identifier","start":4466,"end":4474,"name":"clientId"}},"kind":"init"}]}}]},{"type":"VariableDeclaration","start":4564,"end":4603,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4570,"end":4602,"id":{"type":"Identifier","start":4570,"end":4578,"name":"formData"},"init":{"type":"NewExpression","start":4581,"end":4602,"callee":{"type":"Identifier","start":4585,"end":4600,"name":"URLSearchParams"},"arguments":[]}}]},{"type":"ExpressionStatement","start":4612,"end":4793,"expression":{"type":"CallExpression","start":4612,"end":4792,"optional":false,"callee":{"type":"MemberExpression","start":4612,"end":4652,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4612,"end":4644,"optional":false,"callee":{"type":"MemberExpression","start":4612,"end":4626,"computed":false,"optional":false,"object":{"type":"Identifier","start":4612,"end":4618,"name":"Object"},"property":{"type":"Identifier","start":4619,"end":4626,"name":"entries"}},"arguments":[{"type":"Identifier","start":4627,"end":4643,"name":"tokenRequestData"}]},"property":{"type":"Identifier","start":4645,"end":4652,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":4653,"end":4791,"async":false,"expression":false,"generator":false,"params":[{"type":"ArrayPattern","start":4654,"end":4666,"elements":[{"type":"Identifier","start":4655,"end":4658,"name":"key"},{"type":"Identifier","start":4660,"end":4665,"name":"value"}]}],"body":{"type":"BlockStatement","start":4671,"end":4791,"body":[{"type":"IfStatement","start":4685,"end":4781,"test":{"type":"BinaryExpression","start":4689,"end":4708,"operator":"!==","left":{"type":"Identifier","start":4689,"end":4694,"name":"value"},"right":{"type":"Identifier","start":4699,"end":4708,"name":"undefined"}},"consequent":{"type":"BlockStatement","start":4710,"end":4781,"body":[{"type":"ExpressionStatement","start":4728,"end":4767,"expression":{"type":"CallExpression","start":4728,"end":4766,"optional":false,"callee":{"type":"MemberExpression","start":4728,"end":4743,"computed":false,"optional":false,"object":{"type":"Identifier","start":4728,"end":4736,"name":"formData"},"property":{"type":"Identifier","start":4737,"end":4743,"name":"append"}},"arguments":[{"type":"Identifier","start":4744,"end":4747,"name":"key"},{"type":"CallExpression","start":4749,"end":4765,"optional":false,"callee":{"type":"MemberExpression","start":4749,"end":4763,"computed":false,"optional":false,"object":{"type":"Identifier","start":4749,"end":4754,"name":"value"},"property":{"type":"Identifier","start":4755,"end":4763,"name":"toString"}},"arguments":[]}]}}]},"alternate":null}]},"id":null}]}},{"type":"VariableDeclaration","start":4802,"end":4911,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4808,"end":4910,"id":{"type":"Identifier","start":4808,"end":4815,"name":"headers"},"init":{"type":"NewExpression","start":4818,"end":4910,"callee":{"type":"Identifier","start":4822,"end":4833,"name":"HttpHeaders"},"arguments":[{"type":"ObjectExpression","start":4834,"end":4909,"properties":[{"type":"Property","start":4848,"end":4899,"method":false,"shorthand":false,"computed":false,"key":{"type":"Literal","start":4848,"end":4862,"value":"Content-Type","raw":"'Content-Type'"},"value":{"type":"Literal","start":4864,"end":4899,"value":"application/x-www-form-urlencoded","raw":"'application/x-www-form-urlencoded'"},"kind":"init"}]}]}}]},{"type":"VariableDeclaration","start":4920,"end":5052,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4926,"end":5051,"id":{"type":"Identifier","start":4926,"end":4940,"name":"refreshRequest"},"init":{"type":"NewExpression","start":4943,"end":5051,"callee":{"type":"Identifier","start":4947,"end":4958,"name":"HttpRequest"},"arguments":[{"type":"Literal","start":4959,"end":4965,"value":"POST","raw":"'POST'"},{"type":"MemberExpression","start":4967,"end":4987,"computed":false,"optional":false,"object":{"type":"Identifier","start":4967,"end":4973,"name":"config"},"property":{"type":"Identifier","start":4974,"end":4987,"name":"tokenEndpoint"}},{"type":"CallExpression","start":4989,"end":5008,"optional":false,"callee":{"type":"MemberExpression","start":4989,"end":5006,"computed":false,"optional":false,"object":{"type":"Identifier","start":4989,"end":4997,"name":"formData"},"property":{"type":"Identifier","start":4998,"end":5006,"name":"toString"}},"arguments":[]},{"type":"ObjectExpression","start":5010,"end":5050,"properties":[{"type":"Property","start":5024,"end":5040,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5024,"end":5031,"name":"headers"},"value":{"type":"Identifier","start":5033,"end":5040,"name":"headers"},"kind":"init"}]}]}}]},{"type":"ReturnStatement","start":5061,"end":6990,"argument":{"type":"CallExpression","start":5068,"end":6989,"optional":false,"callee":{"type":"MemberExpression","start":5068,"end":5093,"computed":false,"optional":false,"object":{"type":"CallExpression","start":5068,"end":5088,"optional":false,"callee":{"type":"Identifier","start":5068,"end":5072,"name":"next"},"arguments":[{"type":"Identifier","start":5073,"end":5087,"name":"refreshRequest"}]},"property":{"type":"Identifier","start":5089,"end":5093,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":5094,"end":5142,"optional":false,"callee":{"type":"Identifier","start":5094,"end":5100,"name":"filter"},"arguments":[{"type":"ArrowFunctionExpression","start":5101,"end":5141,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":5102,"end":5107,"name":"event"}],"body":{"type":"BinaryExpression","start":5112,"end":5141,"operator":"instanceof","left":{"type":"Identifier","start":5112,"end":5117,"name":"event"},"right":{"type":"Identifier","start":5129,"end":5141,"name":"HttpResponse"}},"id":null}]},{"type":"CallExpression","start":5144,"end":6187,"optional":false,"callee":{"type":"Identifier","start":5144,"end":5153,"name":"switchMap"},"arguments":[{"type":"ArrowFunctionExpression","start":5154,"end":6186,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":5155,"end":5160,"name":"event"}],"body":{"type":"BlockStatement","start":5165,"end":6186,"body":[{"type":"VariableDeclaration","start":5179,"end":5212,"kind":"const","declarations":[{"type":"VariableDeclarator","start":5185,"end":5211,"id":{"type":"Identifier","start":5185,"end":5198,"name":"tokenResponse"},"init":{"type":"MemberExpression","start":5201,"end":5211,"computed":false,"optional":false,"object":{"type":"Identifier","start":5201,"end":5206,"name":"event"},"property":{"type":"Identifier","start":5207,"end":5211,"name":"body"}}}]},{"type":"ExpressionStatement","start":5225,"end":5246,"expression":{"type":"AssignmentExpression","start":5225,"end":5245,"operator":"=","left":{"type":"Identifier","start":5225,"end":5237,"name":"isRefreshing"},"right":{"type":"Literal","start":5240,"end":5245,"value":false,"raw":"false"}}},{"type":"IfStatement","start":5259,"end":6176,"test":{"type":"ChainExpression","start":5263,"end":5290,"expression":{"type":"MemberExpression","start":5263,"end":5290,"computed":false,"optional":true,"object":{"type":"Identifier","start":5263,"end":5276,"name":"tokenResponse"},"property":{"type":"Identifier","start":5278,"end":5290,"name":"access_token"}}},"consequent":{"type":"BlockStatement","start":5292,"end":6071,"body":[{"type":"ExpressionStatement","start":5346,"end":5431,"expression":{"type":"CallExpression","start":5346,"end":5430,"optional":false,"callee":{"type":"MemberExpression","start":5346,"end":5368,"computed":false,"optional":false,"object":{"type":"Identifier","start":5346,"end":5360,"name":"storageService"},"property":{"type":"Identifier","start":5361,"end":5368,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":5369,"end":5401,"computed":false,"optional":false,"object":{"type":"Identifier","start":5369,"end":5388,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":5389,"end":5401,"name":"ACCESS_TOKEN"}},{"type":"MemberExpression","start":5403,"end":5429,"computed":false,"optional":false,"object":{"type":"Identifier","start":5403,"end":5416,"name":"tokenResponse"},"property":{"type":"Identifier","start":5417,"end":5429,"name":"access_token"}}]}},{"type":"ExpressionStatement","start":5448,"end":5570,"expression":{"type":"CallExpression","start":5448,"end":5569,"optional":false,"callee":{"type":"MemberExpression","start":5448,"end":5470,"computed":false,"optional":false,"object":{"type":"Identifier","start":5448,"end":5462,"name":"storageService"},"property":{"type":"Identifier","start":5463,"end":5470,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":5471,"end":5507,"computed":false,"optional":false,"object":{"type":"Identifier","start":5471,"end":5490,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":5491,"end":5507,"name":"TOKEN_EXPIRES_AT"}},{"type":"CallExpression","start":5509,"end":5568,"optional":false,"callee":{"type":"MemberExpression","start":5509,"end":5566,"computed":false,"optional":false,"object":{"type":"BinaryExpression","start":5510,"end":5556,"operator":"+","left":{"type":"CallExpression","start":5510,"end":5520,"optional":false,"callee":{"type":"MemberExpression","start":5510,"end":5518,"computed":false,"optional":false,"object":{"type":"Identifier","start":5510,"end":5514,"name":"Date"},"property":{"type":"Identifier","start":5515,"end":5518,"name":"now"}},"arguments":[]},"right":{"type":"BinaryExpression","start":5524,"end":5555,"operator":"*","left":{"type":"MemberExpression","start":5524,"end":5548,"computed":false,"optional":false,"object":{"type":"Identifier","start":5524,"end":5537,"name":"tokenResponse"},"property":{"type":"Identifier","start":5538,"end":5548,"name":"expires_in"}},"right":{"type":"Literal","start":5551,"end":5555,"raw":"1000","value":1000}}},"property":{"type":"Identifier","start":5558,"end":5566,"name":"toString"}},"arguments":[]}]}},{"type":"IfStatement","start":5587,"end":5747,"test":{"type":"MemberExpression","start":5591,"end":5618,"computed":false,"optional":false,"object":{"type":"Identifier","start":5591,"end":5604,"name":"tokenResponse"},"property":{"type":"Identifier","start":5605,"end":5618,"name":"refresh_token"}},"consequent":{"type":"BlockStatement","start":5620,"end":5747,"body":[{"type":"ExpressionStatement","start":5642,"end":5729,"expression":{"type":"CallExpression","start":5642,"end":5728,"optional":false,"callee":{"type":"MemberExpression","start":5642,"end":5664,"computed":false,"optional":false,"object":{"type":"Identifier","start":5642,"end":5656,"name":"storageService"},"property":{"type":"Identifier","start":5657,"end":5664,"name":"setItem"}},"arguments":[{"type":"MemberExpression","start":5665,"end":5698,"computed":false,"optional":false,"object":{"type":"Identifier","start":5665,"end":5684,"name":"OAUTH2_STORAGE_KEYS"},"property":{"type":"Identifier","start":5685,"end":5698,"name":"REFRESH_TOKEN"}},{"type":"MemberExpression","start":5700,"end":5727,"computed":false,"optional":false,"object":{"type":"Identifier","start":5700,"end":5713,"name":"tokenResponse"},"property":{"type":"Identifier","start":5714,"end":5727,"name":"refresh_token"}}]}}]},"alternate":null},{"type":"ExpressionStatement","start":5764,"end":5817,"expression":{"type":"CallExpression","start":5764,"end":5816,"optional":false,"callee":{"type":"MemberExpression","start":5764,"end":5788,"computed":false,"optional":false,"object":{"type":"Identifier","start":5764,"end":5783,"name":"refreshTokenSubject"},"property":{"type":"Identifier","start":5784,"end":5788,"name":"next"}},"arguments":[{"type":"MemberExpression","start":5789,"end":5815,"computed":false,"optional":false,"object":{"type":"Identifier","start":5789,"end":5802,"name":"tokenResponse"},"property":{"type":"Identifier","start":5803,"end":5815,"name":"access_token"}}]}},{"type":"ExpressionStatement","start":5834,"end":5911,"expression":{"type":"CallExpression","start":5834,"end":5910,"optional":false,"callee":{"type":"Identifier","start":5834,"end":5841,"name":"logInfo"},"arguments":[{"type":"Identifier","start":5842,"end":5850,"name":"logLevel"},{"type":"Literal","start":5852,"end":5909,"value":"Token refreshed successfully, retrying original request","raw":"'Token refreshed successfully, retrying original request'"}]}},{"type":"ReturnStatement","start":5989,"end":6057,"argument":{"type":"CallExpression","start":5996,"end":6056,"optional":false,"callee":{"type":"Identifier","start":5996,"end":6000,"name":"next"},"arguments":[{"type":"CallExpression","start":6001,"end":6055,"optional":false,"callee":{"type":"Identifier","start":6001,"end":6018,"name":"addTokenToRequest"},"arguments":[{"type":"Identifier","start":6019,"end":6026,"name":"request"},{"type":"MemberExpression","start":6028,"end":6054,"computed":false,"optional":false,"object":{"type":"Identifier","start":6028,"end":6041,"name":"tokenResponse"},"property":{"type":"Identifier","start":6042,"end":6054,"name":"access_token"}}]}]}}]},"alternate":{"type":"BlockStatement","start":6089,"end":6176,"body":[{"type":"ThrowStatement","start":6107,"end":6162,"argument":{"type":"NewExpression","start":6113,"end":6161,"callee":{"type":"Identifier","start":6117,"end":6122,"name":"Error"},"arguments":[{"type":"Literal","start":6123,"end":6160,"value":"No access token in refresh response","raw":"'No access token in refresh response'"}]}}]}}]},"id":null}]},{"type":"CallExpression","start":6189,"end":6988,"optional":false,"callee":{"type":"Identifier","start":6189,"end":6199,"name":"catchError"},"arguments":[{"type":"ArrowFunctionExpression","start":6200,"end":6987,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":6200,"end":6205,"name":"error"}],"body":{"type":"BlockStatement","start":6209,"end":6987,"body":[{"type":"ExpressionStatement","start":6223,"end":6244,"expression":{"type":"AssignmentExpression","start":6223,"end":6243,"operator":"=","left":{"type":"Identifier","start":6223,"end":6235,"name":"isRefreshing"},"right":{"type":"Literal","start":6238,"end":6243,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":6257,"end":6288,"expression":{"type":"CallExpression","start":6257,"end":6287,"optional":false,"callee":{"type":"MemberExpression","start":6257,"end":6281,"computed":false,"optional":false,"object":{"type":"Identifier","start":6257,"end":6276,"name":"refreshTokenSubject"},"property":{"type":"Identifier","start":6277,"end":6281,"name":"next"}},"arguments":[{"type":"Literal","start":6282,"end":6286,"raw":"null","value":null}]}},{"type":"ExpressionStatement","start":6301,"end":6352,"expression":{"type":"CallExpression","start":6301,"end":6351,"optional":false,"callee":{"type":"Identifier","start":6301,"end":6309,"name":"logError"},"arguments":[{"type":"Identifier","start":6310,"end":6318,"name":"logLevel"},{"type":"Literal","start":6320,"end":6343,"value":"Token refresh failed:","raw":"'Token refresh failed:'"},{"type":"Identifier","start":6345,"end":6350,"name":"error"}]}},{"type":"IfStatement","start":6442,"end":6933,"test":{"type":"LogicalExpression","start":6446,"end":6492,"operator":"||","left":{"type":"BinaryExpression","start":6446,"end":6467,"operator":"===","left":{"type":"ChainExpression","start":6446,"end":6459,"expression":{"type":"MemberExpression","start":6446,"end":6459,"computed":false,"optional":true,"object":{"type":"Identifier","start":6446,"end":6451,"name":"error"},"property":{"type":"Identifier","start":6453,"end":6459,"name":"status"}}},"right":{"type":"Literal","start":6464,"end":6467,"raw":"400","value":400}},"right":{"type":"BinaryExpression","start":6471,"end":6492,"operator":"===","left":{"type":"ChainExpression","start":6471,"end":6484,"expression":{"type":"MemberExpression","start":6471,"end":6484,"computed":false,"optional":true,"object":{"type":"Identifier","start":6471,"end":6476,"name":"error"},"property":{"type":"Identifier","start":6478,"end":6484,"name":"status"}}},"right":{"type":"Literal","start":6489,"end":6492,"raw":"401","value":401}}},"consequent":{"type":"BlockStatement","start":6494,"end":6820,"body":[{"type":"ExpressionStatement","start":6512,"end":6575,"expression":{"type":"CallExpression","start":6512,"end":6574,"optional":false,"callee":{"type":"Identifier","start":6512,"end":6519,"name":"logInfo"},"arguments":[{"type":"Identifier","start":6520,"end":6528,"name":"logLevel"},{"type":"Literal","start":6530,"end":6573,"value":"Refresh token is invalid, clearing tokens","raw":"'Refresh token is invalid, clearing tokens'"}]}},{"type":"ExpressionStatement","start":6648,"end":6674,"expression":{"type":"CallExpression","start":6648,"end":6673,"optional":false,"callee":{"type":"MemberExpression","start":6648,"end":6671,"computed":false,"optional":false,"object":{"type":"Identifier","start":6648,"end":6662,"name":"storageService"},"property":{"type":"Identifier","start":6663,"end":6671,"name":"clearAll"}},"arguments":[]}}]},"alternate":{"type":"BlockStatement","start":6838,"end":6933,"body":[{"type":"ExpressionStatement","start":6856,"end":6919,"expression":{"type":"CallExpression","start":6856,"end":6918,"optional":false,"callee":{"type":"Identifier","start":6856,"end":6863,"name":"logInfo"},"arguments":[{"type":"Identifier","start":6864,"end":6872,"name":"logLevel"},{"type":"Literal","start":6874,"end":6917,"value":"Network/server error, not clearing tokens","raw":"'Network/server error, not clearing tokens'"}]}}]}},{"type":"ReturnStatement","start":6946,"end":6977,"argument":{"type":"CallExpression","start":6953,"end":6976,"optional":false,"callee":{"type":"Identifier","start":6953,"end":6963,"name":"throwError"},"arguments":[{"type":"ArrowFunctionExpression","start":6964,"end":6975,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"Identifier","start":6970,"end":6975,"name":"error"},"id":null}]}}]},"id":null}]}]}}]},"alternate":{"type":"BlockStatement","start":7006,"end":7216,"body":[{"type":"ReturnStatement","start":7076,"end":7210,"argument":{"type":"CallExpression","start":7083,"end":7209,"optional":false,"callee":{"type":"MemberExpression","start":7083,"end":7107,"computed":false,"optional":false,"object":{"type":"Identifier","start":7083,"end":7102,"name":"refreshTokenSubject"},"property":{"type":"Identifier","start":7103,"end":7107,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":7108,"end":7138,"optional":false,"callee":{"type":"Identifier","start":7108,"end":7114,"name":"filter"},"arguments":[{"type":"ArrowFunctionExpression","start":7115,"end":7137,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":7115,"end":7120,"name":"token"}],"body":{"type":"BinaryExpression","start":7124,"end":7137,"operator":"!=","left":{"type":"Identifier","start":7124,"end":7129,"name":"token"},"right":{"type":"Literal","start":7133,"end":7137,"raw":"null","value":null}},"id":null}]},{"type":"CallExpression","start":7140,"end":7147,"optional":false,"callee":{"type":"Identifier","start":7140,"end":7144,"name":"take"},"arguments":[{"type":"Literal","start":7145,"end":7146,"raw":"1","value":1}]},{"type":"CallExpression","start":7149,"end":7208,"optional":false,"callee":{"type":"Identifier","start":7149,"end":7158,"name":"switchMap"},"arguments":[{"type":"ArrowFunctionExpression","start":7159,"end":7207,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":7159,"end":7164,"name":"token"}],"body":{"type":"CallExpression","start":7168,"end":7207,"optional":false,"callee":{"type":"Identifier","start":7168,"end":7172,"name":"next"},"arguments":[{"type":"CallExpression","start":7173,"end":7206,"optional":false,"callee":{"type":"Identifier","start":7173,"end":7190,"name":"addTokenToRequest"},"arguments":[{"type":"Identifier","start":7191,"end":7198,"name":"request"},{"type":"Identifier","start":7200,"end":7205,"name":"token"}]}]},"id":null}]}]}}]}}]},"expression":false},{"type":"FunctionDeclaration","start":7244,"end":7395,"async":false,"generator":false,"id":{"type":"Identifier","start":7253,"end":7261,"name":"logDebug"},"params":[{"type":"Identifier","start":7262,"end":7270,"name":"logLevel"},{"type":"Identifier","start":7272,"end":7279,"name":"message"},{"type":"RestElement","start":7281,"end":7288,"argument":{"type":"Identifier","start":7284,"end":7288,"name":"args"}}],"body":{"type":"BlockStatement","start":7290,"end":7395,"body":[{"type":"IfStatement","start":7296,"end":7393,"test":{"type":"BinaryExpression","start":7300,"end":7320,"operator":"===","left":{"type":"Identifier","start":7300,"end":7308,"name":"logLevel"},"right":{"type":"Literal","start":7313,"end":7320,"value":"debug","raw":"'debug'"}},"consequent":{"type":"BlockStatement","start":7322,"end":7393,"body":[{"type":"ExpressionStatement","start":7332,"end":7387,"expression":{"type":"CallExpression","start":7332,"end":7386,"optional":false,"callee":{"type":"MemberExpression","start":7332,"end":7343,"computed":false,"optional":false,"object":{"type":"Identifier","start":7332,"end":7339,"name":"console"},"property":{"type":"Identifier","start":7340,"end":7343,"name":"log"}},"arguments":[{"type":"TemplateLiteral","start":7344,"end":7376,"quasis":[{"type":"TemplateElement","start":7345,"end":7365,"tail":false,"value":{"cooked":"[OAuth2Interceptor] ","raw":"[OAuth2Interceptor] "}},{"type":"TemplateElement","start":7375,"end":7375,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":7367,"end":7374,"name":"message"}]},{"type":"SpreadElement","start":7378,"end":7385,"argument":{"type":"Identifier","start":7381,"end":7385,"name":"args"}}]}}]},"alternate":null}]},"expression":false},{"type":"FunctionDeclaration","start":7420,"end":7587,"async":false,"generator":false,"id":{"type":"Identifier","start":7429,"end":7436,"name":"logInfo"},"params":[{"type":"Identifier","start":7437,"end":7445,"name":"logLevel"},{"type":"Identifier","start":7447,"end":7454,"name":"message"},{"type":"RestElement","start":7456,"end":7463,"argument":{"type":"Identifier","start":7459,"end":7463,"name":"args"}}],"body":{"type":"BlockStatement","start":7465,"end":7587,"body":[{"type":"IfStatement","start":7471,"end":7585,"test":{"type":"CallExpression","start":7475,"end":7511,"optional":false,"callee":{"type":"MemberExpression","start":7475,"end":7501,"computed":false,"optional":false,"object":{"type":"ArrayExpression","start":7475,"end":7492,"elements":[{"type":"Literal","start":7476,"end":7483,"value":"debug","raw":"'debug'"},{"type":"Literal","start":7485,"end":7491,"value":"info","raw":"'info'"}]},"property":{"type":"Identifier","start":7493,"end":7501,"name":"includes"}},"arguments":[{"type":"Identifier","start":7502,"end":7510,"name":"logLevel"}]},"consequent":{"type":"BlockStatement","start":7513,"end":7585,"body":[{"type":"ExpressionStatement","start":7523,"end":7579,"expression":{"type":"CallExpression","start":7523,"end":7578,"optional":false,"callee":{"type":"MemberExpression","start":7523,"end":7535,"computed":false,"optional":false,"object":{"type":"Identifier","start":7523,"end":7530,"name":"console"},"property":{"type":"Identifier","start":7531,"end":7535,"name":"info"}},"arguments":[{"type":"TemplateLiteral","start":7536,"end":7568,"quasis":[{"type":"TemplateElement","start":7537,"end":7557,"tail":false,"value":{"cooked":"[OAuth2Interceptor] ","raw":"[OAuth2Interceptor] "}},{"type":"TemplateElement","start":7567,"end":7567,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":7559,"end":7566,"name":"message"}]},{"type":"SpreadElement","start":7570,"end":7577,"argument":{"type":"Identifier","start":7573,"end":7577,"name":"args"}}]}}]},"alternate":null}]},"expression":false},{"type":"FunctionDeclaration","start":7613,"end":7761,"async":false,"generator":false,"id":{"type":"Identifier","start":7622,"end":7630,"name":"logError"},"params":[{"type":"Identifier","start":7631,"end":7639,"name":"logLevel"},{"type":"Identifier","start":7641,"end":7648,"name":"message"},{"type":"Identifier","start":7650,"end":7655,"name":"error"}],"body":{"type":"BlockStatement","start":7657,"end":7761,"body":[{"type":"IfStatement","start":7663,"end":7759,"test":{"type":"BinaryExpression","start":7667,"end":7686,"operator":"!==","left":{"type":"Identifier","start":7667,"end":7675,"name":"logLevel"},"right":{"type":"Literal","start":7680,"end":7686,"value":"none","raw":"'none'"}},"consequent":{"type":"BlockStatement","start":7688,"end":7759,"body":[{"type":"ExpressionStatement","start":7698,"end":7753,"expression":{"type":"CallExpression","start":7698,"end":7752,"optional":false,"callee":{"type":"MemberExpression","start":7698,"end":7711,"computed":false,"optional":false,"object":{"type":"Identifier","start":7698,"end":7705,"name":"console"},"property":{"type":"Identifier","start":7706,"end":7711,"name":"error"}},"arguments":[{"type":"TemplateLiteral","start":7712,"end":7744,"quasis":[{"type":"TemplateElement","start":7713,"end":7733,"tail":false,"value":{"cooked":"[OAuth2Interceptor] ","raw":"[OAuth2Interceptor] "}},{"type":"TemplateElement","start":7743,"end":7743,"tail":true,"value":{"cooked":"","raw":""}}],"expressions":[{"type":"Identifier","start":7735,"end":7742,"name":"message"}]},{"type":"Identifier","start":7746,"end":7751,"name":"error"}]}}]},"alternate":null}]},"expression":false}],"_rollupRemoved":[{"end":28004,"start":7762,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { inject, PLATFORM_ID } from '@angular/core';\nimport { HttpRequest, HttpResponse, HttpHeaders } from '@angular/common/http';\nimport { throwError, BehaviorSubject } from 'rxjs';\nimport { catchError, switchMap, filter, take } from 'rxjs/operators';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport { OAuth2StorageService } from '../services/oauth2-storage.service';\n// Global state for token refresh\nlet isRefreshing = false;\nlet refreshTokenSubject = new BehaviorSubject(null);\n/**\n * OAuth2 HTTP Interceptor Function\n * Automatically adds Bearer tokens to requests and handles token refresh\n */\nexport const oauth2InterceptorFn = (request, next) => {\n    const platformId = inject(PLATFORM_ID);\n    const config = inject(OAUTH2_CONFIG_TOKEN);\n    const storageService = inject(OAuth2StorageService);\n    const logLevel = config.logLevel || 'warn';\n    // Only intercept requests that should have OAuth2 tokens\n    if (!shouldInterceptRequest(request, config)) {\n        return next(request);\n    }\n    // Get access token directly from storage to avoid circular dependency\n    let accessToken = storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\n    const hasValidToken = accessToken && isTokenValid(storageService);\n    logDebug(logLevel, 'Access token retrieved:', accessToken ? (hasValidToken ? 'Valid' : 'Expired') : 'Not found');\n    logDebug(logLevel, 'Request URL:', request.url);\n    // Always add token if available, even if expired (server will reject and we'll refresh)\n    if (accessToken) {\n        request = addTokenToRequest(request, accessToken);\n        logDebug(logLevel, 'Authorization header added to request');\n    }\n    else {\n        logDebug(logLevel, 'No access token available, proceeding without Authorization header');\n    }\n    return next(request).pipe(catchError((error) => {\n        // Handle 401 Unauthorized errors - attempt refresh if we have access token OR refresh token\n        if (error.status === 401) {\n            const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\n            if (accessToken || refreshToken) {\n                logInfo(logLevel, '401 error detected, attempting token refresh');\n                logDebug(logLevel, 'Has access token:', !!accessToken, 'Has refresh token:', !!refreshToken);\n                return handle401Error(request, next, config, storageService, logLevel);\n            }\n            else {\n                logInfo(logLevel, '401 error but no tokens available for refresh');\n            }\n        }\n        return throwError(() => error);\n    }));\n};\n/**\n * Check if token is valid (not expired)\n */\nfunction isTokenValid(storageService) {\n    const expiresAtStr = storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\n    if (!expiresAtStr) {\n        return false;\n    }\n    const expiresAt = parseInt(expiresAtStr, 10);\n    return Date.now() < expiresAt;\n}\n/**\n * Check if request should be intercepted\n */\nfunction shouldInterceptRequest(request, config) {\n    // Exclude token refresh requests to avoid circular dependency\n    if (request.url === config.tokenEndpoint) {\n        return false;\n    }\n    // Exclude revoke requests\n    if (config.revokeEndpoint && request.url === config.revokeEndpoint) {\n        return false;\n    }\n    // You can customize this logic based on your needs\n    // For example, only intercept requests to specific domains or paths\n    return true;\n}\n/**\n * Add Bearer token to request headers\n */\nfunction addTokenToRequest(request, token) {\n    return request.clone({\n        setHeaders: {\n            Authorization: `Bearer ${token}`\n        }\n    });\n}\n/**\n * Handle 401 Unauthorized errors by attempting token refresh\n */\nfunction handle401Error(request, next, config, storageService, logLevel) {\n    if (!isRefreshing) {\n        isRefreshing = true;\n        refreshTokenSubject.next(null);\n        const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\n        if (!refreshToken) {\n            isRefreshing = false;\n            logInfo(logLevel, 'No refresh token available');\n            return throwError(() => new Error('No refresh token available'));\n        }\n        // Create token refresh request directly using HttpRequest\n        const tokenRequestData = {\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: config.clientId\n        };\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequestData).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded'\n        });\n        const refreshRequest = new HttpRequest('POST', config.tokenEndpoint, formData.toString(), {\n            headers: headers\n        });\n        return next(refreshRequest).pipe(filter((event) => event instanceof HttpResponse), switchMap((event) => {\n            const tokenResponse = event.body;\n            isRefreshing = false;\n            if (tokenResponse?.access_token) {\n                // Store new tokens\n                storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenResponse.access_token);\n                storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, (Date.now() + (tokenResponse.expires_in * 1000)).toString());\n                if (tokenResponse.refresh_token) {\n                    storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenResponse.refresh_token);\n                }\n                refreshTokenSubject.next(tokenResponse.access_token);\n                logInfo(logLevel, 'Token refreshed successfully, retrying original request');\n                // Retry the original request with new token\n                return next(addTokenToRequest(request, tokenResponse.access_token));\n            }\n            else {\n                throw new Error('No access token in refresh response');\n            }\n        }), catchError(error => {\n            isRefreshing = false;\n            refreshTokenSubject.next(null);\n            logError(logLevel, 'Token refresh failed:', error);\n            // Check if it's an authentication error (invalid refresh token)\n            if (error?.status === 400 || error?.status === 401) {\n                logInfo(logLevel, 'Refresh token is invalid, clearing tokens');\n                // Clear all OAuth2 tokens from storage\n                storageService.clearAll();\n                // Optionally redirect to login or emit an event\n                // This depends on your application's requirements\n            }\n            else {\n                logInfo(logLevel, 'Network/server error, not clearing tokens');\n            }\n            return throwError(() => error);\n        }));\n    }\n    else {\n        // Wait for refresh to complete, then retry request\n        return refreshTokenSubject.pipe(filter(token => token != null), take(1), switchMap(token => next(addTokenToRequest(request, token))));\n    }\n}\n/**\n * Debug logging\n */\nfunction logDebug(logLevel, message, ...args) {\n    if (logLevel === 'debug') {\n        console.log(`[OAuth2Interceptor] ${message}`, ...args);\n    }\n}\n/**\n * Info logging\n */\nfunction logInfo(logLevel, message, ...args) {\n    if (['debug', 'info'].includes(logLevel)) {\n        console.info(`[OAuth2Interceptor] ${message}`, ...args);\n    }\n}\n/**\n * Error logging\n */\nfunction logError(logLevel, message, error) {\n    if (logLevel !== 'none') {\n        console.error(`[OAuth2Interceptor] ${message}`, error);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLmludGVyY2VwdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9pbnRlcmNlcHRvcnMvb2F1dGgyLmludGVyY2VwdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBELE9BQU8sRUFFTCxXQUFXLEVBSVgsWUFBWSxFQUNaLFdBQVcsRUFDWixNQUFNLHNCQUFzQixDQUFDO0FBQzlCLE9BQU8sRUFBYyxVQUFVLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQy9ELE9BQU8sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdyRSxPQUFPLEVBQUUsbUJBQW1CLEVBQWtCLE1BQU0sOEJBQThCLENBQUM7QUFDbkYsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDcEUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFFMUUsaUNBQWlDO0FBQ2pDLElBQUksWUFBWSxHQUFHLEtBQUssQ0FBQztBQUN6QixJQUFJLG1CQUFtQixHQUF5QixJQUFJLGVBQWUsQ0FBTSxJQUFJLENBQUMsQ0FBQztBQUUvRTs7O0dBR0c7QUFDSCxNQUFNLENBQUMsTUFBTSxtQkFBbUIsR0FBc0IsQ0FDcEQsT0FBeUIsRUFDekIsSUFBbUIsRUFDUyxFQUFFO0lBQzlCLE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUN2QyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUMzQyxNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUVwRCxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQztJ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b3JlJztcclxuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQge1xyXG4gIEh0dHBJbnRlcmNlcHRvckZuLFxyXG4gIEh0dHBSZXF1ZXN0LFxyXG4gIEh0dHBIYW5kbGVyRm4sXHJcbiAgSHR0cEV2ZW50LFxyXG4gIEh0dHBFcnJvclJlc3BvbnNlLFxyXG4gIEh0dHBSZXNwb25zZSxcclxuICBIdHRwSGVhZGVyc1xyXG59IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGhyb3dFcnJvciwgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGNhdGNoRXJyb3IsIHN3aXRjaE1hcCwgZmlsdGVyLCB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfU1RPUkFHRV9LRVlTLCBPQXV0aDJMb2dMZXZlbCB9IGZyb20gJy4uL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfQ09ORklHX1RPS0VOIH0gZnJvbSAnLi4vdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4nO1xyXG5pbXBvcnQgeyBPQXV0aDJTdG9yYWdlU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL29hdXRoMi1zdG9yYWdlLnNlcnZpY2UnO1xyXG5cclxuLy8gR2xvYmFsIHN0YXRlIGZvciB0b2tlbiByZWZyZXNoXHJcbmxldCBpc1JlZnJlc2hpbmcgPSBmYWxzZTtcclxubGV0IHJlZnJlc2hUb2tlblN1YmplY3Q6IEJlaGF2aW9yU3ViamVjdDxhbnk+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxhbnk+KG51bGwpO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBIVFRQIEludGVyY2VwdG9yIEZ1bmN0aW9uXHJcbiAqIEF1dG9tYXRpY2FsbHkgYWRkcyBCZWFyZXIgdG9rZW5zIHRvIHJlcXVlc3RzIGFuZCBoYW5kbGVzIHRva2VuIHJlZnJlc2hcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJJbnRlcmNlcHRvckZuOiBIdHRwSW50ZXJjZXB0b3JGbiA9IChcclxuICByZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LFxyXG4gIG5leHQ6IEh0dHBIYW5kbGVyRm5cclxuKTogT2JzZXJ2YWJsZTxIdHRwRXZlbnQ8YW55Pj4gPT4ge1xyXG4gIGNvbnN0IHBsYXRmb3JtSWQgPSBpbmplY3QoUExBVEZPUk1fSUQpO1xyXG4gIGNvbnN0IGNvbmZpZyA9IGluamVjdChPQVVUSDJfQ09ORklHX1RPS0VOKTtcclxuICBjb25zdCBzdG9yYWdlU2VydmljZSA9IGluamVjdChPQXV0aDJTdG9yYWdlU2VydmljZSk7XHJcbiAgXHJcbiAgY29uc3QgbG9nTGV2ZWwgPSBjb25maWcubG9nTGV2ZWwgfHwgJ3dhcm4nO1xyXG5cclxuICAvLyBPbmx5IGludGVyY2VwdCByZXF1ZXN0cyB0aGF0IHNob3VsZCBoYXZlIE9BdXRoMiB0b2tlbnNcclxuICBpZiAoIXNob3VsZEludGVyY2VwdFJlcXVlc3QocmVxdWVzdCwgY29uZmlnKSkge1xyXG4gICAgcmV0dXJuIG5leHQocmVxdWVzdCk7XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgYWNjZXNzIHRva2VuIGRpcmVjdGx5IGZyb20gc3RvcmFnZSB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmN5XHJcbiAgbGV0IGFjY2Vzc1Rva2VuID0gc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLkFDQ0VTU19UT0tFTik7XHJcbiAgY29uc3QgaGFzVmFsaWRUb2tlbiA9IGFjY2Vzc1Rva2VuICYmIGlzVG9rZW5WYWxpZChzdG9yYWdlU2VydmljZSk7XHJcbiAgXHJcbiAgbG9nRGVidWcobG9nTGV2ZWwsICdBY2Nlc3MgdG9rZW4gcmV0cmlldmVkOicsIGFjY2Vzc1Rva2VuID8gKGhhc1ZhbGlkVG9rZW4gPyAnVmFsaWQnIDogJ0V4cGlyZWQnKSA6ICdOb3QgZm91bmQnKTtcclxuICBsb2dEZWJ1Zyhsb2dMZXZlbCwgJ1JlcXVlc3QgVVJMOicsIHJlcXVlc3QudXJsKTtcclxuICBcclxuICAvLyBBbHdheXMgYWRkIHRva2VuIGlmIGF2YWlsYWJsZSwgZXZlbiBpZiBleHBpcmVkIChzZXJ2ZXIgd2lsbCByZWplY3QgYW5kIHdlJ2xsIHJlZnJlc2gpXHJcbiAgaWYgKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICByZXF1ZXN0ID0gYWRkVG9rZW5Ub1JlcXVlc3QocmVxdWVzdCwgYWNjZXNzVG9rZW4pO1xyXG4gICAgbG9nRGVidWcobG9nTGV2ZWwsICdBdXRob3JpemF0aW9uIGhlYWRlciBhZGRlZCB0byByZXF1ZXN0Jyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGxvZ0RlYnVnKGxvZ0xldmVsLCAnTm8gYWNjZXNzIHRva2VuIGF2YWlsYWJsZSwgcHJvY2VlZGluZyB3aXRob3V0IEF1dGhvcml6YXRpb24gaGVhZGVyJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmV4dChyZXF1ZXN0KS5waXBlKFxyXG4gICAgY2F0Y2hFcnJvcigoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIC8vIEhhbmRsZSA0MDEgVW5hdXRob3JpemVkIGVycm9ycyAtIGF0dGVtcHQgcmVmcmVzaCBpZiB3ZSBoYXZlIGFjY2VzcyB0b2tlbiBPUiByZWZyZXNoIHRva2VuXHJcbiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHN0b3JhZ2VTZXJ2aWNlLmdldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5SRUZSRVNIX1RPS0VOKTtcclxuICAgICAgICBpZiAoYWNjZXNzVG9rZW4gfHwgcmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgICBsb2dJbmZvKGxvZ0xldmVsLCAnNDAxIGVycm9yIGRldGVjdGVkLCBhdHRlbXB0aW5nIHRva2VuIHJlZnJlc2gnKTtcclxuICAgICAgICAgIGxvZ0RlYnVnKGxvZ0xldmVsLCAnSGFzIGFjY2VzcyB0b2tlbjonLCAhIWFjY2Vzc1Rva2VuLCAnSGFzIHJlZnJlc2ggdG9rZW46JywgISFyZWZyZXNoVG9rZW4pO1xyXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZTQwMUVycm9yKHJlcXVlc3QsIG5leHQsIGNvbmZpZywgc3RvcmFnZVNlcnZpY2UsIGxvZ0xldmVsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nSW5mbyhsb2dMZXZlbCwgJzQwMSBlcnJvciBidXQgbm8gdG9rZW5zIGF2YWlsYWJsZSBmb3IgcmVmcmVzaCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHRocm93RXJyb3IoKCkgPT4gZXJyb3IpO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHRva2VuIGlzIHZhbGlkIChub3QgZXhwaXJlZClcclxuICovXHJcbmZ1bmN0aW9uIGlzVG9rZW5WYWxpZChzdG9yYWdlU2VydmljZTogT0F1dGgyU3RvcmFnZVNlcnZpY2UpOiBib29sZWFuIHtcclxuICBjb25zdCBleHBpcmVzQXRTdHIgPSBzdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fRVhQSVJFU19BVCk7XHJcbiAgaWYgKCFleHBpcmVzQXRTdHIpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgY29uc3QgZXhwaXJlc0F0ID0gcGFyc2VJbnQoZXhwaXJlc0F0U3RyLCAxMCk7XHJcbiAgcmV0dXJuIERhdGUubm93KCkgPCBleHBpcmVzQXQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiByZXF1ZXN0IHNob3VsZCBiZSBpbnRlcmNlcHRlZFxyXG4gKi9cclxuZnVuY3Rpb24gc2hvdWxkSW50ZXJjZXB0UmVxdWVzdChyZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LCBjb25maWc6IE9BdXRoMkNvbmZpZyk6IGJvb2xlYW4ge1xyXG4gIC8vIEV4Y2x1ZGUgdG9rZW4gcmVmcmVzaCByZXF1ZXN0cyB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmN5XHJcbiAgaWYgKHJlcXVlc3QudXJsID09PSBjb25maWcudG9rZW5FbmRwb2ludCkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICAvLyBFeGNsdWRlIHJldm9rZSByZXF1ZXN0c1xyXG4gIGlmIChjb25maWcucmV2b2tlRW5kcG9pbnQgJiYgcmVxdWVzdC51cmwgPT09IGNvbmZpZy5yZXZva2VFbmRwb2ludCkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICAvLyBZb3UgY2FuIGN1c3RvbWl6ZSB0aGlzIGxvZ2ljIGJhc2VkIG9uIHlvdXIgbmVlZHNcclxuICAvLyBGb3IgZXhhbXBsZSwgb25seSBpbnRlcmNlcHQgcmVxdWVzdHMgdG8gc3BlY2lmaWMgZG9tYWlucyBvciBwYXRoc1xyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIEJlYXJlciB0b2tlbiB0byByZXF1ZXN0IGhlYWRlcnNcclxuICovXHJcbmZ1bmN0aW9uIGFkZFRva2VuVG9SZXF1ZXN0KHJlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sIHRva2VuOiBzdHJpbmcpOiBIdHRwUmVxdWVzdDxhbnk+IHtcclxuICByZXR1cm4gcmVxdWVzdC5jbG9uZSh7XHJcbiAgICBzZXRIZWFkZXJzOiB7XHJcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gXHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgNDAxIFVuYXV0aG9yaXplZCBlcnJvcnMgYnkgYXR0ZW1wdGluZyB0b2tlbiByZWZyZXNoXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGU0MDFFcnJvcihcclxuICByZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LFxyXG4gIG5leHQ6IEh0dHBIYW5kbGVyRm4sXHJcbiAgY29uZmlnOiBPQXV0aDJDb25maWcsXHJcbiAgc3RvcmFnZVNlcnZpY2U6IE9BdXRoMlN0b3JhZ2VTZXJ2aWNlLFxyXG4gIGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbFxyXG4pOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxhbnk+PiB7XHJcbiAgaWYgKCFpc1JlZnJlc2hpbmcpIHtcclxuICAgIGlzUmVmcmVzaGluZyA9IHRydWU7XHJcbiAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQobnVsbCk7XHJcblxyXG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4pO1xyXG4gICAgaWYgKCFyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgaXNSZWZyZXNoaW5nID0gZmFsc2U7XHJcbiAgICAgIGxvZ0luZm8obG9nTGV2ZWwsICdObyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZScpO1xyXG4gICAgICByZXR1cm4gdGhyb3dFcnJvcigoKSA9PiBuZXcgRXJyb3IoJ05vIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlJykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENyZWF0ZSB0b2tlbiByZWZyZXNoIHJlcXVlc3QgZGlyZWN0bHkgdXNpbmcgSHR0cFJlcXVlc3RcclxuICAgIGNvbnN0IHRva2VuUmVxdWVzdERhdGEgPSB7XHJcbiAgICAgIGdyYW50X3R5cGU6ICdyZWZyZXNoX3Rva2VuJyxcclxuICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuLFxyXG4gICAgICBjbGllbnRfaWQ6IGNvbmZpZy5jbGllbnRJZFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ29udmVydCB0byBVUkwtZW5jb2RlZCBmb3JtIGRhdGEgYXMgcGVyIE9BdXRoIDIuMCBzdGFuZGFyZFxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcbiAgICBPYmplY3QuZW50cmllcyh0b2tlblJlcXVlc3REYXRhKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCByZWZyZXNoUmVxdWVzdCA9IG5ldyBIdHRwUmVxdWVzdCgnUE9TVCcsIGNvbmZpZy50b2tlbkVuZHBvaW50LCBmb3JtRGF0YS50b1N0cmluZygpLCB7XHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBuZXh0KHJlZnJlc2hSZXF1ZXN0KS5waXBlKFxyXG4gICAgICBmaWx0ZXIoKGV2ZW50OiBIdHRwRXZlbnQ8YW55PikgPT4gZXZlbnQgaW5zdGFuY2VvZiBIdHRwUmVzcG9uc2UpLFxyXG4gICAgICBzd2l0Y2hNYXAoKGV2ZW50OiBIdHRwUmVzcG9uc2U8YW55PikgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRva2VuUmVzcG9uc2UgPSBldmVudC5ib2R5O1xyXG4gICAgICAgIGlzUmVmcmVzaGluZyA9IGZhbHNlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0b2tlblJlc3BvbnNlPy5hY2Nlc3NfdG9rZW4pIHtcclxuICAgICAgICAgIC8vIFN0b3JlIG5ldyB0b2tlbnNcclxuICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5BQ0NFU1NfVE9LRU4sIHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuKTtcclxuICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULCAoRGF0ZS5ub3coKSArICh0b2tlblJlc3BvbnNlLmV4cGlyZXNfaW4gKiAxMDAwKSkudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICBpZiAodG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuKSB7XHJcbiAgICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5SRUZSRVNIX1RPS0VOLCB0b2tlblJlc3BvbnNlLnJlZnJlc2hfdG9rZW4pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQodG9rZW5SZXNwb25zZS5hY2Nlc3NfdG9rZW4pO1xyXG4gICAgICAgICAgbG9nSW5mbyhsb2dMZXZlbCwgJ1Rva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHksIHJldHJ5aW5nIG9yaWdpbmFsIHJlcXVlc3QnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gUmV0cnkgdGhlIG9yaWdpbmFsIHJlcXVlc3Qgd2l0aCBuZXcgdG9rZW5cclxuICAgICAgICAgIHJldHVybiBuZXh0KGFkZFRva2VuVG9SZXF1ZXN0KHJlcXVlc3QsIHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWNjZXNzIHRva2VuIGluIHJlZnJlc2ggcmVzcG9uc2UnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pLFxyXG4gICAgICBjYXRjaEVycm9yKGVycm9yID0+IHtcclxuICAgICAgICBpc1JlZnJlc2hpbmcgPSBmYWxzZTtcclxuICAgICAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQobnVsbCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9nRXJyb3IobG9nTGV2ZWwsICdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhbiBhdXRoZW50aWNhdGlvbiBlcnJvciAoaW52YWxpZCByZWZyZXNoIHRva2VuKVxyXG4gICAgICAgIGlmIChlcnJvcj8uc3RhdHVzID09PSA0MDAgfHwgZXJyb3I/LnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICBsb2dJbmZvKGxvZ0xldmVsLCAnUmVmcmVzaCB0b2tlbiBpcyBpbnZhbGlkLCBjbGVhcmluZyB0b2tlbnMnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2xlYXIgYWxsIE9BdXRoMiB0b2tlbnMgZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICBzdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBPcHRpb25hbGx5IHJlZGlyZWN0IHRvIGxvZ2luIG9yIGVtaXQgYW4gZXZlbnRcclxuICAgICAgICAgIC8vIFRoaXMgZGVwZW5kcyBvbiB5b3VyIGFwcGxpY2F0aW9uJ3MgcmVxdWlyZW1lbnRzXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZ0luZm8obG9nTGV2ZWwsICdOZXR3b3JrL3NlcnZlciBlcnJvciwgbm90IGNsZWFyaW5nIHRva2VucycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhyb3dFcnJvcigoKSA9PiBlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBXYWl0IGZvciByZWZyZXNoIHRvIGNvbXBsZXRlLCB0aGVuIHJldHJ5IHJlcXVlc3RcclxuICAgIHJldHVybiByZWZyZXNoVG9rZW5TdWJqZWN0LnBpcGUoXHJcbiAgICAgIGZpbHRlcih0b2tlbiA9PiB0b2tlbiAhPSBudWxsKSxcclxuICAgICAgdGFrZSgxKSxcclxuICAgICAgc3dpdGNoTWFwKHRva2VuID0+IG5leHQoYWRkVG9rZW5Ub1JlcXVlc3QocmVxdWVzdCwgdG9rZW4pKSlcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRGVidWcgbG9nZ2luZ1xyXG4gKi9cclxuZnVuY3Rpb24gbG9nRGVidWcobG9nTGV2ZWw6IE9BdXRoMkxvZ0xldmVsLCBtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgaWYgKGxvZ0xldmVsID09PSAnZGVidWcnKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW09BdXRoMkludGVyY2VwdG9yXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogSW5mbyBsb2dnaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBsb2dJbmZvKGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbCwgbWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gIGlmIChbJ2RlYnVnJywgJ2luZm8nXS5pbmNsdWRlcyhsb2dMZXZlbCkpIHtcclxuICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMkludGVyY2VwdG9yXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRXJyb3IgbG9nZ2luZ1xyXG4gKi9cclxuZnVuY3Rpb24gbG9nRXJyb3IobG9nTGV2ZWw6IE9BdXRoMkxvZ0xldmVsLCBtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogYW55KTogdm9pZCB7XHJcbiAgaWYgKGxvZ0xldmVsICE9PSAnbm9uZScpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtPQXV0aDJJbnRlcmNlcHRvcl0gJHttZXNzYWdlfWAsIGVycm9yKTtcclxuICB9XHJcbn0iXX0=","customTransformCache":false,"dependencies":["@angular/core","@angular/common/http","rxjs","rxjs/operators","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/interceptors/oauth2.interceptor.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { inject, PLATFORM_ID } from '@angular/core';\nimport { HttpRequest, HttpResponse, HttpHeaders } from '@angular/common/http';\nimport { throwError, BehaviorSubject } from 'rxjs';\nimport { catchError, switchMap, filter, take } from 'rxjs/operators';\nimport { OAUTH2_STORAGE_KEYS } from '../models/oauth2-types.model';\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\nimport { OAuth2StorageService } from '../services/oauth2-storage.service';\n// Global state for token refresh\nlet isRefreshing = false;\nlet refreshTokenSubject = new BehaviorSubject(null);\n/**\n * OAuth2 HTTP Interceptor Function\n * Automatically adds Bearer tokens to requests and handles token refresh\n */\nexport const oauth2InterceptorFn = (request, next) => {\n    const platformId = inject(PLATFORM_ID);\n    const config = inject(OAUTH2_CONFIG_TOKEN);\n    const storageService = inject(OAuth2StorageService);\n    const logLevel = config.logLevel || 'warn';\n    // Only intercept requests that should have OAuth2 tokens\n    if (!shouldInterceptRequest(request, config)) {\n        return next(request);\n    }\n    // Get access token directly from storage to avoid circular dependency\n    let accessToken = storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\n    const hasValidToken = accessToken && isTokenValid(storageService);\n    logDebug(logLevel, 'Access token retrieved:', accessToken ? (hasValidToken ? 'Valid' : 'Expired') : 'Not found');\n    logDebug(logLevel, 'Request URL:', request.url);\n    // Always add token if available, even if expired (server will reject and we'll refresh)\n    if (accessToken) {\n        request = addTokenToRequest(request, accessToken);\n        logDebug(logLevel, 'Authorization header added to request');\n    }\n    else {\n        logDebug(logLevel, 'No access token available, proceeding without Authorization header');\n    }\n    return next(request).pipe(catchError((error) => {\n        // Handle 401 Unauthorized errors - attempt refresh if we have access token OR refresh token\n        if (error.status === 401) {\n            const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\n            if (accessToken || refreshToken) {\n                logInfo(logLevel, '401 error detected, attempting token refresh');\n                logDebug(logLevel, 'Has access token:', !!accessToken, 'Has refresh token:', !!refreshToken);\n                return handle401Error(request, next, config, storageService, logLevel);\n            }\n            else {\n                logInfo(logLevel, '401 error but no tokens available for refresh');\n            }\n        }\n        return throwError(() => error);\n    }));\n};\n/**\n * Check if token is valid (not expired)\n */\nfunction isTokenValid(storageService) {\n    const expiresAtStr = storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\n    if (!expiresAtStr) {\n        return false;\n    }\n    const expiresAt = parseInt(expiresAtStr, 10);\n    return Date.now() < expiresAt;\n}\n/**\n * Check if request should be intercepted\n */\nfunction shouldInterceptRequest(request, config) {\n    // Exclude token refresh requests to avoid circular dependency\n    if (request.url === config.tokenEndpoint) {\n        return false;\n    }\n    // Exclude revoke requests\n    if (config.revokeEndpoint && request.url === config.revokeEndpoint) {\n        return false;\n    }\n    // You can customize this logic based on your needs\n    // For example, only intercept requests to specific domains or paths\n    return true;\n}\n/**\n * Add Bearer token to request headers\n */\nfunction addTokenToRequest(request, token) {\n    return request.clone({\n        setHeaders: {\n            Authorization: `Bearer ${token}`\n        }\n    });\n}\n/**\n * Handle 401 Unauthorized errors by attempting token refresh\n */\nfunction handle401Error(request, next, config, storageService, logLevel) {\n    if (!isRefreshing) {\n        isRefreshing = true;\n        refreshTokenSubject.next(null);\n        const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\n        if (!refreshToken) {\n            isRefreshing = false;\n            logInfo(logLevel, 'No refresh token available');\n            return throwError(() => new Error('No refresh token available'));\n        }\n        // Create token refresh request directly using HttpRequest\n        const tokenRequestData = {\n            grant_type: 'refresh_token',\n            refresh_token: refreshToken,\n            client_id: config.clientId\n        };\n        // Convert to URL-encoded form data as per OAuth 2.0 standard\n        const formData = new URLSearchParams();\n        Object.entries(tokenRequestData).forEach(([key, value]) => {\n            if (value !== undefined) {\n                formData.append(key, value.toString());\n            }\n        });\n        const headers = new HttpHeaders({\n            'Content-Type': 'application/x-www-form-urlencoded'\n        });\n        const refreshRequest = new HttpRequest('POST', config.tokenEndpoint, formData.toString(), {\n            headers: headers\n        });\n        return next(refreshRequest).pipe(filter((event) => event instanceof HttpResponse), switchMap((event) => {\n            const tokenResponse = event.body;\n            isRefreshing = false;\n            if (tokenResponse?.access_token) {\n                // Store new tokens\n                storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenResponse.access_token);\n                storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, (Date.now() + (tokenResponse.expires_in * 1000)).toString());\n                if (tokenResponse.refresh_token) {\n                    storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenResponse.refresh_token);\n                }\n                refreshTokenSubject.next(tokenResponse.access_token);\n                logInfo(logLevel, 'Token refreshed successfully, retrying original request');\n                // Retry the original request with new token\n                return next(addTokenToRequest(request, tokenResponse.access_token));\n            }\n            else {\n                throw new Error('No access token in refresh response');\n            }\n        }), catchError(error => {\n            isRefreshing = false;\n            refreshTokenSubject.next(null);\n            logError(logLevel, 'Token refresh failed:', error);\n            // Check if it's an authentication error (invalid refresh token)\n            if (error?.status === 400 || error?.status === 401) {\n                logInfo(logLevel, 'Refresh token is invalid, clearing tokens');\n                // Clear all OAuth2 tokens from storage\n                storageService.clearAll();\n                // Optionally redirect to login or emit an event\n                // This depends on your application's requirements\n            }\n            else {\n                logInfo(logLevel, 'Network/server error, not clearing tokens');\n            }\n            return throwError(() => error);\n        }));\n    }\n    else {\n        // Wait for refresh to complete, then retry request\n        return refreshTokenSubject.pipe(filter(token => token != null), take(1), switchMap(token => next(addTokenToRequest(request, token))));\n    }\n}\n/**\n * Debug logging\n */\nfunction logDebug(logLevel, message, ...args) {\n    if (logLevel === 'debug') {\n        console.log(`[OAuth2Interceptor] ${message}`, ...args);\n    }\n}\n/**\n * Info logging\n */\nfunction logInfo(logLevel, message, ...args) {\n    if (['debug', 'info'].includes(logLevel)) {\n        console.info(`[OAuth2Interceptor] ${message}`, ...args);\n    }\n}\n/**\n * Error logging\n */\nfunction logError(logLevel, message, error) {\n    if (logLevel !== 'none') {\n        console.error(`[OAuth2Interceptor] ${message}`, error);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLmludGVyY2VwdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9pbnRlcmNlcHRvcnMvb2F1dGgyLmludGVyY2VwdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRXBELE9BQU8sRUFFTCxXQUFXLEVBSVgsWUFBWSxFQUNaLFdBQVcsRUFDWixNQUFNLHNCQUFzQixDQUFDO0FBQzlCLE9BQU8sRUFBYyxVQUFVLEVBQUUsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQy9ELE9BQU8sRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUdyRSxPQUFPLEVBQUUsbUJBQW1CLEVBQWtCLE1BQU0sOEJBQThCLENBQUM7QUFDbkYsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDcEUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7QUFFMUUsaUNBQWlDO0FBQ2pDLElBQUksWUFBWSxHQUFHLEtBQUssQ0FBQztBQUN6QixJQUFJLG1CQUFtQixHQUF5QixJQUFJLGVBQWUsQ0FBTSxJQUFJLENBQUMsQ0FBQztBQUUvRTs7O0dBR0c7QUFDSCxNQUFNLENBQUMsTUFBTSxtQkFBbUIsR0FBc0IsQ0FDcEQsT0FBeUIsRUFDekIsSUFBbUIsRUFDUyxFQUFFO0lBQzlCLE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztJQUN2QyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUMzQyxNQUFNLGNBQWMsR0FBRyxNQUFNLENBQUMsb0JBQW9CLENBQUMsQ0FBQztJQUVwRCxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsUUFBUSxJQUFJLE1BQU0sQ0FBQztJ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b3JlJztcclxuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQge1xyXG4gIEh0dHBJbnRlcmNlcHRvckZuLFxyXG4gIEh0dHBSZXF1ZXN0LFxyXG4gIEh0dHBIYW5kbGVyRm4sXHJcbiAgSHR0cEV2ZW50LFxyXG4gIEh0dHBFcnJvclJlc3BvbnNlLFxyXG4gIEh0dHBSZXNwb25zZSxcclxuICBIdHRwSGVhZGVyc1xyXG59IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT2JzZXJ2YWJsZSwgdGhyb3dFcnJvciwgQmVoYXZpb3JTdWJqZWN0IH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IGNhdGNoRXJyb3IsIHN3aXRjaE1hcCwgZmlsdGVyLCB0YWtlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi4vbW9kZWxzL29hdXRoMi1jb25maWcubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfU1RPUkFHRV9LRVlTLCBPQXV0aDJMb2dMZXZlbCB9IGZyb20gJy4uL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5pbXBvcnQgeyBPQVVUSDJfQ09ORklHX1RPS0VOIH0gZnJvbSAnLi4vdG9rZW5zL29hdXRoMi1jb25maWcudG9rZW4nO1xyXG5pbXBvcnQgeyBPQXV0aDJTdG9yYWdlU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL29hdXRoMi1zdG9yYWdlLnNlcnZpY2UnO1xyXG5cclxuLy8gR2xvYmFsIHN0YXRlIGZvciB0b2tlbiByZWZyZXNoXHJcbmxldCBpc1JlZnJlc2hpbmcgPSBmYWxzZTtcclxubGV0IHJlZnJlc2hUb2tlblN1YmplY3Q6IEJlaGF2aW9yU3ViamVjdDxhbnk+ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxhbnk+KG51bGwpO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBIVFRQIEludGVyY2VwdG9yIEZ1bmN0aW9uXHJcbiAqIEF1dG9tYXRpY2FsbHkgYWRkcyBCZWFyZXIgdG9rZW5zIHRvIHJlcXVlc3RzIGFuZCBoYW5kbGVzIHRva2VuIHJlZnJlc2hcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJJbnRlcmNlcHRvckZuOiBIdHRwSW50ZXJjZXB0b3JGbiA9IChcclxuICByZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LFxyXG4gIG5leHQ6IEh0dHBIYW5kbGVyRm5cclxuKTogT2JzZXJ2YWJsZTxIdHRwRXZlbnQ8YW55Pj4gPT4ge1xyXG4gIGNvbnN0IHBsYXRmb3JtSWQgPSBpbmplY3QoUExBVEZPUk1fSUQpO1xyXG4gIGNvbnN0IGNvbmZpZyA9IGluamVjdChPQVVUSDJfQ09ORklHX1RPS0VOKTtcclxuICBjb25zdCBzdG9yYWdlU2VydmljZSA9IGluamVjdChPQXV0aDJTdG9yYWdlU2VydmljZSk7XHJcbiAgXHJcbiAgY29uc3QgbG9nTGV2ZWwgPSBjb25maWcubG9nTGV2ZWwgfHwgJ3dhcm4nO1xyXG5cclxuICAvLyBPbmx5IGludGVyY2VwdCByZXF1ZXN0cyB0aGF0IHNob3VsZCBoYXZlIE9BdXRoMiB0b2tlbnNcclxuICBpZiAoIXNob3VsZEludGVyY2VwdFJlcXVlc3QocmVxdWVzdCwgY29uZmlnKSkge1xyXG4gICAgcmV0dXJuIG5leHQocmVxdWVzdCk7XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgYWNjZXNzIHRva2VuIGRpcmVjdGx5IGZyb20gc3RvcmFnZSB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmN5XHJcbiAgbGV0IGFjY2Vzc1Rva2VuID0gc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLkFDQ0VTU19UT0tFTik7XHJcbiAgY29uc3QgaGFzVmFsaWRUb2tlbiA9IGFjY2Vzc1Rva2VuICYmIGlzVG9rZW5WYWxpZChzdG9yYWdlU2VydmljZSk7XHJcbiAgXHJcbiAgbG9nRGVidWcobG9nTGV2ZWwsICdBY2Nlc3MgdG9rZW4gcmV0cmlldmVkOicsIGFjY2Vzc1Rva2VuID8gKGhhc1ZhbGlkVG9rZW4gPyAnVmFsaWQnIDogJ0V4cGlyZWQnKSA6ICdOb3QgZm91bmQnKTtcclxuICBsb2dEZWJ1Zyhsb2dMZXZlbCwgJ1JlcXVlc3QgVVJMOicsIHJlcXVlc3QudXJsKTtcclxuICBcclxuICAvLyBBbHdheXMgYWRkIHRva2VuIGlmIGF2YWlsYWJsZSwgZXZlbiBpZiBleHBpcmVkIChzZXJ2ZXIgd2lsbCByZWplY3QgYW5kIHdlJ2xsIHJlZnJlc2gpXHJcbiAgaWYgKGFjY2Vzc1Rva2VuKSB7XHJcbiAgICByZXF1ZXN0ID0gYWRkVG9rZW5Ub1JlcXVlc3QocmVxdWVzdCwgYWNjZXNzVG9rZW4pO1xyXG4gICAgbG9nRGVidWcobG9nTGV2ZWwsICdBdXRob3JpemF0aW9uIGhlYWRlciBhZGRlZCB0byByZXF1ZXN0Jyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGxvZ0RlYnVnKGxvZ0xldmVsLCAnTm8gYWNjZXNzIHRva2VuIGF2YWlsYWJsZSwgcHJvY2VlZGluZyB3aXRob3V0IEF1dGhvcml6YXRpb24gaGVhZGVyJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gbmV4dChyZXF1ZXN0KS5waXBlKFxyXG4gICAgY2F0Y2hFcnJvcigoZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKSA9PiB7XHJcbiAgICAgIC8vIEhhbmRsZSA0MDEgVW5hdXRob3JpemVkIGVycm9ycyAtIGF0dGVtcHQgcmVmcmVzaCBpZiB3ZSBoYXZlIGFjY2VzcyB0b2tlbiBPUiByZWZyZXNoIHRva2VuXHJcbiAgICAgIGlmIChlcnJvci5zdGF0dXMgPT09IDQwMSkge1xyXG4gICAgICAgIGNvbnN0IHJlZnJlc2hUb2tlbiA9IHN0b3JhZ2VTZXJ2aWNlLmdldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5SRUZSRVNIX1RPS0VOKTtcclxuICAgICAgICBpZiAoYWNjZXNzVG9rZW4gfHwgcmVmcmVzaFRva2VuKSB7XHJcbiAgICAgICAgICBsb2dJbmZvKGxvZ0xldmVsLCAnNDAxIGVycm9yIGRldGVjdGVkLCBhdHRlbXB0aW5nIHRva2VuIHJlZnJlc2gnKTtcclxuICAgICAgICAgIGxvZ0RlYnVnKGxvZ0xldmVsLCAnSGFzIGFjY2VzcyB0b2tlbjonLCAhIWFjY2Vzc1Rva2VuLCAnSGFzIHJlZnJlc2ggdG9rZW46JywgISFyZWZyZXNoVG9rZW4pO1xyXG4gICAgICAgICAgcmV0dXJuIGhhbmRsZTQwMUVycm9yKHJlcXVlc3QsIG5leHQsIGNvbmZpZywgc3RvcmFnZVNlcnZpY2UsIGxvZ0xldmVsKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9nSW5mbyhsb2dMZXZlbCwgJzQwMSBlcnJvciBidXQgbm8gdG9rZW5zIGF2YWlsYWJsZSBmb3IgcmVmcmVzaCcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHRocm93RXJyb3IoKCkgPT4gZXJyb3IpO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIHRva2VuIGlzIHZhbGlkIChub3QgZXhwaXJlZClcclxuICovXHJcbmZ1bmN0aW9uIGlzVG9rZW5WYWxpZChzdG9yYWdlU2VydmljZTogT0F1dGgyU3RvcmFnZVNlcnZpY2UpOiBib29sZWFuIHtcclxuICBjb25zdCBleHBpcmVzQXRTdHIgPSBzdG9yYWdlU2VydmljZS5nZXRJdGVtKE9BVVRIMl9TVE9SQUdFX0tFWVMuVE9LRU5fRVhQSVJFU19BVCk7XHJcbiAgaWYgKCFleHBpcmVzQXRTdHIpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgXHJcbiAgY29uc3QgZXhwaXJlc0F0ID0gcGFyc2VJbnQoZXhwaXJlc0F0U3RyLCAxMCk7XHJcbiAgcmV0dXJuIERhdGUubm93KCkgPCBleHBpcmVzQXQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBpZiByZXF1ZXN0IHNob3VsZCBiZSBpbnRlcmNlcHRlZFxyXG4gKi9cclxuZnVuY3Rpb24gc2hvdWxkSW50ZXJjZXB0UmVxdWVzdChyZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LCBjb25maWc6IE9BdXRoMkNvbmZpZyk6IGJvb2xlYW4ge1xyXG4gIC8vIEV4Y2x1ZGUgdG9rZW4gcmVmcmVzaCByZXF1ZXN0cyB0byBhdm9pZCBjaXJjdWxhciBkZXBlbmRlbmN5XHJcbiAgaWYgKHJlcXVlc3QudXJsID09PSBjb25maWcudG9rZW5FbmRwb2ludCkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICAvLyBFeGNsdWRlIHJldm9rZSByZXF1ZXN0c1xyXG4gIGlmIChjb25maWcucmV2b2tlRW5kcG9pbnQgJiYgcmVxdWVzdC51cmwgPT09IGNvbmZpZy5yZXZva2VFbmRwb2ludCkge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuICBcclxuICAvLyBZb3UgY2FuIGN1c3RvbWl6ZSB0aGlzIGxvZ2ljIGJhc2VkIG9uIHlvdXIgbmVlZHNcclxuICAvLyBGb3IgZXhhbXBsZSwgb25seSBpbnRlcmNlcHQgcmVxdWVzdHMgdG8gc3BlY2lmaWMgZG9tYWlucyBvciBwYXRoc1xyXG4gIHJldHVybiB0cnVlO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIEJlYXJlciB0b2tlbiB0byByZXF1ZXN0IGhlYWRlcnNcclxuICovXHJcbmZ1bmN0aW9uIGFkZFRva2VuVG9SZXF1ZXN0KHJlcXVlc3Q6IEh0dHBSZXF1ZXN0PGFueT4sIHRva2VuOiBzdHJpbmcpOiBIdHRwUmVxdWVzdDxhbnk+IHtcclxuICByZXR1cm4gcmVxdWVzdC5jbG9uZSh7XHJcbiAgICBzZXRIZWFkZXJzOiB7XHJcbiAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbn1gXHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgNDAxIFVuYXV0aG9yaXplZCBlcnJvcnMgYnkgYXR0ZW1wdGluZyB0b2tlbiByZWZyZXNoXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGU0MDFFcnJvcihcclxuICByZXF1ZXN0OiBIdHRwUmVxdWVzdDxhbnk+LFxyXG4gIG5leHQ6IEh0dHBIYW5kbGVyRm4sXHJcbiAgY29uZmlnOiBPQXV0aDJDb25maWcsXHJcbiAgc3RvcmFnZVNlcnZpY2U6IE9BdXRoMlN0b3JhZ2VTZXJ2aWNlLFxyXG4gIGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbFxyXG4pOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxhbnk+PiB7XHJcbiAgaWYgKCFpc1JlZnJlc2hpbmcpIHtcclxuICAgIGlzUmVmcmVzaGluZyA9IHRydWU7XHJcbiAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQobnVsbCk7XHJcblxyXG4gICAgY29uc3QgcmVmcmVzaFRva2VuID0gc3RvcmFnZVNlcnZpY2UuZ2V0SXRlbShPQVVUSDJfU1RPUkFHRV9LRVlTLlJFRlJFU0hfVE9LRU4pO1xyXG4gICAgaWYgKCFyZWZyZXNoVG9rZW4pIHtcclxuICAgICAgaXNSZWZyZXNoaW5nID0gZmFsc2U7XHJcbiAgICAgIGxvZ0luZm8obG9nTGV2ZWwsICdObyByZWZyZXNoIHRva2VuIGF2YWlsYWJsZScpO1xyXG4gICAgICByZXR1cm4gdGhyb3dFcnJvcigoKSA9PiBuZXcgRXJyb3IoJ05vIHJlZnJlc2ggdG9rZW4gYXZhaWxhYmxlJykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIENyZWF0ZSB0b2tlbiByZWZyZXNoIHJlcXVlc3QgZGlyZWN0bHkgdXNpbmcgSHR0cFJlcXVlc3RcclxuICAgIGNvbnN0IHRva2VuUmVxdWVzdERhdGEgPSB7XHJcbiAgICAgIGdyYW50X3R5cGU6ICdyZWZyZXNoX3Rva2VuJyxcclxuICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuLFxyXG4gICAgICBjbGllbnRfaWQ6IGNvbmZpZy5jbGllbnRJZFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gQ29udmVydCB0byBVUkwtZW5jb2RlZCBmb3JtIGRhdGEgYXMgcGVyIE9BdXRoIDIuMCBzdGFuZGFyZFxyXG4gICAgY29uc3QgZm9ybURhdGEgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XHJcbiAgICBPYmplY3QuZW50cmllcyh0b2tlblJlcXVlc3REYXRhKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcclxuICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoa2V5LCB2YWx1ZS50b1N0cmluZygpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnN0IGhlYWRlcnMgPSBuZXcgSHR0cEhlYWRlcnMoe1xyXG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCByZWZyZXNoUmVxdWVzdCA9IG5ldyBIdHRwUmVxdWVzdCgnUE9TVCcsIGNvbmZpZy50b2tlbkVuZHBvaW50LCBmb3JtRGF0YS50b1N0cmluZygpLCB7XHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlcnNcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBuZXh0KHJlZnJlc2hSZXF1ZXN0KS5waXBlKFxyXG4gICAgICBmaWx0ZXIoKGV2ZW50OiBIdHRwRXZlbnQ8YW55PikgPT4gZXZlbnQgaW5zdGFuY2VvZiBIdHRwUmVzcG9uc2UpLFxyXG4gICAgICBzd2l0Y2hNYXAoKGV2ZW50OiBIdHRwUmVzcG9uc2U8YW55PikgPT4ge1xyXG4gICAgICAgIGNvbnN0IHRva2VuUmVzcG9uc2UgPSBldmVudC5ib2R5O1xyXG4gICAgICAgIGlzUmVmcmVzaGluZyA9IGZhbHNlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh0b2tlblJlc3BvbnNlPy5hY2Nlc3NfdG9rZW4pIHtcclxuICAgICAgICAgIC8vIFN0b3JlIG5ldyB0b2tlbnNcclxuICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5BQ0NFU1NfVE9LRU4sIHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuKTtcclxuICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5UT0tFTl9FWFBJUkVTX0FULCAoRGF0ZS5ub3coKSArICh0b2tlblJlc3BvbnNlLmV4cGlyZXNfaW4gKiAxMDAwKSkudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICBpZiAodG9rZW5SZXNwb25zZS5yZWZyZXNoX3Rva2VuKSB7XHJcbiAgICAgICAgICAgIHN0b3JhZ2VTZXJ2aWNlLnNldEl0ZW0oT0FVVEgyX1NUT1JBR0VfS0VZUy5SRUZSRVNIX1RPS0VOLCB0b2tlblJlc3BvbnNlLnJlZnJlc2hfdG9rZW4pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQodG9rZW5SZXNwb25zZS5hY2Nlc3NfdG9rZW4pO1xyXG4gICAgICAgICAgbG9nSW5mbyhsb2dMZXZlbCwgJ1Rva2VuIHJlZnJlc2hlZCBzdWNjZXNzZnVsbHksIHJldHJ5aW5nIG9yaWdpbmFsIHJlcXVlc3QnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gUmV0cnkgdGhlIG9yaWdpbmFsIHJlcXVlc3Qgd2l0aCBuZXcgdG9rZW5cclxuICAgICAgICAgIHJldHVybiBuZXh0KGFkZFRva2VuVG9SZXF1ZXN0KHJlcXVlc3QsIHRva2VuUmVzcG9uc2UuYWNjZXNzX3Rva2VuKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWNjZXNzIHRva2VuIGluIHJlZnJlc2ggcmVzcG9uc2UnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pLFxyXG4gICAgICBjYXRjaEVycm9yKGVycm9yID0+IHtcclxuICAgICAgICBpc1JlZnJlc2hpbmcgPSBmYWxzZTtcclxuICAgICAgICByZWZyZXNoVG9rZW5TdWJqZWN0Lm5leHQobnVsbCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9nRXJyb3IobG9nTGV2ZWwsICdUb2tlbiByZWZyZXNoIGZhaWxlZDonLCBlcnJvcik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhbiBhdXRoZW50aWNhdGlvbiBlcnJvciAoaW52YWxpZCByZWZyZXNoIHRva2VuKVxyXG4gICAgICAgIGlmIChlcnJvcj8uc3RhdHVzID09PSA0MDAgfHwgZXJyb3I/LnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICBsb2dJbmZvKGxvZ0xldmVsLCAnUmVmcmVzaCB0b2tlbiBpcyBpbnZhbGlkLCBjbGVhcmluZyB0b2tlbnMnKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ2xlYXIgYWxsIE9BdXRoMiB0b2tlbnMgZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICBzdG9yYWdlU2VydmljZS5jbGVhckFsbCgpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBPcHRpb25hbGx5IHJlZGlyZWN0IHRvIGxvZ2luIG9yIGVtaXQgYW4gZXZlbnRcclxuICAgICAgICAgIC8vIFRoaXMgZGVwZW5kcyBvbiB5b3VyIGFwcGxpY2F0aW9uJ3MgcmVxdWlyZW1lbnRzXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvZ0luZm8obG9nTGV2ZWwsICdOZXR3b3JrL3NlcnZlciBlcnJvciwgbm90IGNsZWFyaW5nIHRva2VucycpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhyb3dFcnJvcigoKSA9PiBlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBXYWl0IGZvciByZWZyZXNoIHRvIGNvbXBsZXRlLCB0aGVuIHJldHJ5IHJlcXVlc3RcclxuICAgIHJldHVybiByZWZyZXNoVG9rZW5TdWJqZWN0LnBpcGUoXHJcbiAgICAgIGZpbHRlcih0b2tlbiA9PiB0b2tlbiAhPSBudWxsKSxcclxuICAgICAgdGFrZSgxKSxcclxuICAgICAgc3dpdGNoTWFwKHRva2VuID0+IG5leHQoYWRkVG9rZW5Ub1JlcXVlc3QocmVxdWVzdCwgdG9rZW4pKSlcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRGVidWcgbG9nZ2luZ1xyXG4gKi9cclxuZnVuY3Rpb24gbG9nRGVidWcobG9nTGV2ZWw6IE9BdXRoMkxvZ0xldmVsLCBtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XHJcbiAgaWYgKGxvZ0xldmVsID09PSAnZGVidWcnKSB7XHJcbiAgICBjb25zb2xlLmxvZyhgW09BdXRoMkludGVyY2VwdG9yXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogSW5mbyBsb2dnaW5nXHJcbiAqL1xyXG5mdW5jdGlvbiBsb2dJbmZvKGxvZ0xldmVsOiBPQXV0aDJMb2dMZXZlbCwgbWVzc2FnZTogc3RyaW5nLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xyXG4gIGlmIChbJ2RlYnVnJywgJ2luZm8nXS5pbmNsdWRlcyhsb2dMZXZlbCkpIHtcclxuICAgIGNvbnNvbGUuaW5mbyhgW09BdXRoMkludGVyY2VwdG9yXSAke21lc3NhZ2V9YCwgLi4uYXJncyk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRXJyb3IgbG9nZ2luZ1xyXG4gKi9cclxuZnVuY3Rpb24gbG9nRXJyb3IobG9nTGV2ZWw6IE9BdXRoMkxvZ0xldmVsLCBtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogYW55KTogdm9pZCB7XHJcbiAgaWYgKGxvZ0xldmVsICE9PSAnbm9uZScpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFtPQXV0aDJJbnRlcmNlcHRvcl0gJHttZXNzYWdlfWAsIGVycm9yKTtcclxuICB9XHJcbn0iXX0=","originalSourcemap":{"version":3,"file":"oauth2.interceptor.js","sourceRoot":"","sources":["../../../../../src/lib/interceptors/oauth2.interceptor.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[15,0,0,15],[17,0,0,17],[28,0,0,28],[30,0,0,30],[36,0,0,36],[51,0,0,51],[52,0,0,52]],[[0,0,2,0],[7,0,2,7],[9,0,4,2],[20,0,4,13],[22,0,8,2],[34,0,8,14],[36,0,9,2],[47,0,9,13],[49,0,10,1],[55,0,10,7],[77,0,10,29],[78,0,10,30]],[[0,0,11,0],[7,0,11,7],[9,0,11,21],[19,0,11,31],[21,0,11,33],[36,0,11,48],[38,0,11,50],[44,0,11,56],[50,0,11,62],[51,0,11,63]],[[0,0,12,0],[7,0,12,7],[9,0,12,9],[19,0,12,19],[21,0,12,21],[30,0,12,30],[32,0,12,32],[38,0,12,38],[40,0,12,40],[44,0,12,44],[46,0,12,46],[52,0,12,52],[68,0,12,68],[69,0,12,69]],[[0,0,15,0],[7,0,15,7],[9,0,15,9],[28,0,15,28],[30,0,15,46],[36,0,15,52],[66,0,15,82],[67,0,15,83]],[[0,0,16,0],[7,0,16,7],[9,0,16,9],[28,0,16,28],[30,0,16,30],[36,0,16,36],[67,0,16,67],[68,0,16,68]],[[0,0,17,0],[7,0,17,7],[9,0,17,9],[29,0,17,29],[31,0,17,31],[37,0,17,37],[73,0,17,73],[74,0,17,74]],[[0,0,19,0],[33,0,19,33]],[[0,0,20,0],[4,0,20,4],[16,0,20,16],[19,0,20,19],[24,0,20,24],[25,0,20,25]],[[0,0,21,0],[4,0,21,4],[23,0,21,23],[26,0,21,48],[30,0,21,52],[45,0,21,67],[46,0,21,73],[50,0,21,77],[51,0,21,78],[52,0,21,79]],[[0,0,23,0]],[],[],[[3,0,26,3]],[[0,0,27,0],[6,0,27,6],[7,0,27,7],[13,0,27,13],[32,0,27,32],[35,0,27,54],[36,0,28,2],[43,0,28,27],[45,0,29,2],[49,0,29,21],[51,0,30,30],[53,0,30,32]],[[4,0,31,2],[10,0,31,8],[20,0,31,18],[23,0,31,21],[29,0,31,27],[30,0,31,28],[41,0,31,39],[42,0,31,40],[43,0,31,41]],[[4,0,32,2],[10,0,32,8],[16,0,32,14],[19,0,32,17],[25,0,32,23],[26,0,32,24],[45,0,32,43],[46,0,32,44],[47,0,32,45]],[[4,0,33,2],[10,0,33,8],[24,0,33,22],[27,0,33,25],[33,0,33,31],[34,0,33,32],[54,0,33,52],[55,0,33,53],[56,0,33,54]],[[4,0,35,2],[10,0,35,8],[18,0,35,16],[21,0,35,19],[27,0,35,25],[28,0,35,26],[36,0,35,34],[40,0,35,38],[46,0,35,44],[47,0,35,45]],[[4,0,37,2],[61,0,37,59]],[[4,0,38,2],[8,0,38,6],[9,0,38,7],[31,0,38,29],[32,0,38,30],[39,0,38,37],[41,0,38,39],[47,0,38,45],[48,0,38,46],[50,0,38,48],[51,0,38,49]],[[8,0,39,4],[15,0,39,11],[19,0,39,15],[20,0,39,16],[27,0,39,23],[28,0,39,24],[29,0,39,25]],[[4,0,40,2],[5,0,40,3]],[[4,0,42,2],[74,0,42,72]],[[4,0,43,2],[8,0,43,6],[19,0,43,17],[22,0,43,20],[36,0,43,34],[37,0,43,35],[44,0,43,42],[45,0,43,43],[64,0,43,62],[65,0,43,63],[77,0,43,75],[78,0,43,76],[79,0,43,77]],[[4,0,44,2],[10,0,44,8],[23,0,44,21],[26,0,44,24],[37,0,44,35],[41,0,44,39],[53,0,44,51],[54,0,44,52],[68,0,44,66],[69,0,44,67],[70,0,44,68]],[[4,0,46,2],[12,0,46,10],[13,0,46,11],[21,0,46,19],[23,0,46,21],[48,0,46,46],[50,0,46,48],[61,0,46,59],[62,0,46,60],[63,0,46,61],[64,0,46,62],[65,0,46,63],[78,0,46,76],[79,0,46,77],[80,0,46,78],[81,0,46,79],[88,0,46,86],[89,0,46,87],[90,0,46,88],[91,0,46,89],[100,0,46,98],[101,0,46,99],[102,0,46,100],[103,0,46,101],[104,0,46,102],[115,0,46,113],[116,0,46,114],[117,0,46,115]],[[4,0,47,2],[12,0,47,10],[13,0,47,11],[21,0,47,19],[23,0,47,21],[37,0,47,35],[39,0,47,37],[46,0,47,44],[47,0,47,45],[50,0,47,48],[51,0,47,49],[52,0,47,50]],[[4,0,49,2],[92,0,49,90]],[[4,0,50,2],[8,0,50,6],[19,0,50,17],[21,0,50,19],[22,0,50,20]],[[8,0,51,4],[15,0,51,11],[18,0,51,14],[35,0,51,31],[36,0,51,32],[43,0,51,39],[45,0,51,41],[56,0,51,52],[57,0,51,53],[58,0,51,54]],[[8,0,52,4],[16,0,52,12],[17,0,52,13],[25,0,52,21],[27,0,52,23],[66,0,52,62],[67,0,52,63],[68,0,52,64]],[[4,0,53,2],[5,0,53,3]],[[9,0,53,9],[10,0,53,10]],[[8,0,54,4],[16,0,54,12],[17,0,54,13],[25,0,54,21],[27,0,54,23],[95,0,54,91],[96,0,54,92],[97,0,54,93]],[[4,0,55,2],[5,0,55,3]],[[4,0,57,2],[11,0,57,9],[15,0,57,13],[16,0,57,14],[23,0,57,21],[24,0,57,22],[25,0,57,23],[29,0,57,27],[30,0,58,4],[40,0,58,14],[41,0,58,15],[42,0,58,16],[47,0,58,40],[49,0,58,42],[51,0,58,44]],[[8,0,59,6],[100,0,59,98]],[[8,0,60,6],[12,0,60,10],[17,0,60,15],[18,0,60,16],[24,0,60,22],[29,0,60,27],[32,0,60,30],[34,0,60,32],[35,0,60,33]],[[12,0,61,8],[18,0,61,14],[30,0,61,26],[33,0,61,29],[47,0,61,43],[48,0,61,44],[55,0,61,51],[56,0,61,52],[75,0,61,71],[76,0,61,72],[89,0,61,85],[90,0,61,86],[91,0,61,87]],[[12,0,62,8],[16,0,62,12],[27,0,62,23],[31,0,62,27],[43,0,62,39],[45,0,62,41],[46,0,62,42]],[[16,0,63,10],[23,0,63,17],[24,0,63,18],[32,0,63,26],[34,0,63,28],[80,0,63,74],[81,0,63,75],[82,0,63,76]],[[16,0,64,10],[24,0,64,18],[25,0,64,19],[33,0,64,27],[35,0,64,29],[54,0,64,48],[56,0,64,50],[57,0,64,51],[58,0,64,52],[69,0,64,63],[71,0,64,65],[91,0,64,85],[93,0,64,87],[94,0,64,88],[95,0,64,89],[107,0,64,101],[108,0,64,102],[109,0,64,103]],[[16,0,65,10],[23,0,65,17],[37,0,65,31],[38,0,65,32],[45,0,65,39],[47,0,65,41],[51,0,65,45],[53,0,65,47],[59,0,65,53],[61,0,65,55],[75,0,65,69],[77,0,65,71],[85,0,65,79],[86,0,65,80],[87,0,65,81]],[[12,0,66,8],[13,0,66,9]],[[17,0,66,15],[18,0,66,16]],[[16,0,67,10],[23,0,67,17],[24,0,67,18],[32,0,67,26],[34,0,67,28],[81,0,67,75],[82,0,67,76],[83,0,67,77]],[[12,0,68,8],[13,0,68,9]],[[8,0,69,6],[9,0,69,7]],[[8,0,71,6],[15,0,71,13],[25,0,71,23],[26,0,71,24],[29,0,71,27],[31,0,71,29],[32,0,71,30],[37,0,71,35],[38,0,71,36],[39,0,71,37]],[[4,0,72,4],[5,0,72,5],[6,0,72,6],[7,0,73,3],[8,0,73,4]],[[0,0,74,0],[1,0,74,1],[2,0,74,2]],[[0,0,76,0]],[],[[3,0,78,3]],[[0,0,79,0],[9,0,79,9],[21,0,79,21],[22,0,79,22],[36,0,79,58]],[[4,0,80,2],[10,0,80,8],[22,0,80,20],[25,0,80,23],[39,0,80,37],[40,0,80,38],[47,0,80,45],[48,0,80,46],[67,0,80,65],[68,0,80,66],[84,0,80,82],[85,0,80,83],[86,0,80,84]],[[4,0,81,2],[8,0,81,6],[9,0,81,7],[21,0,81,19],[23,0,81,21],[24,0,81,22]],[[8,0,82,4],[15,0,82,11],[20,0,82,16],[21,0,82,17]],[[4,0,83,2],[5,0,83,3]],[[4,0,85,2],[10,0,85,8],[19,0,85,17],[22,0,85,20],[30,0,85,28],[31,0,85,29],[43,0,85,41],[45,0,85,43],[47,0,85,45],[48,0,85,46],[49,0,85,47]],[[4,0,86,2],[11,0,86,9],[15,0,86,13],[16,0,86,14],[19,0,86,17],[21,0,86,19],[24,0,86,22],[33,0,86,31],[34,0,86,32]],[[0,0,87,0],[1,0,87,1]],[[0,0,89,0]],[],[[3,0,91,3]],[[0,0,92,0],[9,0,92,9],[31,0,92,31],[32,0,92,32],[39,0,92,57],[41,0,92,59],[47,0,92,79]],[[4,0,93,2],[66,0,93,64]],[[4,0,94,2],[8,0,94,6],[15,0,94,13],[16,0,94,14],[19,0,94,17],[24,0,94,22],[30,0,94,28],[31,0,94,29],[44,0,94,42],[46,0,94,44],[47,0,94,45]],[[8,0,95,4],[15,0,95,11],[20,0,95,16],[21,0,95,17]],[[4,0,96,2],[5,0,96,3]],[[4,0,98,2],[30,0,98,28]],[[4,0,99,2],[8,0,99,6],[14,0,99,12],[15,0,99,13],[29,0,99,27],[33,0,99,31],[40,0,99,38],[41,0,99,39],[44,0,99,42],[49,0,99,47],[55,0,99,53],[56,0,99,54],[70,0,99,68],[72,0,99,70],[73,0,99,71]],[[8,0,100,4],[15,0,100,11],[20,0,100,16],[21,0,100,17]],[[4,0,101,2],[5,0,101,3]],[[4,0,103,2],[55,0,103,53]],[[4,0,104,2],[72,0,104,70]],[[4,0,105,2],[11,0,105,9],[15,0,105,13],[16,0,105,14]],[[0,0,106,0],[1,0,106,1]],[[0,0,108,0]],[],[[3,0,110,3]],[[0,0,111,0],[9,0,111,9],[26,0,111,26],[27,0,111,27],[34,0,111,52],[36,0,111,54],[41,0,111,67]],[[4,0,112,2],[11,0,112,9],[18,0,112,16],[19,0,112,17],[24,0,112,22],[25,0,112,23]],[[8,0,113,4],[18,0,113,14],[20,0,113,16]],[[12,0,114,6],[25,0,114,19],[27,0,114,21],[37,0,114,31],[42,0,114,36],[44,0,114,38]],[[9,0,115,5]],[[5,0,116,3],[6,0,116,4],[7,0,116,5]],[[0,0,117,0],[1,0,117,1]],[[0,0,119,0]],[],[[3,0,121,3]],[[0,0,122,0],[9,0,122,9],[23,0,122,23],[24,0,123,2],[31,0,123,27],[33,0,124,2],[37,0,124,21],[39,0,125,2],[45,0,125,22],[47,0,126,2],[61,0,126,38],[63,0,127,2],[71,0,127,26]],[[4,0,129,2],[8,0,129,6],[9,0,129,7],[21,0,129,19],[23,0,129,21],[24,0,129,22]],[[8,0,130,4],[20,0,130,16],[23,0,130,19],[27,0,130,23],[28,0,130,24]],[[8,0,131,4],[27,0,131,23],[28,0,131,24],[32,0,131,28],[33,0,131,29],[37,0,131,33],[38,0,131,34],[39,0,131,35]],[[8,0,133,4],[14,0,133,10],[26,0,133,22],[29,0,133,25],[43,0,133,39],[44,0,133,40],[51,0,133,47],[52,0,133,48],[71,0,133,67],[72,0,133,68],[85,0,133,81],[86,0,133,82],[87,0,133,83]],[[8,0,134,4],[12,0,134,8],[13,0,134,9],[25,0,134,21],[27,0,134,23],[28,0,134,24]],[[12,0,135,6],[24,0,135,18],[27,0,135,21],[32,0,135,26],[33,0,135,27]],[[12,0,136,6],[19,0,136,13],[20,0,136,14],[28,0,136,22],[30,0,136,24],[58,0,136,52],[59,0,136,53],[60,0,136,54]],[[12,0,137,6],[19,0,137,13],[29,0,137,23],[30,0,137,24],[33,0,137,27],[35,0,137,29],[36,0,137,30],[40,0,137,34],[45,0,137,39],[46,0,137,40],[74,0,137,68],[75,0,137,69],[76,0,137,70],[77,0,137,71]],[[8,0,138,4],[9,0,138,5]],[[8,0,140,4],[66,0,140,62]],[[8,0,141,4],[14,0,141,10],[30,0,141,26],[33,0,141,29]],[[12,0,142,6],[22,0,142,16],[24,0,142,18],[39,0,142,33]],[[12,0,143,6],[25,0,143,19],[27,0,143,21],[39,0,143,33]],[[12,0,144,6],[21,0,144,15],[23,0,144,17],[29,0,144,23],[30,0,144,24],[38,0,144,32]],[[9,0,145,5],[10,0,145,6]],[[8,0,147,4],[69,0,147,65]],[[8,0,148,4],[14,0,148,10],[22,0,148,18],[25,0,148,21],[29,0,148,25],[44,0,148,40],[46,0,148,42],[47,0,148,43]],[[8,0,149,4],[14,0,149,10],[15,0,149,11],[22,0,149,18],[23,0,149,19],[39,0,149,35],[40,0,149,36],[41,0,149,37],[48,0,149,44],[49,0,149,45],[50,0,149,46],[51,0,149,47],[54,0,149,50],[56,0,149,52],[61,0,149,57],[62,0,149,58],[64,0,149,60],[66,0,149,62]],[[12,0,150,6],[16,0,150,10],[21,0,150,15],[26,0,150,20],[35,0,150,29],[37,0,150,31],[38,0,150,32]],[[16,0,151,8],[24,0,151,16],[25,0,151,17],[31,0,151,23],[32,0,151,24],[35,0,151,27],[37,0,151,29],[42,0,151,34],[43,0,151,35],[51,0,151,43],[53,0,151,45],[54,0,151,46],[55,0,151,47]],[[12,0,152,6],[13,0,152,7]],[[8,0,153,4],[9,0,153,5],[10,0,153,6],[11,0,153,7]],[[8,0,155,4],[14,0,155,10],[21,0,155,17],[24,0,155,20],[28,0,155,24],[39,0,155,35],[40,0,155,36]],[[12,0,156,6],[26,0,156,20],[28,0,156,22],[63,0,156,57]],[[9,0,157,5],[10,0,157,6],[11,0,157,7]],[[8,0,159,4],[14,0,159,10],[28,0,159,24],[31,0,159,27],[35,0,159,31],[46,0,159,42],[47,0,159,43],[53,0,159,49],[55,0,159,51],[61,0,159,57],[62,0,159,58],[75,0,159,71],[77,0,159,73],[85,0,159,81],[86,0,159,82],[94,0,159,90],[96,0,159,92],[98,0,159,94]],[[12,0,160,6],[19,0,160,13],[21,0,160,15],[28,0,160,22]],[[9,0,161,5],[10,0,161,6],[11,0,161,7]],[[8,0,163,4],[15,0,163,11],[19,0,163,15],[20,0,163,16],[34,0,163,30],[35,0,163,31],[36,0,163,32],[40,0,163,36],[41,0,164,6],[47,0,164,12],[48,0,164,13],[49,0,164,14],[54,0,164,35],[56,0,164,37],[58,0,164,39],[59,0,164,40],[64,0,164,45],[76,0,164,57],[88,0,164,69],[89,0,164,70],[91,0,165,6],[100,0,165,15],[101,0,165,16],[102,0,165,17],[107,0,165,41],[109,0,165,43],[111,0,165,45]],[[12,0,166,8],[18,0,166,14],[31,0,166,27],[34,0,166,30],[39,0,166,35],[40,0,166,36],[44,0,166,40],[45,0,166,41]],[[12,0,167,8],[24,0,167,20],[27,0,167,23],[32,0,167,28],[33,0,167,29]],[[12,0,169,8],[16,0,169,12],[29,0,169,25],[31,0,169,27],[43,0,169,39],[45,0,169,41],[46,0,169,42]],[[16,0,170,10],[35,0,170,29]],[[16,0,171,10],[30,0,171,24],[31,0,171,25],[38,0,171,32],[39,0,171,33],[58,0,171,52],[59,0,171,53],[71,0,171,65],[73,0,171,67],[86,0,171,80],[87,0,171,81],[99,0,171,93],[100,0,171,94],[101,0,171,95]],[[16,0,172,10],[30,0,172,24],[31,0,172,25],[38,0,172,32],[39,0,172,33],[58,0,172,52],[59,0,172,53],[75,0,172,69],[77,0,172,71],[78,0,172,72],[82,0,172,76],[83,0,172,77],[86,0,172,80],[88,0,172,82],[91,0,172,85],[92,0,172,86],[105,0,172,99],[106,0,172,100],[116,0,172,110],[119,0,172,113],[123,0,172,117],[124,0,172,118],[125,0,172,119],[126,0,172,120],[134,0,172,128],[136,0,172,130],[137,0,172,131],[138,0,172,132]],[[16,0,173,10],[20,0,173,14],[33,0,173,27],[34,0,173,28],[47,0,173,41],[49,0,173,43],[50,0,173,44]],[[20,0,174,12],[34,0,174,26],[35,0,174,27],[42,0,174,34],[43,0,174,35],[62,0,174,54],[63,0,174,55],[76,0,174,68],[78,0,174,70],[91,0,174,83],[92,0,174,84],[105,0,174,97],[106,0,174,98],[107,0,174,99]],[[16,0,175,10],[17,0,175,11]],[[16,0,177,10],[35,0,177,29],[36,0,177,30],[40,0,177,34],[41,0,177,35],[54,0,177,48],[55,0,177,49],[67,0,177,61],[68,0,177,62],[69,0,177,63]],[[16,0,178,10],[23,0,178,17],[24,0,178,18],[32,0,178,26],[34,0,178,28],[91,0,178,85],[92,0,178,86],[93,0,178,87]],[[16,0,180,10],[60,0,180,54]],[[16,0,181,10],[23,0,181,17],[27,0,181,21],[28,0,181,22],[45,0,181,39],[46,0,181,40],[53,0,181,47],[55,0,181,49],[68,0,181,62],[69,0,181,63],[81,0,181,75],[82,0,181,76],[83,0,181,77],[84,0,181,78]],[[12,0,182,8],[13,0,182,9]],[[17,0,182,15],[18,0,182,16]],[[16,0,183,10],[22,0,183,16],[26,0,183,20],[31,0,183,25],[32,0,183,26],[69,0,183,63],[70,0,183,64],[71,0,183,65]],[[12,0,184,8],[13,0,184,9]],[[8,0,185,6],[9,0,185,7],[10,0,185,8],[12,0,186,6],[22,0,186,16],[23,0,186,17],[28,0,186,22],[29,0,186,23],[31,0,186,25]],[[12,0,187,8],[24,0,187,20],[27,0,187,23],[32,0,187,28],[33,0,187,29]],[[12,0,188,8],[31,0,188,27],[32,0,188,28],[36,0,188,32],[37,0,188,33],[41,0,188,37],[42,0,188,38],[43,0,188,39]],[[12,0,190,8],[20,0,190,16],[21,0,190,17],[29,0,190,25],[31,0,190,27],[54,0,190,50],[56,0,190,52],[61,0,190,57],[62,0,190,58],[63,0,190,59]],[[12,0,192,8],[76,0,192,72]],[[12,0,193,8],[16,0,193,12],[21,0,193,17],[23,0,193,19],[29,0,193,25],[34,0,193,30],[37,0,193,33],[41,0,193,37],[46,0,193,42],[48,0,193,44],[54,0,193,50],[59,0,193,55],[62,0,193,58],[64,0,193,60],[65,0,193,61]],[[16,0,194,10],[23,0,194,17],[24,0,194,18],[32,0,194,26],[34,0,194,28],[77,0,194,71],[78,0,194,72],[79,0,194,73]],[[16,0,196,10],[55,0,196,49]],[[16,0,197,10],[30,0,197,24],[31,0,197,25],[39,0,197,33],[41,0,197,35],[42,0,197,36]],[[16,0,199,10],[64,0,199,58]],[[16,0,200,10],[66,0,200,60]],[[12,0,201,8],[13,0,201,9]],[[17,0,201,15],[18,0,201,16]],[[16,0,202,10],[23,0,202,17],[24,0,202,18],[32,0,202,26],[34,0,202,28],[77,0,202,71],[78,0,202,72],[79,0,202,73]],[[12,0,203,8],[13,0,203,9]],[[12,0,205,8],[19,0,205,15],[29,0,205,25],[30,0,205,26],[33,0,205,29],[35,0,205,31],[36,0,205,32],[41,0,205,37],[42,0,205,38],[43,0,205,39]],[[8,0,206,6],[9,0,206,7],[10,0,206,8],[11,0,207,5],[12,0,207,6]],[[4,0,208,2],[5,0,208,3]],[[9,0,208,9],[10,0,208,10]],[[8,0,209,4],[59,0,209,55]],[[8,0,210,4],[15,0,210,11],[34,0,210,30],[35,0,210,31],[39,0,210,35],[40,0,211,6],[46,0,211,12],[47,0,211,13],[52,0,211,18],[53,0,211,19],[55,0,211,21],[56,0,211,22],[61,0,211,27],[65,0,211,31],[69,0,211,35],[70,0,211,36],[72,0,212,6],[76,0,212,10],[77,0,212,11],[78,0,212,12],[79,0,212,13],[81,0,213,6],[90,0,213,15],[91,0,213,16],[96,0,213,21],[97,0,213,22],[99,0,213,24],[100,0,213,25],[104,0,213,29],[105,0,213,30],[122,0,213,47],[123,0,213,48],[130,0,213,55],[132,0,213,57],[137,0,213,62],[138,0,213,63],[139,0,213,64],[140,0,213,65],[141,0,214,5],[142,0,214,6]],[[4,0,215,2],[5,0,215,3]],[[0,0,216,0],[1,0,216,1]],[[0,0,218,0]],[],[[3,0,220,3]],[[0,0,221,0],[9,0,221,9],[17,0,221,17],[18,0,221,18],[26,0,221,42],[28,0,221,44],[35,0,221,59],[37,0,221,61],[40,0,221,64],[44,0,221,75]],[[4,0,222,2],[8,0,222,6],[16,0,222,14],[21,0,222,19],[28,0,222,26],[30,0,222,28],[31,0,222,29]],[[8,0,223,4],[15,0,223,11],[16,0,223,12],[19,0,223,15],[20,0,223,16],[43,0,223,39],[50,0,223,46],[52,0,223,48],[54,0,223,50],[57,0,223,53],[61,0,223,57],[62,0,223,58],[63,0,223,59]],[[4,0,224,2],[5,0,224,3]],[[0,0,225,0],[1,0,225,1]],[[0,0,227,0]],[],[[3,0,229,3]],[[0,0,230,0],[9,0,230,9],[16,0,230,16],[17,0,230,17],[25,0,230,41],[27,0,230,43],[34,0,230,58],[36,0,230,60],[39,0,230,63],[43,0,230,74]],[[4,0,231,2],[8,0,231,6],[9,0,231,7],[16,0,231,14],[18,0,231,16],[24,0,231,22],[25,0,231,23],[26,0,231,24],[34,0,231,32],[35,0,231,33],[43,0,231,41],[44,0,231,42],[46,0,231,44],[47,0,231,45]],[[8,0,232,4],[15,0,232,11],[16,0,232,12],[20,0,232,16],[21,0,232,17],[44,0,232,40],[51,0,232,47],[53,0,232,49],[55,0,232,51],[58,0,232,54],[62,0,232,58],[63,0,232,59],[64,0,232,60]],[[4,0,233,2],[5,0,233,3]],[[0,0,234,0],[1,0,234,1]],[[0,0,236,0]],[],[[3,0,238,3]],[[0,0,239,0],[9,0,239,9],[17,0,239,17],[18,0,239,18],[26,0,239,42],[28,0,239,44],[35,0,239,59],[37,0,239,61],[42,0,239,72]],[[4,0,240,2],[8,0,240,6],[16,0,240,14],[21,0,240,19],[27,0,240,25],[29,0,240,27],[30,0,240,28]],[[8,0,241,4],[15,0,241,11],[16,0,241,12],[21,0,241,17],[22,0,241,18],[45,0,241,41],[52,0,241,48],[54,0,241,50],[56,0,241,52],[61,0,241,57],[62,0,241,58],[63,0,241,59]],[[4,0,242,2],[5,0,242,3]],[[0,0,243,0],[1,0,243,1]]],"sourcesContent":["import { inject, PLATFORM_ID } from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport {\r\n  HttpInterceptorFn,\r\n  HttpRequest,\r\n  HttpHandlerFn,\r\n  HttpEvent,\r\n  HttpErrorResponse,\r\n  HttpResponse,\r\n  HttpHeaders\r\n} from '@angular/common/http';\r\nimport { Observable, throwError, BehaviorSubject } from 'rxjs';\r\nimport { catchError, switchMap, filter, take } from 'rxjs/operators';\r\n\r\nimport { OAuth2Config } from '../models/oauth2-config.model';\r\nimport { OAUTH2_STORAGE_KEYS, OAuth2LogLevel } from '../models/oauth2-types.model';\r\nimport { OAUTH2_CONFIG_TOKEN } from '../tokens/oauth2-config.token';\r\nimport { OAuth2StorageService } from '../services/oauth2-storage.service';\r\n\r\n// Global state for token refresh\r\nlet isRefreshing = false;\r\nlet refreshTokenSubject: BehaviorSubject<any> = new BehaviorSubject<any>(null);\r\n\r\n/**\r\n * OAuth2 HTTP Interceptor Function\r\n * Automatically adds Bearer tokens to requests and handles token refresh\r\n */\r\nexport const oauth2InterceptorFn: HttpInterceptorFn = (\r\n  request: HttpRequest<any>,\r\n  next: HttpHandlerFn\r\n): Observable<HttpEvent<any>> => {\r\n  const platformId = inject(PLATFORM_ID);\r\n  const config = inject(OAUTH2_CONFIG_TOKEN);\r\n  const storageService = inject(OAuth2StorageService);\r\n  \r\n  const logLevel = config.logLevel || 'warn';\r\n\r\n  // Only intercept requests that should have OAuth2 tokens\r\n  if (!shouldInterceptRequest(request, config)) {\r\n    return next(request);\r\n  }\r\n\r\n  // Get access token directly from storage to avoid circular dependency\r\n  let accessToken = storageService.getItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN);\r\n  const hasValidToken = accessToken && isTokenValid(storageService);\r\n  \r\n  logDebug(logLevel, 'Access token retrieved:', accessToken ? (hasValidToken ? 'Valid' : 'Expired') : 'Not found');\r\n  logDebug(logLevel, 'Request URL:', request.url);\r\n  \r\n  // Always add token if available, even if expired (server will reject and we'll refresh)\r\n  if (accessToken) {\r\n    request = addTokenToRequest(request, accessToken);\r\n    logDebug(logLevel, 'Authorization header added to request');\r\n  } else {\r\n    logDebug(logLevel, 'No access token available, proceeding without Authorization header');\r\n  }\r\n\r\n  return next(request).pipe(\r\n    catchError((error: HttpErrorResponse) => {\r\n      // Handle 401 Unauthorized errors - attempt refresh if we have access token OR refresh token\r\n      if (error.status === 401) {\r\n        const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\r\n        if (accessToken || refreshToken) {\r\n          logInfo(logLevel, '401 error detected, attempting token refresh');\r\n          logDebug(logLevel, 'Has access token:', !!accessToken, 'Has refresh token:', !!refreshToken);\r\n          return handle401Error(request, next, config, storageService, logLevel);\r\n        } else {\r\n          logInfo(logLevel, '401 error but no tokens available for refresh');\r\n        }\r\n      }\r\n      \r\n      return throwError(() => error);\r\n    })\r\n  );\r\n};\r\n\r\n/**\r\n * Check if token is valid (not expired)\r\n */\r\nfunction isTokenValid(storageService: OAuth2StorageService): boolean {\r\n  const expiresAtStr = storageService.getItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT);\r\n  if (!expiresAtStr) {\r\n    return false;\r\n  }\r\n  \r\n  const expiresAt = parseInt(expiresAtStr, 10);\r\n  return Date.now() < expiresAt;\r\n}\r\n\r\n/**\r\n * Check if request should be intercepted\r\n */\r\nfunction shouldInterceptRequest(request: HttpRequest<any>, config: OAuth2Config): boolean {\r\n  // Exclude token refresh requests to avoid circular dependency\r\n  if (request.url === config.tokenEndpoint) {\r\n    return false;\r\n  }\r\n  \r\n  // Exclude revoke requests\r\n  if (config.revokeEndpoint && request.url === config.revokeEndpoint) {\r\n    return false;\r\n  }\r\n  \r\n  // You can customize this logic based on your needs\r\n  // For example, only intercept requests to specific domains or paths\r\n  return true;\r\n}\r\n\r\n/**\r\n * Add Bearer token to request headers\r\n */\r\nfunction addTokenToRequest(request: HttpRequest<any>, token: string): HttpRequest<any> {\r\n  return request.clone({\r\n    setHeaders: {\r\n      Authorization: `Bearer ${token}`\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Handle 401 Unauthorized errors by attempting token refresh\r\n */\r\nfunction handle401Error(\r\n  request: HttpRequest<any>,\r\n  next: HttpHandlerFn,\r\n  config: OAuth2Config,\r\n  storageService: OAuth2StorageService,\r\n  logLevel: OAuth2LogLevel\r\n): Observable<HttpEvent<any>> {\r\n  if (!isRefreshing) {\r\n    isRefreshing = true;\r\n    refreshTokenSubject.next(null);\r\n\r\n    const refreshToken = storageService.getItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN);\r\n    if (!refreshToken) {\r\n      isRefreshing = false;\r\n      logInfo(logLevel, 'No refresh token available');\r\n      return throwError(() => new Error('No refresh token available'));\r\n    }\r\n\r\n    // Create token refresh request directly using HttpRequest\r\n    const tokenRequestData = {\r\n      grant_type: 'refresh_token',\r\n      refresh_token: refreshToken,\r\n      client_id: config.clientId\r\n    };\r\n    \r\n    // Convert to URL-encoded form data as per OAuth 2.0 standard\r\n    const formData = new URLSearchParams();\r\n    Object.entries(tokenRequestData).forEach(([key, value]) => {\r\n      if (value !== undefined) {\r\n        formData.append(key, value.toString());\r\n      }\r\n    });\r\n    \r\n    const headers = new HttpHeaders({\r\n      'Content-Type': 'application/x-www-form-urlencoded'\r\n    });\r\n    \r\n    const refreshRequest = new HttpRequest('POST', config.tokenEndpoint, formData.toString(), {\r\n      headers: headers\r\n    });\r\n\r\n    return next(refreshRequest).pipe(\r\n      filter((event: HttpEvent<any>) => event instanceof HttpResponse),\r\n      switchMap((event: HttpResponse<any>) => {\r\n        const tokenResponse = event.body;\r\n        isRefreshing = false;\r\n        \r\n        if (tokenResponse?.access_token) {\r\n          // Store new tokens\r\n          storageService.setItem(OAUTH2_STORAGE_KEYS.ACCESS_TOKEN, tokenResponse.access_token);\r\n          storageService.setItem(OAUTH2_STORAGE_KEYS.TOKEN_EXPIRES_AT, (Date.now() + (tokenResponse.expires_in * 1000)).toString());\r\n          if (tokenResponse.refresh_token) {\r\n            storageService.setItem(OAUTH2_STORAGE_KEYS.REFRESH_TOKEN, tokenResponse.refresh_token);\r\n          }\r\n          \r\n          refreshTokenSubject.next(tokenResponse.access_token);\r\n          logInfo(logLevel, 'Token refreshed successfully, retrying original request');\r\n          \r\n          // Retry the original request with new token\r\n          return next(addTokenToRequest(request, tokenResponse.access_token));\r\n        } else {\r\n          throw new Error('No access token in refresh response');\r\n        }\r\n      }),\r\n      catchError(error => {\r\n        isRefreshing = false;\r\n        refreshTokenSubject.next(null);\r\n        \r\n        logError(logLevel, 'Token refresh failed:', error);\r\n        \r\n        // Check if it's an authentication error (invalid refresh token)\r\n        if (error?.status === 400 || error?.status === 401) {\r\n          logInfo(logLevel, 'Refresh token is invalid, clearing tokens');\r\n          \r\n          // Clear all OAuth2 tokens from storage\r\n          storageService.clearAll();\r\n          \r\n          // Optionally redirect to login or emit an event\r\n          // This depends on your application's requirements\r\n        } else {\r\n          logInfo(logLevel, 'Network/server error, not clearing tokens');\r\n        }\r\n        \r\n        return throwError(() => error);\r\n      })\r\n    );\r\n  } else {\r\n    // Wait for refresh to complete, then retry request\r\n    return refreshTokenSubject.pipe(\r\n      filter(token => token != null),\r\n      take(1),\r\n      switchMap(token => next(addTokenToRequest(request, token)))\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * Debug logging\r\n */\r\nfunction logDebug(logLevel: OAuth2LogLevel, message: string, ...args: any[]): void {\r\n  if (logLevel === 'debug') {\r\n    console.log(`[OAuth2Interceptor] ${message}`, ...args);\r\n  }\r\n}\r\n\r\n/**\r\n * Info logging\r\n */\r\nfunction logInfo(logLevel: OAuth2LogLevel, message: string, ...args: any[]): void {\r\n  if (['debug', 'info'].includes(logLevel)) {\r\n    console.info(`[OAuth2Interceptor] ${message}`, ...args);\r\n  }\r\n}\r\n\r\n/**\r\n * Error logging\r\n */\r\nfunction logError(logLevel: OAuth2LogLevel, message: string, error?: any): void {\r\n  if (logLevel !== 'none') {\r\n    console.error(`[OAuth2Interceptor] ${message}`, error);\r\n  }\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common/http":{"attributes":{},"external":true,"id":"@angular/common/http","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"rxjs":{"attributes":{},"external":true,"id":"rxjs","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"rxjs/operators":{"attributes":{},"external":true,"id":"rxjs/operators","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"../models/oauth2-types.model":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"../tokens/oauth2-config.token":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"../services/oauth2-storage.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":25915,"body":[{"type":"ImportDeclaration","start":0,"end":63,"specifiers":[{"type":"ImportSpecifier","start":9,"end":18,"imported":{"type":"Identifier","start":9,"end":18,"name":"Component"},"local":{"type":"Identifier","start":9,"end":18,"name":"Component"}},{"type":"ImportSpecifier","start":20,"end":26,"imported":{"type":"Identifier","start":20,"end":26,"name":"Inject"},"local":{"type":"Identifier","start":20,"end":26,"name":"Inject"}},{"type":"ImportSpecifier","start":28,"end":39,"imported":{"type":"Identifier","start":28,"end":39,"name":"PLATFORM_ID"},"local":{"type":"Identifier","start":28,"end":39,"name":"PLATFORM_ID"}}],"source":{"type":"Literal","start":47,"end":62,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":64,"end":130,"specifiers":[{"type":"ImportSpecifier","start":73,"end":85,"imported":{"type":"Identifier","start":73,"end":85,"name":"CommonModule"},"local":{"type":"Identifier","start":73,"end":85,"name":"CommonModule"}},{"type":"ImportSpecifier","start":87,"end":104,"imported":{"type":"Identifier","start":87,"end":104,"name":"isPlatformBrowser"},"local":{"type":"Identifier","start":87,"end":104,"name":"isPlatformBrowser"}}],"source":{"type":"Literal","start":112,"end":129,"value":"@angular/common","raw":"'@angular/common'"},"attributes":[]},{"type":"ImportDeclaration","start":131,"end":167,"specifiers":[{"type":"ImportNamespaceSpecifier","start":138,"end":145,"local":{"type":"Identifier","start":143,"end":145,"name":"i0"}}],"source":{"type":"Literal","start":151,"end":166,"value":"@angular/core","raw":"\"@angular/core\""},"attributes":[]},{"type":"ImportDeclaration","start":168,"end":220,"specifiers":[{"type":"ImportNamespaceSpecifier","start":175,"end":182,"local":{"type":"Identifier","start":180,"end":182,"name":"i1"}}],"source":{"type":"Literal","start":188,"end":219,"value":"../../services/oauth2.service","raw":"\"../../services/oauth2.service\""},"attributes":[]},{"type":"ImportDeclaration","start":221,"end":259,"specifiers":[{"type":"ImportNamespaceSpecifier","start":228,"end":235,"local":{"type":"Identifier","start":233,"end":235,"name":"i2"}}],"source":{"type":"Literal","start":241,"end":258,"value":"@angular/router","raw":"\"@angular/router\""},"attributes":[]},{"type":"ImportDeclaration","start":260,"end":298,"specifiers":[{"type":"ImportNamespaceSpecifier","start":267,"end":274,"local":{"type":"Identifier","start":272,"end":274,"name":"i3"}}],"source":{"type":"Literal","start":280,"end":297,"value":"@angular/common","raw":"\"@angular/common\""},"attributes":[]},{"type":"FunctionDeclaration","start":299,"end":666,"async":false,"generator":false,"id":{"type":"Identifier","start":308,"end":346,"name":"OAuth2CallbackComponent_div_2_Template"},"params":[{"type":"Identifier","start":347,"end":349,"name":"rf"},{"type":"Identifier","start":351,"end":354,"name":"ctx"}],"body":{"type":"BlockStatement","start":356,"end":666,"body":[{"type":"IfStatement","start":358,"end":664,"test":{"type":"BinaryExpression","start":362,"end":368,"operator":"&","left":{"type":"Identifier","start":362,"end":364,"name":"rf"},"right":{"type":"Literal","start":367,"end":368,"raw":"1","value":1}},"consequent":{"type":"BlockStatement","start":370,"end":664,"body":[{"type":"ExpressionStatement","start":376,"end":407,"expression":{"type":"CallExpression","start":376,"end":406,"optional":false,"callee":{"type":"MemberExpression","start":376,"end":393,"computed":false,"optional":false,"object":{"type":"Identifier","start":376,"end":378,"name":"i0"},"property":{"type":"Identifier","start":379,"end":393,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":394,"end":395,"raw":"0","value":0},{"type":"Literal","start":397,"end":402,"value":"div","raw":"\"div\""},{"type":"Literal","start":404,"end":405,"raw":"5","value":5}]}},{"type":"ExpressionStatement","start":412,"end":438,"expression":{"type":"CallExpression","start":412,"end":437,"optional":false,"callee":{"type":"MemberExpression","start":412,"end":424,"computed":false,"optional":false,"object":{"type":"Identifier","start":412,"end":414,"name":"i0"},"property":{"type":"Identifier","start":415,"end":424,"name":"ɵɵelement"}},"arguments":[{"type":"Literal","start":425,"end":426,"raw":"1","value":1},{"type":"Literal","start":428,"end":433,"value":"div","raw":"\"div\""},{"type":"Literal","start":435,"end":436,"raw":"6","value":6}]}},{"type":"ExpressionStatement","start":443,"end":470,"expression":{"type":"CallExpression","start":443,"end":469,"optional":false,"callee":{"type":"MemberExpression","start":443,"end":460,"computed":false,"optional":false,"object":{"type":"Identifier","start":443,"end":445,"name":"i0"},"property":{"type":"Identifier","start":446,"end":460,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":461,"end":462,"raw":"2","value":2},{"type":"Literal","start":464,"end":468,"value":"h2","raw":"\"h2\""}]}},{"type":"ExpressionStatement","start":475,"end":520,"expression":{"type":"CallExpression","start":475,"end":519,"optional":false,"callee":{"type":"MemberExpression","start":475,"end":484,"computed":false,"optional":false,"object":{"type":"Identifier","start":475,"end":477,"name":"i0"},"property":{"type":"Identifier","start":478,"end":484,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":485,"end":486,"raw":"3","value":3},{"type":"Literal","start":488,"end":518,"value":"Processing Authentication...","raw":"\"Processing Authentication...\""}]}},{"type":"ExpressionStatement","start":525,"end":543,"expression":{"type":"CallExpression","start":525,"end":542,"optional":false,"callee":{"type":"MemberExpression","start":525,"end":540,"computed":false,"optional":false,"object":{"type":"Identifier","start":525,"end":527,"name":"i0"},"property":{"type":"Identifier","start":528,"end":540,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":548,"end":574,"expression":{"type":"CallExpression","start":548,"end":573,"optional":false,"callee":{"type":"MemberExpression","start":548,"end":565,"computed":false,"optional":false,"object":{"type":"Identifier","start":548,"end":550,"name":"i0"},"property":{"type":"Identifier","start":551,"end":565,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":566,"end":567,"raw":"4","value":4},{"type":"Literal","start":569,"end":572,"value":"p","raw":"\"p\""}]}},{"type":"ExpressionStatement","start":579,"end":637,"expression":{"type":"CallExpression","start":579,"end":636,"optional":false,"callee":{"type":"MemberExpression","start":579,"end":588,"computed":false,"optional":false,"object":{"type":"Identifier","start":579,"end":581,"name":"i0"},"property":{"type":"Identifier","start":582,"end":588,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":589,"end":590,"raw":"5","value":5},{"type":"Literal","start":592,"end":635,"value":"Please wait while we complete your login.","raw":"\"Please wait while we complete your login.\""}]}},{"type":"ExpressionStatement","start":642,"end":662,"expression":{"type":"CallExpression","start":642,"end":661,"optional":false,"callee":{"type":"CallExpression","start":642,"end":659,"optional":false,"callee":{"type":"MemberExpression","start":642,"end":657,"computed":false,"optional":false,"object":{"type":"Identifier","start":642,"end":644,"name":"i0"},"property":{"type":"Identifier","start":645,"end":657,"name":"ɵɵelementEnd"}},"arguments":[]},"arguments":[]}}]},"alternate":null}]},"expression":false},{"type":"FunctionDeclaration","start":667,"end":1057,"async":false,"generator":false,"id":{"type":"Identifier","start":676,"end":714,"name":"OAuth2CallbackComponent_div_3_Template"},"params":[{"type":"Identifier","start":715,"end":717,"name":"rf"},{"type":"Identifier","start":719,"end":722,"name":"ctx"}],"body":{"type":"BlockStatement","start":724,"end":1057,"body":[{"type":"IfStatement","start":726,"end":1055,"test":{"type":"BinaryExpression","start":730,"end":736,"operator":"&","left":{"type":"Identifier","start":730,"end":732,"name":"rf"},"right":{"type":"Literal","start":735,"end":736,"raw":"1","value":1}},"consequent":{"type":"BlockStatement","start":738,"end":1055,"body":[{"type":"ExpressionStatement","start":744,"end":788,"expression":{"type":"CallExpression","start":744,"end":787,"optional":false,"callee":{"type":"CallExpression","start":744,"end":774,"optional":false,"callee":{"type":"MemberExpression","start":744,"end":761,"computed":false,"optional":false,"object":{"type":"Identifier","start":744,"end":746,"name":"i0"},"property":{"type":"Identifier","start":747,"end":761,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":762,"end":763,"raw":"0","value":0},{"type":"Literal","start":765,"end":770,"value":"div","raw":"\"div\""},{"type":"Literal","start":772,"end":773,"raw":"7","value":7}]},"arguments":[{"type":"Literal","start":775,"end":776,"raw":"1","value":1},{"type":"Literal","start":778,"end":783,"value":"div","raw":"\"div\""},{"type":"Literal","start":785,"end":786,"raw":"8","value":8}]}},{"type":"ExpressionStatement","start":793,"end":816,"expression":{"type":"CallExpression","start":793,"end":815,"optional":false,"callee":{"type":"MemberExpression","start":793,"end":802,"computed":false,"optional":false,"object":{"type":"Identifier","start":793,"end":795,"name":"i0"},"property":{"type":"Identifier","start":796,"end":802,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":803,"end":804,"raw":"2","value":2},{"type":"Literal","start":806,"end":814,"value":"✓","raw":"\"\\u2713\""}]}},{"type":"ExpressionStatement","start":821,"end":839,"expression":{"type":"CallExpression","start":821,"end":838,"optional":false,"callee":{"type":"MemberExpression","start":821,"end":836,"computed":false,"optional":false,"object":{"type":"Identifier","start":821,"end":823,"name":"i0"},"property":{"type":"Identifier","start":824,"end":836,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":844,"end":871,"expression":{"type":"CallExpression","start":844,"end":870,"optional":false,"callee":{"type":"MemberExpression","start":844,"end":861,"computed":false,"optional":false,"object":{"type":"Identifier","start":844,"end":846,"name":"i0"},"property":{"type":"Identifier","start":847,"end":861,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":862,"end":863,"raw":"3","value":3},{"type":"Literal","start":865,"end":869,"value":"h2","raw":"\"h2\""}]}},{"type":"ExpressionStatement","start":876,"end":919,"expression":{"type":"CallExpression","start":876,"end":918,"optional":false,"callee":{"type":"MemberExpression","start":876,"end":885,"computed":false,"optional":false,"object":{"type":"Identifier","start":876,"end":878,"name":"i0"},"property":{"type":"Identifier","start":879,"end":885,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":886,"end":887,"raw":"4","value":4},{"type":"Literal","start":889,"end":917,"value":"Authentication Successful!","raw":"\"Authentication Successful!\""}]}},{"type":"ExpressionStatement","start":924,"end":942,"expression":{"type":"CallExpression","start":924,"end":941,"optional":false,"callee":{"type":"MemberExpression","start":924,"end":939,"computed":false,"optional":false,"object":{"type":"Identifier","start":924,"end":926,"name":"i0"},"property":{"type":"Identifier","start":927,"end":939,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":947,"end":973,"expression":{"type":"CallExpression","start":947,"end":972,"optional":false,"callee":{"type":"MemberExpression","start":947,"end":964,"computed":false,"optional":false,"object":{"type":"Identifier","start":947,"end":949,"name":"i0"},"property":{"type":"Identifier","start":950,"end":964,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":965,"end":966,"raw":"5","value":5},{"type":"Literal","start":968,"end":971,"value":"p","raw":"\"p\""}]}},{"type":"ExpressionStatement","start":978,"end":1028,"expression":{"type":"CallExpression","start":978,"end":1027,"optional":false,"callee":{"type":"MemberExpression","start":978,"end":987,"computed":false,"optional":false,"object":{"type":"Identifier","start":978,"end":980,"name":"i0"},"property":{"type":"Identifier","start":981,"end":987,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":988,"end":989,"raw":"6","value":6},{"type":"Literal","start":991,"end":1026,"value":"You will be redirected shortly...","raw":"\"You will be redirected shortly...\""}]}},{"type":"ExpressionStatement","start":1033,"end":1053,"expression":{"type":"CallExpression","start":1033,"end":1052,"optional":false,"callee":{"type":"CallExpression","start":1033,"end":1050,"optional":false,"callee":{"type":"MemberExpression","start":1033,"end":1048,"computed":false,"optional":false,"object":{"type":"Identifier","start":1033,"end":1035,"name":"i0"},"property":{"type":"Identifier","start":1036,"end":1048,"name":"ɵɵelementEnd"}},"arguments":[]},"arguments":[]}}]},"alternate":null}]},"expression":false},{"type":"FunctionDeclaration","start":1058,"end":2189,"async":false,"generator":false,"id":{"type":"Identifier","start":1067,"end":1105,"name":"OAuth2CallbackComponent_div_4_Template"},"params":[{"type":"Identifier","start":1106,"end":1108,"name":"rf"},{"type":"Identifier","start":1110,"end":1113,"name":"ctx"}],"body":{"type":"BlockStatement","start":1115,"end":2189,"body":[{"type":"IfStatement","start":1117,"end":2071,"test":{"type":"BinaryExpression","start":1121,"end":1127,"operator":"&","left":{"type":"Identifier","start":1121,"end":1123,"name":"rf"},"right":{"type":"Literal","start":1126,"end":1127,"raw":"1","value":1}},"consequent":{"type":"BlockStatement","start":1129,"end":2071,"body":[{"type":"VariableDeclaration","start":1135,"end":1169,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1141,"end":1168,"id":{"type":"Identifier","start":1141,"end":1144,"name":"_r1"},"init":{"type":"CallExpression","start":1147,"end":1168,"optional":false,"callee":{"type":"MemberExpression","start":1147,"end":1166,"computed":false,"optional":false,"object":{"type":"Identifier","start":1147,"end":1149,"name":"i0"},"property":{"type":"Identifier","start":1150,"end":1166,"name":"ɵɵgetCurrentView"}},"arguments":[]}}]},{"type":"ExpressionStatement","start":1174,"end":1219,"expression":{"type":"CallExpression","start":1174,"end":1218,"optional":false,"callee":{"type":"CallExpression","start":1174,"end":1204,"optional":false,"callee":{"type":"MemberExpression","start":1174,"end":1191,"computed":false,"optional":false,"object":{"type":"Identifier","start":1174,"end":1176,"name":"i0"},"property":{"type":"Identifier","start":1177,"end":1191,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":1192,"end":1193,"raw":"0","value":0},{"type":"Literal","start":1195,"end":1200,"value":"div","raw":"\"div\""},{"type":"Literal","start":1202,"end":1203,"raw":"9","value":9}]},"arguments":[{"type":"Literal","start":1205,"end":1206,"raw":"1","value":1},{"type":"Literal","start":1208,"end":1213,"value":"div","raw":"\"div\""},{"type":"Literal","start":1215,"end":1217,"raw":"10","value":10}]}},{"type":"ExpressionStatement","start":1224,"end":1247,"expression":{"type":"CallExpression","start":1224,"end":1246,"optional":false,"callee":{"type":"MemberExpression","start":1224,"end":1233,"computed":false,"optional":false,"object":{"type":"Identifier","start":1224,"end":1226,"name":"i0"},"property":{"type":"Identifier","start":1227,"end":1233,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":1234,"end":1235,"raw":"2","value":2},{"type":"Literal","start":1237,"end":1245,"value":"✗","raw":"\"\\u2717\""}]}},{"type":"ExpressionStatement","start":1252,"end":1270,"expression":{"type":"CallExpression","start":1252,"end":1269,"optional":false,"callee":{"type":"MemberExpression","start":1252,"end":1267,"computed":false,"optional":false,"object":{"type":"Identifier","start":1252,"end":1254,"name":"i0"},"property":{"type":"Identifier","start":1255,"end":1267,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":1275,"end":1302,"expression":{"type":"CallExpression","start":1275,"end":1301,"optional":false,"callee":{"type":"MemberExpression","start":1275,"end":1292,"computed":false,"optional":false,"object":{"type":"Identifier","start":1275,"end":1277,"name":"i0"},"property":{"type":"Identifier","start":1278,"end":1292,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":1293,"end":1294,"raw":"3","value":3},{"type":"Literal","start":1296,"end":1300,"value":"h2","raw":"\"h2\""}]}},{"type":"ExpressionStatement","start":1307,"end":1345,"expression":{"type":"CallExpression","start":1307,"end":1344,"optional":false,"callee":{"type":"MemberExpression","start":1307,"end":1316,"computed":false,"optional":false,"object":{"type":"Identifier","start":1307,"end":1309,"name":"i0"},"property":{"type":"Identifier","start":1310,"end":1316,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":1317,"end":1318,"raw":"4","value":4},{"type":"Literal","start":1320,"end":1343,"value":"Authentication Failed","raw":"\"Authentication Failed\""}]}},{"type":"ExpressionStatement","start":1350,"end":1368,"expression":{"type":"CallExpression","start":1350,"end":1367,"optional":false,"callee":{"type":"MemberExpression","start":1350,"end":1365,"computed":false,"optional":false,"object":{"type":"Identifier","start":1350,"end":1352,"name":"i0"},"property":{"type":"Identifier","start":1353,"end":1365,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":1373,"end":1403,"expression":{"type":"CallExpression","start":1373,"end":1402,"optional":false,"callee":{"type":"MemberExpression","start":1373,"end":1390,"computed":false,"optional":false,"object":{"type":"Identifier","start":1373,"end":1375,"name":"i0"},"property":{"type":"Identifier","start":1376,"end":1390,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":1391,"end":1392,"raw":"5","value":5},{"type":"Literal","start":1394,"end":1397,"value":"p","raw":"\"p\""},{"type":"Literal","start":1399,"end":1401,"raw":"11","value":11}]}},{"type":"ExpressionStatement","start":1408,"end":1421,"expression":{"type":"CallExpression","start":1408,"end":1420,"optional":false,"callee":{"type":"MemberExpression","start":1408,"end":1417,"computed":false,"optional":false,"object":{"type":"Identifier","start":1408,"end":1410,"name":"i0"},"property":{"type":"Identifier","start":1411,"end":1417,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":1418,"end":1419,"raw":"6","value":6}]}},{"type":"ExpressionStatement","start":1426,"end":1444,"expression":{"type":"CallExpression","start":1426,"end":1443,"optional":false,"callee":{"type":"MemberExpression","start":1426,"end":1441,"computed":false,"optional":false,"object":{"type":"Identifier","start":1426,"end":1428,"name":"i0"},"property":{"type":"Identifier","start":1429,"end":1441,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":1449,"end":1498,"expression":{"type":"CallExpression","start":1449,"end":1497,"optional":false,"callee":{"type":"CallExpression","start":1449,"end":1480,"optional":false,"callee":{"type":"MemberExpression","start":1449,"end":1466,"computed":false,"optional":false,"object":{"type":"Identifier","start":1449,"end":1451,"name":"i0"},"property":{"type":"Identifier","start":1452,"end":1466,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":1467,"end":1468,"raw":"7","value":7},{"type":"Literal","start":1470,"end":1475,"value":"div","raw":"\"div\""},{"type":"Literal","start":1477,"end":1479,"raw":"12","value":12}]},"arguments":[{"type":"Literal","start":1481,"end":1482,"raw":"8","value":8},{"type":"Literal","start":1484,"end":1492,"value":"button","raw":"\"button\""},{"type":"Literal","start":1494,"end":1496,"raw":"13","value":13}]}},{"type":"ExpressionStatement","start":1503,"end":1707,"expression":{"type":"CallExpression","start":1503,"end":1706,"optional":false,"callee":{"type":"MemberExpression","start":1503,"end":1516,"computed":false,"optional":false,"object":{"type":"Identifier","start":1503,"end":1505,"name":"i0"},"property":{"type":"Identifier","start":1506,"end":1516,"name":"ɵɵlistener"}},"arguments":[{"type":"Literal","start":1517,"end":1524,"value":"click","raw":"\"click\""},{"type":"FunctionExpression","start":1526,"end":1705,"async":false,"generator":false,"id":{"type":"Identifier","start":1535,"end":1597,"name":"OAuth2CallbackComponent_div_4_Template_button_click_8_listener"},"params":[],"body":{"type":"BlockStatement","start":1600,"end":1705,"body":[{"type":"ExpressionStatement","start":1602,"end":1624,"expression":{"type":"CallExpression","start":1602,"end":1623,"optional":false,"callee":{"type":"MemberExpression","start":1602,"end":1618,"computed":false,"optional":false,"object":{"type":"Identifier","start":1602,"end":1604,"name":"i0"},"property":{"type":"Identifier","start":1605,"end":1618,"name":"ɵɵrestoreView"}},"arguments":[{"type":"Identifier","start":1619,"end":1622,"name":"_r1"}]}},{"type":"VariableDeclaration","start":1625,"end":1659,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1631,"end":1658,"id":{"type":"Identifier","start":1631,"end":1637,"name":"ctx_r1"},"init":{"type":"CallExpression","start":1640,"end":1658,"optional":false,"callee":{"type":"MemberExpression","start":1640,"end":1656,"computed":false,"optional":false,"object":{"type":"Identifier","start":1640,"end":1642,"name":"i0"},"property":{"type":"Identifier","start":1643,"end":1656,"name":"ɵɵnextContext"}},"arguments":[]}}]},{"type":"ReturnStatement","start":1660,"end":1703,"argument":{"type":"CallExpression","start":1667,"end":1702,"optional":false,"callee":{"type":"MemberExpression","start":1667,"end":1681,"computed":false,"optional":false,"object":{"type":"Identifier","start":1667,"end":1669,"name":"i0"},"property":{"type":"Identifier","start":1670,"end":1681,"name":"ɵɵresetView"}},"arguments":[{"type":"CallExpression","start":1682,"end":1701,"optional":false,"callee":{"type":"MemberExpression","start":1682,"end":1699,"computed":false,"optional":false,"object":{"type":"Identifier","start":1682,"end":1688,"name":"ctx_r1"},"property":{"type":"Identifier","start":1689,"end":1699,"name":"retryLogin"}},"arguments":[]}]}}]},"expression":false}]}},{"type":"ExpressionStatement","start":1712,"end":1740,"expression":{"type":"CallExpression","start":1712,"end":1739,"optional":false,"callee":{"type":"MemberExpression","start":1712,"end":1721,"computed":false,"optional":false,"object":{"type":"Identifier","start":1712,"end":1714,"name":"i0"},"property":{"type":"Identifier","start":1715,"end":1721,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":1722,"end":1723,"raw":"9","value":9},{"type":"Literal","start":1725,"end":1738,"value":" Try Again ","raw":"\" Try Again \""}]}},{"type":"ExpressionStatement","start":1745,"end":1763,"expression":{"type":"CallExpression","start":1745,"end":1762,"optional":false,"callee":{"type":"MemberExpression","start":1745,"end":1760,"computed":false,"optional":false,"object":{"type":"Identifier","start":1745,"end":1747,"name":"i0"},"property":{"type":"Identifier","start":1748,"end":1760,"name":"ɵɵelementEnd"}},"arguments":[]}},{"type":"ExpressionStatement","start":1768,"end":1804,"expression":{"type":"CallExpression","start":1768,"end":1803,"optional":false,"callee":{"type":"MemberExpression","start":1768,"end":1785,"computed":false,"optional":false,"object":{"type":"Identifier","start":1768,"end":1770,"name":"i0"},"property":{"type":"Identifier","start":1771,"end":1785,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":1786,"end":1788,"raw":"10","value":10},{"type":"Literal","start":1790,"end":1798,"value":"button","raw":"\"button\""},{"type":"Literal","start":1800,"end":1802,"raw":"14","value":14}]}},{"type":"ExpressionStatement","start":1809,"end":2010,"expression":{"type":"CallExpression","start":1809,"end":2009,"optional":false,"callee":{"type":"MemberExpression","start":1809,"end":1822,"computed":false,"optional":false,"object":{"type":"Identifier","start":1809,"end":1811,"name":"i0"},"property":{"type":"Identifier","start":1812,"end":1822,"name":"ɵɵlistener"}},"arguments":[{"type":"Literal","start":1823,"end":1830,"value":"click","raw":"\"click\""},{"type":"FunctionExpression","start":1832,"end":2008,"async":false,"generator":false,"id":{"type":"Identifier","start":1841,"end":1904,"name":"OAuth2CallbackComponent_div_4_Template_button_click_10_listener"},"params":[],"body":{"type":"BlockStatement","start":1907,"end":2008,"body":[{"type":"ExpressionStatement","start":1909,"end":1931,"expression":{"type":"CallExpression","start":1909,"end":1930,"optional":false,"callee":{"type":"MemberExpression","start":1909,"end":1925,"computed":false,"optional":false,"object":{"type":"Identifier","start":1909,"end":1911,"name":"i0"},"property":{"type":"Identifier","start":1912,"end":1925,"name":"ɵɵrestoreView"}},"arguments":[{"type":"Identifier","start":1926,"end":1929,"name":"_r1"}]}},{"type":"VariableDeclaration","start":1932,"end":1966,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1938,"end":1965,"id":{"type":"Identifier","start":1938,"end":1944,"name":"ctx_r1"},"init":{"type":"CallExpression","start":1947,"end":1965,"optional":false,"callee":{"type":"MemberExpression","start":1947,"end":1963,"computed":false,"optional":false,"object":{"type":"Identifier","start":1947,"end":1949,"name":"i0"},"property":{"type":"Identifier","start":1950,"end":1963,"name":"ɵɵnextContext"}},"arguments":[]}}]},{"type":"ReturnStatement","start":1967,"end":2006,"argument":{"type":"CallExpression","start":1974,"end":2005,"optional":false,"callee":{"type":"MemberExpression","start":1974,"end":1988,"computed":false,"optional":false,"object":{"type":"Identifier","start":1974,"end":1976,"name":"i0"},"property":{"type":"Identifier","start":1977,"end":1988,"name":"ɵɵresetView"}},"arguments":[{"type":"CallExpression","start":1989,"end":2004,"optional":false,"callee":{"type":"MemberExpression","start":1989,"end":2002,"computed":false,"optional":false,"object":{"type":"Identifier","start":1989,"end":1995,"name":"ctx_r1"},"property":{"type":"Identifier","start":1996,"end":2002,"name":"goHome"}},"arguments":[]}]}}]},"expression":false}]}},{"type":"ExpressionStatement","start":2015,"end":2042,"expression":{"type":"CallExpression","start":2015,"end":2041,"optional":false,"callee":{"type":"MemberExpression","start":2015,"end":2024,"computed":false,"optional":false,"object":{"type":"Identifier","start":2015,"end":2017,"name":"i0"},"property":{"type":"Identifier","start":2018,"end":2024,"name":"ɵɵtext"}},"arguments":[{"type":"Literal","start":2025,"end":2027,"raw":"11","value":11},{"type":"Literal","start":2029,"end":2040,"value":" Go Home ","raw":"\" Go Home \""}]}},{"type":"ExpressionStatement","start":2047,"end":2069,"expression":{"type":"CallExpression","start":2047,"end":2068,"optional":false,"callee":{"type":"CallExpression","start":2047,"end":2066,"optional":false,"callee":{"type":"CallExpression","start":2047,"end":2064,"optional":false,"callee":{"type":"MemberExpression","start":2047,"end":2062,"computed":false,"optional":false,"object":{"type":"Identifier","start":2047,"end":2049,"name":"i0"},"property":{"type":"Identifier","start":2050,"end":2062,"name":"ɵɵelementEnd"}},"arguments":[]},"arguments":[]},"arguments":[]}}]},"alternate":null},{"type":"IfStatement","start":2072,"end":2187,"test":{"type":"BinaryExpression","start":2076,"end":2082,"operator":"&","left":{"type":"Identifier","start":2076,"end":2078,"name":"rf"},"right":{"type":"Literal","start":2081,"end":2082,"raw":"2","value":2}},"consequent":{"type":"BlockStatement","start":2084,"end":2187,"body":[{"type":"VariableDeclaration","start":2090,"end":2124,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2096,"end":2123,"id":{"type":"Identifier","start":2096,"end":2102,"name":"ctx_r1"},"init":{"type":"CallExpression","start":2105,"end":2123,"optional":false,"callee":{"type":"MemberExpression","start":2105,"end":2121,"computed":false,"optional":false,"object":{"type":"Identifier","start":2105,"end":2107,"name":"i0"},"property":{"type":"Identifier","start":2108,"end":2121,"name":"ɵɵnextContext"}},"arguments":[]}}]},{"type":"ExpressionStatement","start":2129,"end":2145,"expression":{"type":"CallExpression","start":2129,"end":2144,"optional":false,"callee":{"type":"MemberExpression","start":2129,"end":2141,"computed":false,"optional":false,"object":{"type":"Identifier","start":2129,"end":2131,"name":"i0"},"property":{"type":"Identifier","start":2132,"end":2141,"name":"ɵɵadvance"}},"arguments":[{"type":"Literal","start":2142,"end":2143,"raw":"6","value":6}]}},{"type":"ExpressionStatement","start":2150,"end":2185,"expression":{"type":"CallExpression","start":2150,"end":2184,"optional":false,"callee":{"type":"MemberExpression","start":2150,"end":2170,"computed":false,"optional":false,"object":{"type":"Identifier","start":2150,"end":2152,"name":"i0"},"property":{"type":"Identifier","start":2153,"end":2170,"name":"ɵɵtextInterpolate"}},"arguments":[{"type":"MemberExpression","start":2171,"end":2183,"computed":false,"optional":false,"object":{"type":"Identifier","start":2171,"end":2177,"name":"ctx_r1"},"property":{"type":"Identifier","start":2178,"end":2183,"name":"error"}}]}}]},"alternate":null}]},"expression":false},{"type":"ExportNamedDeclaration","start":2309,"end":8607,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":2316,"end":8607,"decorators":[],"id":{"type":"Identifier","start":2322,"end":2345,"name":"OAuth2CallbackComponent"},"superClass":null,"body":{"type":"ClassBody","start":2346,"end":8607,"body":[{"type":"MethodDefinition","start":2352,"end":2606,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":2352,"end":2363,"name":"constructor"},"value":{"type":"FunctionExpression","start":2363,"end":2606,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":2364,"end":2377,"name":"oauth2Service"},{"type":"Identifier","start":2379,"end":2385,"name":"router"},{"type":"Identifier","start":2387,"end":2397,"name":"platformId"}],"body":{"type":"BlockStatement","start":2399,"end":2606,"body":[{"type":"ExpressionStatement","start":2409,"end":2444,"expression":{"type":"AssignmentExpression","start":2409,"end":2443,"operator":"=","left":{"type":"MemberExpression","start":2409,"end":2427,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2409,"end":2413},"property":{"type":"Identifier","start":2414,"end":2427,"name":"oauth2Service"}},"right":{"type":"Identifier","start":2430,"end":2443,"name":"oauth2Service"}}},{"type":"ExpressionStatement","start":2453,"end":2474,"expression":{"type":"AssignmentExpression","start":2453,"end":2473,"operator":"=","left":{"type":"MemberExpression","start":2453,"end":2464,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2453,"end":2457},"property":{"type":"Identifier","start":2458,"end":2464,"name":"router"}},"right":{"type":"Identifier","start":2467,"end":2473,"name":"router"}}},{"type":"ExpressionStatement","start":2483,"end":2512,"expression":{"type":"AssignmentExpression","start":2483,"end":2511,"operator":"=","left":{"type":"MemberExpression","start":2483,"end":2498,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2483,"end":2487},"property":{"type":"Identifier","start":2488,"end":2498,"name":"platformId"}},"right":{"type":"Identifier","start":2501,"end":2511,"name":"platformId"}}},{"type":"ExpressionStatement","start":2521,"end":2543,"expression":{"type":"AssignmentExpression","start":2521,"end":2542,"operator":"=","left":{"type":"MemberExpression","start":2521,"end":2535,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2521,"end":2525},"property":{"type":"Identifier","start":2526,"end":2535,"name":"isLoading"}},"right":{"type":"Literal","start":2538,"end":2542,"value":true,"raw":"true"}}},{"type":"ExpressionStatement","start":2552,"end":2570,"expression":{"type":"AssignmentExpression","start":2552,"end":2569,"operator":"=","left":{"type":"MemberExpression","start":2552,"end":2562,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2552,"end":2556},"property":{"type":"Identifier","start":2557,"end":2562,"name":"error"}},"right":{"type":"Literal","start":2565,"end":2569,"raw":"null","value":null}}},{"type":"ExpressionStatement","start":2579,"end":2600,"expression":{"type":"AssignmentExpression","start":2579,"end":2599,"operator":"=","left":{"type":"MemberExpression","start":2579,"end":2591,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2579,"end":2583},"property":{"type":"Identifier","start":2584,"end":2591,"name":"success"}},"right":{"type":"Literal","start":2594,"end":2599,"value":false,"raw":"false"}}}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":2611,"end":4051,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":2617,"end":2625,"name":"ngOnInit"},"value":{"type":"FunctionExpression","start":2625,"end":4051,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":2628,"end":4051,"body":[{"type":"IfStatement","start":2693,"end":2878,"test":{"type":"UnaryExpression","start":2697,"end":2732,"operator":"!","argument":{"type":"CallExpression","start":2698,"end":2732,"optional":false,"callee":{"type":"Identifier","start":2698,"end":2715,"name":"isPlatformBrowser"},"arguments":[{"type":"MemberExpression","start":2716,"end":2731,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2716,"end":2720},"property":{"type":"Identifier","start":2721,"end":2731,"name":"platformId"}}]},"prefix":true},"consequent":{"type":"BlockStatement","start":2734,"end":2878,"body":[{"type":"ExpressionStatement","start":2748,"end":2771,"expression":{"type":"AssignmentExpression","start":2748,"end":2770,"operator":"=","left":{"type":"MemberExpression","start":2748,"end":2762,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2748,"end":2752},"property":{"type":"Identifier","start":2753,"end":2762,"name":"isLoading"}},"right":{"type":"Literal","start":2765,"end":2770,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":2784,"end":2848,"expression":{"type":"AssignmentExpression","start":2784,"end":2847,"operator":"=","left":{"type":"MemberExpression","start":2784,"end":2794,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2784,"end":2788},"property":{"type":"Identifier","start":2789,"end":2794,"name":"error"}},"right":{"type":"Literal","start":2797,"end":2847,"value":"Browser environment required for OAuth2 callback","raw":"'Browser environment required for OAuth2 callback'"}}},{"type":"ReturnStatement","start":2861,"end":2868,"argument":null}]},"alternate":null},{"type":"ExpressionStatement","start":2973,"end":4045,"expression":{"type":"CallExpression","start":2973,"end":4044,"optional":false,"callee":{"type":"Identifier","start":2973,"end":2983,"name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","start":2984,"end":4038,"async":true,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":2996,"end":4038,"body":[{"type":"TryStatement","start":3010,"end":4028,"block":{"type":"BlockStatement","start":3014,"end":3787,"body":[{"type":"ExpressionStatement","start":3032,"end":3086,"expression":{"type":"CallExpression","start":3032,"end":3085,"optional":false,"callee":{"type":"MemberExpression","start":3032,"end":3043,"computed":false,"optional":false,"object":{"type":"Identifier","start":3032,"end":3039,"name":"console"},"property":{"type":"Identifier","start":3040,"end":3043,"name":"log"}},"arguments":[{"type":"Literal","start":3044,"end":3084,"value":"Starting OAuth2 callback processing...","raw":"'Starting OAuth2 callback processing...'"}]}},{"type":"ExpressionStatement","start":3103,"end":3153,"expression":{"type":"CallExpression","start":3103,"end":3152,"optional":false,"callee":{"type":"MemberExpression","start":3103,"end":3114,"computed":false,"optional":false,"object":{"type":"Identifier","start":3103,"end":3110,"name":"console"},"property":{"type":"Identifier","start":3111,"end":3114,"name":"log"}},"arguments":[{"type":"Literal","start":3115,"end":3129,"value":"Current URL:","raw":"'Current URL:'"},{"type":"MemberExpression","start":3131,"end":3151,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3131,"end":3146,"computed":false,"optional":false,"object":{"type":"Identifier","start":3131,"end":3137,"name":"window"},"property":{"type":"Identifier","start":3138,"end":3146,"name":"location"}},"property":{"type":"Identifier","start":3147,"end":3151,"name":"href"}}]}},{"type":"ExpressionStatement","start":3170,"end":3243,"expression":{"type":"CallExpression","start":3170,"end":3242,"optional":false,"callee":{"type":"MemberExpression","start":3170,"end":3181,"computed":false,"optional":false,"object":{"type":"Identifier","start":3170,"end":3177,"name":"console"},"property":{"type":"Identifier","start":3178,"end":3181,"name":"log"}},"arguments":[{"type":"Literal","start":3182,"end":3207,"value":"LocalStorage available:","raw":"'LocalStorage available:'"},{"type":"BinaryExpression","start":3209,"end":3241,"operator":"!==","left":{"type":"UnaryExpression","start":3209,"end":3225,"operator":"typeof","argument":{"type":"Identifier","start":3217,"end":3224,"name":"Storage"},"prefix":true},"right":{"type":"Literal","start":3230,"end":3241,"value":"undefined","raw":"\"undefined\""}}]}},{"type":"ExpressionStatement","start":3306,"end":3348,"expression":{"type":"AwaitExpression","start":3306,"end":3347,"argument":{"type":"CallExpression","start":3312,"end":3347,"optional":false,"callee":{"type":"MemberExpression","start":3312,"end":3345,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3312,"end":3330,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3312,"end":3316},"property":{"type":"Identifier","start":3317,"end":3330,"name":"oauth2Service"}},"property":{"type":"Identifier","start":3331,"end":3345,"name":"handleCallback"}},"arguments":[]}}},{"type":"ExpressionStatement","start":3392,"end":3415,"expression":{"type":"AssignmentExpression","start":3392,"end":3414,"operator":"=","left":{"type":"MemberExpression","start":3392,"end":3406,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3392,"end":3396},"property":{"type":"Identifier","start":3397,"end":3406,"name":"isLoading"}},"right":{"type":"Literal","start":3409,"end":3414,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":3432,"end":3452,"expression":{"type":"AssignmentExpression","start":3432,"end":3451,"operator":"=","left":{"type":"MemberExpression","start":3432,"end":3444,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3432,"end":3436},"property":{"type":"Identifier","start":3437,"end":3444,"name":"success"}},"right":{"type":"Literal","start":3447,"end":3451,"value":true,"raw":"true"}}},{"type":"ExpressionStatement","start":3517,"end":3773,"expression":{"type":"CallExpression","start":3517,"end":3772,"optional":false,"callee":{"type":"Identifier","start":3517,"end":3527,"name":"setTimeout"},"arguments":[{"type":"ArrowFunctionExpression","start":3528,"end":3765,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":3534,"end":3765,"body":[{"type":"ExpressionStatement","start":3719,"end":3747,"expression":{"type":"CallExpression","start":3719,"end":3746,"optional":false,"callee":{"type":"MemberExpression","start":3719,"end":3739,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3719,"end":3730,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3719,"end":3723},"property":{"type":"Identifier","start":3724,"end":3730,"name":"router"}},"property":{"type":"Identifier","start":3731,"end":3739,"name":"navigate"}},"arguments":[{"type":"ArrayExpression","start":3740,"end":3745,"elements":[{"type":"Literal","start":3741,"end":3744,"value":"/","raw":"'/'"}]}]}}]},"id":null},{"type":"Literal","start":3767,"end":3771,"raw":"2000","value":2000}]}}]},"handler":{"type":"CatchClause","start":3800,"end":4028,"param":{"type":"Identifier","start":3807,"end":3812,"name":"error"},"body":{"type":"BlockStatement","start":3814,"end":4028,"body":[{"type":"ExpressionStatement","start":3832,"end":3879,"expression":{"type":"CallExpression","start":3832,"end":3878,"optional":false,"callee":{"type":"MemberExpression","start":3832,"end":3845,"computed":false,"optional":false,"object":{"type":"Identifier","start":3832,"end":3839,"name":"console"},"property":{"type":"Identifier","start":3840,"end":3845,"name":"error"}},"arguments":[{"type":"Literal","start":3846,"end":3870,"value":"OAuth2 callback error:","raw":"'OAuth2 callback error:'"},{"type":"Identifier","start":3872,"end":3877,"name":"error"}]}},{"type":"ExpressionStatement","start":3896,"end":3919,"expression":{"type":"AssignmentExpression","start":3896,"end":3918,"operator":"=","left":{"type":"MemberExpression","start":3896,"end":3910,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3896,"end":3900},"property":{"type":"Identifier","start":3901,"end":3910,"name":"isLoading"}},"right":{"type":"Literal","start":3913,"end":3918,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":3936,"end":4014,"expression":{"type":"AssignmentExpression","start":3936,"end":4013,"operator":"=","left":{"type":"MemberExpression","start":3936,"end":3946,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3936,"end":3940},"property":{"type":"Identifier","start":3941,"end":3946,"name":"error"}},"right":{"type":"ConditionalExpression","start":3949,"end":4013,"test":{"type":"BinaryExpression","start":3949,"end":3971,"operator":"instanceof","left":{"type":"Identifier","start":3949,"end":3954,"name":"error"},"right":{"type":"Identifier","start":3966,"end":3971,"name":"Error"}},"consequent":{"type":"MemberExpression","start":3974,"end":3987,"computed":false,"optional":false,"object":{"type":"Identifier","start":3974,"end":3979,"name":"error"},"property":{"type":"Identifier","start":3980,"end":3987,"name":"message"}},"alternate":{"type":"Literal","start":3990,"end":4013,"value":"Authentication failed","raw":"'Authentication failed'"}}}}]}},"finalizer":null}]},"id":null},{"type":"Literal","start":4040,"end":4043,"raw":"100","value":100}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":4056,"end":4565,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":4056,"end":4066,"name":"retryLogin"},"value":{"type":"FunctionExpression","start":4066,"end":4565,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":4069,"end":4565,"body":[{"type":"IfStatement","start":4079,"end":4243,"test":{"type":"UnaryExpression","start":4083,"end":4130,"operator":"!","argument":{"type":"CallExpression","start":4084,"end":4130,"optional":false,"callee":{"type":"MemberExpression","start":4084,"end":4128,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4084,"end":4102,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4084,"end":4088},"property":{"type":"Identifier","start":4089,"end":4102,"name":"oauth2Service"}},"property":{"type":"Identifier","start":4103,"end":4128,"name":"isAuthenticationAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":4132,"end":4243,"body":[{"type":"ExpressionStatement","start":4146,"end":4213,"expression":{"type":"AssignmentExpression","start":4146,"end":4212,"operator":"=","left":{"type":"MemberExpression","start":4146,"end":4156,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4146,"end":4150},"property":{"type":"Identifier","start":4151,"end":4156,"name":"error"}},"right":{"type":"Literal","start":4159,"end":4212,"value":"Authentication not available in current environment","raw":"'Authentication not available in current environment'"}}},{"type":"ReturnStatement","start":4226,"end":4233,"argument":null}]},"alternate":null},{"type":"ExpressionStatement","start":4252,"end":4274,"expression":{"type":"AssignmentExpression","start":4252,"end":4273,"operator":"=","left":{"type":"MemberExpression","start":4252,"end":4266,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4252,"end":4256},"property":{"type":"Identifier","start":4257,"end":4266,"name":"isLoading"}},"right":{"type":"Literal","start":4269,"end":4273,"value":true,"raw":"true"}}},{"type":"ExpressionStatement","start":4283,"end":4301,"expression":{"type":"AssignmentExpression","start":4283,"end":4300,"operator":"=","left":{"type":"MemberExpression","start":4283,"end":4293,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4283,"end":4287},"property":{"type":"Identifier","start":4288,"end":4293,"name":"error"}},"right":{"type":"Literal","start":4296,"end":4300,"raw":"null","value":null}}},{"type":"ExpressionStatement","start":4310,"end":4331,"expression":{"type":"AssignmentExpression","start":4310,"end":4330,"operator":"=","left":{"type":"MemberExpression","start":4310,"end":4322,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4310,"end":4314},"property":{"type":"Identifier","start":4315,"end":4322,"name":"success"}},"right":{"type":"Literal","start":4325,"end":4330,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":4340,"end":4559,"expression":{"type":"CallExpression","start":4340,"end":4558,"optional":false,"callee":{"type":"MemberExpression","start":4340,"end":4385,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4340,"end":4379,"optional":false,"callee":{"type":"MemberExpression","start":4340,"end":4377,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4340,"end":4358,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4340,"end":4344},"property":{"type":"Identifier","start":4345,"end":4358,"name":"oauth2Service"}},"property":{"type":"Identifier","start":4359,"end":4377,"name":"startAuthorization"}},"arguments":[]},"property":{"type":"Identifier","start":4380,"end":4385,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":4386,"end":4557,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":4386,"end":4391,"name":"error"}],"body":{"type":"BlockStatement","start":4395,"end":4557,"body":[{"type":"ExpressionStatement","start":4409,"end":4452,"expression":{"type":"CallExpression","start":4409,"end":4451,"optional":false,"callee":{"type":"MemberExpression","start":4409,"end":4422,"computed":false,"optional":false,"object":{"type":"Identifier","start":4409,"end":4416,"name":"console"},"property":{"type":"Identifier","start":4417,"end":4422,"name":"error"}},"arguments":[{"type":"Literal","start":4423,"end":4443,"value":"Retry login error:","raw":"'Retry login error:'"},{"type":"Identifier","start":4445,"end":4450,"name":"error"}]}},{"type":"ExpressionStatement","start":4465,"end":4488,"expression":{"type":"AssignmentExpression","start":4465,"end":4487,"operator":"=","left":{"type":"MemberExpression","start":4465,"end":4479,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4465,"end":4469},"property":{"type":"Identifier","start":4470,"end":4479,"name":"isLoading"}},"right":{"type":"Literal","start":4482,"end":4487,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":4501,"end":4547,"expression":{"type":"AssignmentExpression","start":4501,"end":4546,"operator":"=","left":{"type":"MemberExpression","start":4501,"end":4511,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4501,"end":4505},"property":{"type":"Identifier","start":4506,"end":4511,"name":"error"}},"right":{"type":"Literal","start":4514,"end":4546,"value":"Failed to start authentication","raw":"'Failed to start authentication'"}}}]},"id":null}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":4570,"end":4623,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":4570,"end":4576,"name":"goHome"},"value":{"type":"FunctionExpression","start":4576,"end":4623,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":4579,"end":4623,"body":[{"type":"ExpressionStatement","start":4589,"end":4617,"expression":{"type":"CallExpression","start":4589,"end":4616,"optional":false,"callee":{"type":"MemberExpression","start":4589,"end":4609,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":4589,"end":4600,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4589,"end":4593},"property":{"type":"Identifier","start":4594,"end":4600,"name":"router"}},"property":{"type":"Identifier","start":4601,"end":4609,"name":"navigate"}},"arguments":[{"type":"ArrayExpression","start":4610,"end":4615,"elements":[{"type":"Literal","start":4611,"end":4614,"value":"/","raw":"'/'"}]}]}}]},"expression":false},"kind":"method"},{"type":"StaticBlock","start":4628,"end":4882,"body":[{"type":"ExpressionStatement","start":4637,"end":4880,"expression":{"type":"AssignmentExpression","start":4637,"end":4879,"operator":"=","left":{"type":"MemberExpression","start":4637,"end":4646,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4637,"end":4641},"property":{"type":"Identifier","start":4642,"end":4646,"name":"ɵfac"}},"right":{"type":"FunctionExpression","start":4649,"end":4879,"async":false,"generator":false,"id":{"type":"Identifier","start":4658,"end":4689,"name":"OAuth2CallbackComponent_Factory"},"params":[{"type":"Identifier","start":4690,"end":4707,"name":"__ngFactoryType__"}],"body":{"type":"BlockStatement","start":4709,"end":4879,"body":[{"type":"ReturnStatement","start":4711,"end":4877,"argument":{"type":"NewExpression","start":4718,"end":4876,"callee":{"type":"LogicalExpression","start":4723,"end":4767,"operator":"||","left":{"type":"Identifier","start":4723,"end":4740,"name":"__ngFactoryType__"},"right":{"type":"Identifier","start":4744,"end":4767,"name":"OAuth2CallbackComponent"}},"arguments":[{"type":"CallExpression","start":4769,"end":4807,"optional":false,"callee":{"type":"MemberExpression","start":4769,"end":4789,"computed":false,"optional":false,"object":{"type":"Identifier","start":4769,"end":4771,"name":"i0"},"property":{"type":"Identifier","start":4772,"end":4789,"name":"ɵɵdirectiveInject"}},"arguments":[{"type":"MemberExpression","start":4790,"end":4806,"computed":false,"optional":false,"object":{"type":"Identifier","start":4790,"end":4792,"name":"i1"},"property":{"type":"Identifier","start":4793,"end":4806,"name":"OAuth2Service"}}]},{"type":"CallExpression","start":4809,"end":4840,"optional":false,"callee":{"type":"MemberExpression","start":4809,"end":4829,"computed":false,"optional":false,"object":{"type":"Identifier","start":4809,"end":4811,"name":"i0"},"property":{"type":"Identifier","start":4812,"end":4829,"name":"ɵɵdirectiveInject"}},"arguments":[{"type":"MemberExpression","start":4830,"end":4839,"computed":false,"optional":false,"object":{"type":"Identifier","start":4830,"end":4832,"name":"i2"},"property":{"type":"Identifier","start":4833,"end":4839,"name":"Router"}}]},{"type":"CallExpression","start":4842,"end":4875,"optional":false,"callee":{"type":"MemberExpression","start":4842,"end":4862,"computed":false,"optional":false,"object":{"type":"Identifier","start":4842,"end":4844,"name":"i0"},"property":{"type":"Identifier","start":4845,"end":4862,"name":"ɵɵdirectiveInject"}},"arguments":[{"type":"Identifier","start":4863,"end":4874,"name":"PLATFORM_ID"}]}]}}]},"expression":false}}}]},{"type":"StaticBlock","start":4887,"end":8605,"body":[{"type":"ExpressionStatement","start":4896,"end":8603,"expression":{"type":"AssignmentExpression","start":4896,"end":8602,"operator":"=","left":{"type":"MemberExpression","start":4896,"end":4905,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":4896,"end":4900},"property":{"type":"Identifier","start":4901,"end":4905,"name":"ɵcmp"}},"right":{"type":"CallExpression","start":4922,"end":8602,"optional":false,"_rollupAnnotations":[{"end":4921,"start":4908,"type":"pure"}],"callee":{"type":"MemberExpression","start":4922,"end":4942,"computed":false,"optional":false,"object":{"type":"Identifier","start":4922,"end":4924,"name":"i0"},"property":{"type":"Identifier","start":4925,"end":4942,"name":"ɵɵdefineComponent"}},"arguments":[{"type":"ObjectExpression","start":4943,"end":8601,"properties":[{"type":"Property","start":4945,"end":4974,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4945,"end":4949,"name":"type"},"value":{"type":"Identifier","start":4951,"end":4974,"name":"OAuth2CallbackComponent"},"kind":"init"},{"type":"Property","start":4976,"end":5012,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":4976,"end":4985,"name":"selectors"},"value":{"type":"ArrayExpression","start":4987,"end":5012,"elements":[{"type":"ArrayExpression","start":4988,"end":5011,"elements":[{"type":"Literal","start":4989,"end":5010,"value":"lib-oauth2-callback","raw":"\"lib-oauth2-callback\""}]}]},"kind":"init"},{"type":"Property","start":5014,"end":5022,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5014,"end":5019,"name":"decls"},"value":{"type":"Literal","start":5021,"end":5022,"raw":"5","value":5},"kind":"init"},{"type":"Property","start":5024,"end":5031,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5024,"end":5028,"name":"vars"},"value":{"type":"Literal","start":5030,"end":5031,"raw":"3","value":3},"kind":"init"},{"type":"Property","start":5033,"end":5463,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5033,"end":5039,"name":"consts"},"value":{"type":"ArrayExpression","start":5041,"end":5463,"elements":[{"type":"ArrayExpression","start":5042,"end":5074,"elements":[{"type":"Literal","start":5043,"end":5044,"raw":"1","value":1},{"type":"Literal","start":5046,"end":5073,"value":"oauth2-callback-container","raw":"\"oauth2-callback-container\""}]},{"type":"ArrayExpression","start":5076,"end":5106,"elements":[{"type":"Literal","start":5077,"end":5078,"raw":"1","value":1},{"type":"Literal","start":5080,"end":5105,"value":"oauth2-callback-content","raw":"\"oauth2-callback-content\""}]},{"type":"ArrayExpression","start":5108,"end":5147,"elements":[{"type":"Literal","start":5109,"end":5116,"value":"class","raw":"\"class\""},{"type":"Literal","start":5118,"end":5135,"value":"loading-section","raw":"\"loading-section\""},{"type":"Literal","start":5137,"end":5138,"raw":"4","value":4},{"type":"Literal","start":5140,"end":5146,"value":"ngIf","raw":"\"ngIf\""}]},{"type":"ArrayExpression","start":5149,"end":5188,"elements":[{"type":"Literal","start":5150,"end":5157,"value":"class","raw":"\"class\""},{"type":"Literal","start":5159,"end":5176,"value":"success-section","raw":"\"success-section\""},{"type":"Literal","start":5178,"end":5179,"raw":"4","value":4},{"type":"Literal","start":5181,"end":5187,"value":"ngIf","raw":"\"ngIf\""}]},{"type":"ArrayExpression","start":5190,"end":5227,"elements":[{"type":"Literal","start":5191,"end":5198,"value":"class","raw":"\"class\""},{"type":"Literal","start":5200,"end":5215,"value":"error-section","raw":"\"error-section\""},{"type":"Literal","start":5217,"end":5218,"raw":"4","value":4},{"type":"Literal","start":5220,"end":5226,"value":"ngIf","raw":"\"ngIf\""}]},{"type":"ArrayExpression","start":5229,"end":5251,"elements":[{"type":"Literal","start":5230,"end":5231,"raw":"1","value":1},{"type":"Literal","start":5233,"end":5250,"value":"loading-section","raw":"\"loading-section\""}]},{"type":"ArrayExpression","start":5253,"end":5267,"elements":[{"type":"Literal","start":5254,"end":5255,"raw":"1","value":1},{"type":"Literal","start":5257,"end":5266,"value":"spinner","raw":"\"spinner\""}]},{"type":"ArrayExpression","start":5269,"end":5291,"elements":[{"type":"Literal","start":5270,"end":5271,"raw":"1","value":1},{"type":"Literal","start":5273,"end":5290,"value":"success-section","raw":"\"success-section\""}]},{"type":"ArrayExpression","start":5293,"end":5312,"elements":[{"type":"Literal","start":5294,"end":5295,"raw":"1","value":1},{"type":"Literal","start":5297,"end":5311,"value":"success-icon","raw":"\"success-icon\""}]},{"type":"ArrayExpression","start":5314,"end":5334,"elements":[{"type":"Literal","start":5315,"end":5316,"raw":"1","value":1},{"type":"Literal","start":5318,"end":5333,"value":"error-section","raw":"\"error-section\""}]},{"type":"ArrayExpression","start":5336,"end":5353,"elements":[{"type":"Literal","start":5337,"end":5338,"raw":"1","value":1},{"type":"Literal","start":5340,"end":5352,"value":"error-icon","raw":"\"error-icon\""}]},{"type":"ArrayExpression","start":5355,"end":5375,"elements":[{"type":"Literal","start":5356,"end":5357,"raw":"1","value":1},{"type":"Literal","start":5359,"end":5374,"value":"error-message","raw":"\"error-message\""}]},{"type":"ArrayExpression","start":5377,"end":5397,"elements":[{"type":"Literal","start":5378,"end":5379,"raw":"1","value":1},{"type":"Literal","start":5381,"end":5396,"value":"error-actions","raw":"\"error-actions\""}]},{"type":"ArrayExpression","start":5399,"end":5430,"elements":[{"type":"Literal","start":5400,"end":5401,"raw":"1","value":1},{"type":"Literal","start":5403,"end":5417,"value":"retry-button","raw":"\"retry-button\""},{"type":"Literal","start":5419,"end":5420,"raw":"3","value":3},{"type":"Literal","start":5422,"end":5429,"value":"click","raw":"\"click\""}]},{"type":"ArrayExpression","start":5432,"end":5462,"elements":[{"type":"Literal","start":5433,"end":5434,"raw":"1","value":1},{"type":"Literal","start":5436,"end":5449,"value":"home-button","raw":"\"home-button\""},{"type":"Literal","start":5451,"end":5452,"raw":"3","value":3},{"type":"Literal","start":5454,"end":5461,"value":"click","raw":"\"click\""}]}]},"kind":"init"},{"type":"Property","start":5465,"end":6137,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":5465,"end":5473,"name":"template"},"value":{"type":"FunctionExpression","start":5475,"end":6137,"async":false,"generator":false,"id":{"type":"Identifier","start":5484,"end":5516,"name":"OAuth2CallbackComponent_Template"},"params":[{"type":"Identifier","start":5517,"end":5519,"name":"rf"},{"type":"Identifier","start":5521,"end":5524,"name":"ctx"}],"body":{"type":"BlockStatement","start":5526,"end":6137,"body":[{"type":"IfStatement","start":5528,"end":5846,"test":{"type":"BinaryExpression","start":5532,"end":5538,"operator":"&","left":{"type":"Identifier","start":5532,"end":5534,"name":"rf"},"right":{"type":"Literal","start":5537,"end":5538,"raw":"1","value":1}},"consequent":{"type":"BlockStatement","start":5540,"end":5846,"body":[{"type":"ExpressionStatement","start":5554,"end":5598,"expression":{"type":"CallExpression","start":5554,"end":5597,"optional":false,"callee":{"type":"CallExpression","start":5554,"end":5584,"optional":false,"callee":{"type":"MemberExpression","start":5554,"end":5571,"computed":false,"optional":false,"object":{"type":"Identifier","start":5554,"end":5556,"name":"i0"},"property":{"type":"Identifier","start":5557,"end":5571,"name":"ɵɵelementStart"}},"arguments":[{"type":"Literal","start":5572,"end":5573,"raw":"0","value":0},{"type":"Literal","start":5575,"end":5580,"value":"div","raw":"\"div\""},{"type":"Literal","start":5582,"end":5583,"raw":"0","value":0}]},"arguments":[{"type":"Literal","start":5585,"end":5586,"raw":"1","value":1},{"type":"Literal","start":5588,"end":5593,"value":"div","raw":"\"div\""},{"type":"Literal","start":5595,"end":5596,"raw":"1","value":1}]}},{"type":"ExpressionStatement","start":5611,"end":5803,"expression":{"type":"CallExpression","start":5611,"end":5802,"optional":false,"callee":{"type":"CallExpression","start":5611,"end":5742,"optional":false,"callee":{"type":"CallExpression","start":5611,"end":5683,"optional":false,"callee":{"type":"MemberExpression","start":5611,"end":5624,"computed":false,"optional":false,"object":{"type":"Identifier","start":5611,"end":5613,"name":"i0"},"property":{"type":"Identifier","start":5614,"end":5624,"name":"ɵɵtemplate"}},"arguments":[{"type":"Literal","start":5625,"end":5626,"raw":"2","value":2},{"type":"Identifier","start":5628,"end":5666,"name":"OAuth2CallbackComponent_div_2_Template"},{"type":"Literal","start":5668,"end":5669,"raw":"6","value":6},{"type":"Literal","start":5671,"end":5672,"raw":"0","value":0},{"type":"Literal","start":5674,"end":5679,"value":"div","raw":"\"div\""},{"type":"Literal","start":5681,"end":5682,"raw":"2","value":2}]},"arguments":[{"type":"Literal","start":5684,"end":5685,"raw":"3","value":3},{"type":"Identifier","start":5687,"end":5725,"name":"OAuth2CallbackComponent_div_3_Template"},{"type":"Literal","start":5727,"end":5728,"raw":"7","value":7},{"type":"Literal","start":5730,"end":5731,"raw":"0","value":0},{"type":"Literal","start":5733,"end":5738,"value":"div","raw":"\"div\""},{"type":"Literal","start":5740,"end":5741,"raw":"3","value":3}]},"arguments":[{"type":"Literal","start":5743,"end":5744,"raw":"4","value":4},{"type":"Identifier","start":5746,"end":5784,"name":"OAuth2CallbackComponent_div_4_Template"},{"type":"Literal","start":5786,"end":5788,"raw":"12","value":12},{"type":"Literal","start":5790,"end":5791,"raw":"1","value":1},{"type":"Literal","start":5793,"end":5798,"value":"div","raw":"\"div\""},{"type":"Literal","start":5800,"end":5801,"raw":"4","value":4}]}},{"type":"ExpressionStatement","start":5816,"end":5836,"expression":{"type":"CallExpression","start":5816,"end":5835,"optional":false,"callee":{"type":"CallExpression","start":5816,"end":5833,"optional":false,"callee":{"type":"MemberExpression","start":5816,"end":5831,"computed":false,"optional":false,"object":{"type":"Identifier","start":5816,"end":5818,"name":"i0"},"property":{"type":"Identifier","start":5819,"end":5831,"name":"ɵɵelementEnd"}},"arguments":[]},"arguments":[]}}]},"alternate":null},{"type":"IfStatement","start":5847,"end":6135,"test":{"type":"BinaryExpression","start":5851,"end":5857,"operator":"&","left":{"type":"Identifier","start":5851,"end":5853,"name":"rf"},"right":{"type":"Literal","start":5856,"end":5857,"raw":"2","value":2}},"consequent":{"type":"BlockStatement","start":5859,"end":6135,"body":[{"type":"ExpressionStatement","start":5873,"end":5889,"expression":{"type":"CallExpression","start":5873,"end":5888,"optional":false,"callee":{"type":"MemberExpression","start":5873,"end":5885,"computed":false,"optional":false,"object":{"type":"Identifier","start":5873,"end":5875,"name":"i0"},"property":{"type":"Identifier","start":5876,"end":5885,"name":"ɵɵadvance"}},"arguments":[{"type":"Literal","start":5886,"end":5887,"raw":"2","value":2}]}},{"type":"ExpressionStatement","start":5902,"end":5939,"expression":{"type":"CallExpression","start":5902,"end":5938,"optional":false,"callee":{"type":"MemberExpression","start":5902,"end":5915,"computed":false,"optional":false,"object":{"type":"Identifier","start":5902,"end":5904,"name":"i0"},"property":{"type":"Identifier","start":5905,"end":5915,"name":"ɵɵproperty"}},"arguments":[{"type":"Literal","start":5916,"end":5922,"value":"ngIf","raw":"\"ngIf\""},{"type":"MemberExpression","start":5924,"end":5937,"computed":false,"optional":false,"object":{"type":"Identifier","start":5924,"end":5927,"name":"ctx"},"property":{"type":"Identifier","start":5928,"end":5937,"name":"isLoading"}}]}},{"type":"ExpressionStatement","start":5952,"end":5967,"expression":{"type":"CallExpression","start":5952,"end":5966,"optional":false,"callee":{"type":"MemberExpression","start":5952,"end":5964,"computed":false,"optional":false,"object":{"type":"Identifier","start":5952,"end":5954,"name":"i0"},"property":{"type":"Identifier","start":5955,"end":5964,"name":"ɵɵadvance"}},"arguments":[]}},{"type":"ExpressionStatement","start":5980,"end":6033,"expression":{"type":"CallExpression","start":5980,"end":6032,"optional":false,"callee":{"type":"MemberExpression","start":5980,"end":5993,"computed":false,"optional":false,"object":{"type":"Identifier","start":5980,"end":5982,"name":"i0"},"property":{"type":"Identifier","start":5983,"end":5993,"name":"ɵɵproperty"}},"arguments":[{"type":"Literal","start":5994,"end":6000,"value":"ngIf","raw":"\"ngIf\""},{"type":"LogicalExpression","start":6002,"end":6031,"operator":"&&","left":{"type":"MemberExpression","start":6002,"end":6013,"computed":false,"optional":false,"object":{"type":"Identifier","start":6002,"end":6005,"name":"ctx"},"property":{"type":"Identifier","start":6006,"end":6013,"name":"success"}},"right":{"type":"UnaryExpression","start":6017,"end":6031,"operator":"!","argument":{"type":"MemberExpression","start":6018,"end":6031,"computed":false,"optional":false,"object":{"type":"Identifier","start":6018,"end":6021,"name":"ctx"},"property":{"type":"Identifier","start":6022,"end":6031,"name":"isLoading"}},"prefix":true}}]}},{"type":"ExpressionStatement","start":6046,"end":6061,"expression":{"type":"CallExpression","start":6046,"end":6060,"optional":false,"callee":{"type":"MemberExpression","start":6046,"end":6058,"computed":false,"optional":false,"object":{"type":"Identifier","start":6046,"end":6048,"name":"i0"},"property":{"type":"Identifier","start":6049,"end":6058,"name":"ɵɵadvance"}},"arguments":[]}},{"type":"ExpressionStatement","start":6074,"end":6125,"expression":{"type":"CallExpression","start":6074,"end":6124,"optional":false,"callee":{"type":"MemberExpression","start":6074,"end":6087,"computed":false,"optional":false,"object":{"type":"Identifier","start":6074,"end":6076,"name":"i0"},"property":{"type":"Identifier","start":6077,"end":6087,"name":"ɵɵproperty"}},"arguments":[{"type":"Literal","start":6088,"end":6094,"value":"ngIf","raw":"\"ngIf\""},{"type":"LogicalExpression","start":6096,"end":6123,"operator":"&&","left":{"type":"MemberExpression","start":6096,"end":6105,"computed":false,"optional":false,"object":{"type":"Identifier","start":6096,"end":6099,"name":"ctx"},"property":{"type":"Identifier","start":6100,"end":6105,"name":"error"}},"right":{"type":"UnaryExpression","start":6109,"end":6123,"operator":"!","argument":{"type":"MemberExpression","start":6110,"end":6123,"computed":false,"optional":false,"object":{"type":"Identifier","start":6110,"end":6113,"name":"ctx"},"property":{"type":"Identifier","start":6114,"end":6123,"name":"isLoading"}},"prefix":true}}]}}]},"alternate":null}]},"expression":false},"kind":"init"},{"type":"Property","start":6139,"end":6176,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6139,"end":6151,"name":"dependencies"},"value":{"type":"ArrayExpression","start":6153,"end":6176,"elements":[{"type":"Identifier","start":6154,"end":6166,"name":"CommonModule"},{"type":"MemberExpression","start":6168,"end":6175,"computed":false,"optional":false,"object":{"type":"Identifier","start":6168,"end":6170,"name":"i3"},"property":{"type":"Identifier","start":6171,"end":6175,"name":"NgIf"}}]},"kind":"init"},{"type":"Property","start":6178,"end":8599,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":6178,"end":6184,"name":"styles"},"value":{"type":"ArrayExpression","start":6186,"end":8599,"elements":[{"type":"Literal","start":6187,"end":8598,"value":".oauth2-callback-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .error-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#333}.loading-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:0}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message[_ngcontent-%COMP%]{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.retry-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.home-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.home-button[_ngcontent-%COMP%]:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content[_ngcontent-%COMP%]{margin:.5rem;padding:1.5rem}.error-actions[_ngcontent-%COMP%]{flex-direction:column}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{width:100%}}","raw":"\".oauth2-callback-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .error-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#333}.loading-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:0}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message[_ngcontent-%COMP%]{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.retry-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.home-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.home-button[_ngcontent-%COMP%]:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content[_ngcontent-%COMP%]{margin:.5rem;padding:1.5rem}.error-actions[_ngcontent-%COMP%]{flex-direction:column}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{width:100%}}\""}]},"kind":"init"}]}]}}}]}]}}},{"type":"ExpressionStatement","start":8608,"end":11974,"expression":{"type":"CallExpression","start":8608,"end":11973,"optional":false,"callee":{"type":"ArrowFunctionExpression","start":8609,"end":11970,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":8615,"end":11970,"body":[{"type":"ExpressionStatement","start":8617,"end":11968,"expression":{"type":"LogicalExpression","start":8617,"end":11967,"operator":"&&","left":{"type":"LogicalExpression","start":8618,"end":8663,"operator":"||","left":{"type":"BinaryExpression","start":8618,"end":8650,"operator":"===","left":{"type":"UnaryExpression","start":8618,"end":8634,"operator":"typeof","argument":{"type":"Identifier","start":8625,"end":8634,"name":"ngDevMode"},"prefix":true},"right":{"type":"Literal","start":8639,"end":8650,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":8654,"end":8663,"name":"ngDevMode"}},"right":{"type":"CallExpression","start":8668,"end":11967,"optional":false,"callee":{"type":"MemberExpression","start":8668,"end":8688,"computed":false,"optional":false,"object":{"type":"Identifier","start":8668,"end":8670,"name":"i0"},"property":{"type":"Identifier","start":8671,"end":8688,"name":"ɵsetClassMetadata"}},"arguments":[{"type":"Identifier","start":8689,"end":8712,"name":"OAuth2CallbackComponent"},{"type":"ArrayExpression","start":8714,"end":11788,"elements":[{"type":"ObjectExpression","start":8715,"end":11787,"properties":[{"type":"Property","start":8725,"end":8740,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8725,"end":8729,"name":"type"},"value":{"type":"Identifier","start":8731,"end":8740,"name":"Component"},"kind":"init"},{"type":"Property","start":8750,"end":11781,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8750,"end":8754,"name":"args"},"value":{"type":"ArrayExpression","start":8756,"end":11781,"elements":[{"type":"ObjectExpression","start":8757,"end":11780,"properties":[{"type":"Property","start":8759,"end":8790,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8759,"end":8767,"name":"selector"},"value":{"type":"Literal","start":8769,"end":8790,"value":"lib-oauth2-callback","raw":"'lib-oauth2-callback'"},"kind":"init"},{"type":"Property","start":8792,"end":8808,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8792,"end":8802,"name":"standalone"},"value":{"type":"Literal","start":8804,"end":8808,"value":true,"raw":"true"},"kind":"init"},{"type":"Property","start":8810,"end":8833,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8810,"end":8817,"name":"imports"},"value":{"type":"ArrayExpression","start":8819,"end":8833,"elements":[{"type":"Identifier","start":8820,"end":8832,"name":"CommonModule"}]},"kind":"init"},{"type":"Property","start":8835,"end":9917,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":8835,"end":8843,"name":"template"},"value":{"type":"TemplateLiteral","start":8845,"end":9917,"quasis":[{"type":"TemplateElement","start":8846,"end":9916,"tail":true,"value":{"cooked":"\n    <div class=\"oauth2-callback-container\">\n      <div class=\"oauth2-callback-content\">\n        <div *ngIf=\"isLoading\" class=\"loading-section\">\n          <div class=\"spinner\"></div>\n          <h2>Processing Authentication...</h2>\n          <p>Please wait while we complete your login.</p>\n        </div>\n\n        <div *ngIf=\"success && !isLoading\" class=\"success-section\">\n          <div class=\"success-icon\">✓</div>\n          <h2>Authentication Successful!</h2>\n          <p>You will be redirected shortly...</p>\n        </div>\n\n        <div *ngIf=\"error && !isLoading\" class=\"error-section\">\n          <div class=\"error-icon\">✗</div>\n          <h2>Authentication Failed</h2>\n          <p class=\"error-message\">{{ error }}</p>\n          <div class=\"error-actions\">\n            <button (click)=\"retryLogin()\" class=\"retry-button\">\n              Try Again\n            </button>\n            <button (click)=\"goHome()\" class=\"home-button\">\n              Go Home\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  ","raw":"\r\n    <div class=\"oauth2-callback-container\">\r\n      <div class=\"oauth2-callback-content\">\r\n        <div *ngIf=\"isLoading\" class=\"loading-section\">\r\n          <div class=\"spinner\"></div>\r\n          <h2>Processing Authentication...</h2>\r\n          <p>Please wait while we complete your login.</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"success && !isLoading\" class=\"success-section\">\r\n          <div class=\"success-icon\">✓</div>\r\n          <h2>Authentication Successful!</h2>\r\n          <p>You will be redirected shortly...</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"error && !isLoading\" class=\"error-section\">\r\n          <div class=\"error-icon\">✗</div>\r\n          <h2>Authentication Failed</h2>\r\n          <p class=\"error-message\">{{ error }}</p>\r\n          <div class=\"error-actions\">\r\n            <button (click)=\"retryLogin()\" class=\"retry-button\">\r\n              Try Again\r\n            </button>\r\n            <button (click)=\"goHome()\" class=\"home-button\">\r\n              Go Home\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  "}}],"expressions":[]},"kind":"init"},{"type":"Property","start":9919,"end":11778,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":9919,"end":9925,"name":"styles"},"value":{"type":"ArrayExpression","start":9927,"end":11778,"elements":[{"type":"Literal","start":9928,"end":11777,"value":".oauth2-callback-container{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section h2,.success-section h2,.error-section h2{margin:1rem 0 .5rem;color:#333}.loading-section p,.success-section p{color:#666;margin-bottom:0}.spinner{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button,.home-button{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button{background-color:#007bff;color:#fff}.retry-button:hover{background-color:#0056b3}.home-button{background-color:#6c757d;color:#fff}.home-button:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content{margin:.5rem;padding:1.5rem}.error-actions{flex-direction:column}.retry-button,.home-button{width:100%}}\n","raw":"\".oauth2-callback-container{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section h2,.success-section h2,.error-section h2{margin:1rem 0 .5rem;color:#333}.loading-section p,.success-section p{color:#666;margin-bottom:0}.spinner{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button,.home-button{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button{background-color:#007bff;color:#fff}.retry-button:hover{background-color:#0056b3}.home-button{background-color:#6c757d;color:#fff}.home-button:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content{margin:.5rem;padding:1.5rem}.error-actions{flex-direction:column}.retry-button,.home-button{width:100%}}\\n\""}]},"kind":"init"}]}]},"kind":"init"}]}]},{"type":"ArrowFunctionExpression","start":11790,"end":11960,"async":false,"expression":true,"generator":false,"params":[],"body":{"type":"ArrayExpression","start":11796,"end":11960,"elements":[{"type":"ObjectExpression","start":11797,"end":11823,"properties":[{"type":"Property","start":11799,"end":11821,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11799,"end":11803,"name":"type"},"value":{"type":"MemberExpression","start":11805,"end":11821,"computed":false,"optional":false,"object":{"type":"Identifier","start":11805,"end":11807,"name":"i1"},"property":{"type":"Identifier","start":11808,"end":11821,"name":"OAuth2Service"}},"kind":"init"}]},{"type":"ObjectExpression","start":11825,"end":11844,"properties":[{"type":"Property","start":11827,"end":11842,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11827,"end":11831,"name":"type"},"value":{"type":"MemberExpression","start":11833,"end":11842,"computed":false,"optional":false,"object":{"type":"Identifier","start":11833,"end":11835,"name":"i2"},"property":{"type":"Identifier","start":11836,"end":11842,"name":"Router"}},"kind":"init"}]},{"type":"ObjectExpression","start":11846,"end":11959,"properties":[{"type":"Property","start":11848,"end":11860,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11848,"end":11852,"name":"type"},"value":{"type":"Identifier","start":11854,"end":11860,"name":"Object"},"kind":"init"},{"type":"Property","start":11862,"end":11957,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11862,"end":11872,"name":"decorators"},"value":{"type":"ArrayExpression","start":11874,"end":11957,"elements":[{"type":"ObjectExpression","start":11875,"end":11956,"properties":[{"type":"Property","start":11893,"end":11905,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11893,"end":11897,"name":"type"},"value":{"type":"Identifier","start":11899,"end":11905,"name":"Inject"},"kind":"init"},{"type":"Property","start":11923,"end":11942,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":11923,"end":11927,"name":"args"},"value":{"type":"ArrayExpression","start":11929,"end":11942,"elements":[{"type":"Identifier","start":11930,"end":11941,"name":"PLATFORM_ID"}]},"kind":"init"}]}]},"kind":"init"}]}]},"id":null},{"type":"Literal","start":11962,"end":11966,"raw":"null","value":null}]}}}]},"id":null},"arguments":[]}},{"type":"ExpressionStatement","start":11975,"end":12220,"expression":{"type":"CallExpression","start":11975,"end":12219,"optional":false,"callee":{"type":"ArrowFunctionExpression","start":11976,"end":12216,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":11982,"end":12216,"body":[{"type":"ExpressionStatement","start":11984,"end":12214,"expression":{"type":"LogicalExpression","start":11984,"end":12213,"operator":"&&","left":{"type":"LogicalExpression","start":11985,"end":12030,"operator":"||","left":{"type":"BinaryExpression","start":11985,"end":12017,"operator":"===","left":{"type":"UnaryExpression","start":11985,"end":12001,"operator":"typeof","argument":{"type":"Identifier","start":11992,"end":12001,"name":"ngDevMode"},"prefix":true},"right":{"type":"Literal","start":12006,"end":12017,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":12021,"end":12030,"name":"ngDevMode"}},"right":{"type":"CallExpression","start":12035,"end":12213,"optional":false,"callee":{"type":"MemberExpression","start":12035,"end":12056,"computed":false,"optional":false,"object":{"type":"Identifier","start":12035,"end":12037,"name":"i0"},"property":{"type":"Identifier","start":12038,"end":12056,"name":"ɵsetClassDebugInfo"}},"arguments":[{"type":"Identifier","start":12057,"end":12080,"name":"OAuth2CallbackComponent"},{"type":"ObjectExpression","start":12082,"end":12212,"properties":[{"type":"Property","start":12084,"end":12120,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12084,"end":12093,"name":"className"},"value":{"type":"Literal","start":12095,"end":12120,"value":"OAuth2CallbackComponent","raw":"\"OAuth2CallbackComponent\""},"kind":"init"},{"type":"Property","start":12122,"end":12193,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12122,"end":12130,"name":"filePath"},"value":{"type":"Literal","start":12132,"end":12193,"value":"lib/components/oauth2-callback/oauth2-callback.component.ts","raw":"\"lib/components/oauth2-callback/oauth2-callback.component.ts\""},"kind":"init"},{"type":"Property","start":12195,"end":12210,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":12195,"end":12205,"name":"lineNumber"},"value":{"type":"Literal","start":12207,"end":12210,"raw":"185","value":185},"kind":"init"}]}]}}}]},"id":null},"arguments":[]}}],"_rollupRemoved":[{"end":25915,"start":12221,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { Component, Inject, PLATFORM_ID } from '@angular/core';\nimport { CommonModule, isPlatformBrowser } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/oauth2.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction OAuth2CallbackComponent_div_2_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"div\", 6);\n    i0.ɵɵelementStart(2, \"h2\");\n    i0.ɵɵtext(3, \"Processing Authentication...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Please wait while we complete your login.\");\n    i0.ɵɵelementEnd()();\n} }\nfunction OAuth2CallbackComponent_div_3_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8);\n    i0.ɵɵtext(2, \"\\u2713\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4, \"Authentication Successful!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6, \"You will be redirected shortly...\");\n    i0.ɵɵelementEnd()();\n} }\nfunction OAuth2CallbackComponent_div_4_Template(rf, ctx) { if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\", 10);\n    i0.ɵɵtext(2, \"\\u2717\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4, \"Authentication Failed\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 11);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 12)(8, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function OAuth2CallbackComponent_div_4_Template_button_click_8_listener() { i0.ɵɵrestoreView(_r1); const ctx_r1 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r1.retryLogin()); });\n    i0.ɵɵtext(9, \" Try Again \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function OAuth2CallbackComponent_div_4_Template_button_click_10_listener() { i0.ɵɵrestoreView(_r1); const ctx_r1 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r1.goHome()); });\n    i0.ɵɵtext(11, \" Go Home \");\n    i0.ɵɵelementEnd()()();\n} if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r1.error);\n} }\n/**\n * OAuth2 Callback Component\n * Handles the OAuth2 authorization callback and processes the authorization code\n */\nexport class OAuth2CallbackComponent {\n    constructor(oauth2Service, router, platformId) {\n        this.oauth2Service = oauth2Service;\n        this.router = router;\n        this.platformId = platformId;\n        this.isLoading = true;\n        this.error = null;\n        this.success = false;\n    }\n    async ngOnInit() {\n        // Only handle callback in browser environment\n        if (!isPlatformBrowser(this.platformId)) {\n            this.isLoading = false;\n            this.error = 'Browser environment required for OAuth2 callback';\n            return;\n        }\n        // Add a small delay to ensure the component is fully rendered on client side\n        setTimeout(async () => {\n            try {\n                console.log('Starting OAuth2 callback processing...');\n                console.log('Current URL:', window.location.href);\n                console.log('LocalStorage available:', typeof (Storage) !== \"undefined\");\n                // Handle the OAuth2 callback\n                await this.oauth2Service.handleCallback();\n                // Success\n                this.isLoading = false;\n                this.success = true;\n                // Redirect after a short delay\n                setTimeout(() => {\n                    // You can customize this redirect logic based on your needs\n                    // For example, redirect to a specific route or emit an event\n                    this.router.navigate(['/']);\n                }, 2000);\n            }\n            catch (error) {\n                console.error('OAuth2 callback error:', error);\n                this.isLoading = false;\n                this.error = error instanceof Error ? error.message : 'Authentication failed';\n            }\n        }, 100);\n    }\n    retryLogin() {\n        if (!this.oauth2Service.isAuthenticationAvailable()) {\n            this.error = 'Authentication not available in current environment';\n            return;\n        }\n        this.isLoading = true;\n        this.error = null;\n        this.success = false;\n        this.oauth2Service.startAuthorization().catch(error => {\n            console.error('Retry login error:', error);\n            this.isLoading = false;\n            this.error = 'Failed to start authentication';\n        });\n    }\n    goHome() {\n        this.router.navigate(['/']);\n    }\n    static { this.ɵfac = function OAuth2CallbackComponent_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2CallbackComponent)(i0.ɵɵdirectiveInject(i1.OAuth2Service), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(PLATFORM_ID)); }; }\n    static { this.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: OAuth2CallbackComponent, selectors: [[\"lib-oauth2-callback\"]], decls: 5, vars: 3, consts: [[1, \"oauth2-callback-container\"], [1, \"oauth2-callback-content\"], [\"class\", \"loading-section\", 4, \"ngIf\"], [\"class\", \"success-section\", 4, \"ngIf\"], [\"class\", \"error-section\", 4, \"ngIf\"], [1, \"loading-section\"], [1, \"spinner\"], [1, \"success-section\"], [1, \"success-icon\"], [1, \"error-section\"], [1, \"error-icon\"], [1, \"error-message\"], [1, \"error-actions\"], [1, \"retry-button\", 3, \"click\"], [1, \"home-button\", 3, \"click\"]], template: function OAuth2CallbackComponent_Template(rf, ctx) { if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n            i0.ɵɵtemplate(2, OAuth2CallbackComponent_div_2_Template, 6, 0, \"div\", 2)(3, OAuth2CallbackComponent_div_3_Template, 7, 0, \"div\", 3)(4, OAuth2CallbackComponent_div_4_Template, 12, 1, \"div\", 4);\n            i0.ɵɵelementEnd()();\n        } if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.success && !ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error && !ctx.isLoading);\n        } }, dependencies: [CommonModule, i3.NgIf], styles: [\".oauth2-callback-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .error-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#333}.loading-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:0}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message[_ngcontent-%COMP%]{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.retry-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.home-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.home-button[_ngcontent-%COMP%]:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content[_ngcontent-%COMP%]{margin:.5rem;padding:1.5rem}.error-actions[_ngcontent-%COMP%]{flex-direction:column}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{width:100%}}\"] }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2CallbackComponent, [{\n        type: Component,\n        args: [{ selector: 'lib-oauth2-callback', standalone: true, imports: [CommonModule], template: `\r\n    <div class=\"oauth2-callback-container\">\r\n      <div class=\"oauth2-callback-content\">\r\n        <div *ngIf=\"isLoading\" class=\"loading-section\">\r\n          <div class=\"spinner\"></div>\r\n          <h2>Processing Authentication...</h2>\r\n          <p>Please wait while we complete your login.</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"success && !isLoading\" class=\"success-section\">\r\n          <div class=\"success-icon\">✓</div>\r\n          <h2>Authentication Successful!</h2>\r\n          <p>You will be redirected shortly...</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"error && !isLoading\" class=\"error-section\">\r\n          <div class=\"error-icon\">✗</div>\r\n          <h2>Authentication Failed</h2>\r\n          <p class=\"error-message\">{{ error }}</p>\r\n          <div class=\"error-actions\">\r\n            <button (click)=\"retryLogin()\" class=\"retry-button\">\r\n              Try Again\r\n            </button>\r\n            <button (click)=\"goHome()\" class=\"home-button\">\r\n              Go Home\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `, styles: [\".oauth2-callback-container{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section h2,.success-section h2,.error-section h2{margin:1rem 0 .5rem;color:#333}.loading-section p,.success-section p{color:#666;margin-bottom:0}.spinner{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button,.home-button{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button{background-color:#007bff;color:#fff}.retry-button:hover{background-color:#0056b3}.home-button{background-color:#6c757d;color:#fff}.home-button:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content{margin:.5rem;padding:1.5rem}.error-actions{flex-direction:column}.retry-button,.home-button{width:100%}}\\n\"] }]\n    }], () => [{ type: i1.OAuth2Service }, { type: i2.Router }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }], null); })();\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassDebugInfo(OAuth2CallbackComponent, { className: \"OAuth2CallbackComponent\", filePath: \"lib/components/oauth2-callback/oauth2-callback.component.ts\", lineNumber: 185 }); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9vYXV0aDItY2FsbGJhY2svb2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkUsT0FBTyxFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7SUFlMUQsOEJBQStDO0lBQzdDLHlCQUEyQjtJQUMzQiwwQkFBSTtJQUFBLDRDQUE0QjtJQUFBLGlCQUFLO0lBQ3JDLHlCQUFHO0lBQUEseURBQXlDO0lBQzlDLEFBRDhDLGlCQUFJLEVBQzVDOzs7SUFHSixBQURGLDhCQUEyRCxhQUMvQjtJQUFBLHNCQUFDO0lBQUEsaUJBQU07SUFDakMsMEJBQUk7SUFBQSwwQ0FBMEI7SUFBQSxpQkFBSztJQUNuQyx5QkFBRztJQUFBLGlEQUFpQztJQUN0QyxBQURzQyxpQkFBSSxFQUNwQzs7OztJQUdKLEFBREYsOEJBQXVELGNBQzdCO0lBQUEsc0JBQUM7SUFBQSxpQkFBTTtJQUMvQiwwQkFBSTtJQUFBLHFDQUFxQjtJQUFBLGlCQUFLO0lBQzlCLDZCQUF5QjtJQUFBLFlBQVc7SUFBQSxpQkFBSTtJQUV0QyxBQURGLCtCQUEyQixpQkFDMkI7SUFBNUMsbUxBQVMsbUJBQVksS0FBQztJQUM1QiwyQkFDRjtJQUFBLGlCQUFTO0lBQ1QsbUNBQStDO0lBQXZDLG9MQUFTLGVBQVEsS0FBQztJQUN4QiwwQkFDRjtJQUVKLEFBREUsQUFERSxpQkFBUyxFQUNMLEVBQ0Y7OztJQVRxQixlQUFXO0lBQVgsa0NBQVc7O0FBMUI5Qzs7O0dBR0c7QUFnTEgsTUFBTSxPQUFPLHVCQUF1QjtJQUtsQyxZQUNVLGFBQTRCLEVBQzVCLE1BQWMs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QTtZQWFuQyxBQU5BLEFBTkEsd0VBQStDLDJEQU1ZLDREQU1KO1lBYzNELEFBREUsaUJBQU0sRUFDRjs7WUExQkksZUFBZTtZQUFmLG9DQUFlO1lBTWYsY0FBMkI7WUFBM0Isb0RBQTJCO1lBTTNCLGNBQXlCO1lBQXpCLGtEQUF5Qjs0QkFoQjNCLFlBQVk7O2lGQTRLWCx1QkFBdUI7Y0EvS25DLFNBQVM7MkJBQ0UscUJBQXFCLGNBQ25CLElBQUksV0FDUCxDQUFDLFlBQVksQ0FBQyxZQUNiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0E4QlQ7O3NCQXFKRSxNQUFNO3VCQUFDLFdBQVc7O2tGQVJWLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbW1vbk1vZHVsZSwgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPQXV0aDJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvb2F1dGgyLnNlcnZpY2UnO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBDYWxsYmFjayBDb21wb25lbnRcclxuICogSGFuZGxlcyB0aGUgT0F1dGgyIGF1dGhvcml6YXRpb24gY2FsbGJhY2sgYW5kIHByb2Nlc3NlcyB0aGUgYXV0aG9yaXphdGlvbiBjb2RlXHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi1vYXV0aDItY2FsbGJhY2snLFxyXG4gIHN0YW5kYWxvbmU6IHRydWUsXHJcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgY2xhc3M9XCJvYXV0aDItY2FsbGJhY2stY29udGFpbmVyXCI+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJvYXV0aDItY2FsbGJhY2stY29udGVudFwiPlxyXG4gICAgICAgIDxkaXYgKm5nSWY9XCJpc0xvYWRpbmdcIiBjbGFzcz1cImxvYWRpbmctc2VjdGlvblwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNwaW5uZXJcIj48L2Rpdj5cclxuICAgICAgICAgIDxoMj5Qcm9jZXNzaW5nIEF1dGhlbnRpY2F0aW9uLi4uPC9oMj5cclxuICAgICAgICAgIDxwPlBsZWFzZSB3YWl0IHdoaWxlIHdlIGNvbXBsZXRlIHlvdXIgbG9naW4uPC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICA8ZGl2ICpuZ0lmPVwic3VjY2VzcyAmJiAhaXNMb2FkaW5nXCIgY2xhc3M9XCJzdWNjZXNzLXNlY3Rpb25cIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdWNjZXNzLWljb25cIj7inJM8L2Rpdj5cclxuICAgICAgICAgIDxoMj5BdXRoZW50aWNhdGlvbiBTdWNjZXNzZnVsITwvaDI+XHJcbiAgICAgICAgICA8cD5Zb3Ugd2lsbCBiZSByZWRpcmVjdGVkIHNob3J0bHkuLi48L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIDxkaXYgKm5nSWY9XCJlcnJvciAmJiAhaXNMb2FkaW5nXCIgY2xhc3M9XCJlcnJvci1zZWN0aW9uXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXJyb3ItaWNvblwiPuKclzwvZGl2PlxyXG4gICAgICAgICAgPGgyPkF1dGhlbnRpY2F0aW9uIEZhaWxlZDwvaDI+XHJcbiAgICAgICAgICA8cCBjbGFzcz1cImVycm9yLW1lc3NhZ2VcIj57eyBlcnJvciB9fTwvcD5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJlcnJvci1hY3Rpb25zXCI+XHJcbiAgICAgICAgICAgIDxidXR0b24gKGNsaWNrKT1cInJldHJ5TG9naW4oKVwiIGNsYXNzPVwicmV0cnktYnV0dG9uXCI+XHJcbiAgICAgICAgICAgICAgVHJ5IEFnYWluXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8YnV0dG9uIChjbGljayk9XCJnb0hvbWUoKVwiIGNsYXNzPVwiaG9tZS1idXR0b25cIj5cclxuICAgICAgICAgICAgICBHbyBIb21lXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZXM6IFtgXHJcbiAgICAub2F1dGgyLWNhbGxiYWNrLWNvbnRhaW5lciB7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICBtaW4taGVpZ2h0OiAxMDB2aDtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTtcclxuICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBzYW5zLXNlcmlmO1xyXG4gICAgfVxyXG5cclxuICAgIC5vYXV0aDItY2FsbGJhY2stY29udGVudCB7XHJcbiAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA4cHg7XHJcbiAgICAgIHBhZGRpbmc6IDJyZW07XHJcbiAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgbWF4LXdpZHRoOiA0MDBweDtcclxuICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgIG1hcmdpbjogMXJlbTtcclxuICAgIH1cclxuXHJcbiAgICAubG9hZGluZy1zZWN0aW9uIGgyLFxyXG4gICAgLnN1Y2Nlc3Mtc2VjdGlvbiBoMixcclxuICAgIC5lcnJvci1zZWN0aW9uIGgyIHtcclxuICAgICAgbWFyZ2luOiAxcmVtIDAgMC41cmVtIDA7XHJcbiAgICAgIGNvbG9yOiAjMzMzO1xyXG4gICAgfVxyXG5cclxuICAgIC5sb2FkaW5nLXNlY3Rpb24gcCxcclxuICAgIC5zdWNjZXNzLXNlY3Rpb24gcCB7XHJcbiAgICAgIGNvbG9yOiAjNjY2O1xyXG4gICAgICBtYXJnaW4tYm90dG9tOiAwO1xyXG4gICAgfVxyXG5cclxuICAgIC5zcGlubmVyIHtcclxuICAgICAgYm9yZGVyOiAzcHggc29saWQgI2YzZjNmMztcclxuICAgICAgYm9yZGVyLXRvcDogM3B4IHNvbGlkICMwMDdiZmY7XHJcbiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgICAgd2lkdGg6IDQwcHg7XHJcbiAgICAgIGhlaWdodDogNDBweDtcclxuICAgICAgYW5pbWF0aW9uOiBzcGluIDFzIGxpbmVhciBpbmZpbml0ZTtcclxuICAgICAgbWFyZ2luOiAwIGF1dG8gMXJlbSBhdXRvO1xyXG4gICAgfVxyXG5cclxuICAgIEBrZXlmcmFtZXMgc3BpbiB7XHJcbiAgICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH1cclxuICAgICAgMTAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH1cclxuICAgIH1cclxuXHJcbiAgICAuc3VjY2Vzcy1pY29uIHtcclxuICAgICAgd2lkdGg6IDYwcHg7XHJcbiAgICAgIGhlaWdodDogNjBweDtcclxuICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjhhNzQ1O1xyXG4gICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICBmb250LXNpemU6IDJyZW07XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgICBtYXJnaW46IDAgYXV0byAxcmVtIGF1dG87XHJcbiAgICB9XHJcblxyXG4gICAgLmVycm9yLWljb24ge1xyXG4gICAgICB3aWR0aDogNjBweDtcclxuICAgICAgaGVpZ2h0OiA2MHB4O1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkYzM1NDU7XHJcbiAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICAgIGZvbnQtc2l6ZTogMnJlbTtcclxuICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgIG1hcmdpbjogMCBhdXRvIDFyZW0gYXV0bztcclxuICAgIH1cclxuXHJcbiAgICAuZXJyb3ItbWVzc2FnZSB7XHJcbiAgICAgIGNvbG9yOiAjZGMzNTQ1O1xyXG4gICAgICBtYXJnaW46IDFyZW0gMDtcclxuICAgICAgcGFkZGluZzogMC41cmVtO1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhkN2RhO1xyXG4gICAgICBib3JkZXI6IDFweCBzb2xpZCAjZjVjNmNiO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgIGZvbnQtc2l6ZTogMC45cmVtO1xyXG4gICAgfVxyXG5cclxuICAgIC5lcnJvci1hY3Rpb25zIHtcclxuICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgZ2FwOiAxcmVtO1xyXG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgICAgbWFyZ2luLXRvcDogMS41cmVtO1xyXG4gICAgfVxyXG5cclxuICAgIC5yZXRyeS1idXR0b24sXHJcbiAgICAuaG9tZS1idXR0b24ge1xyXG4gICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTtcclxuICAgICAgYm9yZGVyOiBub25lO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgZm9udC1zaXplOiAwLjlyZW07XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcclxuICAgIH1cclxuXHJcbiAgICAucmV0cnktYnV0dG9uIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjtcclxuICAgICAgY29sb3I6IHdoaXRlO1xyXG4gICAgfVxyXG5cclxuICAgIC5yZXRyeS1idXR0b246aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA1NmIzO1xyXG4gICAgfVxyXG5cclxuICAgIC5ob21lLWJ1dHRvbiB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM2Yzc1N2Q7XHJcbiAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuXHJcbiAgICAuaG9tZS1idXR0b246aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTQ1YjYyO1xyXG4gICAgfVxyXG5cclxuICAgIEBtZWRpYSAobWF4LXdpZHRoOiA0ODBweCkge1xyXG4gICAgICAub2F1dGgyLWNhbGxiYWNrLWNvbnRlbnQge1xyXG4gICAgICAgIG1hcmdpbjogMC41cmVtO1xyXG4gICAgICAgIHBhZGRpbmc6IDEuNXJlbTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLmVycm9yLWFjdGlvbnMge1xyXG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5yZXRyeS1idXR0b24sXHJcbiAgICAgIC5ob21lLWJ1dHRvbiB7XHJcbiAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgT0F1dGgyQ2FsbGJhY2tDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIGlzTG9hZGluZyA9IHRydWU7XHJcbiAgZXJyb3I6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gIHN1Y2Nlc3MgPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG9hdXRoMlNlcnZpY2U6IE9BdXRoMlNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxyXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybUlkOiBPYmplY3RcclxuICApIHt9XHJcblxyXG4gIGFzeW5jIG5nT25Jbml0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8gT25seSBoYW5kbGUgY2FsbGJhY2sgaW4gYnJvd3NlciBlbnZpcm9ubWVudFxyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSAnQnJvd3NlciBlbnZpcm9ubWVudCByZXF1aXJlZCBmb3IgT0F1dGgyIGNhbGxiYWNrJztcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBhIHNtYWxsIGRlbGF5IHRvIGVuc3VyZSB0aGUgY29tcG9uZW50IGlzIGZ1bGx5IHJlbmRlcmVkIG9uIGNsaWVudCBzaWRlXHJcbiAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnU3RhcnRpbmcgT0F1dGgyIGNhbGxiYWNrIHByb2Nlc3NpbmcuLi4nKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ3VycmVudCBVUkw6Jywgd2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdMb2NhbFN0b3JhZ2UgYXZhaWxhYmxlOicsIHR5cGVvZihTdG9yYWdlKSAhPT0gXCJ1bmRlZmluZWRcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSGFuZGxlIHRoZSBPQXV0aDIgY2FsbGJhY2tcclxuICAgICAgICBhd2FpdCB0aGlzLm9hdXRoMlNlcnZpY2UuaGFuZGxlQ2FsbGJhY2soKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTdWNjZXNzXHJcbiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnN1Y2Nlc3MgPSB0cnVlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZGlyZWN0IGFmdGVyIGEgc2hvcnQgZGVsYXlcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIC8vIFlvdSBjYW4gY3VzdG9taXplIHRoaXMgcmVkaXJlY3QgbG9naWMgYmFzZWQgb24geW91ciBuZWVkc1xyXG4gICAgICAgICAgLy8gRm9yIGV4YW1wbGUsIHJlZGlyZWN0IHRvIGEgc3BlY2lmaWMgcm91dGUgb3IgZW1pdCBhbiBldmVudFxyXG4gICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycvJ10pO1xyXG4gICAgICAgIH0sIDIwMDApO1xyXG4gICAgICAgIFxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ09BdXRoMiBjYWxsYmFjayBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJztcclxuICAgICAgfVxyXG4gICAgfSwgMTAwKTtcclxuICB9XHJcblxyXG4gIHJldHJ5TG9naW4oKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMub2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0aW9uQXZhaWxhYmxlKCkpIHtcclxuICAgICAgdGhpcy5lcnJvciA9ICdBdXRoZW50aWNhdGlvbiBub3QgYXZhaWxhYmxlIGluIGN1cnJlbnQgZW52aXJvbm1lbnQnO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgdGhpcy5lcnJvciA9IG51bGw7XHJcbiAgICB0aGlzLnN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgIFxyXG4gICAgdGhpcy5vYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignUmV0cnkgbG9naW4gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmVycm9yID0gJ0ZhaWxlZCB0byBzdGFydCBhdXRoZW50aWNhdGlvbic7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdvSG9tZSgpOiB2b2lkIHtcclxuICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLyddKTtcclxuICB9XHJcbn0iXX0=","customTransformCache":false,"dependencies":["@angular/core","@angular/common","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","@angular/router"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/components/oauth2-callback/oauth2-callback.component.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { Component, Inject, PLATFORM_ID } from '@angular/core';\nimport { CommonModule, isPlatformBrowser } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/oauth2.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nfunction OAuth2CallbackComponent_div_2_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5);\n    i0.ɵɵelement(1, \"div\", 6);\n    i0.ɵɵelementStart(2, \"h2\");\n    i0.ɵɵtext(3, \"Processing Authentication...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\");\n    i0.ɵɵtext(5, \"Please wait while we complete your login.\");\n    i0.ɵɵelementEnd()();\n} }\nfunction OAuth2CallbackComponent_div_3_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"div\", 8);\n    i0.ɵɵtext(2, \"\\u2713\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4, \"Authentication Successful!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6, \"You will be redirected shortly...\");\n    i0.ɵɵelementEnd()();\n} }\nfunction OAuth2CallbackComponent_div_4_Template(rf, ctx) { if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 9)(1, \"div\", 10);\n    i0.ɵɵtext(2, \"\\u2717\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h2\");\n    i0.ɵɵtext(4, \"Authentication Failed\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 11);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 12)(8, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function OAuth2CallbackComponent_div_4_Template_button_click_8_listener() { i0.ɵɵrestoreView(_r1); const ctx_r1 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r1.retryLogin()); });\n    i0.ɵɵtext(9, \" Try Again \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function OAuth2CallbackComponent_div_4_Template_button_click_10_listener() { i0.ɵɵrestoreView(_r1); const ctx_r1 = i0.ɵɵnextContext(); return i0.ɵɵresetView(ctx_r1.goHome()); });\n    i0.ɵɵtext(11, \" Go Home \");\n    i0.ɵɵelementEnd()()();\n} if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r1.error);\n} }\n/**\n * OAuth2 Callback Component\n * Handles the OAuth2 authorization callback and processes the authorization code\n */\nexport class OAuth2CallbackComponent {\n    constructor(oauth2Service, router, platformId) {\n        this.oauth2Service = oauth2Service;\n        this.router = router;\n        this.platformId = platformId;\n        this.isLoading = true;\n        this.error = null;\n        this.success = false;\n    }\n    async ngOnInit() {\n        // Only handle callback in browser environment\n        if (!isPlatformBrowser(this.platformId)) {\n            this.isLoading = false;\n            this.error = 'Browser environment required for OAuth2 callback';\n            return;\n        }\n        // Add a small delay to ensure the component is fully rendered on client side\n        setTimeout(async () => {\n            try {\n                console.log('Starting OAuth2 callback processing...');\n                console.log('Current URL:', window.location.href);\n                console.log('LocalStorage available:', typeof (Storage) !== \"undefined\");\n                // Handle the OAuth2 callback\n                await this.oauth2Service.handleCallback();\n                // Success\n                this.isLoading = false;\n                this.success = true;\n                // Redirect after a short delay\n                setTimeout(() => {\n                    // You can customize this redirect logic based on your needs\n                    // For example, redirect to a specific route or emit an event\n                    this.router.navigate(['/']);\n                }, 2000);\n            }\n            catch (error) {\n                console.error('OAuth2 callback error:', error);\n                this.isLoading = false;\n                this.error = error instanceof Error ? error.message : 'Authentication failed';\n            }\n        }, 100);\n    }\n    retryLogin() {\n        if (!this.oauth2Service.isAuthenticationAvailable()) {\n            this.error = 'Authentication not available in current environment';\n            return;\n        }\n        this.isLoading = true;\n        this.error = null;\n        this.success = false;\n        this.oauth2Service.startAuthorization().catch(error => {\n            console.error('Retry login error:', error);\n            this.isLoading = false;\n            this.error = 'Failed to start authentication';\n        });\n    }\n    goHome() {\n        this.router.navigate(['/']);\n    }\n    static { this.ɵfac = function OAuth2CallbackComponent_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || OAuth2CallbackComponent)(i0.ɵɵdirectiveInject(i1.OAuth2Service), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(PLATFORM_ID)); }; }\n    static { this.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: OAuth2CallbackComponent, selectors: [[\"lib-oauth2-callback\"]], decls: 5, vars: 3, consts: [[1, \"oauth2-callback-container\"], [1, \"oauth2-callback-content\"], [\"class\", \"loading-section\", 4, \"ngIf\"], [\"class\", \"success-section\", 4, \"ngIf\"], [\"class\", \"error-section\", 4, \"ngIf\"], [1, \"loading-section\"], [1, \"spinner\"], [1, \"success-section\"], [1, \"success-icon\"], [1, \"error-section\"], [1, \"error-icon\"], [1, \"error-message\"], [1, \"error-actions\"], [1, \"retry-button\", 3, \"click\"], [1, \"home-button\", 3, \"click\"]], template: function OAuth2CallbackComponent_Template(rf, ctx) { if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n            i0.ɵɵtemplate(2, OAuth2CallbackComponent_div_2_Template, 6, 0, \"div\", 2)(3, OAuth2CallbackComponent_div_3_Template, 7, 0, \"div\", 3)(4, OAuth2CallbackComponent_div_4_Template, 12, 1, \"div\", 4);\n            i0.ɵɵelementEnd()();\n        } if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.success && !ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.error && !ctx.isLoading);\n        } }, dependencies: [CommonModule, i3.NgIf], styles: [\".oauth2-callback-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .error-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:1rem 0 .5rem;color:#333}.loading-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .success-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin-bottom:0}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message[_ngcontent-%COMP%]{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.retry-button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.home-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.home-button[_ngcontent-%COMP%]:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content[_ngcontent-%COMP%]{margin:.5rem;padding:1.5rem}.error-actions[_ngcontent-%COMP%]{flex-direction:column}.retry-button[_ngcontent-%COMP%], .home-button[_ngcontent-%COMP%]{width:100%}}\"] }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(OAuth2CallbackComponent, [{\n        type: Component,\n        args: [{ selector: 'lib-oauth2-callback', standalone: true, imports: [CommonModule], template: `\r\n    <div class=\"oauth2-callback-container\">\r\n      <div class=\"oauth2-callback-content\">\r\n        <div *ngIf=\"isLoading\" class=\"loading-section\">\r\n          <div class=\"spinner\"></div>\r\n          <h2>Processing Authentication...</h2>\r\n          <p>Please wait while we complete your login.</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"success && !isLoading\" class=\"success-section\">\r\n          <div class=\"success-icon\">✓</div>\r\n          <h2>Authentication Successful!</h2>\r\n          <p>You will be redirected shortly...</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"error && !isLoading\" class=\"error-section\">\r\n          <div class=\"error-icon\">✗</div>\r\n          <h2>Authentication Failed</h2>\r\n          <p class=\"error-message\">{{ error }}</p>\r\n          <div class=\"error-actions\">\r\n            <button (click)=\"retryLogin()\" class=\"retry-button\">\r\n              Try Again\r\n            </button>\r\n            <button (click)=\"goHome()\" class=\"home-button\">\r\n              Go Home\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `, styles: [\".oauth2-callback-container{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.oauth2-callback-content{background:#fff;border-radius:8px;padding:2rem;box-shadow:0 4px 6px #0000001a;text-align:center;max-width:400px;width:100%;margin:1rem}.loading-section h2,.success-section h2,.error-section h2{margin:1rem 0 .5rem;color:#333}.loading-section p,.success-section p{color:#666;margin-bottom:0}.spinner{border:3px solid #f3f3f3;border-top:3px solid #007bff;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 1rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.success-icon{width:60px;height:60px;border-radius:50%;background-color:#28a745;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-icon{width:60px;height:60px;border-radius:50%;background-color:#dc3545;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:700;margin:0 auto 1rem}.error-message{color:#dc3545;margin:1rem 0;padding:.5rem;background-color:#f8d7da;border:1px solid #f5c6cb;border-radius:4px;font-size:.9rem}.error-actions{display:flex;gap:1rem;justify-content:center;margin-top:1.5rem}.retry-button,.home-button{padding:.75rem 1.5rem;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;font-weight:500;transition:background-color .2s}.retry-button{background-color:#007bff;color:#fff}.retry-button:hover{background-color:#0056b3}.home-button{background-color:#6c757d;color:#fff}.home-button:hover{background-color:#545b62}@media (max-width: 480px){.oauth2-callback-content{margin:.5rem;padding:1.5rem}.error-actions{flex-direction:column}.retry-button,.home-button{width:100%}}\\n\"] }]\n    }], () => [{ type: i1.OAuth2Service }, { type: i2.Router }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }], null); })();\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassDebugInfo(OAuth2CallbackComponent, { className: \"OAuth2CallbackComponent\", filePath: \"lib/components/oauth2-callback/oauth2-callback.component.ts\", lineNumber: 185 }); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29tcG9uZW50cy9vYXV0aDItY2FsbGJhY2svb2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDdkUsT0FBTyxFQUFFLFlBQVksRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7SUFlMUQsOEJBQStDO0lBQzdDLHlCQUEyQjtJQUMzQiwwQkFBSTtJQUFBLDRDQUE0QjtJQUFBLGlCQUFLO0lBQ3JDLHlCQUFHO0lBQUEseURBQXlDO0lBQzlDLEFBRDhDLGlCQUFJLEVBQzVDOzs7SUFHSixBQURGLDhCQUEyRCxhQUMvQjtJQUFBLHNCQUFDO0lBQUEsaUJBQU07SUFDakMsMEJBQUk7SUFBQSwwQ0FBMEI7SUFBQSxpQkFBSztJQUNuQyx5QkFBRztJQUFBLGlEQUFpQztJQUN0QyxBQURzQyxpQkFBSSxFQUNwQzs7OztJQUdKLEFBREYsOEJBQXVELGNBQzdCO0lBQUEsc0JBQUM7SUFBQSxpQkFBTTtJQUMvQiwwQkFBSTtJQUFBLHFDQUFxQjtJQUFBLGlCQUFLO0lBQzlCLDZCQUF5QjtJQUFBLFlBQVc7SUFBQSxpQkFBSTtJQUV0QyxBQURGLCtCQUEyQixpQkFDMkI7SUFBNUMsbUxBQVMsbUJBQVksS0FBQztJQUM1QiwyQkFDRjtJQUFBLGlCQUFTO0lBQ1QsbUNBQStDO0lBQXZDLG9MQUFTLGVBQVEsS0FBQztJQUN4QiwwQkFDRjtJQUVKLEFBREUsQUFERSxpQkFBUyxFQUNMLEVBQ0Y7OztJQVRxQixlQUFXO0lBQVgsa0NBQVc7O0FBMUI5Qzs7O0dBR0c7QUFnTEgsTUFBTSxPQUFPLHVCQUF1QjtJQUtsQyxZQUNVLGFBQTRCLEVBQzVCLE1BQWMs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QTtZQWFuQyxBQU5BLEFBTkEsd0VBQStDLDJEQU1ZLDREQU1KO1lBYzNELEFBREUsaUJBQU0sRUFDRjs7WUExQkksZUFBZTtZQUFmLG9DQUFlO1lBTWYsY0FBMkI7WUFBM0Isb0RBQTJCO1lBTTNCLGNBQXlCO1lBQXpCLGtEQUF5Qjs0QkFoQjNCLFlBQVk7O2lGQTRLWCx1QkFBdUI7Y0EvS25DLFNBQVM7MkJBQ0UscUJBQXFCLGNBQ25CLElBQUksV0FDUCxDQUFDLFlBQVksQ0FBQyxZQUNiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0E4QlQ7O3NCQXFKRSxNQUFNO3VCQUFDLFdBQVc7O2tGQVJWLHVCQUF1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IENvbW1vbk1vZHVsZSwgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xyXG5pbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPQXV0aDJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvb2F1dGgyLnNlcnZpY2UnO1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBDYWxsYmFjayBDb21wb25lbnRcclxuICogSGFuZGxlcyB0aGUgT0F1dGgyIGF1dGhvcml6YXRpb24gY2FsbGJhY2sgYW5kIHByb2Nlc3NlcyB0aGUgYXV0aG9yaXphdGlvbiBjb2RlXHJcbiAqL1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2xpYi1vYXV0aDItY2FsbGJhY2snLFxyXG4gIHN0YW5kYWxvbmU6IHRydWUsXHJcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgIDxkaXYgY2xhc3M9XCJvYXV0aDItY2FsbGJhY2stY29udGFpbmVyXCI+XHJcbiAgICAgIDxkaXYgY2xhc3M9XCJvYXV0aDItY2FsbGJhY2stY29udGVudFwiPlxyXG4gICAgICAgIDxkaXYgKm5nSWY9XCJpc0xvYWRpbmdcIiBjbGFzcz1cImxvYWRpbmctc2VjdGlvblwiPlxyXG4gICAgICAgICAgPGRpdiBjbGFzcz1cInNwaW5uZXJcIj48L2Rpdj5cclxuICAgICAgICAgIDxoMj5Qcm9jZXNzaW5nIEF1dGhlbnRpY2F0aW9uLi4uPC9oMj5cclxuICAgICAgICAgIDxwPlBsZWFzZSB3YWl0IHdoaWxlIHdlIGNvbXBsZXRlIHlvdXIgbG9naW4uPC9wPlxyXG4gICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICA8ZGl2ICpuZ0lmPVwic3VjY2VzcyAmJiAhaXNMb2FkaW5nXCIgY2xhc3M9XCJzdWNjZXNzLXNlY3Rpb25cIj5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJzdWNjZXNzLWljb25cIj7inJM8L2Rpdj5cclxuICAgICAgICAgIDxoMj5BdXRoZW50aWNhdGlvbiBTdWNjZXNzZnVsITwvaDI+XHJcbiAgICAgICAgICA8cD5Zb3Ugd2lsbCBiZSByZWRpcmVjdGVkIHNob3J0bHkuLi48L3A+XHJcbiAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIDxkaXYgKm5nSWY9XCJlcnJvciAmJiAhaXNMb2FkaW5nXCIgY2xhc3M9XCJlcnJvci1zZWN0aW9uXCI+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiZXJyb3ItaWNvblwiPuKclzwvZGl2PlxyXG4gICAgICAgICAgPGgyPkF1dGhlbnRpY2F0aW9uIEZhaWxlZDwvaDI+XHJcbiAgICAgICAgICA8cCBjbGFzcz1cImVycm9yLW1lc3NhZ2VcIj57eyBlcnJvciB9fTwvcD5cclxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJlcnJvci1hY3Rpb25zXCI+XHJcbiAgICAgICAgICAgIDxidXR0b24gKGNsaWNrKT1cInJldHJ5TG9naW4oKVwiIGNsYXNzPVwicmV0cnktYnV0dG9uXCI+XHJcbiAgICAgICAgICAgICAgVHJ5IEFnYWluXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgICA8YnV0dG9uIChjbGljayk9XCJnb0hvbWUoKVwiIGNsYXNzPVwiaG9tZS1idXR0b25cIj5cclxuICAgICAgICAgICAgICBHbyBIb21lXHJcbiAgICAgICAgICAgIDwvYnV0dG9uPlxyXG4gICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgPC9kaXY+XHJcbiAgYCxcclxuICBzdHlsZXM6IFtgXHJcbiAgICAub2F1dGgyLWNhbGxiYWNrLWNvbnRhaW5lciB7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gICAgICBtaW4taGVpZ2h0OiAxMDB2aDtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTtcclxuICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgJ1NlZ29lIFVJJywgUm9ib3RvLCBzYW5zLXNlcmlmO1xyXG4gICAgfVxyXG5cclxuICAgIC5vYXV0aDItY2FsbGJhY2stY29udGVudCB7XHJcbiAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA4cHg7XHJcbiAgICAgIHBhZGRpbmc6IDJyZW07XHJcbiAgICAgIGJveC1zaGFkb3c6IDAgNHB4IDZweCByZ2JhKDAsIDAsIDAsIDAuMSk7XHJcbiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgICAgbWF4LXdpZHRoOiA0MDBweDtcclxuICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgIG1hcmdpbjogMXJlbTtcclxuICAgIH1cclxuXHJcbiAgICAubG9hZGluZy1zZWN0aW9uIGgyLFxyXG4gICAgLnN1Y2Nlc3Mtc2VjdGlvbiBoMixcclxuICAgIC5lcnJvci1zZWN0aW9uIGgyIHtcclxuICAgICAgbWFyZ2luOiAxcmVtIDAgMC41cmVtIDA7XHJcbiAgICAgIGNvbG9yOiAjMzMzO1xyXG4gICAgfVxyXG5cclxuICAgIC5sb2FkaW5nLXNlY3Rpb24gcCxcclxuICAgIC5zdWNjZXNzLXNlY3Rpb24gcCB7XHJcbiAgICAgIGNvbG9yOiAjNjY2O1xyXG4gICAgICBtYXJnaW4tYm90dG9tOiAwO1xyXG4gICAgfVxyXG5cclxuICAgIC5zcGlubmVyIHtcclxuICAgICAgYm9yZGVyOiAzcHggc29saWQgI2YzZjNmMztcclxuICAgICAgYm9yZGVyLXRvcDogM3B4IHNvbGlkICMwMDdiZmY7XHJcbiAgICAgIGJvcmRlci1yYWRpdXM6IDUwJTtcclxuICAgICAgd2lkdGg6IDQwcHg7XHJcbiAgICAgIGhlaWdodDogNDBweDtcclxuICAgICAgYW5pbWF0aW9uOiBzcGluIDFzIGxpbmVhciBpbmZpbml0ZTtcclxuICAgICAgbWFyZ2luOiAwIGF1dG8gMXJlbSBhdXRvO1xyXG4gICAgfVxyXG5cclxuICAgIEBrZXlmcmFtZXMgc3BpbiB7XHJcbiAgICAgIDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7IH1cclxuICAgICAgMTAwJSB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH1cclxuICAgIH1cclxuXHJcbiAgICAuc3VjY2Vzcy1pY29uIHtcclxuICAgICAgd2lkdGg6IDYwcHg7XHJcbiAgICAgIGhlaWdodDogNjBweDtcclxuICAgICAgYm9yZGVyLXJhZGl1czogNTAlO1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjhhNzQ1O1xyXG4gICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xyXG4gICAgICBmb250LXNpemU6IDJyZW07XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xyXG4gICAgICBtYXJnaW46IDAgYXV0byAxcmVtIGF1dG87XHJcbiAgICB9XHJcblxyXG4gICAgLmVycm9yLWljb24ge1xyXG4gICAgICB3aWR0aDogNjBweDtcclxuICAgICAgaGVpZ2h0OiA2MHB4O1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA1MCU7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNkYzM1NDU7XHJcbiAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbiAgICAgIGZvbnQtc2l6ZTogMnJlbTtcclxuICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgICAgIG1hcmdpbjogMCBhdXRvIDFyZW0gYXV0bztcclxuICAgIH1cclxuXHJcbiAgICAuZXJyb3ItbWVzc2FnZSB7XHJcbiAgICAgIGNvbG9yOiAjZGMzNTQ1O1xyXG4gICAgICBtYXJnaW46IDFyZW0gMDtcclxuICAgICAgcGFkZGluZzogMC41cmVtO1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhkN2RhO1xyXG4gICAgICBib3JkZXI6IDFweCBzb2xpZCAjZjVjNmNiO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgIGZvbnQtc2l6ZTogMC45cmVtO1xyXG4gICAgfVxyXG5cclxuICAgIC5lcnJvci1hY3Rpb25zIHtcclxuICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgZ2FwOiAxcmVtO1xyXG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICAgICAgbWFyZ2luLXRvcDogMS41cmVtO1xyXG4gICAgfVxyXG5cclxuICAgIC5yZXRyeS1idXR0b24sXHJcbiAgICAuaG9tZS1idXR0b24ge1xyXG4gICAgICBwYWRkaW5nOiAwLjc1cmVtIDEuNXJlbTtcclxuICAgICAgYm9yZGVyOiBub25lO1xyXG4gICAgICBib3JkZXItcmFkaXVzOiA0cHg7XHJcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcclxuICAgICAgZm9udC1zaXplOiAwLjlyZW07XHJcbiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4ycztcclxuICAgIH1cclxuXHJcbiAgICAucmV0cnktYnV0dG9uIHtcclxuICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjtcclxuICAgICAgY29sb3I6IHdoaXRlO1xyXG4gICAgfVxyXG5cclxuICAgIC5yZXRyeS1idXR0b246aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA1NmIzO1xyXG4gICAgfVxyXG5cclxuICAgIC5ob21lLWJ1dHRvbiB7XHJcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM2Yzc1N2Q7XHJcbiAgICAgIGNvbG9yOiB3aGl0ZTtcclxuICAgIH1cclxuXHJcbiAgICAuaG9tZS1idXR0b246aG92ZXIge1xyXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjNTQ1YjYyO1xyXG4gICAgfVxyXG5cclxuICAgIEBtZWRpYSAobWF4LXdpZHRoOiA0ODBweCkge1xyXG4gICAgICAub2F1dGgyLWNhbGxiYWNrLWNvbnRlbnQge1xyXG4gICAgICAgIG1hcmdpbjogMC41cmVtO1xyXG4gICAgICAgIHBhZGRpbmc6IDEuNXJlbTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLmVycm9yLWFjdGlvbnMge1xyXG4gICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5yZXRyeS1idXR0b24sXHJcbiAgICAgIC5ob21lLWJ1dHRvbiB7XHJcbiAgICAgICAgd2lkdGg6IDEwMCU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBgXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgT0F1dGgyQ2FsbGJhY2tDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIGlzTG9hZGluZyA9IHRydWU7XHJcbiAgZXJyb3I6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gIHN1Y2Nlc3MgPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG9hdXRoMlNlcnZpY2U6IE9BdXRoMlNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxyXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybUlkOiBPYmplY3RcclxuICApIHt9XHJcblxyXG4gIGFzeW5jIG5nT25Jbml0KCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgLy8gT25seSBoYW5kbGUgY2FsbGJhY2sgaW4gYnJvd3NlciBlbnZpcm9ubWVudFxyXG4gICAgaWYgKCFpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtSWQpKSB7XHJcbiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuZXJyb3IgPSAnQnJvd3NlciBlbnZpcm9ubWVudCByZXF1aXJlZCBmb3IgT0F1dGgyIGNhbGxiYWNrJztcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFkZCBhIHNtYWxsIGRlbGF5IHRvIGVuc3VyZSB0aGUgY29tcG9uZW50IGlzIGZ1bGx5IHJlbmRlcmVkIG9uIGNsaWVudCBzaWRlXHJcbiAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnU3RhcnRpbmcgT0F1dGgyIGNhbGxiYWNrIHByb2Nlc3NpbmcuLi4nKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnQ3VycmVudCBVUkw6Jywgd2luZG93LmxvY2F0aW9uLmhyZWYpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdMb2NhbFN0b3JhZ2UgYXZhaWxhYmxlOicsIHR5cGVvZihTdG9yYWdlKSAhPT0gXCJ1bmRlZmluZWRcIik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSGFuZGxlIHRoZSBPQXV0aDIgY2FsbGJhY2tcclxuICAgICAgICBhd2FpdCB0aGlzLm9hdXRoMlNlcnZpY2UuaGFuZGxlQ2FsbGJhY2soKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTdWNjZXNzXHJcbiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnN1Y2Nlc3MgPSB0cnVlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZGlyZWN0IGFmdGVyIGEgc2hvcnQgZGVsYXlcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgIC8vIFlvdSBjYW4gY3VzdG9taXplIHRoaXMgcmVkaXJlY3QgbG9naWMgYmFzZWQgb24geW91ciBuZWVkc1xyXG4gICAgICAgICAgLy8gRm9yIGV4YW1wbGUsIHJlZGlyZWN0IHRvIGEgc3BlY2lmaWMgcm91dGUgb3IgZW1pdCBhbiBldmVudFxyXG4gICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycvJ10pO1xyXG4gICAgICAgIH0sIDIwMDApO1xyXG4gICAgICAgIFxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ09BdXRoMiBjYWxsYmFjayBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQXV0aGVudGljYXRpb24gZmFpbGVkJztcclxuICAgICAgfVxyXG4gICAgfSwgMTAwKTtcclxuICB9XHJcblxyXG4gIHJldHJ5TG9naW4oKTogdm9pZCB7XHJcbiAgICBpZiAoIXRoaXMub2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0aW9uQXZhaWxhYmxlKCkpIHtcclxuICAgICAgdGhpcy5lcnJvciA9ICdBdXRoZW50aWNhdGlvbiBub3QgYXZhaWxhYmxlIGluIGN1cnJlbnQgZW52aXJvbm1lbnQnO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xyXG4gICAgdGhpcy5lcnJvciA9IG51bGw7XHJcbiAgICB0aGlzLnN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgIFxyXG4gICAgdGhpcy5vYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcignUmV0cnkgbG9naW4gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLmVycm9yID0gJ0ZhaWxlZCB0byBzdGFydCBhdXRoZW50aWNhdGlvbic7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdvSG9tZSgpOiB2b2lkIHtcclxuICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLyddKTtcclxuICB9XHJcbn0iXX0=","originalSourcemap":{"version":3,"file":"oauth2-callback.component.js","sourceRoot":"","sources":["../../../../../../src/lib/components/oauth2-callback/oauth2-callback.component.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[18,0,0,18],[20,0,0,28],[26,0,0,34],[28,0,0,36],[39,0,0,47],[41,0,0,49],[47,0,0,55],[62,0,0,70],[63,0,0,71]],[[0,0,1,0],[7,0,1,7],[9,0,1,9],[21,0,1,21],[23,0,1,23],[40,0,1,40],[42,0,1,42],[48,0,1,48],[65,0,1,65],[66,0,1,66]],[],[],[],[],[],[[4,0,16,8],[34,0,16,55]],[[4,0,17,10],[29,0,17,37]],[[4,0,18,10],[30,0,18,14]],[[4,0,18,14],[48,0,18,42]],[[4,0,18,42],[21,0,18,47]],[[4,0,19,10],[29,0,19,13]],[[4,0,19,13],[61,0,19,54]],[[4,0,20,8],[4,0,19,54],[21,0,19,58],[23,0,20,14]],[],[],[[4,0,23,10],[4,0,22,8],[34,0,22,67],[47,0,23,36]],[[4,0,23,36],[26,0,23,37]],[[4,0,23,37],[21,0,23,43]],[[4,0,24,10],[30,0,24,14]],[[4,0,24,14],[46,0,24,40]],[[4,0,24,40],[21,0,24,45]],[[4,0,25,10],[29,0,25,13]],[[4,0,25,13],[53,0,25,46]],[[4,0,26,8],[4,0,25,46],[21,0,25,50],[23,0,26,14]],[],[],[],[[4,0,29,10],[4,0,28,8],[34,0,28,63],[48,0,29,34]],[[4,0,29,34],[26,0,29,35]],[[4,0,29,35],[21,0,29,41]],[[4,0,30,10],[30,0,30,14]],[[4,0,30,14],[41,0,30,35]],[[4,0,30,35],[21,0,30,40]],[[4,0,31,10],[33,0,31,35]],[[4,0,31,35],[16,0,31,46]],[[4,0,31,46],[21,0,31,50]],[[4,0,33,12],[4,0,32,10],[35,0,32,37],[52,0,33,64]],[[4,0,33,20],[183,0,33,29],[202,0,33,41],[207,0,33,42]],[[4,0,34,14],[31,0,35,12]],[[4,0,35,12],[21,0,35,21]],[[4,0,36,12],[39,0,36,59]],[[4,0,36,20],[184,0,36,29],[199,0,36,37],[204,0,36,38]],[[4,0,37,14],[30,0,38,12]],[[4,0,40,8],[4,0,39,10],[4,0,38,12],[21,0,38,21],[23,0,39,16],[25,0,40,14]],[],[],[[4,0,31,35],[19,0,31,46]],[[4,0,31,35],[38,0,31,46]],[],[[0,0,5,0]],[],[],[[3,0,8,3]],[[0,0,184,0],[6,0,184,6],[13,0,184,13],[36,0,184,36]],[[4,0,189,2],[16,0,190,12],[29,0,190,40],[31,0,191,12],[37,0,191,26],[39,0,192,33],[49,0,192,51]],[[8,0,190,12],[26,0,190,25],[29,0,190,12],[42,0,190,25],[43,0,190,40]],[[8,0,191,12],[19,0,191,18],[22,0,191,12],[28,0,191,18],[29,0,191,26]],[[8,0,192,33],[23,0,192,43],[26,0,192,33],[36,0,192,43],[37,0,192,51]],[[8,0,185,2],[22,0,185,11],[25,0,185,14],[29,0,185,18],[30,0,185,19]],[[8,0,186,2],[18,0,186,7],[21,0,186,25],[25,0,186,29],[26,0,186,30]],[[8,0,187,2],[20,0,187,9],[23,0,187,12],[28,0,187,17],[29,0,187,18]],[[4,0,193,5],[5,0,193,6]],[[4,0,195,2],[9,0,195,7],[10,0,195,8],[18,0,195,16]],[[8,0,196,4],[54,0,196,50]],[[8,0,197,4],[12,0,197,8],[13,0,197,9],[30,0,197,26],[31,0,197,27],[35,0,197,31],[36,0,197,32],[46,0,197,42],[47,0,197,43],[49,0,197,45],[50,0,197,46]],[[12,0,198,6],[16,0,198,10],[17,0,198,11],[26,0,198,20],[29,0,198,23],[34,0,198,28],[35,0,198,29]],[[12,0,199,6],[16,0,199,10],[17,0,199,11],[22,0,199,16],[25,0,199,19],[75,0,199,69],[76,0,199,70]],[[12,0,200,6],[19,0,200,13]],[[8,0,201,4],[9,0,201,5]],[[8,0,203,4],[85,0,203,81]],[[8,0,204,4],[18,0,204,14],[19,0,204,15],[24,0,204,20],[28,0,204,24],[30,0,204,26]],[[12,0,205,6],[16,0,205,10],[17,0,205,11]],[[16,0,206,8],[23,0,206,15],[24,0,206,16],[27,0,206,19],[28,0,206,20],[68,0,206,60],[69,0,206,61],[70,0,206,62]],[[16,0,207,8],[23,0,207,15],[24,0,207,16],[27,0,207,19],[28,0,207,20],[42,0,207,34],[44,0,207,36],[50,0,207,42],[51,0,207,43],[59,0,207,51],[60,0,207,52],[64,0,207,56],[65,0,207,57],[66,0,207,58]],[[16,0,208,8],[23,0,208,15],[24,0,208,16],[27,0,208,19],[28,0,208,20],[53,0,208,45],[55,0,208,47],[62,0,208,53],[63,0,208,54],[70,0,208,61],[71,0,208,62],[76,0,208,67],[87,0,208,78],[88,0,208,79],[89,0,208,80]],[[16,0,210,8],[45,0,210,37]],[[16,0,211,8],[22,0,211,14],[26,0,211,18],[27,0,211,19],[40,0,211,32],[41,0,211,33],[55,0,211,47],[57,0,211,49],[58,0,211,50]],[[16,0,213,8],[26,0,213,18]],[[16,0,214,8],[20,0,214,12],[21,0,214,13],[30,0,214,22],[33,0,214,25],[38,0,214,30],[39,0,214,31]],[[16,0,215,8],[20,0,215,12],[21,0,215,13],[28,0,215,20],[31,0,215,23],[35,0,215,27],[36,0,215,28]],[[16,0,217,8],[47,0,217,39]],[[16,0,218,8],[26,0,218,18],[27,0,218,19],[30,0,218,22],[32,0,218,24]],[[20,0,219,10],[80,0,219,70]],[[20,0,220,10],[81,0,220,71]],[[20,0,221,10],[24,0,221,14],[25,0,221,15],[31,0,221,21],[32,0,221,22],[40,0,221,30],[41,0,221,31],[42,0,221,32],[45,0,221,35],[46,0,221,36],[47,0,221,37],[48,0,221,38]],[[16,0,222,8],[17,0,222,9],[19,0,222,11],[23,0,222,15],[24,0,222,16],[25,0,222,17]],[[12,0,224,6],[13,0,224,7]],[[12,0,224,8],[19,0,224,15],[24,0,224,20],[26,0,224,22],[27,0,224,23]],[[16,0,225,8],[23,0,225,15],[24,0,225,16],[29,0,225,21],[30,0,225,22],[54,0,225,46],[56,0,225,48],[61,0,225,53],[62,0,225,54],[63,0,225,55]],[[16,0,226,8],[20,0,226,12],[21,0,226,13],[30,0,226,22],[33,0,226,25],[38,0,226,30],[39,0,226,31]],[[16,0,227,8],[20,0,227,12],[21,0,227,13],[26,0,227,18],[29,0,227,21],[34,0,227,26],[46,0,227,38],[51,0,227,43],[52,0,227,44],[53,0,227,45],[54,0,227,46],[59,0,227,51],[60,0,227,52],[67,0,227,59],[68,0,227,60],[69,0,227,61],[70,0,227,62],[93,0,227,85],[94,0,227,86]],[[12,0,228,6],[13,0,228,7]],[[8,0,229,4],[9,0,229,5],[11,0,229,7],[14,0,229,10],[15,0,229,11],[16,0,229,12]],[[4,0,230,2],[5,0,230,3]],[[4,0,232,2],[14,0,232,12]],[[8,0,233,4],[12,0,233,8],[13,0,233,9],[17,0,233,13],[18,0,233,14],[31,0,233,27],[32,0,233,28],[57,0,233,53],[59,0,233,55],[61,0,233,57],[62,0,233,58]],[[12,0,234,6],[16,0,234,10],[17,0,234,11],[22,0,234,16],[25,0,234,19],[78,0,234,72],[79,0,234,73]],[[12,0,235,6],[19,0,235,13]],[[8,0,236,4],[9,0,236,5]],[[8,0,238,4],[12,0,238,8],[13,0,238,9],[22,0,238,18],[25,0,238,21],[29,0,238,25],[30,0,238,26]],[[8,0,239,4],[12,0,239,8],[13,0,239,9],[18,0,239,14],[21,0,239,17],[25,0,239,21],[26,0,239,22]],[[8,0,240,4],[12,0,240,8],[13,0,240,9],[20,0,240,16],[23,0,240,19],[28,0,240,24],[29,0,240,25]],[[8,0,242,4],[12,0,242,8],[13,0,242,9],[26,0,242,22],[27,0,242,23],[45,0,242,41],[47,0,242,43],[48,0,242,44],[53,0,242,49],[54,0,242,50],[59,0,242,55],[60,0,242,56],[62,0,242,58]],[[12,0,243,6],[19,0,243,13],[20,0,243,14],[25,0,243,19],[26,0,243,20],[46,0,243,40],[48,0,243,42],[53,0,243,47],[54,0,243,48],[55,0,243,49]],[[12,0,244,6],[16,0,244,10],[17,0,244,11],[26,0,244,20],[29,0,244,23],[34,0,244,28],[35,0,244,29]],[[12,0,245,6],[16,0,245,10],[17,0,245,11],[22,0,245,16],[25,0,245,19],[57,0,245,51],[58,0,245,52]],[[8,0,246,4],[9,0,246,5],[10,0,246,6],[11,0,246,7]],[[4,0,247,2],[5,0,247,3]],[[4,0,249,2],[10,0,249,8]],[[8,0,250,4],[12,0,250,8],[13,0,250,9],[19,0,250,15],[20,0,250,16],[28,0,250,24],[29,0,250,25],[30,0,250,26],[33,0,250,29],[34,0,250,30],[35,0,250,31],[36,0,250,32]],[[4,0,251,2],[5,0,251,3]],[[120,0,184,13],[143,0,184,36],[239,0,192,12],[250,0,192,23]],[[68,0,184,13],[91,0,184,36]],[[12,0,15,6],[12,0,14,4],[42,0,14,43],[55,0,15,43]],[[12,0,28,8],[12,0,22,8],[12,0,16,8],[84,0,16,55],[143,0,22,67],[203,0,28,63]],[[12,0,42,4],[12,0,41,6],[29,0,41,12],[31,0,42,10]],[],[[12,0,16,14],[27,0,16,29]],[[12,0,16,14],[48,0,16,29]],[[12,0,22,14],[26,0,22,41]],[[12,0,22,14],[64,0,22,41]],[[12,0,28,14],[26,0,28,39]],[[12,0,28,14],[62,0,28,39]],[[28,0,12,12],[40,0,12,24]],[],[[81,0,184,13],[104,0,184,36]],[[14,0,9,1],[23,0,9,10]],[[27,0,10,12],[48,0,10,33],[62,0,11,14],[66,0,11,18],[77,0,12,11],[78,0,12,12],[90,0,12,24],[91,0,12,25],[103,0,13,12]],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[[3,0,43,3]],[],[[22,0,192,5],[28,0,192,11]],[[23,0,192,12],[34,0,192,23]],[],[[82,0,184,13],[105,0,184,36]]],"sourcesContent":["import { Component, OnInit, Inject, PLATFORM_ID } from '@angular/core';\r\nimport { CommonModule, isPlatformBrowser } from '@angular/common';\r\nimport { Router } from '@angular/router';\r\nimport { OAuth2Service } from '../../services/oauth2.service';\r\n\r\n/**\r\n * OAuth2 Callback Component\r\n * Handles the OAuth2 authorization callback and processes the authorization code\r\n */\r\n@Component({\r\n  selector: 'lib-oauth2-callback',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  template: `\r\n    <div class=\"oauth2-callback-container\">\r\n      <div class=\"oauth2-callback-content\">\r\n        <div *ngIf=\"isLoading\" class=\"loading-section\">\r\n          <div class=\"spinner\"></div>\r\n          <h2>Processing Authentication...</h2>\r\n          <p>Please wait while we complete your login.</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"success && !isLoading\" class=\"success-section\">\r\n          <div class=\"success-icon\">✓</div>\r\n          <h2>Authentication Successful!</h2>\r\n          <p>You will be redirected shortly...</p>\r\n        </div>\r\n\r\n        <div *ngIf=\"error && !isLoading\" class=\"error-section\">\r\n          <div class=\"error-icon\">✗</div>\r\n          <h2>Authentication Failed</h2>\r\n          <p class=\"error-message\">{{ error }}</p>\r\n          <div class=\"error-actions\">\r\n            <button (click)=\"retryLogin()\" class=\"retry-button\">\r\n              Try Again\r\n            </button>\r\n            <button (click)=\"goHome()\" class=\"home-button\">\r\n              Go Home\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  `,\r\n  styles: [`\r\n    .oauth2-callback-container {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      min-height: 100vh;\r\n      background-color: #f5f5f5;\r\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\r\n    }\r\n\r\n    .oauth2-callback-content {\r\n      background: white;\r\n      border-radius: 8px;\r\n      padding: 2rem;\r\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n      text-align: center;\r\n      max-width: 400px;\r\n      width: 100%;\r\n      margin: 1rem;\r\n    }\r\n\r\n    .loading-section h2,\r\n    .success-section h2,\r\n    .error-section h2 {\r\n      margin: 1rem 0 0.5rem 0;\r\n      color: #333;\r\n    }\r\n\r\n    .loading-section p,\r\n    .success-section p {\r\n      color: #666;\r\n      margin-bottom: 0;\r\n    }\r\n\r\n    .spinner {\r\n      border: 3px solid #f3f3f3;\r\n      border-top: 3px solid #007bff;\r\n      border-radius: 50%;\r\n      width: 40px;\r\n      height: 40px;\r\n      animation: spin 1s linear infinite;\r\n      margin: 0 auto 1rem auto;\r\n    }\r\n\r\n    @keyframes spin {\r\n      0% { transform: rotate(0deg); }\r\n      100% { transform: rotate(360deg); }\r\n    }\r\n\r\n    .success-icon {\r\n      width: 60px;\r\n      height: 60px;\r\n      border-radius: 50%;\r\n      background-color: #28a745;\r\n      color: white;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      font-size: 2rem;\r\n      font-weight: bold;\r\n      margin: 0 auto 1rem auto;\r\n    }\r\n\r\n    .error-icon {\r\n      width: 60px;\r\n      height: 60px;\r\n      border-radius: 50%;\r\n      background-color: #dc3545;\r\n      color: white;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      font-size: 2rem;\r\n      font-weight: bold;\r\n      margin: 0 auto 1rem auto;\r\n    }\r\n\r\n    .error-message {\r\n      color: #dc3545;\r\n      margin: 1rem 0;\r\n      padding: 0.5rem;\r\n      background-color: #f8d7da;\r\n      border: 1px solid #f5c6cb;\r\n      border-radius: 4px;\r\n      font-size: 0.9rem;\r\n    }\r\n\r\n    .error-actions {\r\n      display: flex;\r\n      gap: 1rem;\r\n      justify-content: center;\r\n      margin-top: 1.5rem;\r\n    }\r\n\r\n    .retry-button,\r\n    .home-button {\r\n      padding: 0.75rem 1.5rem;\r\n      border: none;\r\n      border-radius: 4px;\r\n      cursor: pointer;\r\n      font-size: 0.9rem;\r\n      font-weight: 500;\r\n      transition: background-color 0.2s;\r\n    }\r\n\r\n    .retry-button {\r\n      background-color: #007bff;\r\n      color: white;\r\n    }\r\n\r\n    .retry-button:hover {\r\n      background-color: #0056b3;\r\n    }\r\n\r\n    .home-button {\r\n      background-color: #6c757d;\r\n      color: white;\r\n    }\r\n\r\n    .home-button:hover {\r\n      background-color: #545b62;\r\n    }\r\n\r\n    @media (max-width: 480px) {\r\n      .oauth2-callback-content {\r\n        margin: 0.5rem;\r\n        padding: 1.5rem;\r\n      }\r\n\r\n      .error-actions {\r\n        flex-direction: column;\r\n      }\r\n\r\n      .retry-button,\r\n      .home-button {\r\n        width: 100%;\r\n      }\r\n    }\r\n  `]\r\n})\r\nexport class OAuth2CallbackComponent implements OnInit {\r\n  isLoading = true;\r\n  error: string | null = null;\r\n  success = false;\r\n\r\n  constructor(\r\n    private oauth2Service: OAuth2Service,\r\n    private router: Router,\r\n    @Inject(PLATFORM_ID) private platformId: Object\r\n  ) {}\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    // Only handle callback in browser environment\r\n    if (!isPlatformBrowser(this.platformId)) {\r\n      this.isLoading = false;\r\n      this.error = 'Browser environment required for OAuth2 callback';\r\n      return;\r\n    }\r\n\r\n    // Add a small delay to ensure the component is fully rendered on client side\r\n    setTimeout(async () => {\r\n      try {\r\n        console.log('Starting OAuth2 callback processing...');\r\n        console.log('Current URL:', window.location.href);\r\n        console.log('LocalStorage available:', typeof(Storage) !== \"undefined\");\r\n        \r\n        // Handle the OAuth2 callback\r\n        await this.oauth2Service.handleCallback();\r\n        \r\n        // Success\r\n        this.isLoading = false;\r\n        this.success = true;\r\n        \r\n        // Redirect after a short delay\r\n        setTimeout(() => {\r\n          // You can customize this redirect logic based on your needs\r\n          // For example, redirect to a specific route or emit an event\r\n          this.router.navigate(['/']);\r\n        }, 2000);\r\n        \r\n      } catch (error) {\r\n        console.error('OAuth2 callback error:', error);\r\n        this.isLoading = false;\r\n        this.error = error instanceof Error ? error.message : 'Authentication failed';\r\n      }\r\n    }, 100);\r\n  }\r\n\r\n  retryLogin(): void {\r\n    if (!this.oauth2Service.isAuthenticationAvailable()) {\r\n      this.error = 'Authentication not available in current environment';\r\n      return;\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.error = null;\r\n    this.success = false;\r\n    \r\n    this.oauth2Service.startAuthorization().catch(error => {\r\n      console.error('Retry login error:', error);\r\n      this.isLoading = false;\r\n      this.error = 'Failed to start authentication';\r\n    });\r\n  }\r\n\r\n  goHome(): void {\r\n    this.router.navigate(['/']);\r\n  }\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common":{"attributes":{},"external":true,"id":"@angular/common","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/router":{"attributes":{},"external":true,"id":"@angular/router","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"../../services/oauth2.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":22147,"body":[{"type":"ImportDeclaration","start":0,"end":39,"specifiers":[{"type":"ImportSpecifier","start":9,"end":15,"imported":{"type":"Identifier","start":9,"end":15,"name":"inject"},"local":{"type":"Identifier","start":9,"end":15,"name":"inject"}}],"source":{"type":"Literal","start":23,"end":38,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":40,"end":81,"specifiers":[{"type":"ImportSpecifier","start":49,"end":55,"imported":{"type":"Identifier","start":49,"end":55,"name":"Router"},"local":{"type":"Identifier","start":49,"end":55,"name":"Router"}}],"source":{"type":"Literal","start":63,"end":80,"value":"@angular/router","raw":"'@angular/router'"},"attributes":[]},{"type":"ImportDeclaration","start":82,"end":125,"specifiers":[{"type":"ImportSpecifier","start":91,"end":94,"imported":{"type":"Identifier","start":91,"end":94,"name":"map"},"local":{"type":"Identifier","start":91,"end":94,"name":"map"}},{"type":"ImportSpecifier","start":96,"end":100,"imported":{"type":"Identifier","start":96,"end":100,"name":"take"},"local":{"type":"Identifier","start":96,"end":100,"name":"take"}}],"source":{"type":"Literal","start":108,"end":124,"value":"rxjs/operators","raw":"'rxjs/operators'"},"attributes":[]},{"type":"ImportDeclaration","start":126,"end":185,"specifiers":[{"type":"ImportSpecifier","start":135,"end":148,"imported":{"type":"Identifier","start":135,"end":148,"name":"OAuth2Service"},"local":{"type":"Identifier","start":135,"end":148,"name":"OAuth2Service"}}],"source":{"type":"Literal","start":156,"end":184,"value":"../services/oauth2.service","raw":"'../services/oauth2.service'"},"attributes":[]},{"type":"ExportNamedDeclaration","start":290,"end":1576,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"VariableDeclaration","start":297,"end":1576,"kind":"const","declarations":[{"type":"VariableDeclarator","start":303,"end":1575,"id":{"type":"Identifier","start":303,"end":318,"name":"oauth2AuthGuard"},"init":{"type":"ArrowFunctionExpression","start":321,"end":1575,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":322,"end":327,"name":"route"},{"type":"Identifier","start":329,"end":334,"name":"state"}],"body":{"type":"BlockStatement","start":339,"end":1575,"body":[{"type":"VariableDeclaration","start":345,"end":389,"kind":"const","declarations":[{"type":"VariableDeclarator","start":351,"end":388,"id":{"type":"Identifier","start":351,"end":364,"name":"oauth2Service"},"init":{"type":"CallExpression","start":367,"end":388,"optional":false,"callee":{"type":"Identifier","start":367,"end":373,"name":"inject"},"arguments":[{"type":"Identifier","start":374,"end":387,"name":"OAuth2Service"}]}}]},{"type":"VariableDeclaration","start":394,"end":424,"kind":"const","declarations":[{"type":"VariableDeclarator","start":400,"end":423,"id":{"type":"Identifier","start":400,"end":406,"name":"router"},"init":{"type":"CallExpression","start":409,"end":423,"optional":false,"callee":{"type":"Identifier","start":409,"end":415,"name":"inject"},"arguments":[{"type":"Identifier","start":416,"end":422,"name":"Router"}]}}]},{"type":"IfStatement","start":496,"end":668,"test":{"type":"UnaryExpression","start":500,"end":542,"operator":"!","argument":{"type":"CallExpression","start":501,"end":542,"optional":false,"callee":{"type":"MemberExpression","start":501,"end":540,"computed":false,"optional":false,"object":{"type":"Identifier","start":501,"end":514,"name":"oauth2Service"},"property":{"type":"Identifier","start":515,"end":540,"name":"isAuthenticationAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":544,"end":668,"body":[{"type":"ExpressionStatement","start":554,"end":640,"expression":{"type":"CallExpression","start":554,"end":639,"optional":false,"callee":{"type":"MemberExpression","start":554,"end":566,"computed":false,"optional":false,"object":{"type":"Identifier","start":554,"end":561,"name":"console"},"property":{"type":"Identifier","start":562,"end":566,"name":"warn"}},"arguments":[{"type":"Literal","start":567,"end":638,"value":"[OAuth2AuthGuard] Authentication not available in current environment","raw":"'[OAuth2AuthGuard] Authentication not available in current environment'"}]}},{"type":"ReturnStatement","start":649,"end":662,"argument":{"type":"Literal","start":656,"end":661,"value":false,"raw":"false"}}]},"alternate":null},{"type":"ReturnStatement","start":715,"end":1573,"argument":{"type":"CallExpression","start":722,"end":1572,"optional":false,"callee":{"type":"MemberExpression","start":722,"end":751,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":722,"end":746,"computed":false,"optional":false,"object":{"type":"Identifier","start":722,"end":735,"name":"oauth2Service"},"property":{"type":"Identifier","start":736,"end":746,"name":"authState$"}},"property":{"type":"Identifier","start":747,"end":751,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":752,"end":759,"optional":false,"callee":{"type":"Identifier","start":752,"end":756,"name":"take"},"arguments":[{"type":"Literal","start":757,"end":758,"raw":"1","value":1}]},{"type":"CallExpression","start":761,"end":1571,"optional":false,"callee":{"type":"Identifier","start":761,"end":764,"name":"map"},"arguments":[{"type":"ArrowFunctionExpression","start":765,"end":1570,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":765,"end":774,"name":"authState"}],"body":{"type":"BlockStatement","start":778,"end":1570,"body":[{"type":"IfStatement","start":788,"end":855,"test":{"type":"MemberExpression","start":792,"end":817,"computed":false,"optional":false,"object":{"type":"Identifier","start":792,"end":801,"name":"authState"},"property":{"type":"Identifier","start":802,"end":817,"name":"isAuthenticated"}},"consequent":{"type":"BlockStatement","start":819,"end":855,"body":[{"type":"ReturnStatement","start":833,"end":845,"argument":{"type":"Literal","start":840,"end":844,"value":true,"raw":"true"}}]},"alternate":null},{"type":"IfStatement","start":926,"end":999,"test":{"type":"CallExpression","start":930,"end":961,"optional":false,"callee":{"type":"MemberExpression","start":930,"end":959,"computed":false,"optional":false,"object":{"type":"Identifier","start":930,"end":943,"name":"oauth2Service"},"property":{"type":"Identifier","start":944,"end":959,"name":"isAuthenticated"}},"arguments":[]},"consequent":{"type":"BlockStatement","start":963,"end":999,"body":[{"type":"ReturnStatement","start":977,"end":989,"argument":{"type":"Literal","start":984,"end":988,"value":true,"raw":"true"}}]},"alternate":null},{"type":"ExpressionStatement","start":1084,"end":1162,"expression":{"type":"CallExpression","start":1084,"end":1161,"optional":false,"callee":{"type":"MemberExpression","start":1084,"end":1095,"computed":false,"optional":false,"object":{"type":"Identifier","start":1084,"end":1091,"name":"console"},"property":{"type":"Identifier","start":1092,"end":1095,"name":"log"}},"arguments":[{"type":"Literal","start":1096,"end":1160,"value":"[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow","raw":"'[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow'"}]}},{"type":"ExpressionStatement","start":1266,"end":1413,"expression":{"type":"CallExpression","start":1266,"end":1412,"optional":false,"callee":{"type":"MemberExpression","start":1266,"end":1306,"computed":false,"optional":false,"object":{"type":"CallExpression","start":1266,"end":1300,"optional":false,"callee":{"type":"MemberExpression","start":1266,"end":1298,"computed":false,"optional":false,"object":{"type":"Identifier","start":1266,"end":1279,"name":"oauth2Service"},"property":{"type":"Identifier","start":1280,"end":1298,"name":"startAuthorization"}},"arguments":[]},"property":{"type":"Identifier","start":1301,"end":1306,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":1307,"end":1411,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":1307,"end":1312,"name":"error"}],"body":{"type":"BlockStatement","start":1316,"end":1411,"body":[{"type":"ExpressionStatement","start":1330,"end":1401,"expression":{"type":"CallExpression","start":1330,"end":1400,"optional":false,"callee":{"type":"MemberExpression","start":1330,"end":1343,"computed":false,"optional":false,"object":{"type":"Identifier","start":1330,"end":1337,"name":"console"},"property":{"type":"Identifier","start":1338,"end":1343,"name":"error"}},"arguments":[{"type":"Literal","start":1344,"end":1392,"value":"[OAuth2AuthGuard] Failed to start OAuth2 flow:","raw":"'[OAuth2AuthGuard] Failed to start OAuth2 flow:'"},{"type":"Identifier","start":1394,"end":1399,"name":"error"}]}}]},"id":null}]}},{"type":"ReturnStatement","start":1551,"end":1564,"argument":{"type":"Literal","start":1558,"end":1563,"value":false,"raw":"false"}}]},"id":null}]}]}}]},"id":null}}]}},{"type":"ExportNamedDeclaration","start":1703,"end":2923,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":1710,"end":2923,"decorators":[],"id":{"type":"Identifier","start":1716,"end":1731,"name":"OAuth2AuthGuard"},"superClass":null,"body":{"type":"ClassBody","start":1732,"end":2923,"body":[{"type":"MethodDefinition","start":1738,"end":1854,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1738,"end":1749,"name":"constructor"},"value":{"type":"FunctionExpression","start":1749,"end":1854,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":1750,"end":1763,"name":"oauth2Service"},{"type":"Identifier","start":1765,"end":1771,"name":"router"}],"body":{"type":"BlockStatement","start":1773,"end":1854,"body":[{"type":"ExpressionStatement","start":1783,"end":1818,"expression":{"type":"AssignmentExpression","start":1783,"end":1817,"operator":"=","left":{"type":"MemberExpression","start":1783,"end":1801,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1783,"end":1787},"property":{"type":"Identifier","start":1788,"end":1801,"name":"oauth2Service"}},"right":{"type":"Identifier","start":1804,"end":1817,"name":"oauth2Service"}}},{"type":"ExpressionStatement","start":1827,"end":1848,"expression":{"type":"AssignmentExpression","start":1827,"end":1847,"operator":"=","left":{"type":"MemberExpression","start":1827,"end":1838,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1827,"end":1831},"property":{"type":"Identifier","start":1832,"end":1838,"name":"router"}},"right":{"type":"Identifier","start":1841,"end":1847,"name":"router"}}}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":1859,"end":2921,"static":false,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1859,"end":1870,"name":"canActivate"},"value":{"type":"FunctionExpression","start":1870,"end":2921,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":1871,"end":1876,"name":"route"},{"type":"Identifier","start":1878,"end":1883,"name":"state"}],"body":{"type":"BlockStatement","start":1885,"end":2921,"body":[{"type":"IfStatement","start":1966,"end":2155,"test":{"type":"UnaryExpression","start":1970,"end":2017,"operator":"!","argument":{"type":"CallExpression","start":1971,"end":2017,"optional":false,"callee":{"type":"MemberExpression","start":1971,"end":2015,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1971,"end":1989,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1971,"end":1975},"property":{"type":"Identifier","start":1976,"end":1989,"name":"oauth2Service"}},"property":{"type":"Identifier","start":1990,"end":2015,"name":"isAuthenticationAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":2019,"end":2155,"body":[{"type":"ExpressionStatement","start":2033,"end":2119,"expression":{"type":"CallExpression","start":2033,"end":2118,"optional":false,"callee":{"type":"MemberExpression","start":2033,"end":2045,"computed":false,"optional":false,"object":{"type":"Identifier","start":2033,"end":2040,"name":"console"},"property":{"type":"Identifier","start":2041,"end":2045,"name":"warn"}},"arguments":[{"type":"Literal","start":2046,"end":2117,"value":"[OAuth2AuthGuard] Authentication not available in current environment","raw":"'[OAuth2AuthGuard] Authentication not available in current environment'"}]}},{"type":"ReturnStatement","start":2132,"end":2145,"argument":{"type":"Literal","start":2139,"end":2144,"value":false,"raw":"false"}}]},"alternate":null},{"type":"ReturnStatement","start":2210,"end":2915,"argument":{"type":"CallExpression","start":2217,"end":2914,"optional":false,"callee":{"type":"MemberExpression","start":2217,"end":2251,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2217,"end":2246,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2217,"end":2235,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2217,"end":2221},"property":{"type":"Identifier","start":2222,"end":2235,"name":"oauth2Service"}},"property":{"type":"Identifier","start":2236,"end":2246,"name":"authState$"}},"property":{"type":"Identifier","start":2247,"end":2251,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":2252,"end":2259,"optional":false,"callee":{"type":"Identifier","start":2252,"end":2256,"name":"take"},"arguments":[{"type":"Literal","start":2257,"end":2258,"raw":"1","value":1}]},{"type":"CallExpression","start":2261,"end":2913,"optional":false,"callee":{"type":"Identifier","start":2261,"end":2264,"name":"map"},"arguments":[{"type":"ArrowFunctionExpression","start":2265,"end":2912,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":2265,"end":2274,"name":"authState"}],"body":{"type":"BlockStatement","start":2278,"end":2912,"body":[{"type":"IfStatement","start":2292,"end":2367,"test":{"type":"MemberExpression","start":2296,"end":2321,"computed":false,"optional":false,"object":{"type":"Identifier","start":2296,"end":2305,"name":"authState"},"property":{"type":"Identifier","start":2306,"end":2321,"name":"isAuthenticated"}},"consequent":{"type":"BlockStatement","start":2323,"end":2367,"body":[{"type":"ReturnStatement","start":2341,"end":2353,"argument":{"type":"Literal","start":2348,"end":2352,"value":true,"raw":"true"}}]},"alternate":null},{"type":"IfStatement","start":2446,"end":2532,"test":{"type":"CallExpression","start":2450,"end":2486,"optional":false,"callee":{"type":"MemberExpression","start":2450,"end":2484,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2450,"end":2468,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2450,"end":2454},"property":{"type":"Identifier","start":2455,"end":2468,"name":"oauth2Service"}},"property":{"type":"Identifier","start":2469,"end":2484,"name":"isAuthenticated"}},"arguments":[]},"consequent":{"type":"BlockStatement","start":2488,"end":2532,"body":[{"type":"ReturnStatement","start":2506,"end":2518,"argument":{"type":"Literal","start":2513,"end":2517,"value":true,"raw":"true"}}]},"alternate":null},{"type":"ExpressionStatement","start":2625,"end":2703,"expression":{"type":"CallExpression","start":2625,"end":2702,"optional":false,"callee":{"type":"MemberExpression","start":2625,"end":2636,"computed":false,"optional":false,"object":{"type":"Identifier","start":2625,"end":2632,"name":"console"},"property":{"type":"Identifier","start":2633,"end":2636,"name":"log"}},"arguments":[{"type":"Literal","start":2637,"end":2701,"value":"[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow","raw":"'[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow'"}]}},{"type":"ExpressionStatement","start":2716,"end":2876,"expression":{"type":"CallExpression","start":2716,"end":2875,"optional":false,"callee":{"type":"MemberExpression","start":2716,"end":2761,"computed":false,"optional":false,"object":{"type":"CallExpression","start":2716,"end":2755,"optional":false,"callee":{"type":"MemberExpression","start":2716,"end":2753,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2716,"end":2734,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2716,"end":2720},"property":{"type":"Identifier","start":2721,"end":2734,"name":"oauth2Service"}},"property":{"type":"Identifier","start":2735,"end":2753,"name":"startAuthorization"}},"arguments":[]},"property":{"type":"Identifier","start":2756,"end":2761,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":2762,"end":2874,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":2762,"end":2767,"name":"error"}],"body":{"type":"BlockStatement","start":2771,"end":2874,"body":[{"type":"ExpressionStatement","start":2789,"end":2860,"expression":{"type":"CallExpression","start":2789,"end":2859,"optional":false,"callee":{"type":"MemberExpression","start":2789,"end":2802,"computed":false,"optional":false,"object":{"type":"Identifier","start":2789,"end":2796,"name":"console"},"property":{"type":"Identifier","start":2797,"end":2802,"name":"error"}},"arguments":[{"type":"Literal","start":2803,"end":2851,"value":"[OAuth2AuthGuard] Failed to start OAuth2 flow:","raw":"'[OAuth2AuthGuard] Failed to start OAuth2 flow:'"},{"type":"Identifier","start":2853,"end":2858,"name":"error"}]}}]},"id":null}]}},{"type":"ReturnStatement","start":2889,"end":2902,"argument":{"type":"Literal","start":2896,"end":2901,"value":false,"raw":"false"}}]},"id":null}]}]}}]},"expression":false},"kind":"method"}]}}},{"type":"ExportNamedDeclaration","start":3089,"end":3925,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"VariableDeclaration","start":3096,"end":3925,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3102,"end":3924,"id":{"type":"Identifier","start":3102,"end":3119,"name":"oauth2UnauthGuard"},"init":{"type":"ArrowFunctionExpression","start":3122,"end":3924,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":3123,"end":3128,"name":"route"},{"type":"Identifier","start":3130,"end":3135,"name":"state"}],"body":{"type":"BlockStatement","start":3140,"end":3924,"body":[{"type":"VariableDeclaration","start":3146,"end":3190,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3152,"end":3189,"id":{"type":"Identifier","start":3152,"end":3165,"name":"oauth2Service"},"init":{"type":"CallExpression","start":3168,"end":3189,"optional":false,"callee":{"type":"Identifier","start":3168,"end":3174,"name":"inject"},"arguments":[{"type":"Identifier","start":3175,"end":3188,"name":"OAuth2Service"}]}}]},{"type":"VariableDeclaration","start":3195,"end":3225,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3201,"end":3224,"id":{"type":"Identifier","start":3201,"end":3207,"name":"router"},"init":{"type":"CallExpression","start":3210,"end":3224,"optional":false,"callee":{"type":"Identifier","start":3210,"end":3216,"name":"inject"},"arguments":[{"type":"Identifier","start":3217,"end":3223,"name":"Router"}]}}]},{"type":"IfStatement","start":3297,"end":3414,"test":{"type":"UnaryExpression","start":3301,"end":3343,"operator":"!","argument":{"type":"CallExpression","start":3302,"end":3343,"optional":false,"callee":{"type":"MemberExpression","start":3302,"end":3341,"computed":false,"optional":false,"object":{"type":"Identifier","start":3302,"end":3315,"name":"oauth2Service"},"property":{"type":"Identifier","start":3316,"end":3341,"name":"isAuthenticationAvailable"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":3345,"end":3414,"body":[{"type":"ReturnStatement","start":3355,"end":3367,"argument":{"type":"Literal","start":3362,"end":3366,"value":true,"raw":"true"}}]},"alternate":null},{"type":"ReturnStatement","start":3461,"end":3922,"argument":{"type":"CallExpression","start":3468,"end":3921,"optional":false,"callee":{"type":"MemberExpression","start":3468,"end":3497,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3468,"end":3492,"computed":false,"optional":false,"object":{"type":"Identifier","start":3468,"end":3481,"name":"oauth2Service"},"property":{"type":"Identifier","start":3482,"end":3492,"name":"authState$"}},"property":{"type":"Identifier","start":3493,"end":3497,"name":"pipe"}},"arguments":[{"type":"CallExpression","start":3498,"end":3505,"optional":false,"callee":{"type":"Identifier","start":3498,"end":3502,"name":"take"},"arguments":[{"type":"Literal","start":3503,"end":3504,"raw":"1","value":1}]},{"type":"CallExpression","start":3507,"end":3920,"optional":false,"callee":{"type":"Identifier","start":3507,"end":3510,"name":"map"},"arguments":[{"type":"ArrowFunctionExpression","start":3511,"end":3919,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":3511,"end":3520,"name":"authState"}],"body":{"type":"BlockStatement","start":3524,"end":3919,"body":[{"type":"IfStatement","start":3534,"end":3681,"test":{"type":"LogicalExpression","start":3538,"end":3600,"operator":"&&","left":{"type":"UnaryExpression","start":3538,"end":3564,"operator":"!","argument":{"type":"MemberExpression","start":3539,"end":3564,"computed":false,"optional":false,"object":{"type":"Identifier","start":3539,"end":3548,"name":"authState"},"property":{"type":"Identifier","start":3549,"end":3564,"name":"isAuthenticated"}},"prefix":true},"right":{"type":"UnaryExpression","start":3568,"end":3600,"operator":"!","argument":{"type":"CallExpression","start":3569,"end":3600,"optional":false,"callee":{"type":"MemberExpression","start":3569,"end":3598,"computed":false,"optional":false,"object":{"type":"Identifier","start":3569,"end":3582,"name":"oauth2Service"},"property":{"type":"Identifier","start":3583,"end":3598,"name":"isAuthenticated"}},"arguments":[]},"prefix":true}},"consequent":{"type":"BlockStatement","start":3602,"end":3681,"body":[{"type":"ReturnStatement","start":3616,"end":3628,"argument":{"type":"Literal","start":3623,"end":3627,"value":true,"raw":"true"}}]},"alternate":null},{"type":"ExpressionStatement","start":3751,"end":3826,"expression":{"type":"CallExpression","start":3751,"end":3825,"optional":false,"callee":{"type":"MemberExpression","start":3751,"end":3762,"computed":false,"optional":false,"object":{"type":"Identifier","start":3751,"end":3758,"name":"console"},"property":{"type":"Identifier","start":3759,"end":3762,"name":"log"}},"arguments":[{"type":"Literal","start":3763,"end":3824,"value":"[OAuth2UnauthGuard] User already authenticated, redirecting","raw":"'[OAuth2UnauthGuard] User already authenticated, redirecting'"}]}},{"type":"ExpressionStatement","start":3835,"end":3858,"expression":{"type":"CallExpression","start":3835,"end":3857,"optional":false,"callee":{"type":"MemberExpression","start":3835,"end":3850,"computed":false,"optional":false,"object":{"type":"Identifier","start":3835,"end":3841,"name":"router"},"property":{"type":"Identifier","start":3842,"end":3850,"name":"navigate"}},"arguments":[{"type":"ArrayExpression","start":3851,"end":3856,"elements":[{"type":"Literal","start":3852,"end":3855,"value":"/","raw":"'/'"}]}]}},{"type":"ReturnStatement","start":3900,"end":3913,"argument":{"type":"Literal","start":3907,"end":3912,"value":false,"raw":"false"}}]},"id":null}]}]}}]},"id":null}}]}},{"type":"ExportNamedDeclaration","start":3926,"end":6244,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"FunctionDeclaration","start":3933,"end":6244,"async":false,"generator":false,"id":{"type":"Identifier","start":3942,"end":3957,"name":"oauth2RoleGuard"},"params":[{"type":"Identifier","start":3958,"end":3964,"name":"config"}],"body":{"type":"BlockStatement","start":3966,"end":6244,"body":[{"type":"ReturnStatement","start":3972,"end":6242,"argument":{"type":"ArrowFunctionExpression","start":3979,"end":6241,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":3980,"end":3985,"name":"route"},{"type":"Identifier","start":3987,"end":3992,"name":"state"}],"body":{"type":"BlockStatement","start":3997,"end":6241,"body":[{"type":"VariableDeclaration","start":4007,"end":4051,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4013,"end":4050,"id":{"type":"Identifier","start":4013,"end":4026,"name":"oauth2Service"},"init":{"type":"CallExpression","start":4029,"end":4050,"optional":false,"callee":{"type":"Identifier","start":4029,"end":4035,"name":"inject"},"arguments":[{"type":"Identifier","start":4036,"end":4049,"name":"OAuth2Service"}]}}]},{"type":"VariableDeclaration","start":4060,"end":4090,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4066,"end":4089,"id":{"type":"Identifier","start":4066,"end":4072,"name":"router"},"init":{"type":"CallExpression","start":4075,"end":4089,"optional":false,"callee":{"type":"Identifier","start":4075,"end":4081,"name":"inject"},"arguments":[{"type":"Identifier","start":4082,"end":4088,"name":"Router"}]}}]},{"type":"IfStatement","start":4147,"end":4459,"test":{"type":"UnaryExpression","start":4151,"end":4183,"operator":"!","argument":{"type":"CallExpression","start":4152,"end":4183,"optional":false,"callee":{"type":"MemberExpression","start":4152,"end":4181,"computed":false,"optional":false,"object":{"type":"Identifier","start":4152,"end":4165,"name":"oauth2Service"},"property":{"type":"Identifier","start":4166,"end":4181,"name":"isAuthenticated"}},"arguments":[]},"prefix":true},"consequent":{"type":"BlockStatement","start":4185,"end":4459,"body":[{"type":"ExpressionStatement","start":4199,"end":4255,"expression":{"type":"CallExpression","start":4199,"end":4254,"optional":false,"callee":{"type":"MemberExpression","start":4199,"end":4210,"computed":false,"optional":false,"object":{"type":"Identifier","start":4199,"end":4206,"name":"console"},"property":{"type":"Identifier","start":4207,"end":4210,"name":"log"}},"arguments":[{"type":"Literal","start":4211,"end":4253,"value":"[OAuth2RoleGuard] User not authenticated","raw":"'[OAuth2RoleGuard] User not authenticated'"}]}},{"type":"ExpressionStatement","start":4268,"end":4423,"expression":{"type":"CallExpression","start":4268,"end":4422,"optional":false,"callee":{"type":"MemberExpression","start":4268,"end":4308,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4268,"end":4302,"optional":false,"callee":{"type":"MemberExpression","start":4268,"end":4300,"computed":false,"optional":false,"object":{"type":"Identifier","start":4268,"end":4281,"name":"oauth2Service"},"property":{"type":"Identifier","start":4282,"end":4300,"name":"startAuthorization"}},"arguments":[]},"property":{"type":"Identifier","start":4303,"end":4308,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":4309,"end":4421,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":4309,"end":4314,"name":"error"}],"body":{"type":"BlockStatement","start":4318,"end":4421,"body":[{"type":"ExpressionStatement","start":4336,"end":4407,"expression":{"type":"CallExpression","start":4336,"end":4406,"optional":false,"callee":{"type":"MemberExpression","start":4336,"end":4349,"computed":false,"optional":false,"object":{"type":"Identifier","start":4336,"end":4343,"name":"console"},"property":{"type":"Identifier","start":4344,"end":4349,"name":"error"}},"arguments":[{"type":"Literal","start":4350,"end":4398,"value":"[OAuth2RoleGuard] Failed to start OAuth2 flow:","raw":"'[OAuth2RoleGuard] Failed to start OAuth2 flow:'"},{"type":"Identifier","start":4400,"end":4405,"name":"error"}]}}]},"id":null}]}},{"type":"ReturnStatement","start":4436,"end":4449,"argument":{"type":"Literal","start":4443,"end":4448,"value":false,"raw":"false"}}]},"alternate":null},{"type":"IfStatement","start":4543,"end":4637,"test":{"type":"LogicalExpression","start":4547,"end":4599,"operator":"&&","left":{"type":"UnaryExpression","start":4547,"end":4568,"operator":"!","argument":{"type":"ChainExpression","start":4548,"end":4568,"expression":{"type":"MemberExpression","start":4548,"end":4568,"computed":false,"optional":true,"object":{"type":"MemberExpression","start":4548,"end":4560,"computed":false,"optional":false,"object":{"type":"Identifier","start":4548,"end":4554,"name":"config"},"property":{"type":"Identifier","start":4555,"end":4560,"name":"roles"}},"property":{"type":"Identifier","start":4562,"end":4568,"name":"length"}}},"prefix":true},"right":{"type":"UnaryExpression","start":4572,"end":4599,"operator":"!","argument":{"type":"ChainExpression","start":4573,"end":4599,"expression":{"type":"MemberExpression","start":4573,"end":4599,"computed":false,"optional":true,"object":{"type":"MemberExpression","start":4573,"end":4591,"computed":false,"optional":false,"object":{"type":"Identifier","start":4573,"end":4579,"name":"config"},"property":{"type":"Identifier","start":4580,"end":4591,"name":"permissions"}},"property":{"type":"Identifier","start":4593,"end":4599,"name":"length"}}},"prefix":true}},"consequent":{"type":"BlockStatement","start":4601,"end":4637,"body":[{"type":"ReturnStatement","start":4615,"end":4627,"argument":{"type":"Literal","start":4622,"end":4626,"value":true,"raw":"true"}}]},"alternate":null},{"type":"ReturnStatement","start":4698,"end":6235,"argument":{"type":"CallExpression","start":4705,"end":6234,"optional":false,"callee":{"type":"MemberExpression","start":4705,"end":6106,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4705,"end":6100,"optional":false,"callee":{"type":"MemberExpression","start":4705,"end":4737,"computed":false,"optional":false,"object":{"type":"CallExpression","start":4705,"end":4732,"optional":false,"callee":{"type":"MemberExpression","start":4705,"end":4730,"computed":false,"optional":false,"object":{"type":"Identifier","start":4705,"end":4718,"name":"oauth2Service"},"property":{"type":"Identifier","start":4719,"end":4730,"name":"getUserInfo"}},"arguments":[]},"property":{"type":"Identifier","start":4733,"end":4737,"name":"then"}},"arguments":[{"type":"ArrowFunctionExpression","start":4738,"end":6099,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":4738,"end":4746,"name":"userInfo"}],"body":{"type":"BlockStatement","start":4750,"end":6099,"body":[{"type":"VariableDeclaration","start":4764,"end":4803,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4770,"end":4802,"id":{"type":"Identifier","start":4770,"end":4779,"name":"userRoles"},"init":{"type":"LogicalExpression","start":4782,"end":4802,"operator":"||","left":{"type":"MemberExpression","start":4782,"end":4796,"computed":false,"optional":false,"object":{"type":"Identifier","start":4782,"end":4790,"name":"userInfo"},"property":{"type":"Identifier","start":4791,"end":4796,"name":"roles"}},"right":{"type":"ArrayExpression","start":4800,"end":4802,"elements":[]}}}]},{"type":"VariableDeclaration","start":4816,"end":4867,"kind":"const","declarations":[{"type":"VariableDeclarator","start":4822,"end":4866,"id":{"type":"Identifier","start":4822,"end":4837,"name":"userPermissions"},"init":{"type":"LogicalExpression","start":4840,"end":4866,"operator":"||","left":{"type":"MemberExpression","start":4840,"end":4860,"computed":false,"optional":false,"object":{"type":"Identifier","start":4840,"end":4848,"name":"userInfo"},"property":{"type":"Identifier","start":4849,"end":4860,"name":"permissions"}},"right":{"type":"ArrayExpression","start":4864,"end":4866,"elements":[]}}}]},{"type":"VariableDeclaration","start":4880,"end":4908,"kind":"let","declarations":[{"type":"VariableDeclarator","start":4884,"end":4907,"id":{"type":"Identifier","start":4884,"end":4900,"name":"hasRequiredRoles"},"init":{"type":"Literal","start":4903,"end":4907,"value":true,"raw":"true"}}]},{"type":"VariableDeclaration","start":4921,"end":4955,"kind":"let","declarations":[{"type":"VariableDeclarator","start":4925,"end":4954,"id":{"type":"Identifier","start":4925,"end":4947,"name":"hasRequiredPermissions"},"init":{"type":"Literal","start":4950,"end":4954,"value":true,"raw":"true"}}]},{"type":"IfStatement","start":4995,"end":5321,"test":{"type":"ChainExpression","start":4999,"end":5019,"expression":{"type":"MemberExpression","start":4999,"end":5019,"computed":false,"optional":true,"object":{"type":"MemberExpression","start":4999,"end":5011,"computed":false,"optional":false,"object":{"type":"Identifier","start":4999,"end":5005,"name":"config"},"property":{"type":"Identifier","start":5006,"end":5011,"name":"roles"}},"property":{"type":"Identifier","start":5013,"end":5019,"name":"length"}}},"consequent":{"type":"BlockStatement","start":5021,"end":5321,"body":[{"type":"IfStatement","start":5039,"end":5307,"test":{"type":"MemberExpression","start":5043,"end":5060,"computed":false,"optional":false,"object":{"type":"Identifier","start":5043,"end":5049,"name":"config"},"property":{"type":"Identifier","start":5050,"end":5060,"name":"requireAll"}},"consequent":{"type":"BlockStatement","start":5062,"end":5174,"body":[{"type":"ExpressionStatement","start":5084,"end":5156,"expression":{"type":"AssignmentExpression","start":5084,"end":5155,"operator":"=","left":{"type":"Identifier","start":5084,"end":5100,"name":"hasRequiredRoles"},"right":{"type":"CallExpression","start":5103,"end":5155,"optional":false,"callee":{"type":"MemberExpression","start":5103,"end":5121,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5103,"end":5115,"computed":false,"optional":false,"object":{"type":"Identifier","start":5103,"end":5109,"name":"config"},"property":{"type":"Identifier","start":5110,"end":5115,"name":"roles"}},"property":{"type":"Identifier","start":5116,"end":5121,"name":"every"}},"arguments":[{"type":"ArrowFunctionExpression","start":5122,"end":5154,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":5122,"end":5126,"name":"role"}],"body":{"type":"CallExpression","start":5130,"end":5154,"optional":false,"callee":{"type":"MemberExpression","start":5130,"end":5148,"computed":false,"optional":false,"object":{"type":"Identifier","start":5130,"end":5139,"name":"userRoles"},"property":{"type":"Identifier","start":5140,"end":5148,"name":"includes"}},"arguments":[{"type":"Identifier","start":5149,"end":5153,"name":"role"}]},"id":null}]}}}]},"alternate":{"type":"BlockStatement","start":5196,"end":5307,"body":[{"type":"ExpressionStatement","start":5218,"end":5289,"expression":{"type":"AssignmentExpression","start":5218,"end":5288,"operator":"=","left":{"type":"Identifier","start":5218,"end":5234,"name":"hasRequiredRoles"},"right":{"type":"CallExpression","start":5237,"end":5288,"optional":false,"callee":{"type":"MemberExpression","start":5237,"end":5254,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5237,"end":5249,"computed":false,"optional":false,"object":{"type":"Identifier","start":5237,"end":5243,"name":"config"},"property":{"type":"Identifier","start":5244,"end":5249,"name":"roles"}},"property":{"type":"Identifier","start":5250,"end":5254,"name":"some"}},"arguments":[{"type":"ArrowFunctionExpression","start":5255,"end":5287,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":5255,"end":5259,"name":"role"}],"body":{"type":"CallExpression","start":5263,"end":5287,"optional":false,"callee":{"type":"MemberExpression","start":5263,"end":5281,"computed":false,"optional":false,"object":{"type":"Identifier","start":5263,"end":5272,"name":"userRoles"},"property":{"type":"Identifier","start":5273,"end":5281,"name":"includes"}},"arguments":[{"type":"Identifier","start":5282,"end":5286,"name":"role"}]},"id":null}]}}}]}}]},"alternate":null},{"type":"IfStatement","start":5367,"end":5759,"test":{"type":"ChainExpression","start":5371,"end":5397,"expression":{"type":"MemberExpression","start":5371,"end":5397,"computed":false,"optional":true,"object":{"type":"MemberExpression","start":5371,"end":5389,"computed":false,"optional":false,"object":{"type":"Identifier","start":5371,"end":5377,"name":"config"},"property":{"type":"Identifier","start":5378,"end":5389,"name":"permissions"}},"property":{"type":"Identifier","start":5391,"end":5397,"name":"length"}}},"consequent":{"type":"BlockStatement","start":5399,"end":5759,"body":[{"type":"IfStatement","start":5417,"end":5745,"test":{"type":"MemberExpression","start":5421,"end":5438,"computed":false,"optional":false,"object":{"type":"Identifier","start":5421,"end":5427,"name":"config"},"property":{"type":"Identifier","start":5428,"end":5438,"name":"requireAll"}},"consequent":{"type":"BlockStatement","start":5440,"end":5582,"body":[{"type":"ExpressionStatement","start":5462,"end":5564,"expression":{"type":"AssignmentExpression","start":5462,"end":5563,"operator":"=","left":{"type":"Identifier","start":5462,"end":5484,"name":"hasRequiredPermissions"},"right":{"type":"CallExpression","start":5487,"end":5563,"optional":false,"callee":{"type":"MemberExpression","start":5487,"end":5511,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5487,"end":5505,"computed":false,"optional":false,"object":{"type":"Identifier","start":5487,"end":5493,"name":"config"},"property":{"type":"Identifier","start":5494,"end":5505,"name":"permissions"}},"property":{"type":"Identifier","start":5506,"end":5511,"name":"every"}},"arguments":[{"type":"ArrowFunctionExpression","start":5512,"end":5562,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":5512,"end":5522,"name":"permission"}],"body":{"type":"CallExpression","start":5526,"end":5562,"optional":false,"callee":{"type":"MemberExpression","start":5526,"end":5550,"computed":false,"optional":false,"object":{"type":"Identifier","start":5526,"end":5541,"name":"userPermissions"},"property":{"type":"Identifier","start":5542,"end":5550,"name":"includes"}},"arguments":[{"type":"Identifier","start":5551,"end":5561,"name":"permission"}]},"id":null}]}}}]},"alternate":{"type":"BlockStatement","start":5604,"end":5745,"body":[{"type":"ExpressionStatement","start":5626,"end":5727,"expression":{"type":"AssignmentExpression","start":5626,"end":5726,"operator":"=","left":{"type":"Identifier","start":5626,"end":5648,"name":"hasRequiredPermissions"},"right":{"type":"CallExpression","start":5651,"end":5726,"optional":false,"callee":{"type":"MemberExpression","start":5651,"end":5674,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":5651,"end":5669,"computed":false,"optional":false,"object":{"type":"Identifier","start":5651,"end":5657,"name":"config"},"property":{"type":"Identifier","start":5658,"end":5669,"name":"permissions"}},"property":{"type":"Identifier","start":5670,"end":5674,"name":"some"}},"arguments":[{"type":"ArrowFunctionExpression","start":5675,"end":5725,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":5675,"end":5685,"name":"permission"}],"body":{"type":"CallExpression","start":5689,"end":5725,"optional":false,"callee":{"type":"MemberExpression","start":5689,"end":5713,"computed":false,"optional":false,"object":{"type":"Identifier","start":5689,"end":5704,"name":"userPermissions"},"property":{"type":"Identifier","start":5705,"end":5713,"name":"includes"}},"arguments":[{"type":"Identifier","start":5714,"end":5724,"name":"permission"}]},"id":null}]}}}]}}]},"alternate":null},{"type":"VariableDeclaration","start":5772,"end":5833,"kind":"const","declarations":[{"type":"VariableDeclarator","start":5778,"end":5832,"id":{"type":"Identifier","start":5778,"end":5787,"name":"hasAccess"},"init":{"type":"LogicalExpression","start":5790,"end":5832,"operator":"&&","left":{"type":"Identifier","start":5790,"end":5806,"name":"hasRequiredRoles"},"right":{"type":"Identifier","start":5810,"end":5832,"name":"hasRequiredPermissions"}}}]},{"type":"IfStatement","start":5846,"end":6059,"test":{"type":"UnaryExpression","start":5850,"end":5860,"operator":"!","argument":{"type":"Identifier","start":5851,"end":5860,"name":"hasAccess"},"prefix":true},"consequent":{"type":"BlockStatement","start":5862,"end":6059,"body":[{"type":"ExpressionStatement","start":5880,"end":5960,"expression":{"type":"CallExpression","start":5880,"end":5959,"optional":false,"callee":{"type":"MemberExpression","start":5880,"end":5892,"computed":false,"optional":false,"object":{"type":"Identifier","start":5880,"end":5887,"name":"console"},"property":{"type":"Identifier","start":5888,"end":5892,"name":"warn"}},"arguments":[{"type":"Literal","start":5893,"end":5958,"value":"[OAuth2RoleGuard] User does not have required roles/permissions","raw":"'[OAuth2RoleGuard] User does not have required roles/permissions'"}]}},{"type":"ExpressionStatement","start":5977,"end":6012,"expression":{"type":"CallExpression","start":5977,"end":6011,"optional":false,"callee":{"type":"MemberExpression","start":5977,"end":5992,"computed":false,"optional":false,"object":{"type":"Identifier","start":5977,"end":5983,"name":"router"},"property":{"type":"Identifier","start":5984,"end":5992,"name":"navigate"}},"arguments":[{"type":"ArrayExpression","start":5993,"end":6010,"elements":[{"type":"Literal","start":5994,"end":6009,"value":"/unauthorized","raw":"'/unauthorized'"}]}]}}]},"alternate":null},{"type":"ReturnStatement","start":6072,"end":6089,"argument":{"type":"Identifier","start":6079,"end":6088,"name":"hasAccess"}}]},"id":null}]},"property":{"type":"Identifier","start":6101,"end":6106,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":6107,"end":6233,"async":false,"expression":false,"generator":false,"params":[{"type":"Identifier","start":6107,"end":6112,"name":"error"}],"body":{"type":"BlockStatement","start":6116,"end":6233,"body":[{"type":"ExpressionStatement","start":6130,"end":6197,"expression":{"type":"CallExpression","start":6130,"end":6196,"optional":false,"callee":{"type":"MemberExpression","start":6130,"end":6143,"computed":false,"optional":false,"object":{"type":"Identifier","start":6130,"end":6137,"name":"console"},"property":{"type":"Identifier","start":6138,"end":6143,"name":"error"}},"arguments":[{"type":"Literal","start":6144,"end":6188,"value":"[OAuth2RoleGuard] Failed to get user info:","raw":"'[OAuth2RoleGuard] Failed to get user info:'"},{"type":"Identifier","start":6190,"end":6195,"name":"error"}]}},{"type":"ReturnStatement","start":6210,"end":6223,"argument":{"type":"Literal","start":6217,"end":6222,"value":false,"raw":"false"}}]},"id":null}]}}]},"id":null}}]},"expression":false}}],"_rollupRemoved":[{"end":22147,"start":6245,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { map, take } from 'rxjs/operators';\nimport { OAuth2Service } from '../services/oauth2.service';\n/**\n * OAuth2 Authentication Guard Function\n * Protects routes by checking if user is authenticated\n */\nexport const oauth2AuthGuard = (route, state) => {\n    const oauth2Service = inject(OAuth2Service);\n    const router = inject(Router);\n    // Check if authentication is available in current environment\n    if (!oauth2Service.isAuthenticationAvailable()) {\n        console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\n        return false;\n    }\n    // Check current authentication state\n    return oauth2Service.authState$.pipe(take(1), map(authState => {\n        if (authState.isAuthenticated) {\n            return true;\n        }\n        // Check if we have stored tokens that might be valid\n        if (oauth2Service.isAuthenticated()) {\n            return true;\n        }\n        // User is not authenticated, redirect to login or start OAuth flow\n        console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\n        // You can customize this behavior:\n        // Option 1: Start OAuth2 flow immediately\n        oauth2Service.startAuthorization().catch(error => {\n            console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\n        });\n        // Option 2: Redirect to a login page\n        // router.navigate(['/login'], { queryParams: { returnUrl: state.url } });\n        return false;\n    }));\n};\n/**\n * OAuth2 Authentication Guard Class (for backward compatibility)\n * @deprecated Use oauth2AuthGuard function instead\n */\nexport class OAuth2AuthGuard {\n    constructor(oauth2Service, router) {\n        this.oauth2Service = oauth2Service;\n        this.router = router;\n    }\n    canActivate(route, state) {\n        // Check if authentication is available in current environment\n        if (!this.oauth2Service.isAuthenticationAvailable()) {\n            console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\n            return false;\n        }\n        // Check current authentication state\n        return this.oauth2Service.authState$.pipe(take(1), map(authState => {\n            if (authState.isAuthenticated) {\n                return true;\n            }\n            // Check if we have stored tokens that might be valid\n            if (this.oauth2Service.isAuthenticated()) {\n                return true;\n            }\n            // User is not authenticated, redirect to login or start OAuth flow\n            console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\n            this.oauth2Service.startAuthorization().catch(error => {\n                console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\n            });\n            return false;\n        }));\n    }\n}\n/**\n * OAuth2 Unauthenticated Guard Function\n * Protects routes that should only be accessible to unauthenticated users\n * (e.g., login page, registration page)\n */\nexport const oauth2UnauthGuard = (route, state) => {\n    const oauth2Service = inject(OAuth2Service);\n    const router = inject(Router);\n    // Check if authentication is available in current environment\n    if (!oauth2Service.isAuthenticationAvailable()) {\n        return true; // Allow access if auth is not available\n    }\n    // Check current authentication state\n    return oauth2Service.authState$.pipe(take(1), map(authState => {\n        if (!authState.isAuthenticated && !oauth2Service.isAuthenticated()) {\n            return true; // User is not authenticated, allow access\n        }\n        // User is authenticated, redirect to protected area\n        console.log('[OAuth2UnauthGuard] User already authenticated, redirecting');\n        router.navigate(['/']); // Redirect to home or dashboard\n        return false;\n    }));\n};\nexport function oauth2RoleGuard(config) {\n    return (route, state) => {\n        const oauth2Service = inject(OAuth2Service);\n        const router = inject(Router);\n        // First check if user is authenticated\n        if (!oauth2Service.isAuthenticated()) {\n            console.log('[OAuth2RoleGuard] User not authenticated');\n            oauth2Service.startAuthorization().catch(error => {\n                console.error('[OAuth2RoleGuard] Failed to start OAuth2 flow:', error);\n            });\n            return false;\n        }\n        // If no roles or permissions specified, just check authentication\n        if (!config.roles?.length && !config.permissions?.length) {\n            return true;\n        }\n        // Get user info to check roles/permissions\n        return oauth2Service.getUserInfo().then(userInfo => {\n            const userRoles = userInfo.roles || [];\n            const userPermissions = userInfo.permissions || [];\n            let hasRequiredRoles = true;\n            let hasRequiredPermissions = true;\n            // Check roles\n            if (config.roles?.length) {\n                if (config.requireAll) {\n                    hasRequiredRoles = config.roles.every(role => userRoles.includes(role));\n                }\n                else {\n                    hasRequiredRoles = config.roles.some(role => userRoles.includes(role));\n                }\n            }\n            // Check permissions\n            if (config.permissions?.length) {\n                if (config.requireAll) {\n                    hasRequiredPermissions = config.permissions.every(permission => userPermissions.includes(permission));\n                }\n                else {\n                    hasRequiredPermissions = config.permissions.some(permission => userPermissions.includes(permission));\n                }\n            }\n            const hasAccess = hasRequiredRoles && hasRequiredPermissions;\n            if (!hasAccess) {\n                console.warn('[OAuth2RoleGuard] User does not have required roles/permissions');\n                router.navigate(['/unauthorized']); // Redirect to unauthorized page\n            }\n            return hasAccess;\n        }).catch(error => {\n            console.error('[OAuth2RoleGuard] Failed to get user info:', error);\n            return false;\n        });\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWF1dGguZ3VhcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2d1YXJkcy9vYXV0aDItYXV0aC5ndWFyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxNQUFNLEVBQThELE1BQU0saUJBQWlCLENBQUM7QUFFckcsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFM0Q7OztHQUdHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFrQixDQUM1QyxLQUE2QixFQUM3QixLQUEwQixFQUN3QixFQUFFO0lBQ3BELE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUM1QyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFOUIsOERBQThEO0lBQzlELElBQUksQ0FBQyxhQUFhLENBQUMseUJBQXlCLEVBQUUsRUFBRSxDQUFDO1FBQy9DLE9BQU8sQ0FBQyxJQUFJLENBQUMsdUVBQXVFLENBQUMsQ0FBQztRQUN0RixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFFRCxxQ0FBcUM7SUFDckMsT0FBTyxhQUFhLENBQUMsVUFBVSxDQUFDLElBQUksQ0FDbEMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtRQUNkLElBQUksU0FBUyxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQzlCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELHFEQUFxRDtRQUNyRCxJQUFJLGFBQWEsQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDO1lBQ3BDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELG1FQUFtRTtRQUNuRSxPQUFPLENBQUMsR0FBRyxDQUFDLGdFQUFnRSxDQUFDLENBQUM7UUFFOUUsbUNBQW1DO1FBQ25DLDBDQUEwQztRQUMxQyxhQUFhLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDL0MsT0FBTyxDQUFDLEtBQUssQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN6RSxDQUFDLENBQUMsQ0FBQztRQUVILHFDQUFxQztRQUNyQywwRUFBMEU7UUFFMUUsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDLENBQUMsQ0FDSCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUY7OztHQUdHO0FBQ0gsTUFBTSxPQUFPLGVBQWU7SUFDMUIsWUFDVSxhQUE0QixFQUM1QixNQUFjO1FBRGQsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtJQUNyQixDQUFDO0lBRUosV0FBVyxDQUNULEtBQTZCLEVBQzdCLEtBQTBCO1FBRTFCLDhEQUE4RDtRQUM5RCxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyx5QkFBeUIsRUFBRSxFQUFFLENBQUM7WUFDcEQsT0FBTyxDQUFDLElBQUksQ0FBQyx1RUFBdUUsQ0FBQyxDQUFDO1lBQ3RGLE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUVELHFDQUFxQztRQUNyQyxPQUFPLElBQUksQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLElBQUksQ0FDdkMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUNkLElBQUksU0FBUyxDQUFDLGVBQWUsRUFBRSxDQUFDO2dCQUM5QixPQUFPLElBQUksQ0FBQztZQUNkLENBQUM7WUFFRCxxREFBcUQ7WUFDckQsSUFBSSxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUM7Z0JBQ3pDLE9BQU8sSUFBSSxDQUFDO1lBQ2QsQ0FBQztZQUVELG1FQUFtRTtZQUNuRSxPQUFPLENBQUMsR0FBRyxDQUFDLGdFQUFnRSxDQUFDLENBQUM7WUFFOUUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDcEQsT0FBTyxDQUFDLEtBQUssQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUN6RSxDQUFDLENBQUMsQ0FBQztZQUVILE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQyxDQUFDLENBQ0gsQ0FBQztJQUNKLENBQUM7Q0FDRjtBQUVEOzs7O0dBSUc7QUFDSCxNQUFNLENBQUMsTUFBTSxpQkFBaUIsR0FBa0IsQ0FDOUMsS0FBNkIsRUFDN0IsS0FBMEIsRUFDd0IsRUFBRTtJQUNwRCxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDNUMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBRTlCLDhEQUE4RDtJQUM5RCxJQUFJLENBQUMsYUFBYSxDQUFDLHlCQUF5QixFQUFFLEVBQUUsQ0FBQztRQUMvQyxPQUFPLElBQUksQ0FBQyxDQUFDLHdDQUF3QztJQUN2RCxDQUFDO0lBRUQscUNBQXFDO0lBQ3JDLE9BQU8sYUFBYSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQ2xDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUCxHQUFHLENBQUMsU0FBUyxDQUFDLEVBQUU7UUFDZCxJQUFJLENBQUMsU0FBUyxDQUFDLGVBQWUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDO1lBQ25FLE9BQU8sSUFBSSxDQUFDLENBQUMsMENBQTBDO1FBQ3pELENBQUM7UUFFRCxvREFBb0Q7UUFDcEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyw2REFBNkQsQ0FBQyxDQUFDO1FBQzNFLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsZ0NBQWdDO1FBQ3hELE9BQU8sS0FBSyxDQUFDO0lBQ2YsQ0FBQyxDQUFDLENBQ0gsQ0FBQztBQUNKLENBQUMsQ0FBQztBQVlGLE1BQU0sVUFBVSxlQUFlLENBQUMsTUFBNkI7SUFDM0QsT0FBTyxDQUFDLEtBQTZCLEVBQUUsS0FBMEIsRUFBb0QsRUFBRTtRQUNySCxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDNUMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBRTlCLHVDQUF1QztRQUN2QyxJQUFJLENBQUMsYUFBYSxDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUM7WUFDckMsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQ0FBMEMsQ0FBQyxDQUFDO1lBQ3hELGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDL0MsT0FBTyxDQUFDLEtBQUssQ0FBQyxnREFBZ0QsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUN6RSxDQUFDLENBQUMsQ0FBQztZQUNILE9BQU8sS0FBSyxDQUFDO1FBQ2YsQ0FBQztRQUVELGtFQUFrRTtRQUNsRSxJQUFJLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxDQUFDO1lBQ3pELE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELDJDQUEyQztRQUMzQyxPQUFPLGFBQWEsQ0FBQyxXQUFXLEVBQUUsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDakQsTUFBTSxTQUFTLEdBQUksUUFBZ0IsQ0FBQyxLQUFLLElBQUksRUFBRSxDQUFDO1lBQ2hELE1BQU0sZUFBZSxHQUFJLFFBQWdCLENBQUMsV0FBVyxJQUFJLEVBQUUsQ0FBQztZQUU1RCxJQUFJLGdCQUFnQixHQUFHLElBQUksQ0FBQztZQUM1QixJQUFJLHNCQUFzQixHQUFHLElBQUksQ0FBQztZQUVsQyxjQUFjO1lBQ2QsSUFBSSxNQUFNLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxDQUFDO2dCQUN6QixJQUFJLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztvQkFDdEIsZ0JBQWdCLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQzFFLENBQUM7cUJBQU0sQ0FBQztvQkFDTixnQkFBZ0IsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDekUsQ0FBQztZQUNILENBQUM7WUFFRCxvQkFBb0I7WUFDcEIsSUFBSSxNQUFNLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxDQUFDO2dCQUMvQixJQUFJLE1BQU0sQ0FBQyxVQUFVLEVBQUUsQ0FBQztvQkFDdEIsc0JBQXNCLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxlQUFlLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hHLENBQUM7cUJBQU0sQ0FBQztvQkFDTixzQkFBc0IsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztnQkFDdkcsQ0FBQztZQUNILENBQUM7WUFFRCxNQUFNLFNBQVMsR0FBRyxnQkFBZ0IsSUFBSSxzQkFBc0IsQ0FBQztZQUU3RCxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ2YsT0FBTyxDQUFDLElBQUksQ0FBQyxpRUFBaUUsQ0FBQyxDQUFDO2dCQUNoRixNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDLGdDQUFnQztZQUN0RSxDQUFDO1lBRUQsT0FBTyxTQUFTLENBQUM7UUFDbkIsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ2YsT0FBTyxDQUFDLEtBQUssQ0FBQyw0Q0FBNEMsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRSxPQUFPLEtBQUssQ0FBQztRQUNmLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBSb3V0ZXIsIENhbkFjdGl2YXRlRm4sIEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIFJvdXRlclN0YXRlU25hcHNob3QgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtYXAsIHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IE9BdXRoMlNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9vYXV0aDIuc2VydmljZSc7XHJcblxyXG4vKipcclxuICogT0F1dGgyIEF1dGhlbnRpY2F0aW9uIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyBieSBjaGVja2luZyBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJBdXRoR3VhcmQ6IENhbkFjdGl2YXRlRm4gPSAoXHJcbiAgcm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsXHJcbiAgc3RhdGU6IFJvdXRlclN0YXRlU25hcHNob3RcclxuKTogT2JzZXJ2YWJsZTxib29sZWFuPiB8IFByb21pc2U8Ym9vbGVhbj4gfCBib29sZWFuID0+IHtcclxuICBjb25zdCBvYXV0aDJTZXJ2aWNlID0gaW5qZWN0KE9BdXRoMlNlcnZpY2UpO1xyXG4gIGNvbnN0IHJvdXRlciA9IGluamVjdChSb3V0ZXIpO1xyXG5cclxuICAvLyBDaGVjayBpZiBhdXRoZW50aWNhdGlvbiBpcyBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudFxyXG4gIGlmICghb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0aW9uQXZhaWxhYmxlKCkpIHtcclxuICAgIGNvbnNvbGUud2FybignW09BdXRoMkF1dGhHdWFyZF0gQXV0aGVudGljYXRpb24gbm90IGF2YWlsYWJsZSBpbiBjdXJyZW50IGVudmlyb25tZW50Jyk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBjdXJyZW50IGF1dGhlbnRpY2F0aW9uIHN0YXRlXHJcbiAgcmV0dXJuIG9hdXRoMlNlcnZpY2UuYXV0aFN0YXRlJC5waXBlKFxyXG4gICAgdGFrZSgxKSxcclxuICAgIG1hcChhdXRoU3RhdGUgPT4ge1xyXG4gICAgICBpZiAoYXV0aFN0YXRlLmlzQXV0aGVudGljYXRlZCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIHN0b3JlZCB0b2tlbnMgdGhhdCBtaWdodCBiZSB2YWxpZFxyXG4gICAgICBpZiAob2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBsb2dpbiBvciBzdGFydCBPQXV0aCBmbG93XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbT0F1dGgyQXV0aEd1YXJkXSBVc2VyIG5vdCBhdXRoZW50aWNhdGVkLCBzdGFydGluZyBPQXV0aDIgZmxvdycpO1xyXG4gICAgICBcclxuICAgICAgLy8gWW91IGNhbiBjdXN0b21pemUgdGhpcyBiZWhhdmlvcjpcclxuICAgICAgLy8gT3B0aW9uIDE6IFN0YXJ0IE9BdXRoMiBmbG93IGltbWVkaWF0ZWx5XHJcbiAgICAgIG9hdXRoMlNlcnZpY2Uuc3RhcnRBdXRob3JpemF0aW9uKCkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tPQXV0aDJBdXRoR3VhcmRdIEZhaWxlZCB0byBzdGFydCBPQXV0aDIgZmxvdzonLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gT3B0aW9uIDI6IFJlZGlyZWN0IHRvIGEgbG9naW4gcGFnZVxyXG4gICAgICAvLyByb3V0ZXIubmF2aWdhdGUoWycvbG9naW4nXSwgeyBxdWVyeVBhcmFtczogeyByZXR1cm5Vcmw6IHN0YXRlLnVybCB9IH0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBBdXRoZW50aWNhdGlvbiBHdWFyZCBDbGFzcyAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAqIEBkZXByZWNhdGVkIFVzZSBvYXV0aDJBdXRoR3VhcmQgZnVuY3Rpb24gaW5zdGVhZFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE9BdXRoMkF1dGhHdWFyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG9hdXRoMlNlcnZpY2U6IE9BdXRoMlNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyXHJcbiAgKSB7fVxyXG5cclxuICBjYW5BY3RpdmF0ZShcclxuICAgIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LFxyXG4gICAgc3RhdGU6IFJvdXRlclN0YXRlU25hcHNob3RcclxuICApOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHwgUHJvbWlzZTxib29sZWFuPiB8IGJvb2xlYW4ge1xyXG4gICAgLy8gQ2hlY2sgaWYgYXV0aGVudGljYXRpb24gaXMgYXZhaWxhYmxlIGluIGN1cnJlbnQgZW52aXJvbm1lbnRcclxuICAgIGlmICghdGhpcy5vYXV0aDJTZXJ2aWNlLmlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ1tPQXV0aDJBdXRoR3VhcmRdIEF1dGhlbnRpY2F0aW9uIG5vdCBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgY3VycmVudCBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAgcmV0dXJuIHRoaXMub2F1dGgyU2VydmljZS5hdXRoU3RhdGUkLnBpcGUoXHJcbiAgICAgIHRha2UoMSksXHJcbiAgICAgIG1hcChhdXRoU3RhdGUgPT4ge1xyXG4gICAgICAgIGlmIChhdXRoU3RhdGUuaXNBdXRoZW50aWNhdGVkKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgc3RvcmVkIHRva2VucyB0aGF0IG1pZ2h0IGJlIHZhbGlkXHJcbiAgICAgICAgaWYgKHRoaXMub2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBsb2dpbiBvciBzdGFydCBPQXV0aCBmbG93XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tPQXV0aDJBdXRoR3VhcmRdIFVzZXIgbm90IGF1dGhlbnRpY2F0ZWQsIHN0YXJ0aW5nIE9BdXRoMiBmbG93Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5vYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tPQXV0aDJBdXRoR3VhcmRdIEZhaWxlZCB0byBzdGFydCBPQXV0aDIgZmxvdzonLCBlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgVW5hdXRoZW50aWNhdGVkIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyB0aGF0IHNob3VsZCBvbmx5IGJlIGFjY2Vzc2libGUgdG8gdW5hdXRoZW50aWNhdGVkIHVzZXJzXHJcbiAqIChlLmcuLCBsb2dpbiBwYWdlLCByZWdpc3RyYXRpb24gcGFnZSlcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJVbmF1dGhHdWFyZDogQ2FuQWN0aXZhdGVGbiA9IChcclxuICByb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCxcclxuICBzdGF0ZTogUm91dGVyU3RhdGVTbmFwc2hvdFxyXG4pOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHwgUHJvbWlzZTxib29sZWFuPiB8IGJvb2xlYW4gPT4ge1xyXG4gIGNvbnN0IG9hdXRoMlNlcnZpY2UgPSBpbmplY3QoT0F1dGgyU2VydmljZSk7XHJcbiAgY29uc3Qgcm91dGVyID0gaW5qZWN0KFJvdXRlcik7XHJcblxyXG4gIC8vIENoZWNrIGlmIGF1dGhlbnRpY2F0aW9uIGlzIGF2YWlsYWJsZSBpbiBjdXJyZW50IGVudmlyb25tZW50XHJcbiAgaWYgKCFvYXV0aDJTZXJ2aWNlLmlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKSkge1xyXG4gICAgcmV0dXJuIHRydWU7IC8vIEFsbG93IGFjY2VzcyBpZiBhdXRoIGlzIG5vdCBhdmFpbGFibGVcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGN1cnJlbnQgYXV0aGVudGljYXRpb24gc3RhdGVcclxuICByZXR1cm4gb2F1dGgyU2VydmljZS5hdXRoU3RhdGUkLnBpcGUoXHJcbiAgICB0YWtlKDEpLFxyXG4gICAgbWFwKGF1dGhTdGF0ZSA9PiB7XHJcbiAgICAgIGlmICghYXV0aFN0YXRlLmlzQXV0aGVudGljYXRlZCAmJiAhb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlOyAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCBhbGxvdyBhY2Nlc3NcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVXNlciBpcyBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBwcm90ZWN0ZWQgYXJlYVxyXG4gICAgICBjb25zb2xlLmxvZygnW09BdXRoMlVuYXV0aEd1YXJkXSBVc2VyIGFscmVhZHkgYXV0aGVudGljYXRlZCwgcmVkaXJlY3RpbmcnKTtcclxuICAgICAgcm91dGVyLm5hdmlnYXRlKFsnLyddKTsgLy8gUmVkaXJlY3QgdG8gaG9tZSBvciBkYXNoYm9hcmRcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBSb2xlIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyBiYXNlZCBvbiB1c2VyIHJvbGVzIG9yIHBlcm1pc3Npb25zXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMlJvbGVHdWFyZENvbmZpZyB7XHJcbiAgcm9sZXM/OiBzdHJpbmdbXTtcclxuICBwZXJtaXNzaW9ucz86IHN0cmluZ1tdO1xyXG4gIHJlcXVpcmVBbGw/OiBib29sZWFuOyAvLyBJZiB0cnVlLCB1c2VyIG11c3QgaGF2ZSBBTEwgcm9sZXMvcGVybWlzc2lvbnMuIElmIGZhbHNlLCB1c2VyIG5lZWRzIEFOWS5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9hdXRoMlJvbGVHdWFyZChjb25maWc6IE9BdXRoMlJvbGVHdWFyZENvbmZpZyk6IENhbkFjdGl2YXRlRm4ge1xyXG4gIHJldHVybiAocm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIHN0YXRlOiBSb3V0ZXJTdGF0ZVNuYXBzaG90KTogT2JzZXJ2YWJsZTxib29sZWFuPiB8IFByb21pc2U8Ym9vbGVhbj4gfCBib29sZWFuID0+IHtcclxuICAgIGNvbnN0IG9hdXRoMlNlcnZpY2UgPSBpbmplY3QoT0F1dGgyU2VydmljZSk7XHJcbiAgICBjb25zdCByb3V0ZXIgPSBpbmplY3QoUm91dGVyKTtcclxuXHJcbiAgICAvLyBGaXJzdCBjaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICAgIGlmICghb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnW09BdXRoMlJvbGVHdWFyZF0gVXNlciBub3QgYXV0aGVudGljYXRlZCcpO1xyXG4gICAgICBvYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdbT0F1dGgyUm9sZUd1YXJkXSBGYWlsZWQgdG8gc3RhcnQgT0F1dGgyIGZsb3c6JywgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIHJvbGVzIG9yIHBlcm1pc3Npb25zIHNwZWNpZmllZCwganVzdCBjaGVjayBhdXRoZW50aWNhdGlvblxyXG4gICAgaWYgKCFjb25maWcucm9sZXM/Lmxlbmd0aCAmJiAhY29uZmlnLnBlcm1pc3Npb25zPy5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHVzZXIgaW5mbyB0byBjaGVjayByb2xlcy9wZXJtaXNzaW9uc1xyXG4gICAgcmV0dXJuIG9hdXRoMlNlcnZpY2UuZ2V0VXNlckluZm8oKS50aGVuKHVzZXJJbmZvID0+IHtcclxuICAgICAgY29uc3QgdXNlclJvbGVzID0gKHVzZXJJbmZvIGFzIGFueSkucm9sZXMgfHwgW107XHJcbiAgICAgIGNvbnN0IHVzZXJQZXJtaXNzaW9ucyA9ICh1c2VySW5mbyBhcyBhbnkpLnBlcm1pc3Npb25zIHx8IFtdO1xyXG5cclxuICAgICAgbGV0IGhhc1JlcXVpcmVkUm9sZXMgPSB0cnVlO1xyXG4gICAgICBsZXQgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyA9IHRydWU7XHJcblxyXG4gICAgICAvLyBDaGVjayByb2xlc1xyXG4gICAgICBpZiAoY29uZmlnLnJvbGVzPy5sZW5ndGgpIHtcclxuICAgICAgICBpZiAoY29uZmlnLnJlcXVpcmVBbGwpIHtcclxuICAgICAgICAgIGhhc1JlcXVpcmVkUm9sZXMgPSBjb25maWcucm9sZXMuZXZlcnkocm9sZSA9PiB1c2VyUm9sZXMuaW5jbHVkZXMocm9sZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBoYXNSZXF1aXJlZFJvbGVzID0gY29uZmlnLnJvbGVzLnNvbWUocm9sZSA9PiB1c2VyUm9sZXMuaW5jbHVkZXMocm9sZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgcGVybWlzc2lvbnNcclxuICAgICAgaWYgKGNvbmZpZy5wZXJtaXNzaW9ucz8ubGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5yZXF1aXJlQWxsKSB7XHJcbiAgICAgICAgICBoYXNSZXF1aXJlZFBlcm1pc3Npb25zID0gY29uZmlnLnBlcm1pc3Npb25zLmV2ZXJ5KHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyA9IGNvbmZpZy5wZXJtaXNzaW9ucy5zb21lKHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGhhc0FjY2VzcyA9IGhhc1JlcXVpcmVkUm9sZXMgJiYgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucztcclxuXHJcbiAgICAgIGlmICghaGFzQWNjZXNzKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdbT0F1dGgyUm9sZUd1YXJkXSBVc2VyIGRvZXMgbm90IGhhdmUgcmVxdWlyZWQgcm9sZXMvcGVybWlzc2lvbnMnKTtcclxuICAgICAgICByb3V0ZXIubmF2aWdhdGUoWycvdW5hdXRob3JpemVkJ10pOyAvLyBSZWRpcmVjdCB0byB1bmF1dGhvcml6ZWQgcGFnZVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gaGFzQWNjZXNzO1xyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbT0F1dGgyUm9sZUd1YXJkXSBGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mbzonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gIH07XHJcbn0iXX0=","customTransformCache":false,"dependencies":["@angular/core","@angular/router","rxjs/operators","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/guards/oauth2-auth.guard.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { map, take } from 'rxjs/operators';\nimport { OAuth2Service } from '../services/oauth2.service';\n/**\n * OAuth2 Authentication Guard Function\n * Protects routes by checking if user is authenticated\n */\nexport const oauth2AuthGuard = (route, state) => {\n    const oauth2Service = inject(OAuth2Service);\n    const router = inject(Router);\n    // Check if authentication is available in current environment\n    if (!oauth2Service.isAuthenticationAvailable()) {\n        console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\n        return false;\n    }\n    // Check current authentication state\n    return oauth2Service.authState$.pipe(take(1), map(authState => {\n        if (authState.isAuthenticated) {\n            return true;\n        }\n        // Check if we have stored tokens that might be valid\n        if (oauth2Service.isAuthenticated()) {\n            return true;\n        }\n        // User is not authenticated, redirect to login or start OAuth flow\n        console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\n        // You can customize this behavior:\n        // Option 1: Start OAuth2 flow immediately\n        oauth2Service.startAuthorization().catch(error => {\n            console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\n        });\n        // Option 2: Redirect to a login page\n        // router.navigate(['/login'], { queryParams: { returnUrl: state.url } });\n        return false;\n    }));\n};\n/**\n * OAuth2 Authentication Guard Class (for backward compatibility)\n * @deprecated Use oauth2AuthGuard function instead\n */\nexport class OAuth2AuthGuard {\n    constructor(oauth2Service, router) {\n        this.oauth2Service = oauth2Service;\n        this.router = router;\n    }\n    canActivate(route, state) {\n        // Check if authentication is available in current environment\n        if (!this.oauth2Service.isAuthenticationAvailable()) {\n            console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\n            return false;\n        }\n        // Check current authentication state\n        return this.oauth2Service.authState$.pipe(take(1), map(authState => {\n            if (authState.isAuthenticated) {\n                return true;\n            }\n            // Check if we have stored tokens that might be valid\n            if (this.oauth2Service.isAuthenticated()) {\n                return true;\n            }\n            // User is not authenticated, redirect to login or start OAuth flow\n            console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\n            this.oauth2Service.startAuthorization().catch(error => {\n                console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\n            });\n            return false;\n        }));\n    }\n}\n/**\n * OAuth2 Unauthenticated Guard Function\n * Protects routes that should only be accessible to unauthenticated users\n * (e.g., login page, registration page)\n */\nexport const oauth2UnauthGuard = (route, state) => {\n    const oauth2Service = inject(OAuth2Service);\n    const router = inject(Router);\n    // Check if authentication is available in current environment\n    if (!oauth2Service.isAuthenticationAvailable()) {\n        return true; // Allow access if auth is not available\n    }\n    // Check current authentication state\n    return oauth2Service.authState$.pipe(take(1), map(authState => {\n        if (!authState.isAuthenticated && !oauth2Service.isAuthenticated()) {\n            return true; // User is not authenticated, allow access\n        }\n        // User is authenticated, redirect to protected area\n        console.log('[OAuth2UnauthGuard] User already authenticated, redirecting');\n        router.navigate(['/']); // Redirect to home or dashboard\n        return false;\n    }));\n};\nexport function oauth2RoleGuard(config) {\n    return (route, state) => {\n        const oauth2Service = inject(OAuth2Service);\n        const router = inject(Router);\n        // First check if user is authenticated\n        if (!oauth2Service.isAuthenticated()) {\n            console.log('[OAuth2RoleGuard] User not authenticated');\n            oauth2Service.startAuthorization().catch(error => {\n                console.error('[OAuth2RoleGuard] Failed to start OAuth2 flow:', error);\n            });\n            return false;\n        }\n        // If no roles or permissions specified, just check authentication\n        if (!config.roles?.length && !config.permissions?.length) {\n            return true;\n        }\n        // Get user info to check roles/permissions\n        return oauth2Service.getUserInfo().then(userInfo => {\n            const userRoles = userInfo.roles || [];\n            const userPermissions = userInfo.permissions || [];\n            let hasRequiredRoles = true;\n            let hasRequiredPermissions = true;\n            // Check roles\n            if (config.roles?.length) {\n                if (config.requireAll) {\n                    hasRequiredRoles = config.roles.every(role => userRoles.includes(role));\n                }\n                else {\n                    hasRequiredRoles = config.roles.some(role => userRoles.includes(role));\n                }\n            }\n            // Check permissions\n            if (config.permissions?.length) {\n                if (config.requireAll) {\n                    hasRequiredPermissions = config.permissions.every(permission => userPermissions.includes(permission));\n                }\n                else {\n                    hasRequiredPermissions = config.permissions.some(permission => userPermissions.includes(permission));\n                }\n            }\n            const hasAccess = hasRequiredRoles && hasRequiredPermissions;\n            if (!hasAccess) {\n                console.warn('[OAuth2RoleGuard] User does not have required roles/permissions');\n                router.navigate(['/unauthorized']); // Redirect to unauthorized page\n            }\n            return hasAccess;\n        }).catch(error => {\n            console.error('[OAuth2RoleGuard] Failed to get user info:', error);\n            return false;\n        });\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2F1dGgyLWF1dGguZ3VhcmQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvbGliL2d1YXJkcy9vYXV0aDItYXV0aC5ndWFyZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZDLE9BQU8sRUFBRSxNQUFNLEVBQThELE1BQU0saUJBQWlCLENBQUM7QUFFckcsT0FBTyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFM0Q7OztHQUdHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sZUFBZSxHQUFrQixDQUM1QyxLQUE2QixFQUM3QixLQUEwQixFQUN3QixFQUFFO0lBQ3BELE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUM1QyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFFOUIsOERBQThEO0lBQzlELElBQUksQ0FBQyxhQUFhLENBQUMseUJBQXlCLEVBQUUsRUFBRSxDQUFDO1FBQy9DLE9BQU8sQ0FBQyxJQUFJLENBQUMsdUVBQXVFLENBQUMsQ0FBQztRQUN0RixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFFRCxxQ0FBcUM7SUFDckMsT0FBTyxhQUFhLENBQUMsVUFBVSxDQUFDLElBQUksQ0FDbEMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQLEdBQUcsQ0FBQyxTQUFTLENBQUMsRUFBRTtRQUNkLElBQUksU0FBUyxDQUFDLGVBQWUsRUFBRSxDQUFDO1lBQzlCLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELHFEQUFxRDtRQUNyRCxJQUFJLGFBQWEsQ0FBQyxlQUFlLEVBQUUsRUFBRSxDQUFDO1lBQ3BDLE9BQU8sSUFBSSxDQUFDO1FBQ2QsQ0FBQztRQUVELG1FQUFtRTtR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NEMsRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRSxPQUFPLEtBQUssQ0FBQztRQUNmLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGluamVjdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBSb3V0ZXIsIENhbkFjdGl2YXRlRm4sIEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIFJvdXRlclN0YXRlU25hcHNob3QgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtYXAsIHRha2UgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IE9BdXRoMlNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9vYXV0aDIuc2VydmljZSc7XHJcblxyXG4vKipcclxuICogT0F1dGgyIEF1dGhlbnRpY2F0aW9uIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyBieSBjaGVja2luZyBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJBdXRoR3VhcmQ6IENhbkFjdGl2YXRlRm4gPSAoXHJcbiAgcm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsXHJcbiAgc3RhdGU6IFJvdXRlclN0YXRlU25hcHNob3RcclxuKTogT2JzZXJ2YWJsZTxib29sZWFuPiB8IFByb21pc2U8Ym9vbGVhbj4gfCBib29sZWFuID0+IHtcclxuICBjb25zdCBvYXV0aDJTZXJ2aWNlID0gaW5qZWN0KE9BdXRoMlNlcnZpY2UpO1xyXG4gIGNvbnN0IHJvdXRlciA9IGluamVjdChSb3V0ZXIpO1xyXG5cclxuICAvLyBDaGVjayBpZiBhdXRoZW50aWNhdGlvbiBpcyBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudFxyXG4gIGlmICghb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0aW9uQXZhaWxhYmxlKCkpIHtcclxuICAgIGNvbnNvbGUud2FybignW09BdXRoMkF1dGhHdWFyZF0gQXV0aGVudGljYXRpb24gbm90IGF2YWlsYWJsZSBpbiBjdXJyZW50IGVudmlyb25tZW50Jyk7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBjdXJyZW50IGF1dGhlbnRpY2F0aW9uIHN0YXRlXHJcbiAgcmV0dXJuIG9hdXRoMlNlcnZpY2UuYXV0aFN0YXRlJC5waXBlKFxyXG4gICAgdGFrZSgxKSxcclxuICAgIG1hcChhdXRoU3RhdGUgPT4ge1xyXG4gICAgICBpZiAoYXV0aFN0YXRlLmlzQXV0aGVudGljYXRlZCkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIHN0b3JlZCB0b2tlbnMgdGhhdCBtaWdodCBiZSB2YWxpZFxyXG4gICAgICBpZiAob2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBsb2dpbiBvciBzdGFydCBPQXV0aCBmbG93XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbT0F1dGgyQXV0aEd1YXJkXSBVc2VyIG5vdCBhdXRoZW50aWNhdGVkLCBzdGFydGluZyBPQXV0aDIgZmxvdycpO1xyXG4gICAgICBcclxuICAgICAgLy8gWW91IGNhbiBjdXN0b21pemUgdGhpcyBiZWhhdmlvcjpcclxuICAgICAgLy8gT3B0aW9uIDE6IFN0YXJ0IE9BdXRoMiBmbG93IGltbWVkaWF0ZWx5XHJcbiAgICAgIG9hdXRoMlNlcnZpY2Uuc3RhcnRBdXRob3JpemF0aW9uKCkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tPQXV0aDJBdXRoR3VhcmRdIEZhaWxlZCB0byBzdGFydCBPQXV0aDIgZmxvdzonLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgLy8gT3B0aW9uIDI6IFJlZGlyZWN0IHRvIGEgbG9naW4gcGFnZVxyXG4gICAgICAvLyByb3V0ZXIubmF2aWdhdGUoWycvbG9naW4nXSwgeyBxdWVyeVBhcmFtczogeyByZXR1cm5Vcmw6IHN0YXRlLnVybCB9IH0pO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBBdXRoZW50aWNhdGlvbiBHdWFyZCBDbGFzcyAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXHJcbiAqIEBkZXByZWNhdGVkIFVzZSBvYXV0aDJBdXRoR3VhcmQgZnVuY3Rpb24gaW5zdGVhZFxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE9BdXRoMkF1dGhHdWFyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIG9hdXRoMlNlcnZpY2U6IE9BdXRoMlNlcnZpY2UsXHJcbiAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyXHJcbiAgKSB7fVxyXG5cclxuICBjYW5BY3RpdmF0ZShcclxuICAgIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZVNuYXBzaG90LFxyXG4gICAgc3RhdGU6IFJvdXRlclN0YXRlU25hcHNob3RcclxuICApOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHwgUHJvbWlzZTxib29sZWFuPiB8IGJvb2xlYW4ge1xyXG4gICAgLy8gQ2hlY2sgaWYgYXV0aGVudGljYXRpb24gaXMgYXZhaWxhYmxlIGluIGN1cnJlbnQgZW52aXJvbm1lbnRcclxuICAgIGlmICghdGhpcy5vYXV0aDJTZXJ2aWNlLmlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oJ1tPQXV0aDJBdXRoR3VhcmRdIEF1dGhlbnRpY2F0aW9uIG5vdCBhdmFpbGFibGUgaW4gY3VycmVudCBlbnZpcm9ubWVudCcpO1xyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgY3VycmVudCBhdXRoZW50aWNhdGlvbiBzdGF0ZVxyXG4gICAgcmV0dXJuIHRoaXMub2F1dGgyU2VydmljZS5hdXRoU3RhdGUkLnBpcGUoXHJcbiAgICAgIHRha2UoMSksXHJcbiAgICAgIG1hcChhdXRoU3RhdGUgPT4ge1xyXG4gICAgICAgIGlmIChhdXRoU3RhdGUuaXNBdXRoZW50aWNhdGVkKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgc3RvcmVkIHRva2VucyB0aGF0IG1pZ2h0IGJlIHZhbGlkXHJcbiAgICAgICAgaWYgKHRoaXMub2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBsb2dpbiBvciBzdGFydCBPQXV0aCBmbG93XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tPQXV0aDJBdXRoR3VhcmRdIFVzZXIgbm90IGF1dGhlbnRpY2F0ZWQsIHN0YXJ0aW5nIE9BdXRoMiBmbG93Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5vYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1tPQXV0aDJBdXRoR3VhcmRdIEZhaWxlZCB0byBzdGFydCBPQXV0aDIgZmxvdzonLCBlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBPQXV0aDIgVW5hdXRoZW50aWNhdGVkIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyB0aGF0IHNob3VsZCBvbmx5IGJlIGFjY2Vzc2libGUgdG8gdW5hdXRoZW50aWNhdGVkIHVzZXJzXHJcbiAqIChlLmcuLCBsb2dpbiBwYWdlLCByZWdpc3RyYXRpb24gcGFnZSlcclxuICovXHJcbmV4cG9ydCBjb25zdCBvYXV0aDJVbmF1dGhHdWFyZDogQ2FuQWN0aXZhdGVGbiA9IChcclxuICByb3V0ZTogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCxcclxuICBzdGF0ZTogUm91dGVyU3RhdGVTbmFwc2hvdFxyXG4pOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHwgUHJvbWlzZTxib29sZWFuPiB8IGJvb2xlYW4gPT4ge1xyXG4gIGNvbnN0IG9hdXRoMlNlcnZpY2UgPSBpbmplY3QoT0F1dGgyU2VydmljZSk7XHJcbiAgY29uc3Qgcm91dGVyID0gaW5qZWN0KFJvdXRlcik7XHJcblxyXG4gIC8vIENoZWNrIGlmIGF1dGhlbnRpY2F0aW9uIGlzIGF2YWlsYWJsZSBpbiBjdXJyZW50IGVudmlyb25tZW50XHJcbiAgaWYgKCFvYXV0aDJTZXJ2aWNlLmlzQXV0aGVudGljYXRpb25BdmFpbGFibGUoKSkge1xyXG4gICAgcmV0dXJuIHRydWU7IC8vIEFsbG93IGFjY2VzcyBpZiBhdXRoIGlzIG5vdCBhdmFpbGFibGVcclxuICB9XHJcblxyXG4gIC8vIENoZWNrIGN1cnJlbnQgYXV0aGVudGljYXRpb24gc3RhdGVcclxuICByZXR1cm4gb2F1dGgyU2VydmljZS5hdXRoU3RhdGUkLnBpcGUoXHJcbiAgICB0YWtlKDEpLFxyXG4gICAgbWFwKGF1dGhTdGF0ZSA9PiB7XHJcbiAgICAgIGlmICghYXV0aFN0YXRlLmlzQXV0aGVudGljYXRlZCAmJiAhb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlOyAvLyBVc2VyIGlzIG5vdCBhdXRoZW50aWNhdGVkLCBhbGxvdyBhY2Nlc3NcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVXNlciBpcyBhdXRoZW50aWNhdGVkLCByZWRpcmVjdCB0byBwcm90ZWN0ZWQgYXJlYVxyXG4gICAgICBjb25zb2xlLmxvZygnW09BdXRoMlVuYXV0aEd1YXJkXSBVc2VyIGFscmVhZHkgYXV0aGVudGljYXRlZCwgcmVkaXJlY3RpbmcnKTtcclxuICAgICAgcm91dGVyLm5hdmlnYXRlKFsnLyddKTsgLy8gUmVkaXJlY3QgdG8gaG9tZSBvciBkYXNoYm9hcmRcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSlcclxuICApO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIE9BdXRoMiBSb2xlIEd1YXJkIEZ1bmN0aW9uXHJcbiAqIFByb3RlY3RzIHJvdXRlcyBiYXNlZCBvbiB1c2VyIHJvbGVzIG9yIHBlcm1pc3Npb25zXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIE9BdXRoMlJvbGVHdWFyZENvbmZpZyB7XHJcbiAgcm9sZXM/OiBzdHJpbmdbXTtcclxuICBwZXJtaXNzaW9ucz86IHN0cmluZ1tdO1xyXG4gIHJlcXVpcmVBbGw/OiBib29sZWFuOyAvLyBJZiB0cnVlLCB1c2VyIG11c3QgaGF2ZSBBTEwgcm9sZXMvcGVybWlzc2lvbnMuIElmIGZhbHNlLCB1c2VyIG5lZWRzIEFOWS5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIG9hdXRoMlJvbGVHdWFyZChjb25maWc6IE9BdXRoMlJvbGVHdWFyZENvbmZpZyk6IENhbkFjdGl2YXRlRm4ge1xyXG4gIHJldHVybiAocm91dGU6IEFjdGl2YXRlZFJvdXRlU25hcHNob3QsIHN0YXRlOiBSb3V0ZXJTdGF0ZVNuYXBzaG90KTogT2JzZXJ2YWJsZTxib29sZWFuPiB8IFByb21pc2U8Ym9vbGVhbj4gfCBib29sZWFuID0+IHtcclxuICAgIGNvbnN0IG9hdXRoMlNlcnZpY2UgPSBpbmplY3QoT0F1dGgyU2VydmljZSk7XHJcbiAgICBjb25zdCByb3V0ZXIgPSBpbmplY3QoUm91dGVyKTtcclxuXHJcbiAgICAvLyBGaXJzdCBjaGVjayBpZiB1c2VyIGlzIGF1dGhlbnRpY2F0ZWRcclxuICAgIGlmICghb2F1dGgyU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnW09BdXRoMlJvbGVHdWFyZF0gVXNlciBub3QgYXV0aGVudGljYXRlZCcpO1xyXG4gICAgICBvYXV0aDJTZXJ2aWNlLnN0YXJ0QXV0aG9yaXphdGlvbigpLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdbT0F1dGgyUm9sZUd1YXJkXSBGYWlsZWQgdG8gc3RhcnQgT0F1dGgyIGZsb3c6JywgZXJyb3IpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIElmIG5vIHJvbGVzIG9yIHBlcm1pc3Npb25zIHNwZWNpZmllZCwganVzdCBjaGVjayBhdXRoZW50aWNhdGlvblxyXG4gICAgaWYgKCFjb25maWcucm9sZXM/Lmxlbmd0aCAmJiAhY29uZmlnLnBlcm1pc3Npb25zPy5sZW5ndGgpIHtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHVzZXIgaW5mbyB0byBjaGVjayByb2xlcy9wZXJtaXNzaW9uc1xyXG4gICAgcmV0dXJuIG9hdXRoMlNlcnZpY2UuZ2V0VXNlckluZm8oKS50aGVuKHVzZXJJbmZvID0+IHtcclxuICAgICAgY29uc3QgdXNlclJvbGVzID0gKHVzZXJJbmZvIGFzIGFueSkucm9sZXMgfHwgW107XHJcbiAgICAgIGNvbnN0IHVzZXJQZXJtaXNzaW9ucyA9ICh1c2VySW5mbyBhcyBhbnkpLnBlcm1pc3Npb25zIHx8IFtdO1xyXG5cclxuICAgICAgbGV0IGhhc1JlcXVpcmVkUm9sZXMgPSB0cnVlO1xyXG4gICAgICBsZXQgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyA9IHRydWU7XHJcblxyXG4gICAgICAvLyBDaGVjayByb2xlc1xyXG4gICAgICBpZiAoY29uZmlnLnJvbGVzPy5sZW5ndGgpIHtcclxuICAgICAgICBpZiAoY29uZmlnLnJlcXVpcmVBbGwpIHtcclxuICAgICAgICAgIGhhc1JlcXVpcmVkUm9sZXMgPSBjb25maWcucm9sZXMuZXZlcnkocm9sZSA9PiB1c2VyUm9sZXMuaW5jbHVkZXMocm9sZSkpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBoYXNSZXF1aXJlZFJvbGVzID0gY29uZmlnLnJvbGVzLnNvbWUocm9sZSA9PiB1c2VyUm9sZXMuaW5jbHVkZXMocm9sZSkpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gQ2hlY2sgcGVybWlzc2lvbnNcclxuICAgICAgaWYgKGNvbmZpZy5wZXJtaXNzaW9ucz8ubGVuZ3RoKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZy5yZXF1aXJlQWxsKSB7XHJcbiAgICAgICAgICBoYXNSZXF1aXJlZFBlcm1pc3Npb25zID0gY29uZmlnLnBlcm1pc3Npb25zLmV2ZXJ5KHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucyA9IGNvbmZpZy5wZXJtaXNzaW9ucy5zb21lKHBlcm1pc3Npb24gPT4gdXNlclBlcm1pc3Npb25zLmluY2x1ZGVzKHBlcm1pc3Npb24pKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGhhc0FjY2VzcyA9IGhhc1JlcXVpcmVkUm9sZXMgJiYgaGFzUmVxdWlyZWRQZXJtaXNzaW9ucztcclxuXHJcbiAgICAgIGlmICghaGFzQWNjZXNzKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKCdbT0F1dGgyUm9sZUd1YXJkXSBVc2VyIGRvZXMgbm90IGhhdmUgcmVxdWlyZWQgcm9sZXMvcGVybWlzc2lvbnMnKTtcclxuICAgICAgICByb3V0ZXIubmF2aWdhdGUoWycvdW5hdXRob3JpemVkJ10pOyAvLyBSZWRpcmVjdCB0byB1bmF1dGhvcml6ZWQgcGFnZVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gaGFzQWNjZXNzO1xyXG4gICAgfSkuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbT0F1dGgyUm9sZUd1YXJkXSBGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mbzonLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0pO1xyXG4gIH07XHJcbn0iXX0=","originalSourcemap":{"version":3,"file":"oauth2-auth.guard.js","sourceRoot":"","sources":["../../../../../src/lib/guards/oauth2-auth.guard.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,9],[15,0,0,15],[17,0,0,17],[23,0,0,23],[38,0,0,38],[39,0,0,39]],[[0,0,1,0],[7,0,1,7],[9,0,1,9],[15,0,1,15],[17,0,1,77],[23,0,1,83],[40,0,1,100],[41,0,1,101]],[[0,0,3,0],[7,0,3,7],[9,0,3,9],[12,0,3,12],[14,0,3,14],[18,0,3,18],[20,0,3,20],[26,0,3,26],[42,0,3,42],[43,0,3,43]],[[0,0,4,0],[7,0,4,7],[9,0,4,9],[22,0,4,22],[24,0,4,24],[30,0,4,30],[58,0,4,58],[59,0,4,59]],[[0,0,6,0]],[],[],[[3,0,9,3]],[[0,0,10,0],[6,0,10,6],[7,0,10,7],[13,0,10,13],[28,0,10,28],[31,0,10,46],[32,0,11,2],[37,0,11,31],[39,0,12,2],[44,0,12,28],[46,0,13,52],[48,0,13,54]],[[4,0,14,2],[10,0,14,8],[23,0,14,21],[26,0,14,24],[32,0,14,30],[33,0,14,31],[46,0,14,44],[47,0,14,45],[48,0,14,46]],[[4,0,15,2],[10,0,15,8],[16,0,15,14],[19,0,15,17],[25,0,15,23],[26,0,15,24],[32,0,15,30],[33,0,15,31],[34,0,15,32]],[[4,0,17,2],[66,0,17,64]],[[4,0,18,2],[8,0,18,6],[9,0,18,7],[22,0,18,20],[23,0,18,21],[48,0,18,46],[50,0,18,48],[52,0,18,50],[53,0,18,51]],[[8,0,19,4],[15,0,19,11],[16,0,19,12],[20,0,19,16],[21,0,19,17],[92,0,19,88],[93,0,19,89],[94,0,19,90]],[[8,0,20,4],[15,0,20,11],[20,0,20,16],[21,0,20,17]],[[4,0,21,2],[5,0,21,3]],[[4,0,23,2],[41,0,23,39]],[[4,0,24,2],[11,0,24,9],[24,0,24,22],[25,0,24,23],[35,0,24,33],[36,0,24,34],[40,0,24,38],[41,0,25,4],[45,0,25,8],[46,0,25,9],[47,0,25,10],[48,0,25,11],[50,0,26,4],[53,0,26,7],[54,0,26,8],[63,0,26,17],[64,0,26,18],[66,0,26,20]],[[8,0,27,6],[12,0,27,10],[21,0,27,19],[22,0,27,20],[37,0,27,35],[39,0,27,37],[40,0,27,38]],[[12,0,28,8],[19,0,28,15],[23,0,28,19],[24,0,28,20]],[[8,0,29,6],[9,0,29,7]],[[8,0,31,6],[61,0,31,59]],[[8,0,32,6],[12,0,32,10],[25,0,32,23],[26,0,32,24],[41,0,32,39],[43,0,32,41],[45,0,32,43],[46,0,32,44]],[[12,0,33,8],[19,0,33,15],[23,0,33,19],[24,0,33,20]],[[8,0,34,6],[9,0,34,7]],[[8,0,36,6],[75,0,36,73]],[[8,0,37,6],[15,0,37,13],[16,0,37,14],[19,0,37,17],[20,0,37,18],[84,0,37,82],[85,0,37,83],[86,0,37,84]],[[8,0,39,6],[43,0,39,41]],[[8,0,40,6],[50,0,40,48]],[[8,0,41,6],[21,0,41,19],[22,0,41,20],[40,0,41,38],[42,0,41,40],[43,0,41,41],[48,0,41,46],[49,0,41,47],[54,0,41,52],[55,0,41,53],[57,0,41,55]],[[12,0,42,8],[19,0,42,15],[20,0,42,16],[25,0,42,21],[26,0,42,22],[74,0,42,70],[76,0,42,72],[81,0,42,77],[82,0,42,78],[83,0,42,79]],[[8,0,43,6],[9,0,43,7],[10,0,43,8],[11,0,43,9]],[[8,0,45,6],[45,0,45,43]],[[8,0,46,6],[82,0,46,80]],[[8,0,48,6],[15,0,48,13],[20,0,48,18],[21,0,48,19]],[[4,0,49,4],[5,0,49,5],[6,0,49,6],[7,0,50,3],[8,0,50,4]],[[0,0,51,0],[1,0,51,1],[2,0,51,2]],[[0,0,53,0]],[],[],[[3,0,56,3]],[[0,0,57,0],[6,0,57,6],[13,0,57,13],[28,0,57,28]],[[4,0,58,2],[16,0,59,12],[29,0,59,40],[31,0,60,12],[37,0,60,26]],[[8,0,59,12],[26,0,59,25],[29,0,59,12],[42,0,59,25],[43,0,59,40]],[[8,0,60,12],[19,0,60,18],[22,0,60,12],[28,0,60,18],[29,0,60,26]],[[4,0,61,5],[5,0,61,6]],[[4,0,63,2],[15,0,63,13],[16,0,64,4],[21,0,64,33],[23,0,65,4],[28,0,65,30]],[[8,0,67,4],[70,0,67,66]],[[8,0,68,4],[12,0,68,8],[13,0,68,9],[17,0,68,13],[18,0,68,14],[31,0,68,27],[32,0,68,28],[57,0,68,53],[59,0,68,55],[61,0,68,57],[62,0,68,58]],[[12,0,69,6],[19,0,69,13],[20,0,69,14],[24,0,69,18],[25,0,69,19],[96,0,69,90],[97,0,69,91],[98,0,69,92]],[[12,0,70,6],[19,0,70,13],[24,0,70,18],[25,0,70,19]],[[8,0,71,4],[9,0,71,5]],[[8,0,73,4],[45,0,73,41]],[[8,0,74,4],[15,0,74,11],[19,0,74,15],[20,0,74,16],[33,0,74,29],[34,0,74,30],[44,0,74,40],[45,0,74,41],[49,0,74,45],[50,0,75,6],[54,0,75,10],[55,0,75,11],[56,0,75,12],[57,0,75,13],[59,0,76,6],[62,0,76,9],[63,0,76,10],[72,0,76,19],[73,0,76,20],[75,0,76,22]],[[12,0,77,8],[16,0,77,12],[25,0,77,21],[26,0,77,22],[41,0,77,37],[43,0,77,39],[44,0,77,40]],[[16,0,78,10],[23,0,78,17],[27,0,78,21],[28,0,78,22]],[[12,0,79,8],[13,0,79,9]],[[12,0,81,8],[65,0,81,61]],[[12,0,82,8],[16,0,82,12],[20,0,82,16],[21,0,82,17],[34,0,82,30],[35,0,82,31],[50,0,82,46],[52,0,82,48],[54,0,82,50],[55,0,82,51]],[[16,0,83,10],[23,0,83,17],[27,0,83,21],[28,0,83,22]],[[12,0,84,8],[13,0,84,9]],[[12,0,86,8],[79,0,86,75]],[[12,0,87,8],[19,0,87,15],[20,0,87,16],[23,0,87,19],[24,0,87,20],[88,0,87,84],[89,0,87,85],[90,0,87,86]],[[12,0,89,8],[16,0,89,12],[17,0,89,13],[30,0,89,26],[31,0,89,27],[49,0,89,45],[51,0,89,47],[52,0,89,48],[57,0,89,53],[58,0,89,54],[63,0,89,59],[64,0,89,60],[66,0,89,62]],[[16,0,90,10],[23,0,90,17],[24,0,90,18],[29,0,90,23],[30,0,90,24],[78,0,90,72],[80,0,90,74],[85,0,90,79],[86,0,90,80],[87,0,90,81]],[[12,0,91,8],[13,0,91,9],[14,0,91,10],[15,0,91,11]],[[12,0,93,8],[19,0,93,15],[24,0,93,20],[25,0,93,21]],[[8,0,94,6],[9,0,94,7],[10,0,94,8],[11,0,95,5],[12,0,95,6]],[[4,0,96,2],[5,0,96,3]],[[1,0,97,1]],[[0,0,99,0]],[],[],[],[[3,0,103,3]],[[0,0,104,0],[6,0,104,6],[7,0,104,7],[13,0,104,13],[30,0,104,30],[33,0,104,48],[34,0,105,2],[39,0,105,31],[41,0,106,2],[46,0,106,28],[48,0,107,52],[50,0,107,54]],[[4,0,108,2],[10,0,108,8],[23,0,108,21],[26,0,108,24],[32,0,108,30],[33,0,108,31],[46,0,108,44],[47,0,108,45],[48,0,108,46]],[[4,0,109,2],[10,0,109,8],[16,0,109,14],[19,0,109,17],[25,0,109,23],[26,0,109,24],[32,0,109,30],[33,0,109,31],[34,0,109,32]],[[4,0,111,2],[66,0,111,64]],[[4,0,112,2],[8,0,112,6],[9,0,112,7],[22,0,112,20],[23,0,112,21],[48,0,112,46],[50,0,112,48],[52,0,112,50],[53,0,112,51]],[[8,0,113,4],[15,0,113,11],[19,0,113,15],[20,0,113,16],[21,0,113,17],[61,0,113,57]],[[4,0,114,2],[5,0,114,3]],[[4,0,116,2],[41,0,116,39]],[[4,0,117,2],[11,0,117,9],[24,0,117,22],[25,0,117,23],[35,0,117,33],[36,0,117,34],[40,0,117,38],[41,0,118,4],[45,0,118,8],[46,0,118,9],[47,0,118,10],[48,0,118,11],[50,0,119,4],[53,0,119,7],[54,0,119,8],[63,0,119,17],[64,0,119,18],[66,0,119,20]],[[8,0,120,6],[12,0,120,10],[13,0,120,11],[22,0,120,20],[23,0,120,21],[38,0,120,36],[42,0,120,40],[43,0,120,41],[56,0,120,54],[57,0,120,55],[72,0,120,70],[74,0,120,72],[76,0,120,74],[77,0,120,75]],[[12,0,121,8],[19,0,121,15],[23,0,121,19],[24,0,121,20],[25,0,121,21],[67,0,121,63]],[[8,0,122,6],[9,0,122,7]],[[8,0,124,6],[60,0,124,58]],[[8,0,125,6],[15,0,125,13],[16,0,125,14],[19,0,125,17],[20,0,125,18],[81,0,125,79],[82,0,125,80],[83,0,125,81]],[[8,0,126,6],[14,0,126,12],[15,0,126,13],[23,0,126,21],[24,0,126,22],[25,0,126,23],[28,0,126,26],[29,0,126,27],[30,0,126,28],[31,0,126,29],[32,0,126,30],[64,0,126,62]],[[8,0,127,6],[15,0,127,13],[20,0,127,18],[21,0,127,19]],[[4,0,128,4],[5,0,128,5],[6,0,128,6],[7,0,129,3],[8,0,129,4]],[[0,0,130,0],[1,0,130,1],[2,0,130,2]],[[0,0,142,0],[6,0,142,6],[16,0,142,16],[31,0,142,31],[32,0,142,32],[38,0,142,61]],[[4,0,143,2],[11,0,143,9],[12,0,143,10],[17,0,143,39],[19,0,143,41],[24,0,143,67],[26,0,143,119],[28,0,143,121]],[[8,0,144,4],[14,0,144,10],[27,0,144,23],[30,0,144,26],[36,0,144,32],[37,0,144,33],[50,0,144,46],[51,0,144,47],[52,0,144,48]],[[8,0,145,4],[14,0,145,10],[20,0,145,16],[23,0,145,19],[29,0,145,25],[30,0,145,26],[36,0,145,32],[37,0,145,33],[38,0,145,34]],[[8,0,147,4],[47,0,147,43]],[[8,0,148,4],[12,0,148,8],[13,0,148,9],[26,0,148,22],[27,0,148,23],[42,0,148,38],[44,0,148,40],[46,0,148,42],[47,0,148,43]],[[12,0,149,6],[19,0,149,13],[20,0,149,14],[23,0,149,17],[24,0,149,18],[66,0,149,60],[67,0,149,61],[68,0,149,62]],[[12,0,150,6],[25,0,150,19],[26,0,150,20],[44,0,150,38],[46,0,150,40],[47,0,150,41],[52,0,150,46],[53,0,150,47],[58,0,150,52],[59,0,150,53],[61,0,150,55]],[[16,0,151,8],[23,0,151,15],[24,0,151,16],[29,0,151,21],[30,0,151,22],[78,0,151,70],[80,0,151,72],[85,0,151,77],[86,0,151,78],[87,0,151,79]],[[12,0,152,6],[13,0,152,7],[14,0,152,8],[15,0,152,9]],[[12,0,153,6],[19,0,153,13],[24,0,153,18],[25,0,153,19]],[[8,0,154,4],[9,0,154,5]],[[8,0,156,4],[74,0,156,70]],[[8,0,157,4],[12,0,157,8],[13,0,157,9],[19,0,157,15],[20,0,157,16],[25,0,157,21],[27,0,157,23],[33,0,157,29],[37,0,157,33],[38,0,157,34],[44,0,157,40],[45,0,157,41],[56,0,157,52],[58,0,157,54],[64,0,157,60],[66,0,157,62],[67,0,157,63]],[[12,0,158,6],[19,0,158,13],[23,0,158,17],[24,0,158,18]],[[8,0,159,4],[9,0,159,5]],[[8,0,161,4],[51,0,161,47]],[[8,0,162,4],[15,0,162,11],[28,0,162,24],[29,0,162,25],[40,0,162,36],[42,0,162,38],[43,0,162,39],[47,0,162,43],[48,0,162,44],[56,0,162,52],[57,0,162,53],[59,0,162,55]],[[12,0,163,6],[18,0,163,12],[27,0,163,21],[30,0,163,25],[38,0,163,41],[39,0,163,42],[44,0,163,47],[48,0,163,51],[50,0,163,53],[51,0,163,54]],[[12,0,164,6],[18,0,164,12],[33,0,164,27],[36,0,164,31],[44,0,164,47],[45,0,164,48],[56,0,164,59],[60,0,164,63],[62,0,164,65],[63,0,164,66]],[[12,0,166,6],[16,0,166,10],[32,0,166,26],[35,0,166,29],[39,0,166,33],[40,0,166,34]],[[12,0,167,6],[16,0,167,10],[38,0,167,32],[41,0,167,35],[45,0,167,39],[46,0,167,40]],[[12,0,169,6],[26,0,169,20]],[[12,0,170,6],[16,0,170,10],[22,0,170,16],[23,0,170,17],[28,0,170,22],[30,0,170,24],[36,0,170,30],[38,0,170,32],[39,0,170,33]],[[16,0,171,8],[20,0,171,12],[26,0,171,18],[27,0,171,19],[37,0,171,29],[39,0,171,31],[40,0,171,32]],[[20,0,172,10],[36,0,172,26],[39,0,172,29],[45,0,172,35],[46,0,172,36],[51,0,172,41],[52,0,172,42],[57,0,172,47],[58,0,172,48],[62,0,172,52],[63,0,172,53],[65,0,172,55],[66,0,172,56],[75,0,172,65],[76,0,172,66],[84,0,172,74],[85,0,172,75],[89,0,172,79],[90,0,172,80],[91,0,172,81],[92,0,172,82]],[[16,0,173,8],[17,0,173,9]],[[21,0,173,15],[22,0,173,16]],[[20,0,174,10],[36,0,174,26],[39,0,174,29],[45,0,174,35],[46,0,174,36],[51,0,174,41],[52,0,174,42],[56,0,174,46],[57,0,174,47],[61,0,174,51],[62,0,174,52],[64,0,174,54],[65,0,174,55],[74,0,174,64],[75,0,174,65],[83,0,174,73],[84,0,174,74],[88,0,174,78],[89,0,174,79],[90,0,174,80],[91,0,174,81]],[[16,0,175,8],[17,0,175,9]],[[12,0,176,6],[13,0,176,7]],[[12,0,178,6],[32,0,178,26]],[[12,0,179,6],[16,0,179,10],[22,0,179,16],[23,0,179,17],[34,0,179,28],[36,0,179,30],[42,0,179,36],[44,0,179,38],[45,0,179,39]],[[16,0,180,8],[20,0,180,12],[26,0,180,18],[27,0,180,19],[37,0,180,29],[39,0,180,31],[40,0,180,32]],[[20,0,181,10],[42,0,181,32],[45,0,181,35],[51,0,181,41],[52,0,181,42],[63,0,181,53],[64,0,181,54],[69,0,181,59],[70,0,181,60],[80,0,181,70],[81,0,181,71],[83,0,181,73],[84,0,181,74],[99,0,181,89],[100,0,181,90],[108,0,181,98],[109,0,181,99],[119,0,181,109],[120,0,181,110],[121,0,181,111],[122,0,181,112]],[[16,0,182,8],[17,0,182,9]],[[21,0,182,15],[22,0,182,16]],[[20,0,183,10],[42,0,183,32],[45,0,183,35],[51,0,183,41],[52,0,183,42],[63,0,183,53],[64,0,183,54],[68,0,183,58],[69,0,183,59],[79,0,183,69],[80,0,183,70],[82,0,183,72],[83,0,183,73],[98,0,183,88],[99,0,183,89],[107,0,183,97],[108,0,183,98],[118,0,183,108],[119,0,183,109],[120,0,183,110],[121,0,183,111]],[[16,0,184,8],[17,0,184,9]],[[12,0,185,6],[13,0,185,7]],[[12,0,187,6],[18,0,187,12],[27,0,187,21],[30,0,187,24],[46,0,187,40],[50,0,187,44],[72,0,187,66],[73,0,187,67]],[[12,0,189,6],[16,0,189,10],[17,0,189,11],[26,0,189,20],[28,0,189,22],[29,0,189,23]],[[16,0,190,8],[23,0,190,15],[24,0,190,16],[28,0,190,20],[29,0,190,21],[94,0,190,86],[95,0,190,87],[96,0,190,88]],[[16,0,191,8],[22,0,191,14],[23,0,191,15],[31,0,191,23],[32,0,191,24],[33,0,191,25],[48,0,191,40],[49,0,191,41],[50,0,191,42],[51,0,191,43],[52,0,191,44],[84,0,191,76]],[[12,0,192,6],[13,0,192,7]],[[12,0,194,6],[19,0,194,13],[28,0,194,22],[29,0,194,23]],[[8,0,195,4],[9,0,195,5],[10,0,195,6],[11,0,195,7],[16,0,195,12],[17,0,195,13],[22,0,195,18],[23,0,195,19],[25,0,195,21]],[[12,0,196,6],[19,0,196,13],[20,0,196,14],[25,0,196,19],[26,0,196,20],[70,0,196,64],[72,0,196,66],[77,0,196,71],[78,0,196,72],[79,0,196,73]],[[12,0,197,6],[19,0,197,13],[24,0,197,18],[25,0,197,19]],[[8,0,198,4],[9,0,198,5],[10,0,198,6],[11,0,198,7]],[[4,0,199,2],[5,0,199,3],[6,0,199,4]],[[0,0,200,0],[1,0,200,1]]],"sourcesContent":["import { inject } from '@angular/core';\r\nimport { Router, CanActivateFn, ActivatedRouteSnapshot, RouterStateSnapshot } from '@angular/router';\r\nimport { Observable, of } from 'rxjs';\r\nimport { map, take } from 'rxjs/operators';\r\nimport { OAuth2Service } from '../services/oauth2.service';\r\n\r\n/**\r\n * OAuth2 Authentication Guard Function\r\n * Protects routes by checking if user is authenticated\r\n */\r\nexport const oauth2AuthGuard: CanActivateFn = (\r\n  route: ActivatedRouteSnapshot,\r\n  state: RouterStateSnapshot\r\n): Observable<boolean> | Promise<boolean> | boolean => {\r\n  const oauth2Service = inject(OAuth2Service);\r\n  const router = inject(Router);\r\n\r\n  // Check if authentication is available in current environment\r\n  if (!oauth2Service.isAuthenticationAvailable()) {\r\n    console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\r\n    return false;\r\n  }\r\n\r\n  // Check current authentication state\r\n  return oauth2Service.authState$.pipe(\r\n    take(1),\r\n    map(authState => {\r\n      if (authState.isAuthenticated) {\r\n        return true;\r\n      }\r\n\r\n      // Check if we have stored tokens that might be valid\r\n      if (oauth2Service.isAuthenticated()) {\r\n        return true;\r\n      }\r\n\r\n      // User is not authenticated, redirect to login or start OAuth flow\r\n      console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\r\n      \r\n      // You can customize this behavior:\r\n      // Option 1: Start OAuth2 flow immediately\r\n      oauth2Service.startAuthorization().catch(error => {\r\n        console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\r\n      });\r\n      \r\n      // Option 2: Redirect to a login page\r\n      // router.navigate(['/login'], { queryParams: { returnUrl: state.url } });\r\n      \r\n      return false;\r\n    })\r\n  );\r\n};\r\n\r\n/**\r\n * OAuth2 Authentication Guard Class (for backward compatibility)\r\n * @deprecated Use oauth2AuthGuard function instead\r\n */\r\nexport class OAuth2AuthGuard {\r\n  constructor(\r\n    private oauth2Service: OAuth2Service,\r\n    private router: Router\r\n  ) {}\r\n\r\n  canActivate(\r\n    route: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): Observable<boolean> | Promise<boolean> | boolean {\r\n    // Check if authentication is available in current environment\r\n    if (!this.oauth2Service.isAuthenticationAvailable()) {\r\n      console.warn('[OAuth2AuthGuard] Authentication not available in current environment');\r\n      return false;\r\n    }\r\n\r\n    // Check current authentication state\r\n    return this.oauth2Service.authState$.pipe(\r\n      take(1),\r\n      map(authState => {\r\n        if (authState.isAuthenticated) {\r\n          return true;\r\n        }\r\n\r\n        // Check if we have stored tokens that might be valid\r\n        if (this.oauth2Service.isAuthenticated()) {\r\n          return true;\r\n        }\r\n\r\n        // User is not authenticated, redirect to login or start OAuth flow\r\n        console.log('[OAuth2AuthGuard] User not authenticated, starting OAuth2 flow');\r\n        \r\n        this.oauth2Service.startAuthorization().catch(error => {\r\n          console.error('[OAuth2AuthGuard] Failed to start OAuth2 flow:', error);\r\n        });\r\n        \r\n        return false;\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\n/**\r\n * OAuth2 Unauthenticated Guard Function\r\n * Protects routes that should only be accessible to unauthenticated users\r\n * (e.g., login page, registration page)\r\n */\r\nexport const oauth2UnauthGuard: CanActivateFn = (\r\n  route: ActivatedRouteSnapshot,\r\n  state: RouterStateSnapshot\r\n): Observable<boolean> | Promise<boolean> | boolean => {\r\n  const oauth2Service = inject(OAuth2Service);\r\n  const router = inject(Router);\r\n\r\n  // Check if authentication is available in current environment\r\n  if (!oauth2Service.isAuthenticationAvailable()) {\r\n    return true; // Allow access if auth is not available\r\n  }\r\n\r\n  // Check current authentication state\r\n  return oauth2Service.authState$.pipe(\r\n    take(1),\r\n    map(authState => {\r\n      if (!authState.isAuthenticated && !oauth2Service.isAuthenticated()) {\r\n        return true; // User is not authenticated, allow access\r\n      }\r\n\r\n      // User is authenticated, redirect to protected area\r\n      console.log('[OAuth2UnauthGuard] User already authenticated, redirecting');\r\n      router.navigate(['/']); // Redirect to home or dashboard\r\n      return false;\r\n    })\r\n  );\r\n};\r\n\r\n/**\r\n * OAuth2 Role Guard Function\r\n * Protects routes based on user roles or permissions\r\n */\r\nexport interface OAuth2RoleGuardConfig {\r\n  roles?: string[];\r\n  permissions?: string[];\r\n  requireAll?: boolean; // If true, user must have ALL roles/permissions. If false, user needs ANY.\r\n}\r\n\r\nexport function oauth2RoleGuard(config: OAuth2RoleGuardConfig): CanActivateFn {\r\n  return (route: ActivatedRouteSnapshot, state: RouterStateSnapshot): Observable<boolean> | Promise<boolean> | boolean => {\r\n    const oauth2Service = inject(OAuth2Service);\r\n    const router = inject(Router);\r\n\r\n    // First check if user is authenticated\r\n    if (!oauth2Service.isAuthenticated()) {\r\n      console.log('[OAuth2RoleGuard] User not authenticated');\r\n      oauth2Service.startAuthorization().catch(error => {\r\n        console.error('[OAuth2RoleGuard] Failed to start OAuth2 flow:', error);\r\n      });\r\n      return false;\r\n    }\r\n\r\n    // If no roles or permissions specified, just check authentication\r\n    if (!config.roles?.length && !config.permissions?.length) {\r\n      return true;\r\n    }\r\n\r\n    // Get user info to check roles/permissions\r\n    return oauth2Service.getUserInfo().then(userInfo => {\r\n      const userRoles = (userInfo as any).roles || [];\r\n      const userPermissions = (userInfo as any).permissions || [];\r\n\r\n      let hasRequiredRoles = true;\r\n      let hasRequiredPermissions = true;\r\n\r\n      // Check roles\r\n      if (config.roles?.length) {\r\n        if (config.requireAll) {\r\n          hasRequiredRoles = config.roles.every(role => userRoles.includes(role));\r\n        } else {\r\n          hasRequiredRoles = config.roles.some(role => userRoles.includes(role));\r\n        }\r\n      }\r\n\r\n      // Check permissions\r\n      if (config.permissions?.length) {\r\n        if (config.requireAll) {\r\n          hasRequiredPermissions = config.permissions.every(permission => userPermissions.includes(permission));\r\n        } else {\r\n          hasRequiredPermissions = config.permissions.some(permission => userPermissions.includes(permission));\r\n        }\r\n      }\r\n\r\n      const hasAccess = hasRequiredRoles && hasRequiredPermissions;\r\n\r\n      if (!hasAccess) {\r\n        console.warn('[OAuth2RoleGuard] User does not have required roles/permissions');\r\n        router.navigate(['/unauthorized']); // Redirect to unauthorized page\r\n      }\r\n\r\n      return hasAccess;\r\n    }).catch(error => {\r\n      console.error('[OAuth2RoleGuard] Failed to get user info:', error);\r\n      return false;\r\n    });\r\n  };\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/router":{"attributes":{},"external":true,"id":"@angular/router","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"rxjs/operators":{"attributes":{},"external":true,"id":"rxjs/operators","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"../services/oauth2.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":7560,"body":[{"type":"ImportDeclaration","start":0,"end":57,"specifiers":[{"type":"ImportSpecifier","start":9,"end":33,"imported":{"type":"Identifier","start":9,"end":33,"name":"makeEnvironmentProviders"},"local":{"type":"Identifier","start":9,"end":33,"name":"makeEnvironmentProviders"}}],"source":{"type":"Literal","start":41,"end":56,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":58,"end":133,"specifiers":[{"type":"ImportSpecifier","start":67,"end":84,"imported":{"type":"Identifier","start":67,"end":84,"name":"provideHttpClient"},"local":{"type":"Identifier","start":67,"end":84,"name":"provideHttpClient"}},{"type":"ImportSpecifier","start":86,"end":102,"imported":{"type":"Identifier","start":86,"end":102,"name":"withInterceptors"},"local":{"type":"Identifier","start":86,"end":102,"name":"withInterceptors"}}],"source":{"type":"Literal","start":110,"end":132,"value":"@angular/common/http","raw":"'@angular/common/http'"},"attributes":[]},{"type":"ImportDeclaration","start":134,"end":201,"specifiers":[{"type":"ImportSpecifier","start":143,"end":162,"imported":{"type":"Identifier","start":143,"end":162,"name":"OAUTH2_CONFIG_TOKEN"},"local":{"type":"Identifier","start":143,"end":162,"name":"OAUTH2_CONFIG_TOKEN"}}],"source":{"type":"Literal","start":170,"end":200,"value":"./tokens/oauth2-config.token","raw":"'./tokens/oauth2-config.token'"},"attributes":[]},{"type":"ImportDeclaration","start":202,"end":260,"specifiers":[{"type":"ImportSpecifier","start":211,"end":224,"imported":{"type":"Identifier","start":211,"end":224,"name":"OAuth2Service"},"local":{"type":"Identifier","start":211,"end":224,"name":"OAuth2Service"}}],"source":{"type":"Literal","start":232,"end":259,"value":"./services/oauth2.service","raw":"'./services/oauth2.service'"},"attributes":[]},{"type":"ImportDeclaration","start":261,"end":334,"specifiers":[{"type":"ImportSpecifier","start":270,"end":290,"imported":{"type":"Identifier","start":270,"end":290,"name":"OAuth2StorageService"},"local":{"type":"Identifier","start":270,"end":290,"name":"OAuth2StorageService"}}],"source":{"type":"Literal","start":298,"end":333,"value":"./services/oauth2-storage.service","raw":"'./services/oauth2-storage.service'"},"attributes":[]},{"type":"ImportDeclaration","start":335,"end":407,"specifiers":[{"type":"ImportSpecifier","start":344,"end":363,"imported":{"type":"Identifier","start":344,"end":363,"name":"oauth2InterceptorFn"},"local":{"type":"Identifier","start":344,"end":363,"name":"oauth2InterceptorFn"}}],"source":{"type":"Literal","start":371,"end":406,"value":"./interceptors/oauth2.interceptor","raw":"'./interceptors/oauth2.interceptor'"},"attributes":[]},{"type":"ImportDeclaration","start":514,"end":555,"specifiers":[{"type":"ImportSpecifier","start":523,"end":531,"imported":{"type":"Identifier","start":523,"end":531,"name":"NgModule"},"local":{"type":"Identifier","start":523,"end":531,"name":"NgModule"}}],"source":{"type":"Literal","start":539,"end":554,"value":"@angular/core","raw":"'@angular/core'"},"attributes":[]},{"type":"ImportDeclaration","start":556,"end":603,"specifiers":[{"type":"ImportSpecifier","start":565,"end":577,"imported":{"type":"Identifier","start":565,"end":577,"name":"CommonModule"},"local":{"type":"Identifier","start":565,"end":577,"name":"CommonModule"}}],"source":{"type":"Literal","start":585,"end":602,"value":"@angular/common","raw":"'@angular/common'"},"attributes":[]},{"type":"ImportDeclaration","start":604,"end":640,"specifiers":[{"type":"ImportNamespaceSpecifier","start":611,"end":618,"local":{"type":"Identifier","start":616,"end":618,"name":"i0"}}],"source":{"type":"Literal","start":624,"end":639,"value":"@angular/core","raw":"\"@angular/core\""},"attributes":[]},{"type":"ExportNamedDeclaration","start":748,"end":1153,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"FunctionDeclaration","start":755,"end":1153,"async":false,"generator":false,"id":{"type":"Identifier","start":764,"end":777,"name":"provideOAuth2"},"params":[{"type":"Identifier","start":778,"end":784,"name":"config"}],"body":{"type":"BlockStatement","start":786,"end":1153,"body":[{"type":"ReturnStatement","start":792,"end":1151,"argument":{"type":"CallExpression","start":799,"end":1150,"optional":false,"callee":{"type":"Identifier","start":799,"end":823,"name":"makeEnvironmentProviders"},"arguments":[{"type":"ArrayExpression","start":824,"end":1149,"elements":[{"type":"ObjectExpression","start":878,"end":928,"properties":[{"type":"Property","start":880,"end":908,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":880,"end":887,"name":"provide"},"value":{"type":"Identifier","start":889,"end":908,"name":"OAUTH2_CONFIG_TOKEN"},"kind":"init"},{"type":"Property","start":910,"end":926,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":910,"end":918,"name":"useValue"},"value":{"type":"Identifier","start":920,"end":926,"name":"config"},"kind":"init"}]},{"type":"Identifier","start":977,"end":990,"name":"OAuth2Service"},{"type":"Identifier","start":1000,"end":1020,"name":"OAuth2StorageService"},{"type":"CallExpression","start":1085,"end":1143,"optional":false,"callee":{"type":"Identifier","start":1085,"end":1102,"name":"provideHttpClient"},"arguments":[{"type":"CallExpression","start":1103,"end":1142,"optional":false,"callee":{"type":"Identifier","start":1103,"end":1119,"name":"withInterceptors"},"arguments":[{"type":"ArrayExpression","start":1120,"end":1141,"elements":[{"type":"Identifier","start":1121,"end":1140,"name":"oauth2InterceptorFn"}]}]}]}]}]}}]},"expression":false}},{"type":"ExportNamedDeclaration","start":1299,"end":1599,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"FunctionDeclaration","start":1306,"end":1599,"async":false,"generator":false,"id":{"type":"Identifier","start":1315,"end":1346,"name":"provideOAuth2WithoutInterceptor"},"params":[{"type":"Identifier","start":1347,"end":1353,"name":"config"}],"body":{"type":"BlockStatement","start":1355,"end":1599,"body":[{"type":"ReturnStatement","start":1361,"end":1597,"argument":{"type":"CallExpression","start":1368,"end":1596,"optional":false,"callee":{"type":"Identifier","start":1368,"end":1392,"name":"makeEnvironmentProviders"},"arguments":[{"type":"ArrayExpression","start":1393,"end":1595,"elements":[{"type":"ObjectExpression","start":1447,"end":1497,"properties":[{"type":"Property","start":1449,"end":1477,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1449,"end":1456,"name":"provide"},"value":{"type":"Identifier","start":1458,"end":1477,"name":"OAUTH2_CONFIG_TOKEN"},"kind":"init"},{"type":"Property","start":1479,"end":1495,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1479,"end":1487,"name":"useValue"},"value":{"type":"Identifier","start":1489,"end":1495,"name":"config"},"kind":"init"}]},{"type":"Identifier","start":1546,"end":1559,"name":"OAuth2Service"},{"type":"Identifier","start":1569,"end":1589,"name":"OAuth2StorageService"}]}]}}]},"expression":false}},{"type":"ExportNamedDeclaration","start":1600,"end":2241,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":1607,"end":2241,"decorators":[],"id":{"type":"Identifier","start":1613,"end":1631,"name":"NgOAuth2PkceModule"},"superClass":null,"body":{"type":"ClassBody","start":1632,"end":2241,"body":[{"type":"MethodDefinition","start":1638,"end":1913,"static":true,"computed":false,"decorators":[],"key":{"type":"Identifier","start":1645,"end":1652,"name":"forRoot"},"value":{"type":"FunctionExpression","start":1652,"end":1913,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":1653,"end":1659,"name":"config"}],"body":{"type":"BlockStatement","start":1661,"end":1913,"body":[{"type":"ReturnStatement","start":1671,"end":1907,"argument":{"type":"ObjectExpression","start":1678,"end":1906,"properties":[{"type":"Property","start":1692,"end":1720,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1692,"end":1700,"name":"ngModule"},"value":{"type":"Identifier","start":1702,"end":1720,"name":"NgOAuth2PkceModule"},"kind":"init"},{"type":"Property","start":1734,"end":1896,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1734,"end":1743,"name":"providers"},"value":{"type":"ArrayExpression","start":1745,"end":1896,"elements":[{"type":"ObjectExpression","start":1763,"end":1813,"properties":[{"type":"Property","start":1765,"end":1793,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1765,"end":1772,"name":"provide"},"value":{"type":"Identifier","start":1774,"end":1793,"name":"OAUTH2_CONFIG_TOKEN"},"kind":"init"},{"type":"Property","start":1795,"end":1811,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":1795,"end":1803,"name":"useValue"},"value":{"type":"Identifier","start":1805,"end":1811,"name":"config"},"kind":"init"}]},{"type":"Identifier","start":1831,"end":1844,"name":"OAuth2Service"},{"type":"Identifier","start":1862,"end":1882,"name":"OAuth2StorageService"}]},"kind":"init"}]}}]},"expression":false},"kind":"method"},{"type":"StaticBlock","start":1918,"end":2056,"body":[{"type":"ExpressionStatement","start":1927,"end":2054,"expression":{"type":"AssignmentExpression","start":1927,"end":2053,"operator":"=","left":{"type":"MemberExpression","start":1927,"end":1936,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1927,"end":1931},"property":{"type":"Identifier","start":1932,"end":1936,"name":"ɵfac"}},"right":{"type":"FunctionExpression","start":1939,"end":2053,"async":false,"generator":false,"id":{"type":"Identifier","start":1948,"end":1974,"name":"NgOAuth2PkceModule_Factory"},"params":[{"type":"Identifier","start":1975,"end":1992,"name":"__ngFactoryType__"}],"body":{"type":"BlockStatement","start":1994,"end":2053,"body":[{"type":"ReturnStatement","start":1996,"end":2051,"argument":{"type":"NewExpression","start":2003,"end":2050,"callee":{"type":"LogicalExpression","start":2008,"end":2047,"operator":"||","left":{"type":"Identifier","start":2008,"end":2025,"name":"__ngFactoryType__"},"right":{"type":"Identifier","start":2029,"end":2047,"name":"NgOAuth2PkceModule"}},"arguments":[]}}]},"expression":false}}}]},{"type":"StaticBlock","start":2061,"end":2148,"body":[{"type":"ExpressionStatement","start":2070,"end":2146,"expression":{"type":"AssignmentExpression","start":2070,"end":2145,"operator":"=","left":{"type":"MemberExpression","start":2070,"end":2079,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2070,"end":2074},"property":{"type":"Identifier","start":2075,"end":2079,"name":"ɵmod"}},"right":{"type":"CallExpression","start":2096,"end":2145,"optional":false,"_rollupAnnotations":[{"end":2095,"start":2082,"type":"pure"}],"callee":{"type":"MemberExpression","start":2096,"end":2115,"computed":false,"optional":false,"object":{"type":"Identifier","start":2096,"end":2098,"name":"i0"},"property":{"type":"Identifier","start":2099,"end":2115,"name":"ɵɵdefineNgModule"}},"arguments":[{"type":"ObjectExpression","start":2116,"end":2144,"properties":[{"type":"Property","start":2118,"end":2142,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2118,"end":2122,"name":"type"},"value":{"type":"Identifier","start":2124,"end":2142,"name":"NgOAuth2PkceModule"},"kind":"init"}]}]}}}]},{"type":"StaticBlock","start":2153,"end":2239,"body":[{"type":"ExpressionStatement","start":2162,"end":2237,"expression":{"type":"AssignmentExpression","start":2162,"end":2236,"operator":"=","left":{"type":"MemberExpression","start":2162,"end":2171,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2162,"end":2166},"property":{"type":"Identifier","start":2167,"end":2171,"name":"ɵinj"}},"right":{"type":"CallExpression","start":2188,"end":2236,"optional":false,"_rollupAnnotations":[{"end":2187,"start":2174,"type":"pure"}],"callee":{"type":"MemberExpression","start":2188,"end":2207,"computed":false,"optional":false,"object":{"type":"Identifier","start":2188,"end":2190,"name":"i0"},"property":{"type":"Identifier","start":2191,"end":2207,"name":"ɵɵdefineInjector"}},"arguments":[{"type":"ObjectExpression","start":2208,"end":2235,"properties":[{"type":"Property","start":2210,"end":2233,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2210,"end":2217,"name":"imports"},"value":{"type":"ArrayExpression","start":2219,"end":2233,"elements":[{"type":"Identifier","start":2220,"end":2232,"name":"CommonModule"}]},"kind":"init"}]}]}}}]}]}}},{"type":"ExpressionStatement","start":2242,"end":2497,"expression":{"type":"CallExpression","start":2242,"end":2496,"optional":false,"callee":{"type":"ArrowFunctionExpression","start":2243,"end":2493,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":2249,"end":2493,"body":[{"type":"ExpressionStatement","start":2251,"end":2491,"expression":{"type":"LogicalExpression","start":2251,"end":2490,"operator":"&&","left":{"type":"LogicalExpression","start":2252,"end":2297,"operator":"||","left":{"type":"BinaryExpression","start":2252,"end":2284,"operator":"===","left":{"type":"UnaryExpression","start":2252,"end":2268,"operator":"typeof","argument":{"type":"Identifier","start":2259,"end":2268,"name":"ngDevMode"},"prefix":true},"right":{"type":"Literal","start":2273,"end":2284,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":2288,"end":2297,"name":"ngDevMode"}},"right":{"type":"CallExpression","start":2302,"end":2490,"optional":false,"callee":{"type":"MemberExpression","start":2302,"end":2322,"computed":false,"optional":false,"object":{"type":"Identifier","start":2302,"end":2304,"name":"i0"},"property":{"type":"Identifier","start":2305,"end":2322,"name":"ɵsetClassMetadata"}},"arguments":[{"type":"Identifier","start":2323,"end":2341,"name":"NgOAuth2PkceModule"},{"type":"ArrayExpression","start":2343,"end":2477,"elements":[{"type":"ObjectExpression","start":2344,"end":2476,"properties":[{"type":"Property","start":2354,"end":2368,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2354,"end":2358,"name":"type"},"value":{"type":"Identifier","start":2360,"end":2368,"name":"NgModule"},"kind":"init"},{"type":"Property","start":2378,"end":2470,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2378,"end":2382,"name":"args"},"value":{"type":"ArrayExpression","start":2384,"end":2470,"elements":[{"type":"ObjectExpression","start":2385,"end":2469,"properties":[{"type":"Property","start":2403,"end":2426,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2403,"end":2410,"name":"imports"},"value":{"type":"ArrayExpression","start":2412,"end":2426,"elements":[{"type":"Identifier","start":2413,"end":2425,"name":"CommonModule"}]},"kind":"init"},{"type":"Property","start":2444,"end":2455,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2444,"end":2451,"name":"exports"},"value":{"type":"ArrayExpression","start":2453,"end":2455,"elements":[]},"kind":"init"}]}]},"kind":"init"}]}]},{"type":"Literal","start":2479,"end":2483,"raw":"null","value":null},{"type":"Literal","start":2485,"end":2489,"raw":"null","value":null}]}}}]},"id":null},"arguments":[]}},{"type":"ExpressionStatement","start":2498,"end":2641,"expression":{"type":"CallExpression","start":2498,"end":2640,"optional":false,"callee":{"type":"FunctionExpression","start":2499,"end":2637,"async":false,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":2511,"end":2637,"body":[{"type":"ExpressionStatement","start":2513,"end":2635,"expression":{"type":"LogicalExpression","start":2513,"end":2634,"operator":"&&","left":{"type":"LogicalExpression","start":2514,"end":2559,"operator":"||","left":{"type":"BinaryExpression","start":2514,"end":2546,"operator":"===","left":{"type":"UnaryExpression","start":2514,"end":2530,"operator":"typeof","argument":{"type":"Identifier","start":2521,"end":2530,"name":"ngJitMode"},"prefix":true},"right":{"type":"Literal","start":2535,"end":2546,"value":"undefined","raw":"\"undefined\""}},"right":{"type":"Identifier","start":2550,"end":2559,"name":"ngJitMode"}},"right":{"type":"CallExpression","start":2564,"end":2634,"optional":false,"callee":{"type":"MemberExpression","start":2564,"end":2585,"computed":false,"optional":false,"object":{"type":"Identifier","start":2564,"end":2566,"name":"i0"},"property":{"type":"Identifier","start":2567,"end":2585,"name":"ɵɵsetNgModuleScope"}},"arguments":[{"type":"Identifier","start":2586,"end":2604,"name":"NgOAuth2PkceModule"},{"type":"ObjectExpression","start":2606,"end":2633,"properties":[{"type":"Property","start":2608,"end":2631,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":2608,"end":2615,"name":"imports"},"value":{"type":"ArrayExpression","start":2617,"end":2631,"elements":[{"type":"Identifier","start":2618,"end":2630,"name":"CommonModule"}]},"kind":"init"}]}]}}}]},"expression":false},"arguments":[]}}],"_rollupRemoved":[{"end":7560,"start":2642,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"import { makeEnvironmentProviders } from '@angular/core';\nimport { provideHttpClient, withInterceptors } from '@angular/common/http';\nimport { OAUTH2_CONFIG_TOKEN } from './tokens/oauth2-config.token';\nimport { OAuth2Service } from './services/oauth2.service';\nimport { OAuth2StorageService } from './services/oauth2-storage.service';\nimport { oauth2InterceptorFn } from './interceptors/oauth2.interceptor';\n/**\n * Legacy NgModule for backward compatibility\n * @deprecated Use provideOAuth2() function instead\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\n/**\n * Provide OAuth2 configuration and services\n * Use this function in your app.config.ts or main.ts\n */\nexport function provideOAuth2(config) {\n    return makeEnvironmentProviders([\n        // Provide the OAuth2 configuration\n        { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n        // Provide the OAuth2 services\n        OAuth2Service,\n        OAuth2StorageService,\n        // Provide HTTP client with OAuth2 interceptor\n        provideHttpClient(withInterceptors([oauth2InterceptorFn]))\n    ]);\n}\n/**\n * Provide OAuth2 configuration and services without HTTP interceptor\n * Use this if you want to manually configure the HTTP interceptor\n */\nexport function provideOAuth2WithoutInterceptor(config) {\n    return makeEnvironmentProviders([\n        // Provide the OAuth2 configuration\n        { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n        // Provide the OAuth2 services\n        OAuth2Service,\n        OAuth2StorageService\n    ]);\n}\nexport class NgOAuth2PkceModule {\n    static forRoot(config) {\n        return {\n            ngModule: NgOAuth2PkceModule,\n            providers: [\n                { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n                OAuth2Service,\n                OAuth2StorageService\n            ]\n        };\n    }\n    static { this.ɵfac = function NgOAuth2PkceModule_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || NgOAuth2PkceModule)(); }; }\n    static { this.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: NgOAuth2PkceModule }); }\n    static { this.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [CommonModule] }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgOAuth2PkceModule, [{\n        type: NgModule,\n        args: [{\n                imports: [CommonModule],\n                exports: []\n            }]\n    }], null, null); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(NgOAuth2PkceModule, { imports: [CommonModule] }); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctb2F1dGgyLXBrY2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvbmctb2F1dGgyLXBrY2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQXdCLHdCQUF3QixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQy9FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTNFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN6RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQXFDeEU7OztHQUdHO0FBQ0gsT0FBTyxFQUFFLFFBQVEsRUFBdUIsTUFBTSxlQUFlLENBQUM7QUFDOUQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDOztBQXhDL0M7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLGFBQWEsQ0FBQyxNQUFvQjtJQUNoRCxPQUFPLHdCQUF3QixDQUFDO1FBQzlCLG1DQUFtQztRQUNuQyxFQUFFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFO1FBRWxELDhCQUE4QjtRQUM5QixhQUFhO1FBQ2Isb0JBQW9CO1FBRXBCLDhDQUE4QztRQUM5QyxpQkFBaUIsQ0FDZixnQkFBZ0IsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FDeEM7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLCtCQUErQixDQUFDLE1BQW9CO0lBQ2xFLE9BQU8sd0JBQXdCLENBQUM7UUFDOUIsbUNBQW1DO1FBQ25DLEVBQUUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUU7UUFFbEQsOEJBQThCO1FBQzlCLGFBQWE7UUFDYixvQkFBb0I7S0FDckIsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQWFELE1BQU0sT0FBTyxrQkFBa0I7SUFDN0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFvQjtRQUNqQyxPQUFPO1lBQ0wsUUFBUSxFQUFFLGtCQUFrQjtZQUM1QixTQUFTLEVBQUU7Z0JBQ1QsRUFBRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRTtnQkFDbEQsYUFBYTtnQkFDYixvQkFBb0I7YUFDckI7U0FDRixDQUFDO0lBQ0osQ0FBQzttSEFWVSxrQkFBa0I7bUVBQWxCLGtCQUFrQjt1RUFIbkIsWUFBWTs7aUZBR1gsa0JBQWtCO2NBSjlCLFFBQVE7ZUFBQztnQkFDUixPQUFPLEVBQUUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3ZCLE9BQU8sRUFBRSxFQUFFO2FBQ1o7O3dGQUNZLGtCQUFrQixjQUhuQixZQUFZIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW52aXJvbm1lbnRQcm92aWRlcnMsIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBwcm92aWRlSHR0cENsaWVudCwgd2l0aEludGVyY2VwdG9ycyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi9tb2RlbHMvb2F1dGgyLWNvbmZpZy5tb2RlbCc7XHJcbmltcG9ydCB7IE9BVVRIMl9DT05GSUdfVE9LRU4gfSBmcm9tICcuL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuaW1wb3J0IHsgT0F1dGgyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvb2F1dGgyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBPQXV0aDJTdG9yYWdlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZSc7XHJcbmltcG9ydCB7IG9hdXRoMkludGVyY2VwdG9yRm4gfSBmcm9tICcuL2ludGVyY2VwdG9ycy9vYXV0aDIuaW50ZXJjZXB0b3InO1xyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGUgT0F1dGgyIGNvbmZpZ3VyYXRpb24gYW5kIHNlcnZpY2VzXHJcbiAqIFVzZSB0aGlzIGZ1bmN0aW9uIGluIHlvdXIgYXBwLmNvbmZpZy50cyBvciBtYWluLnRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcHJvdmlkZU9BdXRoMihjb25maWc6IE9BdXRoMkNvbmZpZyk6IEVudmlyb25tZW50UHJvdmlkZXJzIHtcclxuICByZXR1cm4gbWFrZUVudmlyb25tZW50UHJvdmlkZXJzKFtcclxuICAgIC8vIFByb3ZpZGUgdGhlIE9BdXRoMiBjb25maWd1cmF0aW9uXHJcbiAgICB7IHByb3ZpZGU6IE9BVVRIMl9DT05GSUdfVE9LRU4sIHVzZVZhbHVlOiBjb25maWcgfSxcclxuICAgIFxyXG4gICAgLy8gUHJvdmlkZSB0aGUgT0F1dGgyIHNlcnZpY2VzXHJcbiAgICBPQXV0aDJTZXJ2aWNlLFxyXG4gICAgT0F1dGgyU3RvcmFnZVNlcnZpY2UsXHJcbiAgICBcclxuICAgIC8vIFByb3ZpZGUgSFRUUCBjbGllbnQgd2l0aCBPQXV0aDIgaW50ZXJjZXB0b3JcclxuICAgIHByb3ZpZGVIdHRwQ2xpZW50KFxyXG4gICAgICB3aXRoSW50ZXJjZXB0b3JzKFtvYXV0aDJJbnRlcmNlcHRvckZuXSlcclxuICAgIClcclxuICBdKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGUgT0F1dGgyIGNvbmZpZ3VyYXRpb24gYW5kIHNlcnZpY2VzIHdpdGhvdXQgSFRUUCBpbnRlcmNlcHRvclxyXG4gKiBVc2UgdGhpcyBpZiB5b3Ugd2FudCB0byBtYW51YWxseSBjb25maWd1cmUgdGhlIEhUVFAgaW50ZXJjZXB0b3JcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwcm92aWRlT0F1dGgyV2l0aG91dEludGVyY2VwdG9yKGNvbmZpZzogT0F1dGgyQ29uZmlnKTogRW52aXJvbm1lbnRQcm92aWRlcnMge1xyXG4gIHJldHVybiBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMoW1xyXG4gICAgLy8gUHJvdmlkZSB0aGUgT0F1dGgyIGNvbmZpZ3VyYXRpb25cclxuICAgIHsgcHJvdmlkZTogT0FVVEgyX0NPTkZJR19UT0tFTiwgdXNlVmFsdWU6IGNvbmZpZyB9LFxyXG4gICAgXHJcbiAgICAvLyBQcm92aWRlIHRoZSBPQXV0aDIgc2VydmljZXNcclxuICAgIE9BdXRoMlNlcnZpY2UsXHJcbiAgICBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gIF0pO1xyXG59XHJcblxyXG4vKipcclxuICogTGVnYWN5IE5nTW9kdWxlIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbiAqIEBkZXByZWNhdGVkIFVzZSBwcm92aWRlT0F1dGgyKCkgZnVuY3Rpb24gaW5zdGVhZFxyXG4gKi9cclxuaW1wb3J0IHsgTmdNb2R1bGUsIE1vZHVsZVdpdGhQcm92aWRlcnMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuXHJcbkBOZ01vZHVsZSh7XHJcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXHJcbiAgZXhwb3J0czogW11cclxufSlcclxuZXhwb3J0IGNsYXNzIE5nT0F1dGgyUGtjZU1vZHVsZSB7XHJcbiAgc3RhdGljIGZvclJvb3QoY29uZmlnOiBPQXV0aDJDb25maWcpOiBNb2R1bGVXaXRoUHJvdmlkZXJzPE5nT0F1dGgyUGtjZU1vZHVsZT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmdNb2R1bGU6IE5nT0F1dGgyUGtjZU1vZHVsZSxcclxuICAgICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgeyBwcm92aWRlOiBPQVVUSDJfQ09ORklHX1RPS0VOLCB1c2VWYWx1ZTogY29uZmlnIH0sXHJcbiAgICAgICAgT0F1dGgyU2VydmljZSxcclxuICAgICAgICBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gICAgICBdXHJcbiAgICB9O1xyXG4gIH1cclxufSJdfQ==","customTransformCache":false,"dependencies":["@angular/core","@angular/common/http","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/interceptors/oauth2.interceptor.mjs","@angular/common"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/ng-oauth2-pkce.service.mjs","meta":{},"moduleSideEffects":true,"originalCode":"import { makeEnvironmentProviders } from '@angular/core';\nimport { provideHttpClient, withInterceptors } from '@angular/common/http';\nimport { OAUTH2_CONFIG_TOKEN } from './tokens/oauth2-config.token';\nimport { OAuth2Service } from './services/oauth2.service';\nimport { OAuth2StorageService } from './services/oauth2-storage.service';\nimport { oauth2InterceptorFn } from './interceptors/oauth2.interceptor';\n/**\n * Legacy NgModule for backward compatibility\n * @deprecated Use provideOAuth2() function instead\n */\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\n/**\n * Provide OAuth2 configuration and services\n * Use this function in your app.config.ts or main.ts\n */\nexport function provideOAuth2(config) {\n    return makeEnvironmentProviders([\n        // Provide the OAuth2 configuration\n        { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n        // Provide the OAuth2 services\n        OAuth2Service,\n        OAuth2StorageService,\n        // Provide HTTP client with OAuth2 interceptor\n        provideHttpClient(withInterceptors([oauth2InterceptorFn]))\n    ]);\n}\n/**\n * Provide OAuth2 configuration and services without HTTP interceptor\n * Use this if you want to manually configure the HTTP interceptor\n */\nexport function provideOAuth2WithoutInterceptor(config) {\n    return makeEnvironmentProviders([\n        // Provide the OAuth2 configuration\n        { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n        // Provide the OAuth2 services\n        OAuth2Service,\n        OAuth2StorageService\n    ]);\n}\nexport class NgOAuth2PkceModule {\n    static forRoot(config) {\n        return {\n            ngModule: NgOAuth2PkceModule,\n            providers: [\n                { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\n                OAuth2Service,\n                OAuth2StorageService\n            ]\n        };\n    }\n    static { this.ɵfac = function NgOAuth2PkceModule_Factory(__ngFactoryType__) { return new (__ngFactoryType__ || NgOAuth2PkceModule)(); }; }\n    static { this.ɵmod = /*@__PURE__*/ i0.ɵɵdefineNgModule({ type: NgOAuth2PkceModule }); }\n    static { this.ɵinj = /*@__PURE__*/ i0.ɵɵdefineInjector({ imports: [CommonModule] }); }\n}\n(() => { (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NgOAuth2PkceModule, [{\n        type: NgModule,\n        args: [{\n                imports: [CommonModule],\n                exports: []\n            }]\n    }], null, null); })();\n(function () { (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(NgOAuth2PkceModule, { imports: [CommonModule] }); })();\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmctb2F1dGgyLXBrY2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvbmctb2F1dGgyLXBrY2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQXdCLHdCQUF3QixFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQy9FLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTNFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQ25FLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUMxRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUN6RSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQXFDeEU7OztHQUdHO0FBQ0gsT0FBTyxFQUFFLFFBQVEsRUFBdUIsTUFBTSxlQUFlLENBQUM7QUFDOUQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGlCQUFpQixDQUFDOztBQXhDL0M7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLGFBQWEsQ0FBQyxNQUFvQjtJQUNoRCxPQUFPLHdCQUF3QixDQUFDO1FBQzlCLG1DQUFtQztRQUNuQyxFQUFFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFO1FBRWxELDhCQUE4QjtRQUM5QixhQUFhO1FBQ2Isb0JBQW9CO1FBRXBCLDhDQUE4QztRQUM5QyxpQkFBaUIsQ0FDZixnQkFBZ0IsQ0FBQyxDQUFDLG1CQUFtQixDQUFDLENBQUMsQ0FDeEM7S0FDRixDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSxVQUFVLCtCQUErQixDQUFDLE1BQW9CO0lBQ2xFLE9BQU8sd0JBQXdCLENBQUM7UUFDOUIsbUNBQW1DO1FBQ25DLEVBQUUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUU7UUFFbEQsOEJBQThCO1FBQzlCLGFBQWE7UUFDYixvQkFBb0I7S0FDckIsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQWFELE1BQU0sT0FBTyxrQkFBa0I7SUFDN0IsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFvQjtRQUNqQyxPQUFPO1lBQ0wsUUFBUSxFQUFFLGtCQUFrQjtZQUM1QixTQUFTLEVBQUU7Z0JBQ1QsRUFBRSxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRTtnQkFDbEQsYUFBYTtnQkFDYixvQkFBb0I7YUFDckI7U0FDRixDQUFDO0lBQ0osQ0FBQzttSEFWVSxrQkFBa0I7bUVBQWxCLGtCQUFrQjt1RUFIbkIsWUFBWTs7aUZBR1gsa0JBQWtCO2NBSjlCLFFBQVE7ZUFBQztnQkFDUixPQUFPLEVBQUUsQ0FBQyxZQUFZLENBQUM7Z0JBQ3ZCLE9BQU8sRUFBRSxFQUFFO2FBQ1o7O3dGQUNZLGtCQUFrQixjQUhuQixZQUFZIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW52aXJvbm1lbnRQcm92aWRlcnMsIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBwcm92aWRlSHR0cENsaWVudCwgd2l0aEludGVyY2VwdG9ycyB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgT0F1dGgyQ29uZmlnIH0gZnJvbSAnLi9tb2RlbHMvb2F1dGgyLWNvbmZpZy5tb2RlbCc7XHJcbmltcG9ydCB7IE9BVVRIMl9DT05GSUdfVE9LRU4gfSBmcm9tICcuL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuaW1wb3J0IHsgT0F1dGgyU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvb2F1dGgyLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBPQXV0aDJTdG9yYWdlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZSc7XHJcbmltcG9ydCB7IG9hdXRoMkludGVyY2VwdG9yRm4gfSBmcm9tICcuL2ludGVyY2VwdG9ycy9vYXV0aDIuaW50ZXJjZXB0b3InO1xyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGUgT0F1dGgyIGNvbmZpZ3VyYXRpb24gYW5kIHNlcnZpY2VzXHJcbiAqIFVzZSB0aGlzIGZ1bmN0aW9uIGluIHlvdXIgYXBwLmNvbmZpZy50cyBvciBtYWluLnRzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcHJvdmlkZU9BdXRoMihjb25maWc6IE9BdXRoMkNvbmZpZyk6IEVudmlyb25tZW50UHJvdmlkZXJzIHtcclxuICByZXR1cm4gbWFrZUVudmlyb25tZW50UHJvdmlkZXJzKFtcclxuICAgIC8vIFByb3ZpZGUgdGhlIE9BdXRoMiBjb25maWd1cmF0aW9uXHJcbiAgICB7IHByb3ZpZGU6IE9BVVRIMl9DT05GSUdfVE9LRU4sIHVzZVZhbHVlOiBjb25maWcgfSxcclxuICAgIFxyXG4gICAgLy8gUHJvdmlkZSB0aGUgT0F1dGgyIHNlcnZpY2VzXHJcbiAgICBPQXV0aDJTZXJ2aWNlLFxyXG4gICAgT0F1dGgyU3RvcmFnZVNlcnZpY2UsXHJcbiAgICBcclxuICAgIC8vIFByb3ZpZGUgSFRUUCBjbGllbnQgd2l0aCBPQXV0aDIgaW50ZXJjZXB0b3JcclxuICAgIHByb3ZpZGVIdHRwQ2xpZW50KFxyXG4gICAgICB3aXRoSW50ZXJjZXB0b3JzKFtvYXV0aDJJbnRlcmNlcHRvckZuXSlcclxuICAgIClcclxuICBdKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFByb3ZpZGUgT0F1dGgyIGNvbmZpZ3VyYXRpb24gYW5kIHNlcnZpY2VzIHdpdGhvdXQgSFRUUCBpbnRlcmNlcHRvclxyXG4gKiBVc2UgdGhpcyBpZiB5b3Ugd2FudCB0byBtYW51YWxseSBjb25maWd1cmUgdGhlIEhUVFAgaW50ZXJjZXB0b3JcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBwcm92aWRlT0F1dGgyV2l0aG91dEludGVyY2VwdG9yKGNvbmZpZzogT0F1dGgyQ29uZmlnKTogRW52aXJvbm1lbnRQcm92aWRlcnMge1xyXG4gIHJldHVybiBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnMoW1xyXG4gICAgLy8gUHJvdmlkZSB0aGUgT0F1dGgyIGNvbmZpZ3VyYXRpb25cclxuICAgIHsgcHJvdmlkZTogT0FVVEgyX0NPTkZJR19UT0tFTiwgdXNlVmFsdWU6IGNvbmZpZyB9LFxyXG4gICAgXHJcbiAgICAvLyBQcm92aWRlIHRoZSBPQXV0aDIgc2VydmljZXNcclxuICAgIE9BdXRoMlNlcnZpY2UsXHJcbiAgICBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gIF0pO1xyXG59XHJcblxyXG4vKipcclxuICogTGVnYWN5IE5nTW9kdWxlIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XHJcbiAqIEBkZXByZWNhdGVkIFVzZSBwcm92aWRlT0F1dGgyKCkgZnVuY3Rpb24gaW5zdGVhZFxyXG4gKi9cclxuaW1wb3J0IHsgTmdNb2R1bGUsIE1vZHVsZVdpdGhQcm92aWRlcnMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuXHJcbkBOZ01vZHVsZSh7XHJcbiAgaW1wb3J0czogW0NvbW1vbk1vZHVsZV0sXHJcbiAgZXhwb3J0czogW11cclxufSlcclxuZXhwb3J0IGNsYXNzIE5nT0F1dGgyUGtjZU1vZHVsZSB7XHJcbiAgc3RhdGljIGZvclJvb3QoY29uZmlnOiBPQXV0aDJDb25maWcpOiBNb2R1bGVXaXRoUHJvdmlkZXJzPE5nT0F1dGgyUGtjZU1vZHVsZT4ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmdNb2R1bGU6IE5nT0F1dGgyUGtjZU1vZHVsZSxcclxuICAgICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgeyBwcm92aWRlOiBPQVVUSDJfQ09ORklHX1RPS0VOLCB1c2VWYWx1ZTogY29uZmlnIH0sXHJcbiAgICAgICAgT0F1dGgyU2VydmljZSxcclxuICAgICAgICBPQXV0aDJTdG9yYWdlU2VydmljZVxyXG4gICAgICBdXHJcbiAgICB9O1xyXG4gIH1cclxufSJdfQ==","originalSourcemap":{"version":3,"file":"ng-oauth2-pkce.service.js","sourceRoot":"","sources":["../../../../src/lib/ng-oauth2-pkce.service.ts"],"names":[],"mappings":[[[0,0,0,0],[7,0,0,7],[9,0,0,31],[33,0,0,55],[35,0,0,57],[41,0,0,63],[56,0,0,78],[57,0,0,79]],[[0,0,1,0],[7,0,1,7],[9,0,1,9],[26,0,1,26],[28,0,1,28],[44,0,1,44],[46,0,1,46],[52,0,1,52],[74,0,1,74],[75,0,1,75]],[[0,0,3,0],[7,0,3,7],[9,0,3,9],[28,0,3,28],[30,0,3,30],[36,0,3,36],[66,0,3,66],[67,0,3,67]],[[0,0,4,0],[7,0,4,7],[9,0,4,9],[22,0,4,22],[24,0,4,24],[30,0,4,30],[57,0,4,57],[58,0,4,58]],[[0,0,5,0],[7,0,5,7],[9,0,5,9],[29,0,5,29],[31,0,5,31],[37,0,5,37],[72,0,5,72],[73,0,5,73]],[[0,0,6,0],[7,0,6,7],[9,0,6,9],[28,0,6,28],[30,0,6,30],[36,0,6,36],[71,0,6,71],[72,0,6,72]],[[0,0,43,0]],[],[],[[3,0,46,3]],[[0,0,47,0],[7,0,47,7],[9,0,47,9],[17,0,47,17],[19,0,47,40],[25,0,47,46],[40,0,47,61],[41,0,47,62]],[[0,0,48,0],[7,0,48,7],[9,0,48,9],[21,0,48,21],[23,0,48,23],[29,0,48,29],[46,0,48,46],[47,0,48,47]],[],[[0,0,8,0]],[],[],[[3,0,11,3]],[[0,0,12,0],[6,0,12,6],[16,0,12,16],[29,0,12,29],[30,0,12,30],[36,0,12,50]],[[4,0,13,2],[11,0,13,9],[35,0,13,33],[36,0,13,34]],[[8,0,14,4],[43,0,14,39]],[[8,0,15,4],[10,0,15,6],[17,0,15,13],[19,0,15,15],[38,0,15,34],[40,0,15,36],[48,0,15,44],[50,0,15,46],[56,0,15,52],[58,0,15,54]],[[8,0,17,4],[38,0,17,34]],[[8,0,18,4],[21,0,18,17]],[[8,0,19,4],[28,0,19,24]],[[8,0,21,4],[54,0,21,50]],[[8,0,22,4],[25,0,22,21],[26,0,23,6],[42,0,23,22],[43,0,23,23],[44,0,23,24],[63,0,23,43],[64,0,23,44],[65,0,23,45],[66,0,24,5]],[[5,0,25,3],[6,0,25,4],[7,0,25,5]],[[0,0,26,0],[1,0,26,1]],[[0,0,28,0]],[],[],[[3,0,31,3]],[[0,0,32,0],[6,0,32,6],[16,0,32,16],[47,0,32,47],[48,0,32,48],[54,0,32,68]],[[4,0,33,2],[11,0,33,9],[35,0,33,33],[36,0,33,34]],[[8,0,34,4],[43,0,34,39]],[[8,0,35,4],[10,0,35,6],[17,0,35,13],[19,0,35,15],[38,0,35,34],[40,0,35,36],[48,0,35,44],[50,0,35,46],[56,0,35,52],[58,0,35,54]],[[8,0,37,4],[38,0,37,34]],[[8,0,38,4],[21,0,38,17]],[[8,0,39,4],[28,0,39,24]],[[5,0,40,3],[6,0,40,4],[7,0,40,5]],[[0,0,41,0],[1,0,41,1]],[[0,0,54,0],[6,0,54,6],[13,0,54,13],[31,0,54,31]],[[4,0,55,2],[10,0,55,8],[11,0,55,9],[18,0,55,16],[19,0,55,17],[25,0,55,37]],[[8,0,56,4],[15,0,56,11]],[[12,0,57,6],[20,0,57,14],[22,0,57,16],[40,0,57,34]],[[12,0,58,6],[21,0,58,15],[23,0,58,17]],[[16,0,59,8],[18,0,59,10],[25,0,59,17],[27,0,59,19],[46,0,59,38],[48,0,59,40],[56,0,59,48],[58,0,59,50],[64,0,59,56],[66,0,59,58]],[[16,0,60,8],[29,0,60,21]],[[16,0,61,8],[36,0,61,28]],[[13,0,62,7]],[[9,0,63,5],[10,0,63,6]],[[4,0,64,2],[5,0,64,3]],[[115,0,54,13],[133,0,54,31]],[[67,0,54,13],[85,0,54,31]],[[71,0,51,12],[83,0,51,24]],[],[[81,0,54,13],[99,0,54,31]],[[14,0,50,1],[22,0,50,9]],[[15,0,50,10]],[[16,0,51,2],[23,0,51,9],[25,0,51,11],[26,0,51,12],[38,0,51,24],[39,0,51,25]],[[16,0,52,2],[23,0,52,9],[25,0,52,11],[27,0,52,13]],[[13,0,53,1]],[],[[88,0,54,13],[106,0,54,31],[120,0,51,12],[132,0,51,24]]],"sourcesContent":["import { EnvironmentProviders, makeEnvironmentProviders } from '@angular/core';\r\nimport { provideHttpClient, withInterceptors } from '@angular/common/http';\r\nimport { OAuth2Config } from './models/oauth2-config.model';\r\nimport { OAUTH2_CONFIG_TOKEN } from './tokens/oauth2-config.token';\r\nimport { OAuth2Service } from './services/oauth2.service';\r\nimport { OAuth2StorageService } from './services/oauth2-storage.service';\r\nimport { oauth2InterceptorFn } from './interceptors/oauth2.interceptor';\r\n\r\n/**\r\n * Provide OAuth2 configuration and services\r\n * Use this function in your app.config.ts or main.ts\r\n */\r\nexport function provideOAuth2(config: OAuth2Config): EnvironmentProviders {\r\n  return makeEnvironmentProviders([\r\n    // Provide the OAuth2 configuration\r\n    { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\r\n    \r\n    // Provide the OAuth2 services\r\n    OAuth2Service,\r\n    OAuth2StorageService,\r\n    \r\n    // Provide HTTP client with OAuth2 interceptor\r\n    provideHttpClient(\r\n      withInterceptors([oauth2InterceptorFn])\r\n    )\r\n  ]);\r\n}\r\n\r\n/**\r\n * Provide OAuth2 configuration and services without HTTP interceptor\r\n * Use this if you want to manually configure the HTTP interceptor\r\n */\r\nexport function provideOAuth2WithoutInterceptor(config: OAuth2Config): EnvironmentProviders {\r\n  return makeEnvironmentProviders([\r\n    // Provide the OAuth2 configuration\r\n    { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\r\n    \r\n    // Provide the OAuth2 services\r\n    OAuth2Service,\r\n    OAuth2StorageService\r\n  ]);\r\n}\r\n\r\n/**\r\n * Legacy NgModule for backward compatibility\r\n * @deprecated Use provideOAuth2() function instead\r\n */\r\nimport { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  exports: []\r\n})\r\nexport class NgOAuth2PkceModule {\r\n  static forRoot(config: OAuth2Config): ModuleWithProviders<NgOAuth2PkceModule> {\r\n    return {\r\n      ngModule: NgOAuth2PkceModule,\r\n      providers: [\r\n        { provide: OAUTH2_CONFIG_TOKEN, useValue: config },\r\n        OAuth2Service,\r\n        OAuth2StorageService\r\n      ]\r\n    };\r\n  }\r\n}"]},"resolvedIds":{"@angular/core":{"attributes":{},"external":true,"id":"@angular/core","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common/http":{"attributes":{},"external":true,"id":"@angular/common/http","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"@angular/common":{"attributes":{},"external":true,"id":"@angular/common","meta":{},"moduleSideEffects":true,"resolvedBy":"rollup","syntheticNamedExports":false},"./tokens/oauth2-config.token":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./services/oauth2.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./services/oauth2-storage.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./interceptors/oauth2.interceptor":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/interceptors/oauth2.interceptor.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":2327,"body":[{"type":"ExportAllDeclaration","start":64,"end":113,"exported":null,"source":{"type":"Literal","start":78,"end":112,"value":"./lib/models/oauth2-config.model","raw":"'./lib/models/oauth2-config.model'"},"attributes":[]},{"type":"ExportAllDeclaration","start":114,"end":162,"exported":null,"source":{"type":"Literal","start":128,"end":161,"value":"./lib/models/oauth2-types.model","raw":"'./lib/models/oauth2-types.model'"},"attributes":[]},{"type":"ExportAllDeclaration","start":182,"end":228,"exported":null,"source":{"type":"Literal","start":196,"end":227,"value":"./lib/services/oauth2.service","raw":"'./lib/services/oauth2.service'"},"attributes":[]},{"type":"ExportAllDeclaration","start":229,"end":283,"exported":null,"source":{"type":"Literal","start":243,"end":282,"value":"./lib/services/oauth2-storage.service","raw":"'./lib/services/oauth2-storage.service'"},"attributes":[]},{"type":"ExportAllDeclaration","start":307,"end":361,"exported":null,"source":{"type":"Literal","start":321,"end":360,"value":"./lib/interceptors/oauth2.interceptor","raw":"'./lib/interceptors/oauth2.interceptor'"},"attributes":[]},{"type":"ExportAllDeclaration","start":383,"end":458,"exported":null,"source":{"type":"Literal","start":397,"end":457,"value":"./lib/components/oauth2-callback/oauth2-callback.component","raw":"'./lib/components/oauth2-callback/oauth2-callback.component'"},"attributes":[]},{"type":"ExportAllDeclaration","start":476,"end":523,"exported":null,"source":{"type":"Literal","start":490,"end":522,"value":"./lib/guards/oauth2-auth.guard","raw":"'./lib/guards/oauth2-auth.guard'"},"attributes":[]},{"type":"ExportAllDeclaration","start":541,"end":590,"exported":null,"source":{"type":"Literal","start":555,"end":589,"value":"./lib/tokens/oauth2-config.token","raw":"'./lib/tokens/oauth2-config.token'"},"attributes":[]},{"type":"ExportAllDeclaration","start":627,"end":672,"exported":null,"source":{"type":"Literal","start":641,"end":671,"value":"./lib/ng-oauth2-pkce.service","raw":"'./lib/ng-oauth2-pkce.service'"},"attributes":[]}],"_rollupRemoved":[{"end":2327,"start":673,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"/*\n * Public API Surface of ng-oauth2-pkce\n */\n// Export models\nexport * from './lib/models/oauth2-config.model';\nexport * from './lib/models/oauth2-types.model';\n// Export services\nexport * from './lib/services/oauth2.service';\nexport * from './lib/services/oauth2-storage.service';\n// Export interceptors\nexport * from './lib/interceptors/oauth2.interceptor';\n// Export components\nexport * from './lib/components/oauth2-callback/oauth2-callback.component';\n// Export guards\nexport * from './lib/guards/oauth2-auth.guard';\n// Export tokens\nexport * from './lib/tokens/oauth2-config.token';\n// Export main module and providers\nexport * from './lib/ng-oauth2-pkce.service';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGljLWFwaS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wdWJsaWMtYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztHQUVHO0FBRUgsZ0JBQWdCO0FBQ2hCLGNBQWMsa0NBQWtDLENBQUM7QUFDakQsY0FBYyxpQ0FBaUMsQ0FBQztBQUVoRCxrQkFBa0I7QUFDbEIsY0FBYywrQkFBK0IsQ0FBQztBQUM5QyxjQUFjLHVDQUF1QyxDQUFDO0FBRXRELHNCQUFzQjtBQUN0QixjQUFjLHVDQUF1QyxDQUFDO0FBRXRELG9CQUFvQjtBQUNwQixjQUFjLDREQUE0RCxDQUFDO0FBRTNFLGdCQUFnQjtBQUNoQixjQUFjLGdDQUFnQyxDQUFDO0FBRS9DLGdCQUFnQjtBQUNoQixjQUFjLGtDQUFrQyxDQUFDO0FBRWpELG1DQUFtQztBQUNuQyxjQUFjLDhCQUE4QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogUHVibGljIEFQSSBTdXJmYWNlIG9mIG5nLW9hdXRoMi1wa2NlXHJcbiAqL1xyXG5cclxuLy8gRXhwb3J0IG1vZGVsc1xyXG5leHBvcnQgKiBmcm9tICcuL2xpYi9tb2RlbHMvb2F1dGgyLWNvbmZpZy5tb2RlbCc7XHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5cclxuLy8gRXhwb3J0IHNlcnZpY2VzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL3NlcnZpY2VzL29hdXRoMi5zZXJ2aWNlJztcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZSc7XHJcblxyXG4vLyBFeHBvcnQgaW50ZXJjZXB0b3JzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL2ludGVyY2VwdG9ycy9vYXV0aDIuaW50ZXJjZXB0b3InO1xyXG5cclxuLy8gRXhwb3J0IGNvbXBvbmVudHNcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvY29tcG9uZW50cy9vYXV0aDItY2FsbGJhY2svb2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudCc7XHJcblxyXG4vLyBFeHBvcnQgZ3VhcmRzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL2d1YXJkcy9vYXV0aDItYXV0aC5ndWFyZCc7XHJcblxyXG4vLyBFeHBvcnQgdG9rZW5zXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuXHJcbi8vIEV4cG9ydCBtYWluIG1vZHVsZSBhbmQgcHJvdmlkZXJzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL25nLW9hdXRoMi1wa2NlLnNlcnZpY2UnOyJdfQ==","customTransformCache":false,"dependencies":["E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-config.model.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/interceptors/oauth2.interceptor.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/components/oauth2-callback/oauth2-callback.component.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/guards/oauth2-auth.guard.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/ng-oauth2-pkce.service.mjs"],"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/public-api.mjs","meta":{},"moduleSideEffects":true,"originalCode":"/*\n * Public API Surface of ng-oauth2-pkce\n */\n// Export models\nexport * from './lib/models/oauth2-config.model';\nexport * from './lib/models/oauth2-types.model';\n// Export services\nexport * from './lib/services/oauth2.service';\nexport * from './lib/services/oauth2-storage.service';\n// Export interceptors\nexport * from './lib/interceptors/oauth2.interceptor';\n// Export components\nexport * from './lib/components/oauth2-callback/oauth2-callback.component';\n// Export guards\nexport * from './lib/guards/oauth2-auth.guard';\n// Export tokens\nexport * from './lib/tokens/oauth2-config.token';\n// Export main module and providers\nexport * from './lib/ng-oauth2-pkce.service';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGljLWFwaS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wdWJsaWMtYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztHQUVHO0FBRUgsZ0JBQWdCO0FBQ2hCLGNBQWMsa0NBQWtDLENBQUM7QUFDakQsY0FBYyxpQ0FBaUMsQ0FBQztBQUVoRCxrQkFBa0I7QUFDbEIsY0FBYywrQkFBK0IsQ0FBQztBQUM5QyxjQUFjLHVDQUF1QyxDQUFDO0FBRXRELHNCQUFzQjtBQUN0QixjQUFjLHVDQUF1QyxDQUFDO0FBRXRELG9CQUFvQjtBQUNwQixjQUFjLDREQUE0RCxDQUFDO0FBRTNFLGdCQUFnQjtBQUNoQixjQUFjLGdDQUFnQyxDQUFDO0FBRS9DLGdCQUFnQjtBQUNoQixjQUFjLGtDQUFrQyxDQUFDO0FBRWpELG1DQUFtQztBQUNuQyxjQUFjLDhCQUE4QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogUHVibGljIEFQSSBTdXJmYWNlIG9mIG5nLW9hdXRoMi1wa2NlXHJcbiAqL1xyXG5cclxuLy8gRXhwb3J0IG1vZGVsc1xyXG5leHBvcnQgKiBmcm9tICcuL2xpYi9tb2RlbHMvb2F1dGgyLWNvbmZpZy5tb2RlbCc7XHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL21vZGVscy9vYXV0aDItdHlwZXMubW9kZWwnO1xyXG5cclxuLy8gRXhwb3J0IHNlcnZpY2VzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL3NlcnZpY2VzL29hdXRoMi5zZXJ2aWNlJztcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvc2VydmljZXMvb2F1dGgyLXN0b3JhZ2Uuc2VydmljZSc7XHJcblxyXG4vLyBFeHBvcnQgaW50ZXJjZXB0b3JzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL2ludGVyY2VwdG9ycy9vYXV0aDIuaW50ZXJjZXB0b3InO1xyXG5cclxuLy8gRXhwb3J0IGNvbXBvbmVudHNcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvY29tcG9uZW50cy9vYXV0aDItY2FsbGJhY2svb2F1dGgyLWNhbGxiYWNrLmNvbXBvbmVudCc7XHJcblxyXG4vLyBFeHBvcnQgZ3VhcmRzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL2d1YXJkcy9vYXV0aDItYXV0aC5ndWFyZCc7XHJcblxyXG4vLyBFeHBvcnQgdG9rZW5zXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL3Rva2Vucy9vYXV0aDItY29uZmlnLnRva2VuJztcclxuXHJcbi8vIEV4cG9ydCBtYWluIG1vZHVsZSBhbmQgcHJvdmlkZXJzXHJcbmV4cG9ydCAqIGZyb20gJy4vbGliL25nLW9hdXRoMi1wa2NlLnNlcnZpY2UnOyJdfQ==","originalSourcemap":{"version":3,"file":"public-api.js","sourceRoot":"","sources":["../../../src/public-api.ts"],"names":[],"mappings":[[[0,0,0,0]],[],[[3,0,2,3]],[[0,0,4,0],[16,0,4,16]],[[0,0,5,0],[14,0,5,14],[48,0,5,48],[49,0,5,49]],[[0,0,6,0],[14,0,6,14],[47,0,6,47],[48,0,6,48]],[[0,0,8,0],[18,0,8,18]],[[0,0,9,0],[14,0,9,14],[45,0,9,45],[46,0,9,46]],[[0,0,10,0],[14,0,10,14],[53,0,10,53],[54,0,10,54]],[[0,0,12,0],[22,0,12,22]],[[0,0,13,0],[14,0,13,14],[53,0,13,53],[54,0,13,54]],[[0,0,15,0],[20,0,15,20]],[[0,0,16,0],[14,0,16,14],[74,0,16,74],[75,0,16,75]],[[0,0,18,0],[16,0,18,16]],[[0,0,19,0],[14,0,19,14],[46,0,19,46],[47,0,19,47]],[[0,0,21,0],[16,0,21,16]],[[0,0,22,0],[14,0,22,14],[48,0,22,48],[49,0,22,49]],[[0,0,24,0],[35,0,24,35]],[[0,0,25,0],[14,0,25,14],[44,0,25,44],[45,0,25,45]]],"sourcesContent":["/*\r\n * Public API Surface of ng-oauth2-pkce\r\n */\r\n\r\n// Export models\r\nexport * from './lib/models/oauth2-config.model';\r\nexport * from './lib/models/oauth2-types.model';\r\n\r\n// Export services\r\nexport * from './lib/services/oauth2.service';\r\nexport * from './lib/services/oauth2-storage.service';\r\n\r\n// Export interceptors\r\nexport * from './lib/interceptors/oauth2.interceptor';\r\n\r\n// Export components\r\nexport * from './lib/components/oauth2-callback/oauth2-callback.component';\r\n\r\n// Export guards\r\nexport * from './lib/guards/oauth2-auth.guard';\r\n\r\n// Export tokens\r\nexport * from './lib/tokens/oauth2-config.token';\r\n\r\n// Export main module and providers\r\nexport * from './lib/ng-oauth2-pkce.service';"]},"resolvedIds":{"./lib/models/oauth2-config.model":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-config.model.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/models/oauth2-types.model":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/models/oauth2-types.model.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/services/oauth2.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/services/oauth2-storage.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/services/oauth2-storage.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/interceptors/oauth2.interceptor":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/interceptors/oauth2.interceptor.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/components/oauth2-callback/oauth2-callback.component":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/components/oauth2-callback/oauth2-callback.component.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/guards/oauth2-auth.guard":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/guards/oauth2-auth.guard.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/tokens/oauth2-config.token":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/tokens/oauth2-config.token.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false},"./lib/ng-oauth2-pkce.service":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/lib/ng-oauth2-pkce.service.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":500,"body":[{"type":"ExportAllDeclaration","start":48,"end":77,"exported":null,"source":{"type":"Literal","start":62,"end":76,"value":"./public-api","raw":"'./public-api'"},"attributes":[]}],"_rollupRemoved":[{"end":500,"start":78,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"/**\n * Generated bundle index. Do not edit.\n */\nexport * from './public-api';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2l0c3ByeS1hdXRoLW5nLWNsaWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy93aXRzcHJ5LWF1dGgtbmctY2xpZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztHQUVHO0FBRUgsY0FBYyxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEdlbmVyYXRlZCBidW5kbGUgaW5kZXguIERvIG5vdCBlZGl0LlxuICovXG5cbmV4cG9ydCAqIGZyb20gJy4vcHVibGljLWFwaSc7XG4iXX0=","customTransformCache":false,"dependencies":["E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/public-api.mjs"],"id":"E:\\Witspry\\SourceCode\\witspry-auth-ng-client\\dist\\witspry-auth-ng-client\\esm2022\\witspry-auth-ng-client.mjs","meta":{},"moduleSideEffects":true,"originalCode":"/**\n * Generated bundle index. Do not edit.\n */\nexport * from './public-api';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2l0c3ByeS1hdXRoLW5nLWNsaWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy93aXRzcHJ5LWF1dGgtbmctY2xpZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztHQUVHO0FBRUgsY0FBYyxjQUFjLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEdlbmVyYXRlZCBidW5kbGUgaW5kZXguIERvIG5vdCBlZGl0LlxuICovXG5cbmV4cG9ydCAqIGZyb20gJy4vcHVibGljLWFwaSc7XG4iXX0=","originalSourcemap":{"version":3,"file":"witspry-auth-ng-client.js","sourceRoot":"","sources":["../../../src/witspry-auth-ng-client.ts"],"names":[],"mappings":[[[0,0,0,0]],[],[[3,0,2,3]],[[0,0,4,0],[14,0,4,14],[28,0,4,28],[29,0,4,29]]],"sourcesContent":["/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]},"resolvedIds":{"./public-api":{"attributes":{},"external":false,"id":"E:/Witspry/SourceCode/witspry-auth-ng-client/dist/witspry-auth-ng-client/esm2022/public-api.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"file-loader","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]}],"plugins":{"file-loader":{},"json":{}}}